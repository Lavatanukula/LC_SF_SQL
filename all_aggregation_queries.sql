<br> </br>
TRUNCATE TABLE RECEIPTS_FOR_VOLUME_REBATE;
<br> </br>
TRUNCATE TABLE FACILITY_OUTBOUND_THROUGHPUT_JOINED;
<br> </br>
TRUNCATE TABLE OCEAN_FREIGHT_W_CONTAINER;
<br> </br>
TRUNCATE TABLE PURCHASE_ORDER_LINE_PREPAID;
<br> </br>
TRUNCATE TABLE FACILITY_LOCATION_3PL_MIXING_VOL_WEI_STACKED_PREPARED;
<br> </br>
TRUNCATE TABLE UNSELLABLES_AND_MISC_PREP_JOINED_PREPARED;
<br> </br>
TRUNCATE TABLE OMNI_MASTER_SALES_FINAL;
<br> </br>
TRUNCATE TABLE ROADIE_DROPOUT_FINAL;
<br> </br>
TRUNCATE TABLE VARIABLE_COST_COMBINED_MASTER_FILE;
<br> </br>
TRUNCATE TABLE BOOTH_RENTAL_FINAL;
<br> </br>
TRUNCATE TABLE DCSHRINK_RATE;
<br> </br>
TRUNCATE TABLE DC_SHRINK_FINAL;
<br> </br>
TRUNCATE TABLE DEFECTIVES_FINAL;
<br> </br>
TRUNCATE TABLE MIXING_CENTER_FINAL;
<br> </br>
TRUNCATE TABLE NEW_STORE_DISCOUNT_FINAL;
<br> </br>
TRUNCATE TABLE PDQ_FINAL;
<br> </br>
TRUNCATE TABLE POP_FINAL;
<br> </br>
TRUNCATE TABLE FREIGHT_OTHER_CHARGES_FINAL;
<br> </br>
TRUNCATE TABLE PRICE_CUTS_FINAL;
<br> </br>
TRUNCATE TABLE LM_SCANDOWN_FINAL;
<br> </br>
TRUNCATE TABLE DC_3PL_PNL_OMNI_FULFILLMENT_FIXED;
<br> </br>
TRUNCATE TABLE DC_3PL_PNL_OMNI_FULFILLMENT_VARIABLE;
<br> </br>
TRUNCATE TABLE DC_3PL_VARIABLE_COST_PREP_JOINED;
<br> </br>
TRUNCATE TABLE MARKETING_FINAL;
<br> </br>
TRUNCATE TABLE tsc_delivery_final;
<br> </br>
TRUNCATE TABLE multichannel_salvage;
<br> </br>
TRUNCATE TABLE dc_3pl_PandL_fixed_cost_final;
<br> </br>
TRUNCATE TABLE volume_rebate_2022_final;
<br> </br>
TRUNCATE TABLE vendor_support_fast_exception_final;
<br> </br>
TRUNCATE TABLE DC_3PL_Variable_Cost_prep_joined;
<br> </br>
TRUNCATE TABLE financial_inventory_master;
<br> </br>
TRUNCATE TABLE CASH_DISCOUNTS_BY_FLAG;
<br> </br>
TRUNCATE TABLE CASH_DISCOUNTS_BY_FLAG_FINAL;
<br> </br>
TRUNCATE TABLE cash_discounts_w_vendor_final;
<br> </br>
TRUNCATE TABLE DC_3PL_PANDL_FIXED_COST_FINAL;
<br> </br>
TRUNCATE TABLE LM_MARKDOWNS_FINAL;
<br> </br>
TRUNCATE TABLE MARKDOWNS_FINAL;
<br> </br>
TRUNCATE TABLE OMNI_ROADIE_FINAL;
<br> </br>
TRUNCATE TABLE SHRINK_INVENTORY_FINAL;
<br> </br>
TRUNCATE TABLE THEFT_FINAL;
<br> </br>
TRUNCATE TABLE UNSELLABLES_FINAL;
<br> </br>
TRUNCATE TABLE VENDOR_COMPLIANCE_FINAL;
<br> </br>
TRUNCATE TABLE VF_DEFECTIVE_FINAL;
<br> </br>
TRUNCATE TABLE VOLUME_REBATE_2021_2020_FINAL;
<br> </br>
TRUNCATE TABLE VOLUME_REBATE_DEVIATION_FINAL;
<br> </br>
TRUNCATE TABLE DC_3PL_VARIABLE_COST_COMBINED_STACKED;
<br> </br>
TRUNCATE TABLE DC_3PL_omni_fulfillment_base_final;
<br> </br>
TRUNCATE TABLE BATTERY_CORE_ALLOCATE;
<br> </br>
TRUNCATE TABLE BATTERY_CORE_FINAL;
<br> </br>
TRUNCATE TABLE MERCH_YEAR_YEAR_PERIOD;
<br> </br>
TRUNCATE TABLE OMNI_MASTER_SALES;
<br> </br>
TRUNCATE TABLE OMNI_MASTER_SALES_PREP;
<br> </br>
TRUNCATE TABLE OMNI_SMALL_PACKAGE_LTL_DROPOUT_BY_ALLOCATION_VALUE;
<br> </br>
TRUNCATE TABLE OMNI_SMALL_PACKAGE_LTL_DROPOUT_FINAL;
<br> </br>
TRUNCATE TABLE OMNI_SMALL_PACKAGE_LTL;
<br> </br>
TRUNCATE TABLE OMNI_SMALL_PACKAGE_LTL_GRP;
<br> </br>
TRUNCATE TABLE SMALL_PACKAGE_LTL_FINAL;
<br> </br>
TRUNCATE TABLE TENANT149_DATA_VOLUME_REBATE_2021_V2_PREPARED_BY_VENDOR_JOINED_BY_VENDOR_JOINED_PREPARED;
<br> </br>
TRUNCATE TABLE TENANT149_DATA_TIME_DIMENSION_BY_YEAR_PERIOD_PREPARED;
<br> </br>
TRUNCATE TABLE TENANT149_DATA_TIME_DIMENSION_BY_YEAR_PERIOD_BIGINT;
<br> </br>
TRUNCATE TABLE scandowns_final;
<br> </br>
TRUNCATE TABLE TENANT149_DATA_volume_rebate_2022_fold_by_Parent_Vendor_stacked_period;
<br> </br>
TRUNCATE TABLE markdowns_final_sf;
<br> </br>
TRUNCATE TABLE vendor_support_fast_exception;
<br> </br>
TRUNCATE TABLE volume_rebate_deviation;
<br> </br>
TRUNCATE TABLE scandowns_final_sf;
<br> </br>
TRUNCATE TABLE TENANT149_DATA_freight_other_charges_prepared_by_year;
<br> </br>
TRUNCATE TABLE volume_rebate_2021_2020_allocate;
<br> </br>
TRUNCATE TABLE price_cuts_allocate;
<br> </br>
TRUNCATE TABLE lm_scandown_prepared_filtered;
<br> </br>
TRUNCATE TABLE TENANT149_lm_markdowns_new_filtered;
<br> </br>
TRUNCATE TABLE TENANT149_DATA_TIME_DIMENSION_PREPARED
<br> </br>
TRUNCATE TABLE TENANT149_dc_3pl_PnL_omni_fulfillment_variable;
<br> </br>
TRUNCATE TABLE TENANT149_dc_3pl_PnL_omni_fulfillment_fixed;
<br> </br>
TRUNCATE TABLE UNSELLABLES_ALLOCATE;
<br> </br>
TRUNCATE TABLE DEFECTIVES_ALLOCATE;
<br> </br>
TRUNCATE TABLE DC_SHRINK_ALLOCATE;
<br> </br>
TRUNCATE TABLE THEFT_ALLOCATE;
<br> </br>
TRUNCATE TABLE SHRINK_ALLOCATE;
<br> </br>
TRUNCATE TABLE MIXING_CENTER_CREDIT_PREP;
<br> </br>
TRUNCATE TABLE VF_DEFECTIVE_ALLOCATE;
<br> </br>
TRUNCATE TABLE TENANT149_DATA_NEW_STORE_DISCOUNT_PREPARED_PREPARED_BY_NSD_SKU;
<br> </br>
TRUNCATE TABLE POP_ALLOCATE;
<br> </br>
TRUNCATE TABLE PDQ_ALLOCATE_FILTERED;
<br> </br>
TRUNCATE TABLE MARKETING_ALLOCATE;
<br> </br>
TRUNCATE TABLE VENDOR_COMPLIANCE_ALLOCATE;
<br> </br>
TRUNCATE TABLE CASH_DISCOUNTS_W_VENDOR;
<br> </br>
TRUNCATE TABLE DC_3PL_omni_fulfillment_base;
<br> </br>
TRUNCATE TABLE DO_FLOW_PATH;
<br> </br>
TRUNCATE TABLE DOMESTIC_SHIPPING_FREIGHT_DO_ALLOCATION;
<br> 
---Lava's 
/*FACILITY_INBOUND_DC_ONLY_QTY*/
</br>

CREATE OR REPLACE  TEMPORARY TABLE  "FACILITY_INBOUND_DC_ONLY_QTY"
AS
SELECT  
         CASE WHEN facility.period <= '9' THEN   CONCAT(facility.acct_year,CONCAT('0' ,facility.period)) 
         ELSE  CONCAT(facility.acct_year, facility.period::VARCHAR) END  AS  YEAR_PERIOD,		 
         facility.article_no,
         facility.vendor_id,
         facility.store_no,
         to_double((Sum(facility.vendor_rcpt_unit_qty))) as vendor_rcpt_unit_qty_sum
FROM      facility_inbound_20to22 facility
JOIN     DC_3pl_Location_Mapping_Prepared DC
ON       facility.store_no=DC."FACILITY_CODE"
WHERE DC."DC_3PL" ='DC'
GROUP BY facility.store_no,facility.vendor_id,facility.article_no,
         ( CASE WHEN facility.period <= '9' THEN   CONCAT(facility.acct_year,CONCAT('0' ,facility.period)) 
         ELSE  CONCAT(facility.acct_year, facility.period::VARCHAR) END);
		 
<br>
/*DC_3PL_PNL_OMNI_FULFILLMENT_JOINED*/
</br>
CREATE OR REPLACE TEMPORARY TABLE DC_3PL_PNL_OMNI_FULFILLMENT_JOINED
AS 
SELECT 
    A."STORE_NO" AS "STORE_NO",
    A."YEAR_PERIOD" AS "YEAR_PERIOD",
    A."Cost_Type",
    A."allocation_value",
    A."channel" AS "channel",
    tim_."MERCH_YEAR" AS "MERCH_YEAR"
FROM 
  (
SELECT 
    dc_ful."Cost Center" AS "STORE_NO",
    "Period",
    CONCAT("Year" ,LPAD("Period" , 2, '0')) AS "YEAR_PERIOD",
    dc_ful."Year" AS "Year",
    dc_ful."Cost_Type" AS "Cost_Type",
    dc_ful."Actual_sum" AS "allocation_value",
    'Omni' AS "channel"
  FROM  dc_3pl_pnl_omni_fulfillment_by_cost_center dc_ful
  )A 
  LEFT JOIN (SELECT 
             "YEAR_PERIOD" AS "YEAR_PERIOD",
             "MERCH_YEAR" AS "MERCH_YEAR",
             "YEAR_QUARTER" AS "YEAR_QUARTER"
             FROM "EDW"."TIME_DIMENSION"
            GROUP BY "YEAR_PERIOD", "MERCH_YEAR", "YEAR_QUARTER") tim_
    ON A."YEAR_PERIOD" = tim_."YEAR_PERIOD";

<br>
--SALES_W_PAR_VENDOR
</br>
CREATE OR REPLACE TEMP TABLE SALES_W_PAR_VENDOR AS
SELECT 
    "sales_aggregated_weekly"."CO_CODE" AS "CO_CODE",
    "sales_aggregated_weekly"."ARTICLE_NO" AS "ARTICLE_NO",
    "sales_aggregated_weekly"."SUM_TYPE_CODE" AS "SUM_TYPE_CODE",
    "sales_aggregated_weekly"."VENDOR_ID" AS "VENDOR_ID",
    "sales_aggregated_weekly"."PRICE_OVRD_FLAG" AS "PRICE_OVRD_FLAG",
    "sales_aggregated_weekly"."SCAN_ITEM_FLAG" AS "SCAN_ITEM_FLAG",
    "sales_aggregated_weekly"."PRICE_TYPE_CODE" AS "PRICE_TYPE_CODE",
    "sales_aggregated_weekly"."BUY_ONLINE_CODE" AS "BUY_ONLINE_CODE",
    "sales_aggregated_weekly"."MERCH_YEAR" AS "MERCH_YEAR",
    "sales_aggregated_weekly"."YEAR_WEEK" AS "YEAR_WEEK",
    "sales_aggregated_weekly"."YEAR_QUARTER" AS "YEAR_QUARTER",
    "sales_aggregated_weekly"."YEAR_PERIOD" AS "YEAR_PERIOD",
    "sales_aggregated_weekly"."ARTICLE_DESC" AS "ARTICLE_DESC",
    "sales_aggregated_weekly"."ARTICLE_FULL" AS "ARTICLE_FULL",
    "sales_aggregated_weekly"."ARTICLE_TYPE_NAME" AS "ARTICLE_TYPE_NAME",
    "sales_aggregated_weekly"."ARTICLE_TYPE_CODE" AS "ARTICLE_TYPE_CODE",
    "sales_aggregated_weekly"."ARTICLE_TYPE_FULL" AS "ARTICLE_TYPE_FULL",
    "sales_aggregated_weekly"."LABEL_TYPE_CODE" AS "LABEL_TYPE_CODE",
    "sales_aggregated_weekly"."UOM_CODE" AS "UOM_CODE",
    "sales_aggregated_weekly"."UOM_DESC" AS "UOM_DESC",
    "sales_aggregated_weekly"."UOM_FULL" AS "UOM_FULL",
    "sales_aggregated_weekly"."ARTICLE_LENGTH" AS "ARTICLE_LENGTH",
    "sales_aggregated_weekly"."ARTICLE_WIDTH" AS "ARTICLE_WIDTH",
    "sales_aggregated_weekly"."ARTICLE_HEIGHT" AS "ARTICLE_HEIGHT",
    "sales_aggregated_weekly"."ARTICLE_WEIGHT" AS "ARTICLE_WEIGHT",
    "sales_aggregated_weekly"."ARTICLE_SIZE" AS "ARTICLE_SIZE",
    "sales_aggregated_weekly"."ARTICLE_COUNT" AS "ARTICLE_COUNT",
    "sales_aggregated_weekly"."LOC_TYPE_CODE" AS "LOC_TYPE_CODE",
    "sales_aggregated_weekly"."PRIMARY_VENDOR_ID" AS "PRIMARY_VENDOR_ID",
    "sales_aggregated_weekly"."ARTICLE_CAT_CODE" AS "ARTICLE_CAT_CODE",
    "sales_aggregated_weekly"."ARTICLE_CAT_NAME" AS "ARTICLE_CAT_NAME",
    "sales_aggregated_weekly"."ARTICLE_CAT_FULL" AS "ARTICLE_CAT_FULL",
    "sales_aggregated_weekly"."DEPT_CODE" AS "DEPT_CODE",
    "sales_aggregated_weekly"."DEPT_NAME" AS "DEPT_NAME",
    "sales_aggregated_weekly"."DEPT_FULL" AS "DEPT_FULL",
    "sales_aggregated_weekly"."LOB_NO" AS "LOB_NO",
    "sales_aggregated_weekly"."LOB_DESC" AS "LOB_DESC",
    "sales_aggregated_weekly"."LOB_FULL" AS "LOB_FULL",
    "sales_aggregated_weekly"."MAJ_DEPT_NO" AS "MAJ_DEPT_NO",
    "sales_aggregated_weekly"."MAJ_DEPT_DESC" AS "MAJ_DEPT_DESC",
    "sales_aggregated_weekly"."MAJ_DEPT_FULL" AS "MAJ_DEPT_FULL",
    "sales_aggregated_weekly"."BRAND_NAME" AS "BRAND_NAME",
    "sales_aggregated_weekly"."PVT_LABEL_DESC" AS "PVT_LABEL_DESC",
    "sales_aggregated_weekly"."VENDOR_NAME" AS "VENDOR_NAME",
    "sales_aggregated_weekly"."VENDOR_FULL" AS "VENDOR_FULL",
    "sales_aggregated_weekly"."VENDOR_CO_NAME" AS "VENDOR_CO_NAME",
    "sales_aggregated_weekly"."REGION_CODE" AS "REGION_CODE",
    "sales_aggregated_weekly"."SALES_QTY" AS "SALES_QTY",
    "sales_aggregated_weekly"."SALES_AMT" AS "SALES_AMT",
    "sales_aggregated_weekly"."COST_AMT" AS "COST_AMT",
    "sales_aggregated_weekly"."DISC_AMT" AS "DISC_AMT",
    "sales_aggregated_weekly"."OVRD_AMT" AS "OVRD_AMT",
    "sales_aggregated_weekly"."TRANS_TAX_AMT" AS "TRANS_TAX_AMT",
    "sales_aggregated_weekly"."gross_sales" AS "gross_sales",
    "company_parent_vendor_prepared"."PARENT_VENDOR_ID" AS "PARENT_VENDOR_ID"
  FROM SALES_AGGREGATED_WEEKLY "sales_aggregated_weekly"
  LEFT JOIN COMPANY_PARENT_VENDOR_PREPARED "company_parent_vendor_prepared"
    ON cast("sales_aggregated_weekly"."VENDOR_ID" as number) = "company_parent_vendor_prepared"."VENDOR_ID";

<br>
--SALES_W_ARTICLE_YEAR
</br>
CREATE OR REPLACE  TEMPORARY TABLE "SALES_W_ARTICLE_YEAR"
AS
SELECT
  "ARTICLE_NO",
  "ARTICLE_CAT_CODE",
  "ARTICLE_CAT_NAME",
  SUM("COST_AMT") AS "COST_AMT"
FROM "SALES_W_PAR_VENDOR"
WHERE "YEAR_PERIOD" <= (TRIM(REPLACE(LEFT(ADD_MONTHS(GETDATE(),-1),7),'-',''))) AND "YEAR_WEEK" >= (YEAR((DATEADD(WEEK,-52,(LAST_DAY(ADD_MONTHS(GETDATE(),-1))))))||''||WEEK((DATEADD(WEEK,-52,(LAST_DAY(ADD_MONTHS(GETDATE(),-1)))))))
GROUP BY "ARTICLE_NO", "ARTICLE_CAT_CODE", "ARTICLE_CAT_NAME";

<br>
----------------------------
--Abhilash's

--CAL_BY_PERIOD_WEEK
--------------------
</br>
CREATE OR REPLACE TEMPORARY TABLE CAL_BY_PERIOD_WEEK AS
SELECT 
    "MERCH_YEAR" AS "MERCH_YEAR",
    "YEAR_QUARTER" AS "YEAR_QUARTER",
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "YEAR_WEEK" AS "YEAR_WEEK"
FROM EDW."TIME_DIMENSION"
GROUP BY "MERCH_YEAR", "YEAR_QUARTER", "YEAR_PERIOD", "YEAR_WEEK";

<br>		  
/*INVENTORY_BY_ARTICE_WEEK_JOINED_FILTERED_PREPARED*/		  
</br>
CREATE OR REPLACE TEMPORARY TABLE "INVENTORY_BY_ARTICE_WEEK_JOINED_FILTERED_PREPARED"
AS
SELECT
  i."CO_CODE" AS "CO_CODE",
  i."ARTICLE_NO" AS "ARTICLE_NO",
  i."YEAR_WEEK" AS "YEAR_WEEK",
  i."TIME_DIM_KEY" AS "TIME_DIM_KEY",
  i."FIN_INV_53_AMT_SUM" AS "FIN_INV_53_AMT_sum",
      "FIN_INV_53_AMT_SUM"/53 AS "weekly_inv",
  c."MERCH_YEAR" AS "MERCH_YEAR",
  c."YEAR_QUARTER" AS "YEAR_QUARTER",
  c."YEAR_PERIOD" AS "YEAR_PERIOD"
FROM "INVENTORY_BY_ARTICE_WEEK" i
LEFT JOIN "CAL_BY_PERIOD_WEEK" c
  ON i."YEAR_WEEK" = c."YEAR_WEEK"
WHERE (i."YEAR_WEEK" = (YEAR((DATEADD(WEEK,-52,(LAST_DAY(ADD_MONTHS(GETDATE(),-1))))))||''||WEEK((DATEADD(WEEK,-52,(LAST_DAY(ADD_MONTHS(GETDATE(),-1)))))))) OR (c."YEAR_PERIOD" = (TRIM(REPLACE(LEFT(ADD_MONTHS(GETDATE(),-1),7),'-',''))));

<br>		  
/*INVENTORY_BY_CATEGORY_AVG*/		  
</br>  
CREATE OR REPLACE TEMPORARY TABLE "INVENTORY_BY_CATEGORY_AVG"
AS
SELECT 
    "ARTICLE_CAT_CODE", "ARTICLE_CAT_NAME",AVG(DISTINCT  "weekly_inv") as "weekly_inv_avg"
FROM (
  SELECT 
    b."ARTICLE_CAT_CODE" AS "ARTICLE_CAT_CODE",
    b."ARTICLE_CAT_NAME" AS "ARTICLE_CAT_NAME",
    a."YEAR_WEEK" AS "YEAR_WEEK",
    SUM (DISTINCT  a."weekly_inv") AS "weekly_inv"
  FROM "INVENTORY_BY_ARTICE_WEEK_JOINED_FILTERED_PREPARED" a
  LEFT JOIN ARTICLE_W_SHP_DIM_PREP b
    ON a."ARTICLE_NO" = b."ARTICLE_NO" 
  GROUP BY "ARTICLE_CAT_CODE", "ARTICLE_CAT_NAME", "YEAR_WEEK"
  )  
GROUP BY "ARTICLE_CAT_CODE", "ARTICLE_CAT_NAME"	;

<br>	
/*"AVG_INV_BY_ARTICLE"*/			
</br>		  
CREATE OR REPLACE TEMPORARY TABLE "AVG_INV_BY_ARTICLE"
AS
SELECT 
  a."ARTICLE_NO" AS "ARTICLE_NO",
  2021 AS "year",
  AVG(a."weekly_inv") AS "weekly_inv",
  COUNT(*) AS "count"
FROM "INVENTORY_BY_ARTICE_WEEK_JOINED_FILTERED_PREPARED" a
INNER JOIN (
              SELECT 
                    "ARTICLE_NO" AS "ARTICLE_NO",
                    COUNT( DISTINCT "YEAR_WEEK") AS "YEAR_WEEK_",
                    COUNT(*) AS "count"
                    FROM "INVENTORY_BY_ARTICE_WEEK_JOINED_FILTERED_PREPARED"
                GROUP BY "ARTICLE_NO"
                HAVING  COUNT(DISTINCT  "YEAR_WEEK") =2  
            ) b
  ON a."ARTICLE_NO" = b."ARTICLE_NO"
  GROUP BY a."ARTICLE_NO", "year"	;	  

<br>	
 /*INVENTORY_BY_CATEGORY_AVG_JOINED_PREPARED*/	
</br>
CREATE OR REPLACE TEMPORARY TABLE "INVENTORY_BY_CATEGORY_AVG_JOINED_PREPARED" 
AS
WITH CTE AS (

            SELECT  *,
                CASE 
                  WHEN ROUND("turn_period_decimal", 0) >= "turn_period_decimal" THEN ROUND("turn_period_decimal", 0) 
                  ELSE ROUND("turn_period_decimal", 0) + 1 
                END AS "turn_period" 
            FROM (
                  SELECT *, 
                        CASE WHEN "inventory_period_calc" <= 1 THEN 1 
                              ELSE CASE 
                                    WHEN "inventory_period_calc" >= 12 THEN 12 
                                      ELSE "inventory_period_calc" 
                                      END  
                        END AS "turn_period_decimal" 
                  FROM 
                      (
                      SELECT * , 
                          CAST(12 AS DOUBLE) / NULLIF("inventory_turn", 0) AS "inventory_period_calc"
                      FROM 
                          (
                          SELECT 
                              ca."ARTICLE_CAT_CODE" AS "ARTICLE_CAT_CODE",
                              ca."ARTICLE_CAT_NAME" AS "ARTICLE_CAT_NAME",
                              ca."weekly_inv_avg" AS "weekly_inv_avg",
                              sac."COST_AMT" AS "COST_AMT",
                              ROUND(ca."weekly_inv_avg", 0) AS "round_weekly_inv_avg",
                              CASE WHEN ("COST_AMT" = 0) OR "COST_AMT" IS NULL THEN 0 
                              ELSE
                                  CASE WHEN ((ROUND(ca."weekly_inv_avg", 0)) = 0) OR (ROUND(ca."weekly_inv_avg", 0)) IS NULL THEN 99999999 
                                        ELSE CAST(COALESCE("COST_AMT", 0) AS DOUBLE) / NULLIF(COALESCE((ROUND(ca."weekly_inv_avg", 0)), 0), 0) END 
                              END AS "inventory_turn"
                          FROM "INVENTORY_BY_CATEGORY_AVG" ca
                          LEFT JOIN (
                                      SELECT 
                                          "ARTICLE_CAT_CODE" AS "ARTICLE_CAT_CODE",
                                          "ARTICLE_CAT_NAME" AS "ARTICLE_CAT_NAME",
                                          SUM("COST_AMT") AS "COST_AMT"
                                      FROM "SALES_W_ARTICLE_YEAR"
                                      GROUP BY "ARTICLE_CAT_CODE", "ARTICLE_CAT_NAME"
                                    ) sac
                          ON ca."ARTICLE_CAT_CODE" = sac."ARTICLE_CAT_CODE"
                          )A
                      )B
                    )C

            )   
SELECT 
    "ARTICLE_CAT_CODE" AS "ARTICLE_CAT_CODE",
    "ARTICLE_CAT_NAME" AS "ARTICLE_CAT_NAME",
    "weekly_inv_avg" AS "weekly_inv_avg",
    "round_weekly_inv_avg" AS "round_weekly_inv_avg",
    "inventory_turn" AS "inventory_turn",
    "inventory_period_calc" AS "inventory_period_calc",
    "turn_period" AS "turn_period",
    "COST_AMT" AS "COST_AMT"
FROM CTE ;


<br>
---FINAL QUERY 
  /*TURN_PERIOD_MASTER*/
</br>
CREATE OR REPLACE TEMPORARY TABLE "TURN_PERIOD_MASTER"
AS
WITH CTE AS 
(
SELECT  * ,  
        CASE WHEN "inventory_period_calc" <= 1 THEN 1 
              ELSE 
                   CASE WHEN "inventory_period_calc" >= 12 THEN 12 
                        ELSE "inventory_period_calc" 
              END 
        END AS "turn_period_decimal" 
FROM (
SELECT *,CAST(12 AS DOUBLE) / NULLIF("inventory_turn", 0) AS "inventory_period_calc" 
FROM (
SELECT 
    a."ARTICLE_NO" AS "ARTICLE_NO",
    a."year" AS "year",
    a."weekly_inv" AS "weekly_inv_avg",
    a."count" AS "count",
    s."COST_AMT" AS "COST_AMT",
     ROUND("weekly_inv_avg", 0) AS "round_weekly_inv_avg",
     CASE WHEN ("COST_AMT" = 0) OR "COST_AMT" IS NULL THEN 0 ELSE 
          CASE WHEN ((ROUND("weekly_inv_avg", 0)) = 0) OR (ROUND("weekly_inv_avg", 0)) IS NULL THEN 99999999 
               ELSE CAST(COALESCE("COST_AMT", 0) AS DOUBLE) / NULLIF(COALESCE((ROUND("weekly_inv_avg", 0)), 0), 0) 
          END 
    END AS "inventory_turn"    
  FROM "AVG_INV_BY_ARTICLE" a
  LEFT JOIN "SALES_W_ARTICLE_YEAR" s
    ON a."ARTICLE_NO" = s."ARTICLE_NO")A
      )B
) 

SELECT  *,
      COALESCE("turn_period_article", "turn_period_cat", 12) AS "turn_period" 
FROM 
(
SELECT 
    t."ARTICLE_NO" AS "ARTICLE_NO",
    t."ARTICLE_CAT_CODE" AS "ARTICLE_CAT_CODE",
    t."ARTICLE_CAT_NAME" AS "ARTICLE_CAT_NAME",
    i."inventory_turn" AS "inventory_turn_ratio_cat",
    i."turn_period" AS "turn_period_cat",
    c."inventory_turn" AS "inventory_turn_ratio_article",
     CASE WHEN ROUND(c."turn_period_decimal", 0) >= c."turn_period_decimal" THEN ROUND(c."turn_period_decimal", 0) 
     ELSE ROUND(c."turn_period_decimal", 0) + 1 END  AS "turn_period_article"     
  FROM  
     (SELECT 
       "ARTICLE_NO" AS "ARTICLE_NO",
       "ARTICLE_CAT_CODE" AS "ARTICLE_CAT_CODE",
       "ARTICLE_CAT_NAME" AS "ARTICLE_CAT_NAME" 
      FROM  ARTICLE_W_SHP_DIM_PREP
      GROUP BY "ARTICLE_NO", "ARTICLE_CAT_CODE", "ARTICLE_CAT_NAME" ) t
  LEFT JOIN "INVENTORY_BY_CATEGORY_AVG_JOINED_PREPARED" i
    ON t."ARTICLE_CAT_CODE" = i."ARTICLE_CAT_CODE"
  LEFT JOIN CTE c
    ON t."ARTICLE_NO" = c."ARTICLE_NO"
    )A;
	
	
<br>
/*FREIGHT_DETAIL_ROADIE_WINDOWS_JOINED_PREPARED*/
</br>
 
CREATE OR REPLACE TEMPORARY TABLE "FREIGHT_DETAIL_ROADIE_WINDOWS_JOINED_PREPARED"
AS
SELECT  order_date,
       order_no,
       po_order_no,
       order_line_key,
       po_order_line_key,
       oms_item_parcel_ship_flag,
       oms_item_id,
       oms_shipment_line_item_desc,
       oms_ship_node_key,
       roa_tracking_number,
       scac,
       shipment_item_weight,
       shipment_total_weight,
       shipment_share_by_weight,
       roadie_total_cost_sum,
       COALESCE(roadie_total_cost_sum, 0) * COALESCE(shipment_share_by_weight, 0) AS trans_amt_by_weight
FROM (
              SELECT order_date,
                     order_no,
                     po_order_no,
                     order_line_key,
                     po_order_line_key,
                     oms_item_parcel_ship_flag,
                     oms_item_id,
                     oms_shipment_line_item_desc,
                     oms_ship_node_key,
                     roa_tracking_number,
                     scac,
                     shipment_item_weight,
                     shipment_total_weight,
                     CASE
                            WHEN COALESCE(shipment_total_weight, 0) = 0 THEN 0
                            ELSE COALESCE(shipment_item_weight, 0) / COALESCE(shipment_total_weight, 0)
                     END AS shipment_share_by_weight,
                     roadie_total_cost_sum

        FROM (

                               SELECT    frt.order_date,
                                         frt.order_no,
                                         frt.po_order_no,
                                         frt.order_line_key,
                                         frt.po_order_line_key,
                                         frt.oms_item_parcel_ship_flag,
                                         frt.oms_item_id,
                                         frt.oms_shipment_line_item_desc,
                                         frt.oms_ship_node_key,
                                         frt.shipment_total_weight_sum AS shipment_item_weight,
                                         frt.scac,
                                         frt.roa_tracking_number,
					                   sum(frt.shipment_total_weight_sum) OVER (partition BY frt.roa_tracking_number) AS shipment_total_weight,							                   rts.roadie_total_cost_sum AS roadie_total_cost_sum
                               FROM    (
                                                  SELECT    order_date,
                                                           order_no,
                                                           po_order_no,
                                                           order_line_key,
                                                           po_order_line_key,
                                                           oms_item_parcel_ship_flag,
                                                           oms_item_id,
                                                           oms_shipment_line_item_desc,
                                                           oms_ship_node_key,
                                                           roa_tracking_number,
                                                           scac,
                                                           sum(COALESCE(line_weight,0)) AS shipment_total_weight_sum
                                                  FROM     FREIGHT_DETAIL_ROADIE_PREPARED
                                                  WHERE    roa_roadie_flag = 1
                                                  GROUP BY order_date,
                                                           order_no,
                                                           po_order_no,
                                                           order_line_key,
                                                           po_order_line_key,
                                                           oms_item_parcel_ship_flag,
                                                           oms_item_id,
                                                           oms_shipment_line_item_desc,
                                                           oms_ship_node_key,
                                                           scac,
                                                           roa_tracking_number) frt
                               LEFT JOIN ROADIE_TRACTOR_SUPPLY_INVOICE_STACKED_BY_TRACKING_NUMBER rts
                               ON        frt.roa_tracking_number = rts.tracking_number )B
)Final ;

<br>
--A8--TENANT149_DATA_time_dimension_prepared
</br>
insert into  TENANT149_DATA_TIME_DIMENSION_PREPARED 
SELECT 
   *,
   TO_TIMESTAMP_TZ(TO_TIMESTAMP_NTZ(CAST("TIME_DIM_KEY" AS VARCHAR),'YYYYMMDD'))as "DATE"
FROM 
  (
    SELECT 
        TIME_DIM_KEY AS TIME_DIM_KEY,
        CAL_DATE AS CAL_DATE,
        WEEK_IN_YEAR AS WEEK_IN_YEAR,
        WEEK AS WEEK,
        PERIOD AS PERIOD,
        QUARTER AS QUARTER,
        HOLIDAY_FLAG AS HOLIDAY_FLAG,
        SEASON_DESC AS SEASON_DESC,
        WEEKEND_FLAG AS WEEKEND_FLAG,
         TIME_DIM_UPD_TS,
        MERCH_YEAR AS MERCH_YEAR,
        ACCT_YEAR AS ACCT_YEAR,
        WEEK_DAY AS WEEK_DAY,
        MONTH_END_FLAG AS MONTH_END_FLAG,
        YEAR_WEEK AS YEAR_WEEK,
        YEAR_WEEK_START_DATE AS YEAR_WEEK_START_DATE,
        YEAR_WEEK_END_DATE AS YEAR_WEEK_END_DATE,
        YEAR_QUARTER AS YEAR_QUARTER,
        YEAR_PERIOD AS YEAR_PERIOD,
        LAST_FISCAL_YEAR_TIME_DIM_KEY AS LAST_FISCAL_YEAR_TIME_DIM_KEY,
        WEEKS_52_BACK_TIME_DIM_KEY AS WEEKS_52_BACK_TIME_DIM_KEY,
        WEEKS_104_BACK_TIME_DIM_KEY,
        WEEK_END_DATE AS WEEK_END_DATE,
        MONTH_END_IND AS MONTH_END_IND,
        QUARTER_END_IND AS QUARTER_END_IND,
        HALF_YEAR_END_IND AS HALF_YEAR_END_IND,
        YEAR_END_IND AS YEAR_END_IND
    FROM EDW.TIME_DIMENSION
)DKU;

<br>	  
--AGENCY_FEE_W_ARTICLE_JOINED_FILTERED
</br>
CREATE OR REPLACE TEMPORARY TABLE "AGENCY_FEE_W_ARTICLE_JOINED_FILTERED"
AS
SELECT 
    A."PODATE" AS "PODATE",
    A."PONUM" AS "PONUM",
    A."ITEMNUM" AS "ITEMNUM",
    A."NET" AS "NET",
    A."PER" AS "PER",
    A."FEE" AS "FEE",
    P."ARTICLE_NO" AS "ARTICLE_NO",
    P."VENDOR_ID" AS "VENDOR_ID",
    T."MERCH_YEAR" AS "MERCH_YEAR",
    T."YEAR_WEEK" AS "YEAR_WEEK",
    T."YEAR_QUARTER" AS "YEAR_QUARTER",
    T."YEAR_PERIOD" AS "YEAR_PERIOD"
  FROM "AGENCY_FEE_PREPARED_PREPARED" A
  LEFT JOIN "EDW"."VW_PURCHASE_ORDER_LINE" P
    ON A."PONUM" = P."PO_NO"
      AND A."ITEMNUM" = P."PO_LINE_NO"
 LEFT JOIN "EDW"."VW_TIME_DIMENSION" T
    ON A."PODATE" = T."TIME_DIM_KEY"
 WHERE T."MERCH_YEAR" >= 2020;

<br> 
--TIME_DIMENSION_BY_YEAR_PERIOD
</br> 
CREATE OR REPLACE TEMPORARY TABLE TIME_DIMENSION_BY_YEAR_PERIOD AS
SELECT  YEAR_PERIOD
  FROM EDW.TIME_DIMENSION
  GROUP BY "YEAR_PERIOD"  ;

<br> 
--Staging table 2  
 --Creating dataset TIME_DIMENSION_BY_YEAR_PERIOD_FILTERED
 
-- CREATE OR REPLACE TEMPORARY TABLE  "TIME_DIMENSION_BY_YEAR_PERIOD_FILTERED"
</br> 
CREATE or replace TEMPORARY TABLE TIME_DIMENSION_BY_YEAR_PERIOD_FILTERED AS
SELECT DISTINCT
   YEAR_PERIOD
FROM TIME_DIMENSION_BY_YEAR_PERIOD
WHERE YEAR_PERIOD >= 202001 AND YEAR_PERIOD <= (TRIM(REPLACE(LEFT(ADD_MONTHS(GETDATE(),-1),7),'-','')));
	
<br>
 --Staging table 3 
 --Creating staging table "AGENCY_FEE_TURN_PERIOD_BASE"
</br> 
 
CREATE OR REPLACE TEMPORARY TABLE "AGENCY_FEE_TURN_PERIOD_BASE"
AS
WITH "AGENCY_FEE_TURN_PERIOD_BASE" AS
(
          SELECT     A.article_no,
                    A.vendor_id,
                    A.year_period,
                    A.per,
                    tpm."turn_period"
          FROM      (
                             SELECT   article_no,
                                      vendor_id,
                                      year_period,
                                      Avg(per) AS per
                             FROM     (
                                               SELECT    article_no,
                                                        vendor_id,
                                                        year_period,
                                                        Avg(per) AS per
                                               FROM     AGENCY_FEE_W_ARTICLE_JOINED_FILTERED
                                               GROUP BY article_no,
                                                        vendor_id,
                                                        year_period
                                               UNION ALL
                                               SELECT  af.article_no,
                                                      af.vendor_id,
                                                      tdf.year_period,
                                                      Null as per
                                               FROM 
                                               (SELECT      article_no,
                                                           vendor_id
                                               FROM       AGENCY_FEE_W_ARTICLE_JOINED_FILTERED GROUP BY article_no,vendor_id ) af
                                               CROSS JOIN TIME_DIMENSION_BY_YEAR_PERIOD_FILTERED tdf
                                                            )Agency_fee_w_article_joined_filtered_by_ARTICLE_NO_stacked
                             GROUP BY article_no,
                                      vendor_id,
                                      year_period )A 
                             LEFT JOIN TURN_PERIOD_MASTER tpm
                             ON        tpm.article_no=A.article_no )

   SELECT  
          B.Article_no	      
        , B.Vendor_ID
        , B.Year_Period
        , B.Per
        , B."turn_period"
        , ifnull(  ( B."turn_period"  ) *-1, -1  ) as negativeturn_period
        , TO_DATE(  CONCAT(  LEFT( cast(B.Year_Period AS VARCHAR) , 4 ) , '-' , RIGHT( cast(B.Year_Period AS VARCHAR) , 2 ) , '-01'  ) ) as Period
    FROM
        "AGENCY_FEE_TURN_PERIOD_BASE" B;

<br>
    --FINAL QUERY  
    --/*AGENCY_FEE_RATE_PREP*/ 
</br>
CREATE  OR REPLACE TEMPORARY TABLE "AGENCY_FEE_RATE_PREP"
AS
WITH agency_fee_rate_latest_rate AS 
(
      SELECT   article_no,
              vendor_id,
              year_period,
              per,
              "turn_period",
              "avg_per",
              COALESCE("avg_per",0)/100 AS "agency_fee_rate"
    FROM (

      SELECT 
          Base.Article_no	      
        , Base.Vendor_ID
        , Base.Year_Period
        , Base.Per
        , Base."turn_period"        
        , AVG( Agg.Per)     as "avg_per"
          
      FROM 
          AGENCY_FEE_TURN_PERIOD_BASE Base 
          LEFT OUTER JOIN AGENCY_FEE_TURN_PERIOD_BASE Agg on Base.Article_no = Agg.Article_no
              AND Base.Vendor_ID = Agg.Vendor_ID
              AND Agg.Period between DateAdd( month, Base.negativeturn_period + 1  , Base.Period ) and Base.Period
      GROUP BY 
          Base.Article_no	      
        , Base.Vendor_ID
        , Base.Year_Period
        , Base.Per
        , Base."turn_period"  
      )A
)
SELECT 
          R.ARTICLE_NO	
        , R.VENDOR_ID	
        , R.YEAR_PERIOD	
        , R.PER	
        , R."turn_period"	
        , R."avg_per"
        , R."agency_fee_rate"      
        , R.value_partition
        , first_Value(R."agency_fee_rate")over (partition by R.ARTICLE_NO, R.VENDOR_ID, R.value_partition order by R.YEAR_PERIOD ASC)  as "last_agency_fee_rate"
        ,1 AS import_flag
FROM
    (  
      SELECT   
            I.ARTICLE_NO	
          , I.VENDOR_ID	
          , I.YEAR_PERIOD	
          , I.PER	
          , I."turn_period"	
          , I."avg_per"
          , I."agency_fee_rate"      
          , sum(case when ifnull( I."agency_fee_rate" ,0) = 0 then 0 else 1 end) over (Partition By I.ARTICLE_NO, I.VENDOR_ID order by I.YEAR_PERIOD ) as value_partition
      FROM 
          agency_fee_rate_latest_rate I
      ORDER BY 
          I.ARTICLE_NO, 
          I.VENDOR_ID, 
          I.YEAR_PERIOD 
) as R    
ORDER BY 
      R.ARTICLE_NO
    , R.VENDOR_ID
    , R.YEAR_PERIOD  ;     


<br>
----------
</br>

CREATE OR REPLACE TEMPORARY TABLE SALES_FOR_SHRINK AS
SELECT 
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "ARTICLE_NO" AS "ARTICLE_NO",
    SUM("SALES_AMT") AS "SALES_AMT"
FROM SALES_W_VENDOR_PREP_TMP
WHERE "CO_CODE" = 'TSC' AND "STORE_NO" != 5509 
GROUP BY "YEAR_PERIOD", "ARTICLE_NO";

<br>
----------
</br>
CREATE OR REPLACE TEMPORARY TABLE "OMNI_LM_MULTICHANNEL_SALVAGE_RATE" 
AS 
WITH CTE AS (
    SELECT
        omni."Article",
        td."MERCH_YEAR" AS cal_merch_year,
        td."YEAR_PERIOD" AS cal_year_period,
        Sum(
            COALESCE(omni."Amount_in_LC", 0) * movcodes."MULTIPLIER"
        ) AS allocation_value
    FROM
        OMNI_LM_MULTICHANNEL_SALVAGE_STACKED omni
        LEFT JOIN MOVEMENT_CODES_PREPARED_STG movcodes ON omni."Movement_type" = movcodes."MOVEMENT_CODES"
        LEFT JOIN EDW.VW_TIME_DIMENSION td ON omni."Posting_date" = td."TIME_DIM_KEY"
    WHERE
        omni."Movement_type" = 985
        OR omni."Movement_type" = 885
    GROUP BY
        omni."Article",
        td."MERCH_YEAR",
        td."YEAR_PERIOD"
)
SELECT 
    J."Article",
    J.cal_merch_year,
    J.cal_year_period,
    J.allocation_value,
    sales.sales_amt,
    CASE
        WHEN sales.sales_amt IS NULL
        OR sales.sales_amt = 0 THEN 0
        ELSE coalesce(J.allocation_value, 0) / coalesce(sales.sales_amt, 0)
    END AS shrink_rate
FROM
    CTE J
    LEFT JOIN SALES_FOR_SHRINK sales ON J."Article" = sales.article_no
    AND sales.year_period = J.cal_year_period;



<br>
--FACILITY_INBOUND_DC_ONLY
</br>
CREATE OR REPLACE TEMP TABLE "FACILITY_INBOUND_DC_ONLY"
  AS
  SELECT 
    facinbound.ACCT_YEAR,
    facinbound.PERIOD,
     CASE WHEN facinbound.PERIOD <= '9' THEN   CONCAT(facinbound.ACCT_YEAR,CONCAT('0' ,facinbound.PERIOD)) 
         ELSE  CONCAT(facinbound.ACCT_YEAR, facinbound.PERIOD::VARCHAR) END	 AS YEAR_PERIOD,
    facinbound.WEEK_IN_YEAR,
    facinbound.STORE_NO,
    facinbound.STORE_NAME,
    facinbound.ADDR_LINE_1,
    facinbound.CITY,
    facinbound.STATE_POSTAL,
    facinbound.STATE_NAME,
    facinbound.POSTAL_CODE,
    facinbound.VENDOR_ID,
    facinbound.ARTICLE_NO,
    facinbound.ARTICLE_CAT_CODE,
    facinbound.ARTICLE_CAT_FULL,
    facinbound.DEPT_FULL,
    facinbound.VENDOR_RCPT_UNIT_QTY,
    facinbound.VENDOR_RCPT_COST_AMT,
    Mapping."DC_3PL"
  FROM FACILITY_INBOUND_20TO22 facinbound
  INNER JOIN DC_3PL_LOCATION_MAPPING_PREPARED Mapping
    ON facinbound.STORE_NO = Mapping."FACILITY_CODE"
  WHERE  Mapping."DC_3PL" = 'DC';

<br>  
 --FACILITY_OUTBOUND_DC_ONLY
</br>
CREATE OR REPLACE TEMP TABLE "FACILITY_OUTBOUND_DC_ONLY"
AS
SELECT 
    facility.ACCT_YEAR, 		
    facility.PERIOD,		
       CASE WHEN facility.PERIOD <= '9' THEN   CONCAT(facility.ACCT_YEAR,CONCAT('0' ,facility.PERIOD)) 
         ELSE  CONCAT(facility.ACCT_YEAR, facility.PERIOD::VARCHAR) END  AS YEAR_PERIOD,	
    facility.WEEK_IN_YEAR,	
    facility.ARTICLE_NO,		
    facility.ARTICLE_CAT_FULL,
    LEFT(facility.ARTICLE_CAT_FULL, CHARINDEX(' - ', facility.ARTICLE_CAT_FULL) - 1) ARTICLE_CAT_CODE,
    facility.VENDOR_ID,   
    facility.DEPT_FULL,  
    facility.STORE_NO, 
    facility.ADDR_LINE_1,    
    facility.CITY ,           
    facility.STATE_POSTAL ,   
    facility.STATE_NAME  ,    
    facility.POSTAL_CODE  ,   
    facility.VENDOR_RCPT_UNIT_QTY,
    facility.VENDOR_RCPT_COST_AMT ,
    Prep."DC_3PL"
  FROM FACILITY_OUTBOUND_20TO22 facility
  INNER JOIN DC_3PL_LOCATION_MAPPING_PREPARED Prep
    ON facility.STORE_NO = Prep."FACILITY_CODE"
  WHERE Prep."DC_3PL" ='DC';

<br>
  ---DC_3PL_OUTBOUND_PRODUCTIVITY_RATE_STACKED
</br>
CREATE OR REPLACE TEMP TABLE "DC_3PL_OUTBOUND_PRODUCTIVITY_RATE_STACKED"
  AS
  SELECT  * 
  FROM (
  SELECT   
    DC,
   CONCAT(to_number(LEFT(YEAR_PERIOD, 4))-2,(RIGHT(YEAR_PERIOD, 2))) YEAR_PERIOD,
   Product_Type,
   Total,
   Hours,
   UPH,
   Productivity_Rate      
  FROM DC_3PL_OUTBOUND_PRODUCTIVITY_RATE_BY_PRODUCT_SEGMENT_PREPARED
  UNION ALL   
   SELECT   
   DC,
   CONCAT(to_number(LEFT(YEAR_PERIOD, 4))-1,(RIGHT(YEAR_PERIOD, 2))) AS YEAR_PERIOD,
   Product_Type,
   Total,
   Hours,
   UPH,
   Productivity_Rate      
  FROM DC_3PL_OUTBOUND_PRODUCTIVITY_RATE_BY_PRODUCT_SEGMENT_PREPARED
  UNION ALL 
  SELECT   
   DC,
   YEAR_PERIOD,
   Product_Type,
   Total,
   Hours,
   UPH,
   Productivity_Rate      
  FROM DC_3PL_OUTBOUND_PRODUCTIVITY_RATE_BY_PRODUCT_SEGMENT_PREPARED
  ) DC_3PL_OUTBOUND_PRODUCTIVITY_RATE_Stacked
  WHERE YEAR_PERIOD >='202001';

<br>
  --DC_3PL_ITEM_MAPPING_TO_PRODUCT_SEGMENT_PREPARED_BY_ITEM
</br>
CREATE OR REPLACE TEMP TABLE "DC_3PL_ITEM_MAPPING_TO_PRODUCT_SEGMENT_PREPARED_BY_ITEM"
  AS
 SELECT 
 "Item",
 "Product_Type" 
 FROM DC_3PL_ITEM_MAPPING_TO_PRODUCT_SEGMENT_PREPARED
 GROUP BY "Item","Product_Type";

<br>
--DC_3PL_INBOUND_PRODUCTIVITY_RATE_STACKED 
</br>
CREATE OR REPLACE  TEMP TABLE "DC_3PL_INBOUND_PRODUCTIVITY_RATE_STACKED"
  AS
  SELECT  * FROM (
  SELECT   
   "DC",
   CONCAT(to_number(LEFT("Year_Period", 4))-2,(RIGHT("Year_Period", 2))) YEAR_PERIOD,
   "Product_Type",
   "Total",
   "Hours",
   "UPH",
   "Productivity_Rate"      
  FROM DC_3PL_INBOUND_PRODUCTIVITY_RATE_BY_PRODUCT_SEGMENT_PREPARED
  UNION ALL   
   SELECT   
   "DC",
   CONCAT(to_number(LEFT("Year_Period", 4))-1,(RIGHT("Year_Period", 2))) AS YEAR_PERIOD,
   "Product_Type",
   "Total",
   "Hours",
   "UPH",
   "Productivity_Rate"      
  FROM DC_3PL_INBOUND_PRODUCTIVITY_RATE_BY_PRODUCT_SEGMENT_PREPARED
  UNION ALL 
  SELECT   
   "DC",
   "Year_Period" as YEAR_PERIOD,
   "Product_Type",
   "Total",
   "Hours",
   "UPH",
   "Productivity_Rate"      
  FROM DC_3PL_INBOUND_PRODUCTIVITY_RATE_BY_PRODUCT_SEGMENT_PREPARED
  ) DC_3PL_OUTBOUND_PRODUCTIVITY_RATE_Stacked
  WHERE YEAR_PERIOD >='202001';

<br>
--"dc3plinb1"
</br>
CREATE OR REPLACE TEMP TABLE dc3plinb1
AS 
SELECT DISTINCT CAST(dc3plinb1.Year_Period AS NUMBER) AS Year_Period,
                DC, 
                "Product_Type",
                dc3plinb1."Productivity_Rate"
FROM DC_3PL_INBOUND_PRODUCTIVITY_RATE_STACKED dc3plinb1;

<br>
--"walbd"
</br>

CREATE OR REPLACE TEMP TABLE walbd
AS
SELECT DISTINCT YEAR_PERIOD, 
       LEFT(YEAR_PERIOD,4)AS YEAR,
      RIGHT(YEAR_PERIOD,2) AS PERIOD_FOR ,
      Labor_Rate,
      Facility_Code
FROM DC_3PL_WEIGHTED_AVERAGE_LABOR_RATES_BY_DC_20TO22_PREPARED;

<br>
--"prcapregro"
</br>

CREATE OR REPLACE TEMP TABLE prcapregro
AS
SELECT 
     "Category_Number",
     "Primary_Product_Segment",
     "Secondary_Product_Segment",
	 COUNT(*) AS count
  FROM  DC_3PL_DC_VARIABLE_ITEM_MAPPING_PROD_CAT_PREPARED
  GROUP BY "Category_Number","Primary_Product_Segment","Secondary_Product_Segment";

<br>
--"dc3plinb2"
</br>
CREATE OR REPLACE TEMP TABLE dc3plinb2
AS
SELECT DISTINCT dc3plinb1.Year_Period,
              DC,
              Product_Type,
              dc3plinb1.Productivity_Rate
FROM DC_3PL_OUTBOUND_PRODUCTIVITY_RATE_STACKED dc3plinb1;

<br>
--"FACILITY_INBOUND_PREPARED_JOINED"
</br>
CREATE OR REPLACE TEMP TABLE "FACILITY_INBOUND_PREPARED_JOINED"
AS
SELECT 
    facin.ACCT_YEAR,
    facin.PERIOD,
    facin.YEAR_PERIOD,
    facin.WEEK_IN_YEAR,
    facin.STORE_NO,
    facin.STORE_NAME,
    facin.ADDR_LINE_1,
    facin.CITY,
    facin.STATE_POSTAL,
    facin.STATE_NAME,
    facin.POSTAL_CODE,
    facin.VENDOR_ID,
    facin.ARTICLE_NO,
    facin.ARTICLE_CAT_CODE,
    facin.ARTICLE_CAT_FULL,
    facin.DEPT_FULL,
    facin.VENDOR_RCPT_UNIT_QTY,
    facin.VENDOR_RCPT_COST_AMT,
    facin."DC_3PL",
    pspi."Product_Type" AS pd_Product_Type ,
    walbd.Labor_Rate AS lr_Labor_Rate,
       TRIM(CASE WHEN "Product_Type" IS NULL THEN prcapregro."Primary_Product_Segment" ELSE pspi."Product_Type" END) AS primary_Product_Type,
    TRIM(CASE WHEN "Product_Type" IS NULL THEN prcapregro1."Secondary_Product_Segment" ELSE pspi."Product_Type" END) AS secondary_Product_Type,
    prcapregro."Primary_Product_Segment" AS cat_Primary_Product_Segment,
    prcapregro1."Secondary_Product_Segment" AS cat_Secondary_Product_Segment
  FROM FACILITY_INBOUND_DC_ONLY facin
  LEFT JOIN DC_3PL_ITEM_MAPPING_TO_PRODUCT_SEGMENT_PREPARED_BY_ITEM pspi
    ON facin.ARTICLE_NO = pspi."Item"
  LEFT JOIN (walbd) walbd
    ON     (facin.YEAR_PERIOD = walbd.YEAR_PERIOD )
      AND (facin.STORE_NO = walbd.Facility_Code)
  LEFT JOIN  (prcapregro) prcapregro
    ON facin.ARTICLE_CAT_CODE = prcapregro."Category_Number"
  LEFT JOIN  (prcapregro) prcapregro1
    ON facin.ARTICLE_CAT_CODE = prcapregro1."Category_Number";

<br>
	--"FACILITY_OUTBOUND_THROUGHPUT_JOINED"
</br>
insert into "FACILITY_OUTBOUND_THROUGHPUT_JOINED"
SELECT      facdcjoin.ACCT_YEAR,
            facdcjoin.PERIOD,
            facdcjoin.YEAR_PERIOD,
            facdcjoin.WEEK_IN_YEAR,
            facdcjoin.STORE_NO,
            facdcjoin.ADDR_LINE_1,
            facdcjoin.CITY,
            facdcjoin.STATE_POSTAL,
            facdcjoin.STATE_NAME,
            facdcjoin.POSTAL_CODE,
            facdcjoin.VENDOR_ID,
            facdcjoin.ARTICLE_NO,
            facdcjoin.ARTICLE_CAT_CODE,
            facdcjoin.ARTICLE_CAT_FULL,
            facdcjoin.DEPT_FULL,
            facdcjoin.VENDOR_RCPT_UNIT_QTY,
            facdcjoin.VENDOR_RCPT_COST_AMT,
            facdcjoin."DC_3PL",
            pd_Product_Type,
            lr_Labor_Rate,
            primary_Product_Type,
            secondary_Product_Type,
            cat_Primary_Product_Segment,
            cat_Secondary_Product_Segment,
             dcprosta1.Productivity_Rate AS primary_Productivity_Rate,
             dcprosta2.Productivity_Rate AS secondary_Productivity_Rate
	FROM 
	(
		 SELECT 
		 facout.ACCT_YEAR,
		 facout.PERIOD,
		 facout.YEAR_PERIOD,
		 facout.WEEK_IN_YEAR,
		 facout.STORE_NO,
		 facout.ADDR_LINE_1,
		 facout.CITY,
		 facout.STATE_POSTAL,
		 facout.STATE_NAME,
		 facout.POSTAL_CODE,
		 facout.VENDOR_ID,
		 facout.ARTICLE_NO,
		 facout.ARTICLE_CAT_CODE,
		 facout.ARTICLE_CAT_FULL,
		 facout.DEPT_FULL,
		 facout.VENDOR_RCPT_UNIT_QTY,
		 facout.VENDOR_RCPT_COST_AMT,
		 facout."DC_3PL",
		 pspi."Product_Type" AS pd_Product_Type ,
		 walbd.LABOR_RATE AS lr_Labor_Rate,
		 TRIM(CASE WHEN "Product_Type" IS NULL THEN prcapregro."Primary_Product_Segment" ELSE pspi."Product_Type" END) AS primary_Product_Type,
		 TRIM(CASE WHEN "Product_Type" IS NULL THEN prcapregro1."Secondary_Product_Segment" ELSE pspi."Product_Type" END) AS secondary_Product_Type,
		 prcapregro."Primary_Product_Segment" AS cat_Primary_Product_Segment,
		 prcapregro1."Secondary_Product_Segment" AS cat_Secondary_Product_Segment
         FROM FACILITY_OUTBOUND_DC_ONLY facout 
         LEFT JOIN DC_3PL_ITEM_MAPPING_TO_PRODUCT_SEGMENT_PREPARED_BY_ITEM pspi
         ON facout.ARTICLE_NO = pspi."Item"
         LEFT JOIN (walbd) walbd
         ON (facout.YEAR_PERIOD = walbd.YEAR_PERIOD)
		 AND (facout.STORE_NO = walbd.Facility_Code)
         LEFT JOIN  (prcapregro)prcapregro
         ON facout.ARTICLE_CAT_CODE = prcapregro."Category_Number"
         LEFT JOIN  (prcapregro)prcapregro1
         ON facout.ARTICLE_CAT_CODE = prcapregro1."Category_Number"
	)facdcjoin	
   LEFT JOIN (dc3plinb2) dcprosta1
    ON (facdcjoin.YEAR_PERIOD = dcprosta1.Year_Period)
      AND (facdcjoin.STORE_NO = dcprosta1.DC)
      AND (facdcjoin.primary_Product_Type = dcprosta1.Product_Type)	  
   LEFT JOIN (dc3plinb2) dcprosta2
    ON (facdcjoin.YEAR_PERIOD = dcprosta2.Year_Period)
      AND (facdcjoin.STORE_NO = dcprosta2.DC)
      AND (facdcjoin.primary_Product_Type = dcprosta2.Product_Type);

<br>	  
--VARIABLE_COST_INBOUND_AGG	  
</br>
CREATE OR REPLACE TEMP TABLE "VARIABLE_COST_INBOUND_AGG"
AS
WITH facility_inbound_Throughput_Joined AS (
 
SELECT  
         fipj.ACCT_YEAR
        ,fipj.PERIOD
        ,fipj.YEAR_PERIOD
        ,fipj.WEEK_IN_YEAR
        ,fipj.STORE_NO
        ,fipj.STORE_NAME
        ,fipj.ADDR_LINE_1
        ,fipj.CITY
        ,fipj.STATE_POSTAL
        ,fipj.STATE_NAME
        ,fipj.POSTAL_CODE
        ,fipj.VENDOR_ID
        ,fipj.ARTICLE_NO
        ,fipj.ARTICLE_CAT_CODE
        ,fipj.ARTICLE_CAT_FULL
        ,fipj.DEPT_FULL
        ,fipj.VENDOR_RCPT_UNIT_QTY
        ,fipj.VENDOR_RCPT_COST_AMT
        ,fipj."DC_3PL"
        ,fipj.PD_PRODUCT_TYPE
        ,fipj.LR_LABOR_RATE,
        CASE 
        WHEN fipj.pd_Product_Type IS NULL THEN fipj.cat_Primary_Product_Segment
        ELSE fipj.pd_Product_Type
        END AS primary_Product_Type,
		CASE 
        WHEN fipj.pd_Product_Type IS NULL THEN fipj.cat_Secondary_Product_Segment
        ELSE fipj.pd_Product_Type
        END AS secondary_Product_Type,
		dc3plinb1."Productivity_Rate" AS primary_Productivity_Rate,
        dc3plinb2."Productivity_Rate" AS secondary_Productivity_Rate	      
FROM FACILITY_INBOUND_PREPARED_JOINED fipj
LEFT JOIN (dc3plinb1) dc3plinb1
       ON  (fipj.YEAR_PERIOD =  dc3plinb1.Year_Period)
      AND (TRIM(fipj.STORE_NO) = TRIM(dc3plinb1.DC))
      AND (UPPER(TRIM(fipj.primary_Product_Type)) = UPPER(TRIM(dc3plinb1."Product_Type")))
LEFT JOIN (dc3plinb1 ) dc3plinb2
ON    ( fipj.YEAR_PERIOD = dc3plinb2.Year_Period)
      AND (TRIM(fipj.STORE_NO) = TRIM(dc3plinb2.DC))
      AND (UPPER(TRIM(fipj.primary_Product_Type)) = UPPER(TRIM(dc3plinb2."Product_Type")))
    )       
         SELECT 		  
            ARTICLE_NO,
            YEAR_PERIOD,
            STORE_NO,
            VENDOR_ID,
            SUM(variable_cost_inbound) AS total_variable_cost_inbound
         FROM ( 
            SELECT * ,
            coalesce(Productivity_Rate,0)*coalesce(LR_LABOR_RATE,0)*coalesce(VENDOR_RCPT_UNIT_QTY,0) AS variable_cost_inbound
            FROM 
            (            
           SELECT   
             ARTICLE_NO,
            YEAR_PERIOD,
            STORE_NO,
            VENDOR_ID,
            LR_LABOR_RATE,
            VENDOR_RCPT_UNIT_QTY,
            coalesce(Productivity_Rate,0)  AS Productivity_Rate
           FROM 
           (
	       SELECT  fac.*,
				   CASE 
				    WHEN (primary_Productivity_Rate IS NULL OR primary_Productivity_Rate < 0.0001) THEN secondary_Productivity_Rate
					ELSE primary_Productivity_Rate
				   END AS Productivity_Rate
		   FROM facility_inbound_Throughput_Joined fac
           )A)B)FINAL 
         GROUP BY ARTICLE_NO,YEAR_PERIOD,STORE_NO,VENDOR_ID;

<br>	   
	/*VARIABLE_COST_OUTBOUND_AGG*/
</br>  
CREATE OR REPLACE TEMP TABLE "VARIABLE_COST_OUTBOUND_AGG"
       AS
       WITH VARIABLE_COST_OUTBOUND_AGG AS
       (
       SELECT  *,COALESCE(Productivity_Rate, 0) * COALESCE(lr_Labor_Rate, 0) * COALESCE(VENDOR_RCPT_UNIT_QTY, 0) AS variable_cost_outbound
		  FROM 
		  (
	     SELECT fotj.*,
		 CASE     WHEN (primary_Productivity_Rate IS NULL OR primary_Productivity_Rate < 0.0001) THEN secondary_Productivity_Rate
					ELSE primary_Productivity_Rate
				   END AS Productivity_Rate
		 FROM facility_outbound_Throughput_Joined fotj
		 )variable_cost_outbound
         )
          SELECT 
			ARTICLE_NO,
			YEAR_PERIOD,
			STORE_NO,
			VENDOR_ID,
			SUM(variable_cost_outbound) AS total_variable_cost_outbound		 
		 FROM VARIABLE_COST_OUTBOUND_AGG
		 GROUP BY ARTICLE_NO,YEAR_PERIOD,STORE_NO,VENDOR_ID;   
	
<br>
--	TIME_DIMENSION_BY_YEAR_PERIOD_MERCH
</br>
CREATE OR REPLACE TEMPORARY TABLE  "TIME_DIMENSION_BY_YEAR_PERIOD_MERCH"
AS
SELECT 
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "MERCH_YEAR" AS "MERCH_YEAR",
    "YEAR_QUARTER" AS "YEAR_QUARTER"
  FROM  EDW.TIME_DIMENSION
  GROUP BY "YEAR_PERIOD", "MERCH_YEAR", "YEAR_QUARTER";

<br>	 
--VARIABLE_COST_COMBINED_PREPARED_JOINED_TMP  
</br>
CREATE OR REPLACE TEMPORARY TABLE VARIABLE_COST_COMBINED_PREPARED_JOINED_TMP
AS
      WITH VARIABLE_COST_COMBINED_PREPARED_JOINED_TMP
  AS
  (
  SELECT  *, 
  COALESCE(total_variable_cost_inbound, 0) + COALESCE(total_variable_cost_outbound, 0) AS variable_cost_combined
FROM 
(
SELECT 
inagg.ARTICLE_NO,
inagg.YEAR_PERIOD,
inagg.STORE_NO,
inagg.VENDOR_ID,
inagg.total_variable_cost_inbound,
outagg.total_variable_cost_outbound
FROM VARIABLE_COST_INBOUND_AGG inagg
FULL OUTER JOIN VARIABLE_COST_OUTBOUND_AGG outagg
  ON (inagg.YEAR_PERIOD = outagg.YEAR_PERIOD)
  AND (inagg.STORE_NO = outagg.STORE_NO)
  AND (inagg.VENDOR_ID = outagg.VENDOR_ID)
  AND (inagg.ARTICLE_NO = outagg.ARTICLE_NO)
)Variable_cost_inbound_combined
  )
    SELECT  vccpre.ARTICLE_NO,
          vccpre.YEAR_PERIOD,
          vccpre.STORE_NO,
          vccpre.VENDOR_ID,
          vccpre.variable_cost_combined,                
          tdim.MERCH_YEAR
FROM VARIABLE_COST_COMBINED_PREPARED_JOINED_TMP vccpre
LEFT JOIN TIME_DIMENSION_BY_YEAR_PERIOD_MERCH tdim
ON vccpre.YEAR_PERIOD =tdim.YEAR_PERIOD ;

<br>
/*OMNI_FREIGHT_DETAIL_SMALL_LTL_WINDOWS_PREPARED*/
</br>
CREATE OR REPLACE TEMPORARY TABLE "OMNI_FREIGHT_DETAIL_SMALL_LTL_WINDOWS_PREPARED"
AS
SELECT 
	  ORDER_DATE,
    ORDER_NO,
    PO_ORDER_NO,
    ORDER_LINE_KEY,
    PO_ORDER_LINE_KEY,
    OMS_ITEM_PARCEL_SHIP_FLAG,
    OMS_ITEM_ID,
    OMS_SHIPMENT_LINE_ITEM_DESC,
    TRACKING_NO,
    OMS_SHIP_NODE_KEY,
	   SCAC,
    SHIPMENT_QTY,
	  LINE_WEIGHT,
	  shipment_item_weight
    TRANS_AMT,
	  LINE_WEIGHT_sum,
	 shipment_total_weight,
	CASE WHEN COALESCE(shipment_total_weight, 0) = 0 THEN 0 ELSE CAST(COALESCE(shipment_item_weight, 0) AS DOUBLE) / NULLIF(COALESCE(shipment_total_weight, 0), 0) END AS shipment_share_by_weight,
	COALESCE(TRANS_AMT, 0) * COALESCE((CASE WHEN COALESCE(shipment_total_weight, 0) = 0 THEN 0 ELSE CAST(COALESCE(shipment_item_weight, 0) AS DOUBLE) / NULLIF(COALESCE(shipment_total_weight, 0), 0) END), 0) AS trans_amt_by_weight
FROM 	 
(
SELECT 
	ORDER_DATE,
    ORDER_NO,
    PO_ORDER_NO,
    ORDER_LINE_KEY,
    PO_ORDER_LINE_KEY,
    OMS_ITEM_PARCEL_SHIP_FLAG,
    OMS_ITEM_ID,
    OMS_SHIPMENT_LINE_ITEM_DESC,
    TRACKING_NO,
    OMS_SHIP_NODE_KEY,
	SCAC,
    SHIPMENT_QTY,
	LINE_WEIGHT_sum AS LINE_WEIGHT,
	shipment_total_weight AS shipment_item_weight,
    TRANS_AMT,
	SUM (LINE_WEIGHT_sum) OVER (PARTITION BY TRACKING_NO) AS LINE_WEIGHT_sum,
	SUM (shipment_total_weight) OVER (PARTITION BY TRACKING_NO) AS 	shipment_total_weight
FROM ( 

 SELECT   
	ORDER_DATE,
    ORDER_NO,
    PO_ORDER_NO,
    ORDER_LINE_KEY,
    PO_ORDER_LINE_KEY,
    OMS_ITEM_PARCEL_SHIP_FLAG,
    OMS_ITEM_ID,
    OMS_SHIPMENT_LINE_ITEM_DESC,
    TRACKING_NO,
    OMS_SHIP_NODE_KEY,
	SCAC,
    SUM(SHIPMENT_QTY) AS  SHIPMENT_QTY,
    SUM(LINE_WEIGHT) AS LINE_WEIGHT_sum,
    SUM(COALESCE(LINE_WEIGHT,0)) AS shipment_total_weight,
	SUM("TRANS_AMT") AS TRANS_AMT
  FROM FREIGHT_DETAIL_SMALL_LTL
  GROUP BY ORDER_DATE, ORDER_NO, PO_ORDER_NO, ORDER_LINE_KEY, PO_ORDER_LINE_KEY, OMS_ITEM_PARCEL_SHIP_FLAG, OMS_ITEM_ID, OMS_SHIPMENT_LINE_ITEM_DESC, TRACKING_NO, OMS_SHIP_NODE_KEY, SCAC
  )FREIGHT_DETAIL_SMALL_LTL_WEIGHT_CAL_BY_ORDER_DATE
  )DATA_FREIGHT_DETAIL_SMALL_LTL_WINDOWS;
  

<br>  
--,FEDEX_UPS_PREPARED_FILTERED_STACKED
</br>
CREATE OR REPLACE TEMP TABLE "FEDEX_UPS_PREPARED_FILTERED_STACKED"
AS
SELECT  Period,ups_fedex FROM fedex_ups_prepared
WHERE Period < 202207
UNION ALL 
SELECT   "Period","ups_fedex" FROM  FEDEX_UPS_CHARGES_PREPARED_FILTER
  WHERE "Period" >= 202207
UNION ALL 
SELECT  "Period","ups_fedex" FROM FEDEX_UPS_CHARGES_CSV_PREPARED;

<br>
--RECEIPTS_FOR_VOLUME_REBATE
</br>

INSERT INTO "RECEIPTS_FOR_VOLUME_REBATE"
WITH CTE AS 
(

                SELECT 
                     "CO_CODE",
                     "cal_YEAR_PERIOD",    
                     "cal_MERCH_YEAR",
                    "VENDOR_ID",
                    "PO_LINE_ORDER_QTY",
                    "PO_LINE_UNIT_PRICE",
                    "po_date_parsed",
                    "deliv_date_parsed" AS "DELIV_DATE_PARSED"
                  FROM PURCHASE_ORDER_LINE_W_CAL   WHERE "cal_YEAR_PERIOD" >= 202206 AND ("CO_CODE" = 'TSC') 
)

   SELECT 
              "cal_YEAR_PERIOD" AS "cal_YEAR_PERIOD",
              "cal_MERCH_YEAR" AS "cal_MERCH_YEAR",
               "VENDOR_ID" AS "VENDOR_ID",
               SUM("receipt") AS "receipt_sum"
    FROM
    (
    SELECT *,
           COALESCE("PO_LINE_ORDER_QTY", 0) * COALESCE("PO_LINE_UNIT_PRICE", 0) AS "receipt"
    FROM CTE
    )GROUP BY "cal_YEAR_PERIOD", "cal_MERCH_YEAR", "VENDOR_ID";

<br>
--SMALL_PACKAGE_ORDERS_FILTERED
</br>
 CREATE OR REPLACE TEMP TABLE SMALL_PACKAGE_ORDERS_FILTERED
    AS
	SELECT * 
	FROM SMALL_PACKAGE_ORDERS
	WHERE "small_package_flag" = 1;
	
<br>
--SMALL_PACKAGE_BY_YEAR_PERIOD
--434529
</br>
CREATE OR REPLACE TEMP TABLE SMALL_PACKAGE_BY_YEAR_PERIOD
	 AS
	 SELECT  
    "cal_YEAR_PERIOD" AS "YEAR_PERIOD",
    "ARTICLE_NO" AS "ARTICLE_NO",
    "VENDOR_ID" AS "VENDOR_ID",
    "org_Facility_Code" AS "org_Facility_Code",
    "org_Facility_Name" AS "org_Facility_Name",
    "org_Facility_Type" AS "org_Facility_Type",
    "dest_Facility_Code" AS "dest_Facility_Code",
    "dest_Facility_Name" AS "dest_Facility_Name",
    "dest_Facility_Type" AS "dest_Facility_Type",
     "small_package_flag" AS "small_package_flag",
     SUM("PO_LINE_ORDER_QTY") AS "order_qty",
     SUM("item_weight") AS "item_weight"
	 FROM SMALL_PACKAGE_ORDERS_FILTERED
	 GROUP BY 
	 "cal_YEAR_PERIOD",
    "ARTICLE_NO",
    "VENDOR_ID",
	  "org_Facility_Code", 
    "org_Facility_Name", 
    "org_Facility_Type",
    "dest_Facility_Code",
    "dest_Facility_Name",
    "dest_Facility_Type",
     "small_package_flag" ;

<br>
--SMALL_PACKAGE_BY_YEAR_PERIOD_WINDOWS
--434529
</br>	 
CREATE OR REPLACE TEMP TABLE SMALL_PACKAGE_BY_YEAR_PERIOD_WINDOWS
	 AS 
	 SELECT 
	"YEAR_PERIOD" AS "YEAR_PERIOD",
    "ARTICLE_NO" AS "ARTICLE_NO",
    "VENDOR_ID" AS "VENDOR_ID",
    "org_Facility_Code" AS "org_Facility_Code",
    "org_Facility_Name" AS "org_Facility_Name",
    "org_Facility_Type" AS "org_Facility_Type",
    "dest_Facility_Code" AS "dest_Facility_Code",
    "dest_Facility_Name" AS "dest_Facility_Name",
    "dest_Facility_Type" AS "dest_Facility_Type",
    "small_package_flag" AS "small_package_flag",
    "order_qty" AS "order_qty",
    "item_weight" AS "item_weight",
    SUM("item_weight") OVER (PARTITION BY "YEAR_PERIOD") AS "item_weight_sum"
	FROM SMALL_PACKAGE_BY_YEAR_PERIOD;

<br>
 --  SMALL_PACKAGE_BY_YEAR_PERIOD_SHARE
 	--434529
</br>

CREATE OR REPLACE TEMP TABLE SMALL_PACKAGE_BY_YEAR_PERIOD_SHARE
	AS
	SELECT  *,(COALESCE(SPBYP."item_weight",0) / COALESCE(SPBYP."item_weight_sum",0)) * COALESCE(SPBYP."ups_fedex", 0) AS "allocation_final"
	FROM (
	SELECT spp.*,f."UPS_FEDEX" AS "ups_fedex"
	FROM SMALL_PACKAGE_BY_YEAR_PERIOD_WINDOWS spp
    LEFT JOIN "FEDEX_UPS_PREPARED_FILTERED_STACKED" f 
	ON spp."YEAR_PERIOD" = f."PERIOD" )SPBYP;
	

<br>
 --DOMESTIC_SHIPPING_FREIGHT_PREPARED_1
</br>
CREATE OR REPLACE TEMP TABLE "DOMESTIC_SHIPPING_FREIGHT_PREPARED_1"
AS
WITH domestic_shipping_w_date_1 AS 
(
  SELECT 
    "sc_tlm_invoiced_object"."INV_ID" AS "INV_ID",
    "sc_tlm_invoiced_object"."INV_OBJECT_ID" AS "INV_OBJECT_ID",
    "sc_tlm_invoiced_object"."TC_COMPANY_ID" AS "TC_COMPANY_ID",
    "sc_tlm_invoiced_object"."TC_OBJECT_ID" AS "TC_OBJECT_ID",
    "sc_tlm_invoiced_object"."INV_OBJECT_STATUS" AS "INV_OBJECT_STATUS",
    "sc_tlm_invoiced_object"."O_NAME" AS "O_NAME",
    "sc_tlm_invoiced_object"."O_ADDRESS" AS "O_ADDRESS",
    "sc_tlm_invoiced_object"."O_CITY" AS "O_CITY",
    "sc_tlm_invoiced_object"."O_COUNTY" AS "O_COUNTY",
    "sc_tlm_invoiced_object"."O_STATE_PROV" AS "O_STATE_PROV",
    "sc_tlm_invoiced_object"."O_POSTAL_CODE" AS "O_POSTAL_CODE",
    "sc_tlm_invoiced_object"."O_COUNTRY_CODE" AS "O_COUNTRY_CODE",
    "sc_tlm_invoiced_object"."D_NAME" AS "D_NAME",
    "sc_tlm_invoiced_object"."D_ADDRESS" AS "D_ADDRESS",
    "sc_tlm_invoiced_object"."D_CITY" AS "D_CITY",
    "sc_tlm_invoiced_object"."D_COUNTY" AS "D_COUNTY",
    "sc_tlm_invoiced_object"."D_STATE_PROV" AS "D_STATE_PROV",
    "sc_tlm_invoiced_object"."D_POSTAL_CODE" AS "D_POSTAL_CODE",
    "sc_tlm_invoiced_object"."D_COUNTRY_CODE" AS "D_COUNTRY_CODE",
    "sc_tlm_invoiced_object"."MOT_DESC" AS "MOT_DESC",
    "sc_tlm_invoiced_object"."EQUIPMENT_DESC" AS "EQUIPMENT_DESC",
    "sc_tlm_invoiced_object"."SERVICE_LEVEL_DESC" AS "SERVICE_LEVEL_DESC",
    "sc_tlm_invoiced_object"."PROTECTION_LEVEL_DESC" AS "PROTECTION_LEVEL_DESC",
    "sc_tlm_invoiced_object"."FINANCIAL_WEIGHT" AS "FINANCIAL_WEIGHT",
    "sc_tlm_invoiced_object"."ACTUAL_WEIGHT" AS "ACTUAL_WEIGHT",
    "sc_tlm_invoiced_object"."TOTAL_COST" AS "TOTAL_COST",
    "sc_tlm_invoiced_object"."LH_COST" AS "LH_COST",
    "sc_tlm_invoiced_object"."DISTANCE" AS "DISTANCE",
    "sc_tlm_invoiced_object"."DISTANCE_UOM" AS "DISTANCE_UOM",
    "sc_tlm_invoiced_object"."BILL_OF_LADING_NUMBER" AS "BILL_OF_LADING_NUMBER",
    "sc_tlm_invoiced_object"."PO_NUMBER" AS "PO_NUMBER",
    "sc_tlm_invoiced_object"."SPEC_HANDLING_METHOD" AS "SPEC_HANDLING_METHOD",
    "sc_tlm_invoiced_object"."COMMENTS" AS "COMMENTS",
    "sc_tlm_invoiced_object"."HAS_IMPORT_ERROR" AS "HAS_IMPORT_ERROR",
    "sc_tlm_invoiced_object"."HAS_WARNING" AS "HAS_WARNING",
    "sc_tlm_invoiced_object"."IS_VALID" AS "IS_VALID",
    "sc_tlm_invoiced_object"."CREATED_SOURCE_TYPE" AS "CREATED_SOURCE_TYPE",
    "sc_tlm_invoiced_object"."CREATED_SOURCE" AS "CREATED_SOURCE",
    "sc_tlm_invoiced_object"."CREATED_DTTM" AS "CREATED_DTTM",
    "sc_tlm_invoiced_object"."LAST_UPDATED_SOURCE" AS "LAST_UPDATED_SOURCE",
    "sc_tlm_invoiced_object"."LAST_UPDATED_DTTM" AS "LAST_UPDATED_DTTM",
    "sc_tlm_invoiced_object"."STOP_COST" AS "STOP_COST",
    "sc_tlm_invoiced_object"."AUXILARY_DATA" AS "AUXILARY_DATA",
    "sc_tlm_invoiced_object"."PICKUP_DTTM" AS "PICKUP_DTTM",
    "sc_tlm_invoiced_object"."DELIVERY_DTTM" AS "DELIVERY_DTTM",
    "sc_tlm_invoiced_object"."CURRENCY_CODE" AS "CURRENCY_CODE",
    "sc_tlm_invoiced_object"."LH_CURRENCY_CODE" AS "LH_CURRENCY_CODE",
    "sc_tlm_invoiced_object"."STOP_CURRENCY_CODE" AS "STOP_CURRENCY_CODE",
    "sc_tlm_invoiced_object"."SPOT_CHARGE_COST" AS "SPOT_CHARGE_COST",
    "sc_tlm_invoiced_object"."SPOT_CHARGE_CURRENCY_CODE" AS "SPOT_CHARGE_CURRENCY_CODE",
    "sc_tlm_invoiced_object"."ASSIGNED_CARRIER_CODE" AS "ASSIGNED_CARRIER_CODE",
    "sc_tlm_invoiced_object"."NUM_PICKUPS" AS "NUM_PICKUPS",
    "sc_tlm_invoiced_object"."NUM_DELIVERIES" AS "NUM_DELIVERIES",
    "sc_tlm_invoiced_object"."RATE" AS "RATE",
    "sc_tlm_invoiced_object"."RATE_CALC_METHOD" AS "RATE_CALC_METHOD",
    "sc_tlm_invoiced_object"."RATE_UOM" AS "RATE_UOM",
    "sc_tlm_invoiced_object"."TPE_OBJECT_ID" AS "TPE_OBJECT_ID",
    "sc_tlm_invoiced_object"."O_FACILITY_ID" AS "O_FACILITY_ID",
    "sc_tlm_invoiced_object"."D_FACILITY_ID" AS "D_FACILITY_ID",
    "sc_tlm_invoiced_object"."TP_COMPANY_ID" AS "TP_COMPANY_ID",
    "sc_tlm_invoiced_object"."PACKAGE_TYPE_ID" AS "PACKAGE_TYPE_ID",
    "sc_tlm_invoiced_object"."COMPUTED_RATE" AS "COMPUTED_RATE",
    "sc_tlm_invoiced_object"."COMPUTED_RATE_UOM" AS "COMPUTED_RATE_UOM",
    "sc_tlm_invoiced_object"."COMPUTED_RATE_CALC_METHOD" AS "COMPUTED_RATE_CALC_METHOD",
    "sc_tlm_invoiced_object"."COMPUTED_TOTAL_COST" AS "COMPUTED_TOTAL_COST",
    "sc_tlm_invoiced_object"."COMPUTED_TOTAL_COST_CURR_CODE" AS "COMPUTED_TOTAL_COST_CURR_CODE",
    "sc_tlm_invoiced_object"."O_FACILITY_NAME" AS "O_FACILITY_NAME",
    "sc_tlm_invoiced_object"."D_FACILITY_NAME" AS "D_FACILITY_NAME",
    "sc_tlm_invoiced_object"."COMPUTED_DISTANCE" AS "COMPUTED_DISTANCE",
    "sc_tlm_invoiced_object"."COMPUTED_DISTANCE_UOM" AS "COMPUTED_DISTANCE_UOM",
    "sc_tlm_invoiced_object"."COMPUTED_STOP_COST" AS "COMPUTED_STOP_COST",
    "sc_tlm_invoiced_object"."COMPUTED_STOP_COST_CURR_CODE" AS "COMPUTED_STOP_COST_CURR_CODE",
    "sc_tlm_invoiced_object"."APPROVED_DISTANCE" AS "APPROVED_DISTANCE",
    "sc_tlm_invoiced_object"."APPROVED_LH_COST" AS "APPROVED_LH_COST",
    "sc_tlm_invoiced_object"."APPROVED_RATE" AS "APPROVED_RATE",
    "sc_tlm_invoiced_object"."APPROVED_FINANCIAL_WEIGHT" AS "APPROVED_FINANCIAL_WEIGHT",
    "sc_tlm_invoiced_object"."APPROVED_ACTUAL_WEIGHT" AS "APPROVED_ACTUAL_WEIGHT",
    "sc_tlm_invoiced_object"."RATE_ADJUSTMENT" AS "RATE_ADJUSTMENT",
    "sc_tlm_invoiced_object"."MIN_CHARGE" AS "MIN_CHARGE",
    "sc_tlm_invoiced_object"."COMPUTED_TARIFF" AS "COMPUTED_TARIFF",
    "sc_tlm_invoiced_object"."COMPUTED_MIN_RATE" AS "COMPUTED_MIN_RATE",
    "sc_tlm_invoiced_object"."UNDEFINED_ADJUSTMENT" AS "UNDEFINED_ADJUSTMENT",
    "sc_tlm_invoiced_object"."DISCOUNT_AMOUNT" AS "DISCOUNT_AMOUNT",
    "sc_tlm_invoiced_object"."UNDEFINED_ADJ_CURR_CODE" AS "UNDEFINED_ADJ_CURR_CODE",
    "sc_tlm_invoiced_object"."DISCOUNT_AMT_CURR_CODE" AS "DISCOUNT_AMT_CURR_CODE",
    "sc_tlm_invoiced_object"."RATE_CURR_CODE" AS "RATE_CURR_CODE",
    "sc_tlm_invoiced_object"."CARRIER_ID" AS "CARRIER_ID",
    "sc_tlm_invoiced_object"."ASSIGNED_CARRIER_ID" AS "ASSIGNED_CARRIER_ID",
    "sc_tlm_invoiced_object"."EQUIPMENT_ID" AS "EQUIPMENT_ID",
    "sc_tlm_invoiced_object"."MOT_ID" AS "MOT_ID",
    "sc_tlm_invoiced_object"."PROTECTION_LEVEL_ID" AS "PROTECTION_LEVEL_ID",
    "sc_tlm_invoiced_object"."SERVICE_LEVEL_ID" AS "SERVICE_LEVEL_ID",
    "sc_tlm_invoiced_object"."UNDF_ADJ_CURR_CODE" AS "UNDF_ADJ_CURR_CODE",
    "sc_tlm_invoiced_object"."COMPUTED_FINANCIAL_WEIGHT" AS "COMPUTED_FINANCIAL_WEIGHT",
    "sc_tlm_invoiced_object"."ADJUSTMENT_AMOUNT" AS "ADJUSTMENT_AMOUNT",
    "sc_tlm_invoiced_object"."APPROVED_ADJUSTMENT_AMOUNT" AS "APPROVED_ADJUSTMENT_AMOUNT",
    "sc_tlm_invoiced_object"."APPROVED_STOP_COST" AS "APPROVED_STOP_COST",
    "sc_tlm_invoiced_object"."APPROVED_RATE_ADJUSTMENT" AS "APPROVED_RATE_ADJUSTMENT",
    "sc_tlm_invoiced_object"."APPROVED_RATE_CALC_METHOD" AS "APPROVED_RATE_CALC_METHOD",
    "sc_tlm_invoiced_object"."APPROVED_RATE_UOM" AS "APPROVED_RATE_UOM",
    "sc_tlm_invoiced_object"."APPROVED_DISTANCE_UOM" AS "APPROVED_DISTANCE_UOM",
    "sc_tlm_invoiced_object"."COMPUTED_LH_COST" AS "COMPUTED_LH_COST",
    "sc_tlm_invoiced_object"."COMPUTED_LH_COST_CURR_CODE" AS "COMPUTED_LH_COST_CURR_CODE",
    "sc_tlm_invoiced_object"."WEIGHT_UOM_ID" AS "WEIGHT_UOM_ID",
    "sc_tlm_invoiced_object"."APPROVED_WEIGHT_UOM_ID" AS "APPROVED_WEIGHT_UOM_ID",
    "sc_tlm_invoiced_object"."INV_MIN_RATE" AS "INV_MIN_RATE",
    "sc_tlm_invoiced_object"."SYS_MIN_RATE" AS "SYS_MIN_RATE",
    "sc_tlm_invoiced_object"."UNAPPLIED_LH_COST" AS "UNAPPLIED_LH_COST",
    "sc_tlm_invoiced_object"."UNAPPLIED_LH_CURRENCY_CODE" AS "UNAPPLIED_LH_CURRENCY_CODE",
    "sc_tlm_invoiced_object"."UNAPPLIED_STOP_COST" AS "UNAPPLIED_STOP_COST",
    "sc_tlm_invoiced_object"."UNAPPLIED_STOP_CURRENCY_CODE" AS "UNAPPLIED_STOP_CURRENCY_CODE",
    "sc_tlm_invoiced_object"."ORG_SHIP_VIA_FACILITY_ID" AS "ORG_SHIP_VIA_FACILITY_ID",
    "sc_tlm_invoiced_object"."ORG_SHIP_VIA_FACILITY_ALIAS_ID" AS "ORG_SHIP_VIA_FACILITY_ALIAS_ID",
    "sc_tlm_invoiced_object"."DES_SHIP_VIA_FACILITY_ID" AS "DES_SHIP_VIA_FACILITY_ID",
    "sc_tlm_invoiced_object"."DES_SHIP_VIA_FACILITY_ALIAS_ID" AS "DES_SHIP_VIA_FACILITY_ALIAS_ID",
    "sc_tlm_invoiced_object"."INCOTERM_ID" AS "INCOTERM_ID",
    "sc_tlm_invoiced_object"."SEC_CARRIER_ID" AS "SEC_CARRIER_ID",
    "sc_tlm_invoiced_object"."COMMODITY_CLASS" AS "COMMODITY_CLASS",
    "sc_tlm_invoiced_object"."ACTUAL_PAYMENT_AMOUNT" AS "ACTUAL_PAYMENT_AMOUNT",
    "sc_tlm_invoiced_object"."ACTUAL_CURRENCY_CODE" AS "ACTUAL_CURRENCY_CODE",
    "sc_tlm_invoiced_object"."NET_AMOUNT_CURRENCY_CODE" AS "NET_AMOUNT_CURRENCY_CODE",
    "sc_tlm_invoiced_object"."NET_AMOUNT_DUE" AS "NET_AMOUNT_DUE",
    "sc_tlm_invoiced_object"."NORMALIZED_NET_AMOUNT_DUE" AS "NORMALIZED_NET_AMOUNT_DUE",
    "sc_tlm_invoiced_object"."REF_INV_OBJECT_PAID_AMOUNT" AS "REF_INV_OBJECT_PAID_AMOUNT",
    "sc_tlm_invoiced_object"."REF_INV_OBJECT_PAID_AMOUNT_CC" AS "REF_INV_OBJECT_PAID_AMOUNT_CC",
    "sc_tlm_invoiced_object"."REF_INV_OBJECT_AMOUNT" AS "REF_INV_OBJECT_AMOUNT",
    "sc_tlm_invoiced_object"."REF_INV_OBJECT_AMOUNT_CC" AS "REF_INV_OBJECT_AMOUNT_CC",
    "sc_tlm_invoiced_object"."REF_INVOICED_OBJECT_ID" AS "REF_INVOICED_OBJECT_ID",
    "sc_tlm_invoiced_object"."INCOTERM_CODE" AS "INCOTERM_CODE",
    "sc_tlm_invoiced_object"."ACTUAL_VOLUME" AS "ACTUAL_VOLUME",
    "sc_tlm_invoiced_object"."VOLUME_UOM_ID" AS "VOLUME_UOM_ID",
    "sc_tlm_invoiced_object"."COMPUTED_VOLUME" AS "COMPUTED_VOLUME",
    "sc_tlm_invoiced_object"."COMPUTED_VOLUME_UOM_ID" AS "COMPUTED_VOLUME_UOM_ID",
    "sc_tlm_invoiced_object"."APPROVED_VOLUME" AS "APPROVED_VOLUME",
    "sc_tlm_invoiced_object"."APPROVED_VOLUME_UOM_ID" AS "APPROVED_VOLUME_UOM_ID",
    "sc_tlm_invoiced_object"."VOLUME_UOM" AS "VOLUME_UOM",
    "sc_tlm_invoiced_object"."WEIGHT_UOM" AS "WEIGHT_UOM",
    "sc_tlm_invoiced_object"."INV_OBJ_GRS_AMT_DUE_CURR_CODE" AS "INV_OBJ_GRS_AMT_DUE_CURR_CODE",
    "sc_tlm_invoiced_object"."INV_OBJ_TAX_AM_DUE_CURR_CODE" AS "INV_OBJ_TAX_AM_DUE_CURR_CODE",
    "sc_tlm_invoiced_object"."INV_OBJ_TAX_AMT_DUE" AS "INV_OBJ_TAX_AMT_DUE",
    "sc_tlm_invoiced_object"."INV_OBJ_GRS_AMT_DUE" AS "INV_OBJ_GRS_AMT_DUE",
    "sc_tlm_invoiced_object"."TRACKING_NUMBER" AS "TRACKING_NUMBER",
    "sc_tlm_invoiced_object"."LENGTH" AS "LENGTH",
    "sc_tlm_invoiced_object"."WIDTH" AS "WIDTH",
    "sc_tlm_invoiced_object"."HEIGHT" AS "HEIGHT",
    "sc_tlm_invoiced_object"."ADJ_RATE" AS "ADJ_RATE",
    "sc_tlm_invoiced_object"."COMPUTED_ADJ_RATE" AS "COMPUTED_ADJ_RATE",
    "sc_tlm_invoiced_object"."APPROVED_ADJ_RATE" AS "APPROVED_ADJ_RATE",
    "sc_tlm_invoiced_object"."ADJ_LH_COST" AS "ADJ_LH_COST",
    "sc_tlm_invoiced_object"."COMPUTED_ADJ_LH_COST" AS "COMPUTED_ADJ_LH_COST",
    "sc_tlm_invoiced_object"."APPROVED_ADJ_LH_COST" AS "APPROVED_ADJ_LH_COST",
    "sc_tlm_invoiced_object"."ENTRY_TYPE" AS "ENTRY_TYPE",
    "sc_tlm_invoiced_object"."PICKUP_NUMBER" AS "PICKUP_NUMBER",
    "sc_tlm_invoiced_object"."MONETARY_VALUE" AS "MONETARY_VALUE",
    "sc_tlm_invoiced_object"."MONETARY_VALUE_CURRENCY_CODE" AS "MONETARY_VALUE_CURRENCY_CODE",
    "sc_tlm_invoiced_object"."MANIFEST_TYPE" AS "MANIFEST_TYPE",
    "sc_tlm_invoiced_object"."NON_MACHINABLE" AS "NON_MACHINABLE",
    "sc_tlm_invoiced_object"."LENGTH_UOM_ID" AS "LENGTH_UOM_ID",
    "sc_tlm_invoiced_object"."RATING_LEVEL" AS "RATING_LEVEL",
    "sc_tlm_invoiced_object"."WIDTH_UOM_ID" AS "WIDTH_UOM_ID",
    "sc_tlm_invoiced_object"."HEIGHT_UOM_ID" AS "HEIGHT_UOM_ID",
    "sc_tlm_invoiced_object"."MARK_FOR_DELETION" AS "MARK_FOR_DELETION",
    "sc_tlm_invoiced_object"."BILLING_METHOD" AS "BILLING_METHOD",
    "sc_tlm_invoiced_object"."LAST_UPDATED_SOURCE_TYPE" AS "LAST_UPDATED_SOURCE_TYPE",
    "sc_tlm_invoiced_object"."UNAPPLIED_SPOT_COST" AS "UNAPPLIED_SPOT_COST",
    "sc_tlm_invoiced_object"."UNAPPLIED_SPOT_CURRENCY_CODE" AS "UNAPPLIED_SPOT_CURRENCY_CODE",
    "sc_tlm_invoiced_object"."APPROVED_SPOT_COST" AS "APPROVED_SPOT_COST",
    "sc_tlm_invoiced_object"."INVOICE_DTL_ID" AS "INVOICE_DTL_ID",
    "sc_tlm_invoiced_object"."VESSEL_NUMBER" AS "VESSEL_NUMBER",
    "sc_tlm_invoiced_object"."VOYAGE_FLIGHT_NUMBER" AS "VOYAGE_FLIGHT_NUMBER",
    "sc_tlm_invoiced_object"."BOOKING_TYPE" AS "BOOKING_TYPE",
    "sc_tlm_invoiced_object"."PRO_NUMBER" AS "PRO_NUMBER",
    "sc_tlm_invoiced_object"."TRAILER_NUMBER" AS "TRAILER_NUMBER",
    "sc_tlm_invoiced_object"."COMMODITY_CODE_ID" AS "COMMODITY_CODE_ID",
    "sc_tlm_invoiced_object"."UNAPPLIED_TOTAL_BALANCE" AS "UNAPPLIED_TOTAL_BALANCE",
    "sc_tlm_invoiced_object"."APPROVED_TOTAL_BALANCE" AS "APPROVED_TOTAL_BALANCE",
    "sc_tlm_invoiced_object"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP",
    "sc_tlm_invoiced_object"."OPERATION_TYPE" AS "OPERATION_TYPE",
    "sc_tlm_invoiced_object"."ARCHIVED_DTTM" AS "ARCHIVED_DTTM",
    "demestic_shipping_tlm_invoice_1"."INVOICE_DT" AS "INVOICE_DT",
    "demestic_shipping_tlm_invoice_1"."NUM_REJECTIONS" AS "NUM_REJECTIONS",
    "TENANT149_DATA_sc_tlm_shipment_by_TC_SHIPMENT_ID_1"."TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID",
    "TENANT149_DATA_sc_tlm_shipment_by_TC_SHIPMENT_ID_1"."DELIVERY_START_DTTM" AS "DELIVERY_START_DTTM",
    "TENANT149_DATA_sc_tlm_shipment_by_TC_SHIPMENT_ID_1"."DELIVERY_END_DTTM" AS "DELIVERY_END_DTTM",
    "tlm_shipment_actual_delivery_date"."ORIGIN" AS "ORIGIN",
    "tlm_shipment_actual_delivery_date"."FINAL_DESTINATION" AS "FINAL_DESTINATION",
    CAST("tlm_shipment_actual_delivery_date"."ACTUAL_DELIVERY_DATE_PARSED" AS DATE) AS "actual_delivery_date_parsed"
  FROM EDW.VW_SC_TLM_INVOICED_OBJECT "sc_tlm_invoiced_object"
  LEFT JOIN 
     ( SELECT 
    "INV_ID" AS "INV_ID",
    "INVOICE_DT" AS "INVOICE_DT",
    "NUM_REJECTIONS" AS "NUM_REJECTIONS"
     FROM EDW.VW_SC_TLM_INVOICE
     GROUP BY "INV_ID", "INVOICE_DT", "NUM_REJECTIONS") "demestic_shipping_tlm_invoice_1"     
    ON "sc_tlm_invoiced_object"."INV_ID" = "demestic_shipping_tlm_invoice_1"."INV_ID"
  LEFT JOIN (  SELECT 
        "TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID",
        MIN("DELIVERY_START_DTTM") AS "DELIVERY_START_DTTM",
        MIN("DELIVERY_END_DTTM") AS "DELIVERY_END_DTTM"
     FROM EDW.VW_SC_TLM_SHIPMENT
     GROUP BY "TC_SHIPMENT_ID") "TENANT149_DATA_sc_tlm_shipment_by_TC_SHIPMENT_ID_1"
    ON "sc_tlm_invoiced_object"."TC_OBJECT_ID" = "TENANT149_DATA_sc_tlm_shipment_by_TC_SHIPMENT_ID_1"."TC_SHIPMENT_ID"
  LEFT JOIN tlm_shipment_actual_delivery_date "tlm_shipment_actual_delivery_date"
    ON "sc_tlm_invoiced_object"."TC_OBJECT_ID" = "tlm_shipment_actual_delivery_date"."SHIPMENT_NUMBER"
)
SELECT 
    "INV_ID" AS "INV_ID",
    "INV_OBJECT_ID" AS "INV_OBJECT_ID",
    "TC_COMPANY_ID" AS "TC_COMPANY_ID",
    "TC_OBJECT_ID" AS "TC_OBJECT_ID",
    "INV_OBJECT_STATUS" AS "INV_OBJECT_STATUS",
    "O_NAME" AS "O_NAME",
    "O_ADDRESS" AS "O_ADDRESS",
    "O_CITY" AS "O_CITY",
    "O_COUNTY" AS "O_COUNTY",
    "O_STATE_PROV" AS "O_STATE_PROV",
    "O_POSTAL_CODE" AS "O_POSTAL_CODE",
    "O_COUNTRY_CODE" AS "O_COUNTRY_CODE",
    "D_NAME" AS "D_NAME",
    "D_ADDRESS" AS "D_ADDRESS",
    "D_CITY" AS "D_CITY",
    "D_COUNTY" AS "D_COUNTY",
    "D_STATE_PROV" AS "D_STATE_PROV",
    "D_POSTAL_CODE" AS "D_POSTAL_CODE",
    "D_COUNTRY_CODE" AS "D_COUNTRY_CODE",
    "MOT_DESC" AS "MOT_DESC",
    "EQUIPMENT_DESC" AS "EQUIPMENT_DESC",
    "SERVICE_LEVEL_DESC" AS "SERVICE_LEVEL_DESC",
    "PROTECTION_LEVEL_DESC" AS "PROTECTION_LEVEL_DESC",
    "FINANCIAL_WEIGHT" AS "FINANCIAL_WEIGHT",
    "ACTUAL_WEIGHT" AS "ACTUAL_WEIGHT",
    "TOTAL_COST" AS "TOTAL_COST",
    "LH_COST" AS "LH_COST",
    "DISTANCE" AS "DISTANCE",
    "DISTANCE_UOM" AS "DISTANCE_UOM",
    "BILL_OF_LADING_NUMBER" AS "BILL_OF_LADING_NUMBER",
    "PO_NUMBER" AS "PO_NUMBER",
    "SPEC_HANDLING_METHOD" AS "SPEC_HANDLING_METHOD",
    "COMMENTS" AS "COMMENTS",
    "HAS_IMPORT_ERROR" AS "HAS_IMPORT_ERROR",
    "HAS_WARNING" AS "HAS_WARNING",
    "IS_VALID" AS "IS_VALID",
    "CREATED_SOURCE_TYPE" AS "CREATED_SOURCE_TYPE",
    "CREATED_SOURCE" AS "CREATED_SOURCE",
    "CREATED_DTTM" AS "CREATED_DTTM",
    "LAST_UPDATED_SOURCE" AS "LAST_UPDATED_SOURCE",
    "LAST_UPDATED_DTTM" AS "LAST_UPDATED_DTTM",
    "STOP_COST" AS "STOP_COST",
    "AUXILARY_DATA" AS "AUXILARY_DATA",
    "PICKUP_DTTM" AS "PICKUP_DTTM",
    "DELIVERY_DTTM" AS "DELIVERY_DTTM",
    "CURRENCY_CODE" AS "CURRENCY_CODE",
    "LH_CURRENCY_CODE" AS "LH_CURRENCY_CODE",
    "STOP_CURRENCY_CODE" AS "STOP_CURRENCY_CODE",
    "SPOT_CHARGE_COST" AS "SPOT_CHARGE_COST",
    "SPOT_CHARGE_CURRENCY_CODE" AS "SPOT_CHARGE_CURRENCY_CODE",
    "ASSIGNED_CARRIER_CODE" AS "ASSIGNED_CARRIER_CODE",
    "NUM_PICKUPS" AS "NUM_PICKUPS",
    "NUM_DELIVERIES" AS "NUM_DELIVERIES",
    "RATE" AS "RATE",
    "RATE_CALC_METHOD" AS "RATE_CALC_METHOD",
    "RATE_UOM" AS "RATE_UOM",
    "TPE_OBJECT_ID" AS "TPE_OBJECT_ID",
    "O_FACILITY_ID" AS "O_FACILITY_ID",
    "D_FACILITY_ID" AS "D_FACILITY_ID",
    "TP_COMPANY_ID" AS "TP_COMPANY_ID",
    "PACKAGE_TYPE_ID" AS "PACKAGE_TYPE_ID",
    "COMPUTED_RATE" AS "COMPUTED_RATE",
    "COMPUTED_RATE_UOM" AS "COMPUTED_RATE_UOM",
    "COMPUTED_RATE_CALC_METHOD" AS "COMPUTED_RATE_CALC_METHOD",
    "COMPUTED_TOTAL_COST" AS "COMPUTED_TOTAL_COST",
    "COMPUTED_TOTAL_COST_CURR_CODE" AS "COMPUTED_TOTAL_COST_CURR_CODE",
    "O_FACILITY_NAME" AS "O_FACILITY_NAME",
    "D_FACILITY_NAME" AS "D_FACILITY_NAME",
    "COMPUTED_DISTANCE" AS "COMPUTED_DISTANCE",
    "COMPUTED_DISTANCE_UOM" AS "COMPUTED_DISTANCE_UOM",
    "COMPUTED_STOP_COST" AS "COMPUTED_STOP_COST",
    "COMPUTED_STOP_COST_CURR_CODE" AS "COMPUTED_STOP_COST_CURR_CODE",
    "APPROVED_DISTANCE" AS "APPROVED_DISTANCE",
    "APPROVED_LH_COST" AS "APPROVED_LH_COST",
    "APPROVED_RATE" AS "APPROVED_RATE",
    "APPROVED_FINANCIAL_WEIGHT" AS "APPROVED_FINANCIAL_WEIGHT",
    "APPROVED_ACTUAL_WEIGHT" AS "APPROVED_ACTUAL_WEIGHT",
    "RATE_ADJUSTMENT" AS "RATE_ADJUSTMENT",
    "MIN_CHARGE" AS "MIN_CHARGE",
    "COMPUTED_TARIFF" AS "COMPUTED_TARIFF",
    "COMPUTED_MIN_RATE" AS "COMPUTED_MIN_RATE",
    "UNDEFINED_ADJUSTMENT" AS "UNDEFINED_ADJUSTMENT",
    "DISCOUNT_AMOUNT" AS "DISCOUNT_AMOUNT",
    "UNDEFINED_ADJ_CURR_CODE" AS "UNDEFINED_ADJ_CURR_CODE",
    "DISCOUNT_AMT_CURR_CODE" AS "DISCOUNT_AMT_CURR_CODE",
    "RATE_CURR_CODE" AS "RATE_CURR_CODE",
    "CARRIER_ID" AS "CARRIER_ID",
    "ASSIGNED_CARRIER_ID" AS "ASSIGNED_CARRIER_ID",
    "EQUIPMENT_ID" AS "EQUIPMENT_ID",
    "MOT_ID" AS "MOT_ID",
    "PROTECTION_LEVEL_ID" AS "PROTECTION_LEVEL_ID",
    "SERVICE_LEVEL_ID" AS "SERVICE_LEVEL_ID",
    "UNDF_ADJ_CURR_CODE" AS "UNDF_ADJ_CURR_CODE",
    "COMPUTED_FINANCIAL_WEIGHT" AS "COMPUTED_FINANCIAL_WEIGHT",
    "ADJUSTMENT_AMOUNT" AS "ADJUSTMENT_AMOUNT",
    "APPROVED_ADJUSTMENT_AMOUNT" AS "APPROVED_ADJUSTMENT_AMOUNT",
    "APPROVED_STOP_COST" AS "APPROVED_STOP_COST",
    "APPROVED_RATE_ADJUSTMENT" AS "APPROVED_RATE_ADJUSTMENT",
    "APPROVED_RATE_CALC_METHOD" AS "APPROVED_RATE_CALC_METHOD",
    "APPROVED_RATE_UOM" AS "APPROVED_RATE_UOM",
    "APPROVED_DISTANCE_UOM" AS "APPROVED_DISTANCE_UOM",
    "COMPUTED_LH_COST" AS "COMPUTED_LH_COST",
    "COMPUTED_LH_COST_CURR_CODE" AS "COMPUTED_LH_COST_CURR_CODE",
    "WEIGHT_UOM_ID" AS "WEIGHT_UOM_ID",
    "APPROVED_WEIGHT_UOM_ID" AS "APPROVED_WEIGHT_UOM_ID",
    "INV_MIN_RATE" AS "INV_MIN_RATE",
    "SYS_MIN_RATE" AS "SYS_MIN_RATE",
    "UNAPPLIED_LH_COST" AS "UNAPPLIED_LH_COST",
    "UNAPPLIED_LH_CURRENCY_CODE" AS "UNAPPLIED_LH_CURRENCY_CODE",
    "UNAPPLIED_STOP_COST" AS "UNAPPLIED_STOP_COST",
    "UNAPPLIED_STOP_CURRENCY_CODE" AS "UNAPPLIED_STOP_CURRENCY_CODE",
    "ORG_SHIP_VIA_FACILITY_ID" AS "ORG_SHIP_VIA_FACILITY_ID",
    "ORG_SHIP_VIA_FACILITY_ALIAS_ID" AS "ORG_SHIP_VIA_FACILITY_ALIAS_ID",
    "DES_SHIP_VIA_FACILITY_ID" AS "DES_SHIP_VIA_FACILITY_ID",
    "DES_SHIP_VIA_FACILITY_ALIAS_ID" AS "DES_SHIP_VIA_FACILITY_ALIAS_ID",
    "INCOTERM_ID" AS "INCOTERM_ID",
    "SEC_CARRIER_ID" AS "SEC_CARRIER_ID",
    "COMMODITY_CLASS" AS "COMMODITY_CLASS",
    "ACTUAL_PAYMENT_AMOUNT" AS "ACTUAL_PAYMENT_AMOUNT",
    "ACTUAL_CURRENCY_CODE" AS "ACTUAL_CURRENCY_CODE",
    "NET_AMOUNT_CURRENCY_CODE" AS "NET_AMOUNT_CURRENCY_CODE",
    "NET_AMOUNT_DUE" AS "NET_AMOUNT_DUE",
    "NORMALIZED_NET_AMOUNT_DUE" AS "NORMALIZED_NET_AMOUNT_DUE",
    "REF_INV_OBJECT_PAID_AMOUNT" AS "REF_INV_OBJECT_PAID_AMOUNT",
    "REF_INV_OBJECT_PAID_AMOUNT_CC" AS "REF_INV_OBJECT_PAID_AMOUNT_CC",
    "REF_INV_OBJECT_AMOUNT" AS "REF_INV_OBJECT_AMOUNT",
    "REF_INV_OBJECT_AMOUNT_CC" AS "REF_INV_OBJECT_AMOUNT_CC",
    "REF_INVOICED_OBJECT_ID" AS "REF_INVOICED_OBJECT_ID",
    "INCOTERM_CODE" AS "INCOTERM_CODE",
    "ACTUAL_VOLUME" AS "ACTUAL_VOLUME",
    "VOLUME_UOM_ID" AS "VOLUME_UOM_ID",
    "COMPUTED_VOLUME" AS "COMPUTED_VOLUME",
    "COMPUTED_VOLUME_UOM_ID" AS "COMPUTED_VOLUME_UOM_ID",
    "APPROVED_VOLUME" AS "APPROVED_VOLUME",
    "APPROVED_VOLUME_UOM_ID" AS "APPROVED_VOLUME_UOM_ID",
    "VOLUME_UOM" AS "VOLUME_UOM",
    "WEIGHT_UOM" AS "WEIGHT_UOM",
    "INV_OBJ_GRS_AMT_DUE_CURR_CODE" AS "INV_OBJ_GRS_AMT_DUE_CURR_CODE",
    "INV_OBJ_TAX_AM_DUE_CURR_CODE" AS "INV_OBJ_TAX_AM_DUE_CURR_CODE",
    "INV_OBJ_TAX_AMT_DUE" AS "INV_OBJ_TAX_AMT_DUE",
    "INV_OBJ_GRS_AMT_DUE" AS "INV_OBJ_GRS_AMT_DUE",
    "TRACKING_NUMBER" AS "TRACKING_NUMBER",
    "LENGTH" AS "LENGTH",
    "WIDTH" AS "WIDTH",
    "HEIGHT" AS "HEIGHT",
    "ADJ_RATE" AS "ADJ_RATE",
    "COMPUTED_ADJ_RATE" AS "COMPUTED_ADJ_RATE",
    "APPROVED_ADJ_RATE" AS "APPROVED_ADJ_RATE",
    "ADJ_LH_COST" AS "ADJ_LH_COST",
    "COMPUTED_ADJ_LH_COST" AS "COMPUTED_ADJ_LH_COST",
    "APPROVED_ADJ_LH_COST" AS "APPROVED_ADJ_LH_COST",
    "ENTRY_TYPE" AS "ENTRY_TYPE",
    "PICKUP_NUMBER" AS "PICKUP_NUMBER",
    "MONETARY_VALUE" AS "MONETARY_VALUE",
    "MONETARY_VALUE_CURRENCY_CODE" AS "MONETARY_VALUE_CURRENCY_CODE",
    "MANIFEST_TYPE" AS "MANIFEST_TYPE",
    "NON_MACHINABLE" AS "NON_MACHINABLE",
    "LENGTH_UOM_ID" AS "LENGTH_UOM_ID",
    "RATING_LEVEL" AS "RATING_LEVEL",
    "WIDTH_UOM_ID" AS "WIDTH_UOM_ID",
    "HEIGHT_UOM_ID" AS "HEIGHT_UOM_ID",
    "MARK_FOR_DELETION" AS "MARK_FOR_DELETION",
    "BILLING_METHOD" AS "BILLING_METHOD",
    "LAST_UPDATED_SOURCE_TYPE" AS "LAST_UPDATED_SOURCE_TYPE",
    "UNAPPLIED_SPOT_COST" AS "UNAPPLIED_SPOT_COST",
    "UNAPPLIED_SPOT_CURRENCY_CODE" AS "UNAPPLIED_SPOT_CURRENCY_CODE",
    "APPROVED_SPOT_COST" AS "APPROVED_SPOT_COST",
    "INVOICE_DTL_ID" AS "INVOICE_DTL_ID",
    "VESSEL_NUMBER" AS "VESSEL_NUMBER",
    "VOYAGE_FLIGHT_NUMBER" AS "VOYAGE_FLIGHT_NUMBER",
    "BOOKING_TYPE" AS "BOOKING_TYPE",
    "PRO_NUMBER" AS "PRO_NUMBER",
    "TRAILER_NUMBER" AS "TRAILER_NUMBER",
    "COMMODITY_CODE_ID" AS "COMMODITY_CODE_ID",
    "UNAPPLIED_TOTAL_BALANCE" AS "UNAPPLIED_TOTAL_BALANCE",
    "APPROVED_TOTAL_BALANCE" AS "APPROVED_TOTAL_BALANCE",
    "CDC_TIMESTAMP" AS "CDC_TIMESTAMP",
    "OPERATION_TYPE" AS "OPERATION_TYPE",
    "ARCHIVED_DTTM" AS "ARCHIVED_DTTM",
    "INVOICE_DT" AS "INVOICE_DT",
     SUBSTR("INVOICE_DT",1,10) as "INVOICE_DT_0",
      To_varchar(Date_trunc('SECOND', Convert_timezone('UTC', 'UTC', (SUBSTR("INVOICE_DT",1,10)))), 'YYYY-MM-DD"T"HH24:MI:SS"."FF3"Z"') AS 
    invoice_date_parsed,
    "NUM_REJECTIONS" AS "NUM_REJECTIONS",
    "TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID",
    "DELIVERY_START_DTTM" AS "DELIVERY_START_DTTM",
     SUBSTR("DELIVERY_START_DTTM",1,10) as "DELIVERY_DT_0",
      To_varchar(Date_trunc('SECOND', Convert_timezone('UTC', 'UTC', (SUBSTR("DELIVERY_START_DTTM",1,10)))), 'YYYY-MM-DD"T"HH24:MI:SS"."FF3"Z"') AS 
    delivery_date_parsed,
    "DELIVERY_END_DTTM" AS "DELIVERY_END_DTTM",
    "ORIGIN" AS "ORIGIN",
    "FINAL_DESTINATION" AS "FINAL_DESTINATION",
    "actual_delivery_date_parsed" AS "actual_delivery_date_parsed",
    "VENDOR_ID" AS "VENDOR_ID",
    "flag_wood_pellet" AS "flag_wood_pellet",
    "VENDOR_NAME" AS "VENDOR_NAME",
    "flag_wood_pellet_2" AS "flag_wood_pellet_2",
    COALESCE("flag_wood_pellet", "flag_wood_pellet_2", 0) AS "flag_wood_pellet_combined"
  FROM (
    SELECT 
        "domestic_shipping_w_date_1"."INV_ID" AS "INV_ID",
        "domestic_shipping_w_date_1"."INV_OBJECT_ID" AS "INV_OBJECT_ID",
        "domestic_shipping_w_date_1"."TC_COMPANY_ID" AS "TC_COMPANY_ID",
        "domestic_shipping_w_date_1"."TC_OBJECT_ID" AS "TC_OBJECT_ID",
        "domestic_shipping_w_date_1"."INV_OBJECT_STATUS" AS "INV_OBJECT_STATUS",
        "domestic_shipping_w_date_1"."O_NAME" AS "O_NAME",
        "domestic_shipping_w_date_1"."O_ADDRESS" AS "O_ADDRESS",
        "domestic_shipping_w_date_1"."O_CITY" AS "O_CITY",
        "domestic_shipping_w_date_1"."O_COUNTY" AS "O_COUNTY",
        "domestic_shipping_w_date_1"."O_STATE_PROV" AS "O_STATE_PROV",
        "domestic_shipping_w_date_1"."O_POSTAL_CODE" AS "O_POSTAL_CODE",
        "domestic_shipping_w_date_1"."O_COUNTRY_CODE" AS "O_COUNTRY_CODE",
        "domestic_shipping_w_date_1"."D_NAME" AS "D_NAME",
        "domestic_shipping_w_date_1"."D_ADDRESS" AS "D_ADDRESS",
        "domestic_shipping_w_date_1"."D_CITY" AS "D_CITY",
        "domestic_shipping_w_date_1"."D_COUNTY" AS "D_COUNTY",
        "domestic_shipping_w_date_1"."D_STATE_PROV" AS "D_STATE_PROV",
        "domestic_shipping_w_date_1"."D_POSTAL_CODE" AS "D_POSTAL_CODE",
        "domestic_shipping_w_date_1"."D_COUNTRY_CODE" AS "D_COUNTRY_CODE",
        "domestic_shipping_w_date_1"."MOT_DESC" AS "MOT_DESC",
        "domestic_shipping_w_date_1"."EQUIPMENT_DESC" AS "EQUIPMENT_DESC",
        "domestic_shipping_w_date_1"."SERVICE_LEVEL_DESC" AS "SERVICE_LEVEL_DESC",
        "domestic_shipping_w_date_1"."PROTECTION_LEVEL_DESC" AS "PROTECTION_LEVEL_DESC",
        "domestic_shipping_w_date_1"."FINANCIAL_WEIGHT" AS "FINANCIAL_WEIGHT",
        "domestic_shipping_w_date_1"."ACTUAL_WEIGHT" AS "ACTUAL_WEIGHT",
        "domestic_shipping_w_date_1"."TOTAL_COST" AS "TOTAL_COST",
        "domestic_shipping_w_date_1"."LH_COST" AS "LH_COST",
        "domestic_shipping_w_date_1"."DISTANCE" AS "DISTANCE",
        "domestic_shipping_w_date_1"."DISTANCE_UOM" AS "DISTANCE_UOM",
        "domestic_shipping_w_date_1"."BILL_OF_LADING_NUMBER" AS "BILL_OF_LADING_NUMBER",
        "domestic_shipping_w_date_1"."PO_NUMBER" AS "PO_NUMBER",
        "domestic_shipping_w_date_1"."SPEC_HANDLING_METHOD" AS "SPEC_HANDLING_METHOD",
        "domestic_shipping_w_date_1"."COMMENTS" AS "COMMENTS",
        "domestic_shipping_w_date_1"."HAS_IMPORT_ERROR" AS "HAS_IMPORT_ERROR",
        "domestic_shipping_w_date_1"."HAS_WARNING" AS "HAS_WARNING",
        "domestic_shipping_w_date_1"."IS_VALID" AS "IS_VALID",
        "domestic_shipping_w_date_1"."CREATED_SOURCE_TYPE" AS "CREATED_SOURCE_TYPE",
        "domestic_shipping_w_date_1"."CREATED_SOURCE" AS "CREATED_SOURCE",
        "domestic_shipping_w_date_1"."CREATED_DTTM" AS "CREATED_DTTM",
        "domestic_shipping_w_date_1"."LAST_UPDATED_SOURCE" AS "LAST_UPDATED_SOURCE",
        "domestic_shipping_w_date_1"."LAST_UPDATED_DTTM" AS "LAST_UPDATED_DTTM",
        "domestic_shipping_w_date_1"."STOP_COST" AS "STOP_COST",
        "domestic_shipping_w_date_1"."AUXILARY_DATA" AS "AUXILARY_DATA",
        "domestic_shipping_w_date_1"."PICKUP_DTTM" AS "PICKUP_DTTM",
        "domestic_shipping_w_date_1"."DELIVERY_DTTM" AS "DELIVERY_DTTM",
        "domestic_shipping_w_date_1"."CURRENCY_CODE" AS "CURRENCY_CODE",
        "domestic_shipping_w_date_1"."LH_CURRENCY_CODE" AS "LH_CURRENCY_CODE",
        "domestic_shipping_w_date_1"."STOP_CURRENCY_CODE" AS "STOP_CURRENCY_CODE",
        "domestic_shipping_w_date_1"."SPOT_CHARGE_COST" AS "SPOT_CHARGE_COST",
        "domestic_shipping_w_date_1"."SPOT_CHARGE_CURRENCY_CODE" AS "SPOT_CHARGE_CURRENCY_CODE",
        "domestic_shipping_w_date_1"."ASSIGNED_CARRIER_CODE" AS "ASSIGNED_CARRIER_CODE",
        "domestic_shipping_w_date_1"."NUM_PICKUPS" AS "NUM_PICKUPS",
        "domestic_shipping_w_date_1"."NUM_DELIVERIES" AS "NUM_DELIVERIES",
        "domestic_shipping_w_date_1"."RATE" AS "RATE",
        "domestic_shipping_w_date_1"."RATE_CALC_METHOD" AS "RATE_CALC_METHOD",
        "domestic_shipping_w_date_1"."RATE_UOM" AS "RATE_UOM",
        "domestic_shipping_w_date_1"."TPE_OBJECT_ID" AS "TPE_OBJECT_ID",
        "domestic_shipping_w_date_1"."O_FACILITY_ID" AS "O_FACILITY_ID",
        "domestic_shipping_w_date_1"."D_FACILITY_ID" AS "D_FACILITY_ID",
        "domestic_shipping_w_date_1"."TP_COMPANY_ID" AS "TP_COMPANY_ID",
        "domestic_shipping_w_date_1"."PACKAGE_TYPE_ID" AS "PACKAGE_TYPE_ID",
        "domestic_shipping_w_date_1"."COMPUTED_RATE" AS "COMPUTED_RATE",
        "domestic_shipping_w_date_1"."COMPUTED_RATE_UOM" AS "COMPUTED_RATE_UOM",
        "domestic_shipping_w_date_1"."COMPUTED_RATE_CALC_METHOD" AS "COMPUTED_RATE_CALC_METHOD",
        "domestic_shipping_w_date_1"."COMPUTED_TOTAL_COST" AS "COMPUTED_TOTAL_COST",
        "domestic_shipping_w_date_1"."COMPUTED_TOTAL_COST_CURR_CODE" AS "COMPUTED_TOTAL_COST_CURR_CODE",
        "domestic_shipping_w_date_1"."O_FACILITY_NAME" AS "O_FACILITY_NAME",
        "domestic_shipping_w_date_1"."D_FACILITY_NAME" AS "D_FACILITY_NAME",
        "domestic_shipping_w_date_1"."COMPUTED_DISTANCE" AS "COMPUTED_DISTANCE",
        "domestic_shipping_w_date_1"."COMPUTED_DISTANCE_UOM" AS "COMPUTED_DISTANCE_UOM",
        "domestic_shipping_w_date_1"."COMPUTED_STOP_COST" AS "COMPUTED_STOP_COST",
        "domestic_shipping_w_date_1"."COMPUTED_STOP_COST_CURR_CODE" AS "COMPUTED_STOP_COST_CURR_CODE",
        "domestic_shipping_w_date_1"."APPROVED_DISTANCE" AS "APPROVED_DISTANCE",
        "domestic_shipping_w_date_1"."APPROVED_LH_COST" AS "APPROVED_LH_COST",
        "domestic_shipping_w_date_1"."APPROVED_RATE" AS "APPROVED_RATE",
        "domestic_shipping_w_date_1"."APPROVED_FINANCIAL_WEIGHT" AS "APPROVED_FINANCIAL_WEIGHT",
        "domestic_shipping_w_date_1"."APPROVED_ACTUAL_WEIGHT" AS "APPROVED_ACTUAL_WEIGHT",
        "domestic_shipping_w_date_1"."RATE_ADJUSTMENT" AS "RATE_ADJUSTMENT",
        "domestic_shipping_w_date_1"."MIN_CHARGE" AS "MIN_CHARGE",
        "domestic_shipping_w_date_1"."COMPUTED_TARIFF" AS "COMPUTED_TARIFF",
        "domestic_shipping_w_date_1"."COMPUTED_MIN_RATE" AS "COMPUTED_MIN_RATE",
        "domestic_shipping_w_date_1"."UNDEFINED_ADJUSTMENT" AS "UNDEFINED_ADJUSTMENT",
        "domestic_shipping_w_date_1"."DISCOUNT_AMOUNT" AS "DISCOUNT_AMOUNT",
        "domestic_shipping_w_date_1"."UNDEFINED_ADJ_CURR_CODE" AS "UNDEFINED_ADJ_CURR_CODE",
        "domestic_shipping_w_date_1"."DISCOUNT_AMT_CURR_CODE" AS "DISCOUNT_AMT_CURR_CODE",
        "domestic_shipping_w_date_1"."RATE_CURR_CODE" AS "RATE_CURR_CODE",
        "domestic_shipping_w_date_1"."CARRIER_ID" AS "CARRIER_ID",
        "domestic_shipping_w_date_1"."ASSIGNED_CARRIER_ID" AS "ASSIGNED_CARRIER_ID",
        "domestic_shipping_w_date_1"."EQUIPMENT_ID" AS "EQUIPMENT_ID",
        "domestic_shipping_w_date_1"."MOT_ID" AS "MOT_ID",
        "domestic_shipping_w_date_1"."PROTECTION_LEVEL_ID" AS "PROTECTION_LEVEL_ID",
        "domestic_shipping_w_date_1"."SERVICE_LEVEL_ID" AS "SERVICE_LEVEL_ID",
        "domestic_shipping_w_date_1"."UNDF_ADJ_CURR_CODE" AS "UNDF_ADJ_CURR_CODE",
        "domestic_shipping_w_date_1"."COMPUTED_FINANCIAL_WEIGHT" AS "COMPUTED_FINANCIAL_WEIGHT",
        "domestic_shipping_w_date_1"."ADJUSTMENT_AMOUNT" AS "ADJUSTMENT_AMOUNT",
        "domestic_shipping_w_date_1"."APPROVED_ADJUSTMENT_AMOUNT" AS "APPROVED_ADJUSTMENT_AMOUNT",
        "domestic_shipping_w_date_1"."APPROVED_STOP_COST" AS "APPROVED_STOP_COST",
        "domestic_shipping_w_date_1"."APPROVED_RATE_ADJUSTMENT" AS "APPROVED_RATE_ADJUSTMENT",
        "domestic_shipping_w_date_1"."APPROVED_RATE_CALC_METHOD" AS "APPROVED_RATE_CALC_METHOD",
        "domestic_shipping_w_date_1"."APPROVED_RATE_UOM" AS "APPROVED_RATE_UOM",
        "domestic_shipping_w_date_1"."APPROVED_DISTANCE_UOM" AS "APPROVED_DISTANCE_UOM",
        "domestic_shipping_w_date_1"."COMPUTED_LH_COST" AS "COMPUTED_LH_COST",
        "domestic_shipping_w_date_1"."COMPUTED_LH_COST_CURR_CODE" AS "COMPUTED_LH_COST_CURR_CODE",
        "domestic_shipping_w_date_1"."WEIGHT_UOM_ID" AS "WEIGHT_UOM_ID",
        "domestic_shipping_w_date_1"."APPROVED_WEIGHT_UOM_ID" AS "APPROVED_WEIGHT_UOM_ID",
        "domestic_shipping_w_date_1"."INV_MIN_RATE" AS "INV_MIN_RATE",
        "domestic_shipping_w_date_1"."SYS_MIN_RATE" AS "SYS_MIN_RATE",
        "domestic_shipping_w_date_1"."UNAPPLIED_LH_COST" AS "UNAPPLIED_LH_COST",
        "domestic_shipping_w_date_1"."UNAPPLIED_LH_CURRENCY_CODE" AS "UNAPPLIED_LH_CURRENCY_CODE",
        "domestic_shipping_w_date_1"."UNAPPLIED_STOP_COST" AS "UNAPPLIED_STOP_COST",
        "domestic_shipping_w_date_1"."UNAPPLIED_STOP_CURRENCY_CODE" AS "UNAPPLIED_STOP_CURRENCY_CODE",
        "domestic_shipping_w_date_1"."ORG_SHIP_VIA_FACILITY_ID" AS "ORG_SHIP_VIA_FACILITY_ID",
        "domestic_shipping_w_date_1"."ORG_SHIP_VIA_FACILITY_ALIAS_ID" AS "ORG_SHIP_VIA_FACILITY_ALIAS_ID",
        "domestic_shipping_w_date_1"."DES_SHIP_VIA_FACILITY_ID" AS "DES_SHIP_VIA_FACILITY_ID",
        "domestic_shipping_w_date_1"."DES_SHIP_VIA_FACILITY_ALIAS_ID" AS "DES_SHIP_VIA_FACILITY_ALIAS_ID",
        "domestic_shipping_w_date_1"."INCOTERM_ID" AS "INCOTERM_ID",
        "domestic_shipping_w_date_1"."SEC_CARRIER_ID" AS "SEC_CARRIER_ID",
        "domestic_shipping_w_date_1"."COMMODITY_CLASS" AS "COMMODITY_CLASS",
        "domestic_shipping_w_date_1"."ACTUAL_PAYMENT_AMOUNT" AS "ACTUAL_PAYMENT_AMOUNT",
        "domestic_shipping_w_date_1"."ACTUAL_CURRENCY_CODE" AS "ACTUAL_CURRENCY_CODE",
        "domestic_shipping_w_date_1"."NET_AMOUNT_CURRENCY_CODE" AS "NET_AMOUNT_CURRENCY_CODE",
        "domestic_shipping_w_date_1"."NET_AMOUNT_DUE" AS "NET_AMOUNT_DUE",
        "domestic_shipping_w_date_1"."NORMALIZED_NET_AMOUNT_DUE" AS "NORMALIZED_NET_AMOUNT_DUE",
        "domestic_shipping_w_date_1"."REF_INV_OBJECT_PAID_AMOUNT" AS "REF_INV_OBJECT_PAID_AMOUNT",
        "domestic_shipping_w_date_1"."REF_INV_OBJECT_PAID_AMOUNT_CC" AS "REF_INV_OBJECT_PAID_AMOUNT_CC",
        "domestic_shipping_w_date_1"."REF_INV_OBJECT_AMOUNT" AS "REF_INV_OBJECT_AMOUNT",
        "domestic_shipping_w_date_1"."REF_INV_OBJECT_AMOUNT_CC" AS "REF_INV_OBJECT_AMOUNT_CC",
        "domestic_shipping_w_date_1"."REF_INVOICED_OBJECT_ID" AS "REF_INVOICED_OBJECT_ID",
        "domestic_shipping_w_date_1"."INCOTERM_CODE" AS "INCOTERM_CODE",
        "domestic_shipping_w_date_1"."ACTUAL_VOLUME" AS "ACTUAL_VOLUME",
        "domestic_shipping_w_date_1"."VOLUME_UOM_ID" AS "VOLUME_UOM_ID",
        "domestic_shipping_w_date_1"."COMPUTED_VOLUME" AS "COMPUTED_VOLUME",
        "domestic_shipping_w_date_1"."COMPUTED_VOLUME_UOM_ID" AS "COMPUTED_VOLUME_UOM_ID",
        "domestic_shipping_w_date_1"."APPROVED_VOLUME" AS "APPROVED_VOLUME",
        "domestic_shipping_w_date_1"."APPROVED_VOLUME_UOM_ID" AS "APPROVED_VOLUME_UOM_ID",
        "domestic_shipping_w_date_1"."VOLUME_UOM" AS "VOLUME_UOM",
        "domestic_shipping_w_date_1"."WEIGHT_UOM" AS "WEIGHT_UOM",
        "domestic_shipping_w_date_1"."INV_OBJ_GRS_AMT_DUE_CURR_CODE" AS "INV_OBJ_GRS_AMT_DUE_CURR_CODE",
        "domestic_shipping_w_date_1"."INV_OBJ_TAX_AM_DUE_CURR_CODE" AS "INV_OBJ_TAX_AM_DUE_CURR_CODE",
        "domestic_shipping_w_date_1"."INV_OBJ_TAX_AMT_DUE" AS "INV_OBJ_TAX_AMT_DUE",
        "domestic_shipping_w_date_1"."INV_OBJ_GRS_AMT_DUE" AS "INV_OBJ_GRS_AMT_DUE",
        "domestic_shipping_w_date_1"."TRACKING_NUMBER" AS "TRACKING_NUMBER",
        "domestic_shipping_w_date_1"."LENGTH" AS "LENGTH",
        "domestic_shipping_w_date_1"."WIDTH" AS "WIDTH",
        "domestic_shipping_w_date_1"."HEIGHT" AS "HEIGHT",
        "domestic_shipping_w_date_1"."ADJ_RATE" AS "ADJ_RATE",
        "domestic_shipping_w_date_1"."COMPUTED_ADJ_RATE" AS "COMPUTED_ADJ_RATE",
        "domestic_shipping_w_date_1"."APPROVED_ADJ_RATE" AS "APPROVED_ADJ_RATE",
        "domestic_shipping_w_date_1"."ADJ_LH_COST" AS "ADJ_LH_COST",
        "domestic_shipping_w_date_1"."COMPUTED_ADJ_LH_COST" AS "COMPUTED_ADJ_LH_COST",
        "domestic_shipping_w_date_1"."APPROVED_ADJ_LH_COST" AS "APPROVED_ADJ_LH_COST",
        "domestic_shipping_w_date_1"."ENTRY_TYPE" AS "ENTRY_TYPE",
        "domestic_shipping_w_date_1"."PICKUP_NUMBER" AS "PICKUP_NUMBER",
        "domestic_shipping_w_date_1"."MONETARY_VALUE" AS "MONETARY_VALUE",
        "domestic_shipping_w_date_1"."MONETARY_VALUE_CURRENCY_CODE" AS "MONETARY_VALUE_CURRENCY_CODE",
        "domestic_shipping_w_date_1"."MANIFEST_TYPE" AS "MANIFEST_TYPE",
        "domestic_shipping_w_date_1"."NON_MACHINABLE" AS "NON_MACHINABLE",
        "domestic_shipping_w_date_1"."LENGTH_UOM_ID" AS "LENGTH_UOM_ID",
        "domestic_shipping_w_date_1"."RATING_LEVEL" AS "RATING_LEVEL",
        "domestic_shipping_w_date_1"."WIDTH_UOM_ID" AS "WIDTH_UOM_ID",
        "domestic_shipping_w_date_1"."HEIGHT_UOM_ID" AS "HEIGHT_UOM_ID",
        "domestic_shipping_w_date_1"."MARK_FOR_DELETION" AS "MARK_FOR_DELETION",
        "domestic_shipping_w_date_1"."BILLING_METHOD" AS "BILLING_METHOD",
        "domestic_shipping_w_date_1"."LAST_UPDATED_SOURCE_TYPE" AS "LAST_UPDATED_SOURCE_TYPE",
        "domestic_shipping_w_date_1"."UNAPPLIED_SPOT_COST" AS "UNAPPLIED_SPOT_COST",
        "domestic_shipping_w_date_1"."UNAPPLIED_SPOT_CURRENCY_CODE" AS "UNAPPLIED_SPOT_CURRENCY_CODE",
        "domestic_shipping_w_date_1"."APPROVED_SPOT_COST" AS "APPROVED_SPOT_COST",
        "domestic_shipping_w_date_1"."INVOICE_DTL_ID" AS "INVOICE_DTL_ID",
        "domestic_shipping_w_date_1"."VESSEL_NUMBER" AS "VESSEL_NUMBER",
        "domestic_shipping_w_date_1"."VOYAGE_FLIGHT_NUMBER" AS "VOYAGE_FLIGHT_NUMBER",
        "domestic_shipping_w_date_1"."BOOKING_TYPE" AS "BOOKING_TYPE",
        "domestic_shipping_w_date_1"."PRO_NUMBER" AS "PRO_NUMBER",
        "domestic_shipping_w_date_1"."TRAILER_NUMBER" AS "TRAILER_NUMBER",
        "domestic_shipping_w_date_1"."COMMODITY_CODE_ID" AS "COMMODITY_CODE_ID",
        "domestic_shipping_w_date_1"."UNAPPLIED_TOTAL_BALANCE" AS "UNAPPLIED_TOTAL_BALANCE",
        "domestic_shipping_w_date_1"."APPROVED_TOTAL_BALANCE" AS "APPROVED_TOTAL_BALANCE",
        "domestic_shipping_w_date_1"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP",
        "domestic_shipping_w_date_1"."OPERATION_TYPE" AS "OPERATION_TYPE",
        "domestic_shipping_w_date_1"."ARCHIVED_DTTM" AS "ARCHIVED_DTTM",
        "domestic_shipping_w_date_1"."INVOICE_DT" AS "INVOICE_DT",
        "domestic_shipping_w_date_1"."NUM_REJECTIONS" AS "NUM_REJECTIONS",
        "domestic_shipping_w_date_1"."TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID",
        "domestic_shipping_w_date_1"."DELIVERY_START_DTTM" AS "DELIVERY_START_DTTM",
        "domestic_shipping_w_date_1"."DELIVERY_END_DTTM" AS "DELIVERY_END_DTTM",
        "domestic_shipping_w_date_1"."ORIGIN" AS "ORIGIN",
        "domestic_shipping_w_date_1"."FINAL_DESTINATION" AS "FINAL_DESTINATION",
        "domestic_shipping_w_date_1"."actual_delivery_date_parsed" AS "actual_delivery_date_parsed",
        "wood_pellet_vendors_w_number_by_VENDOR_ID"."VENDOR_ID" AS "VENDOR_ID",
        "wood_pellet_vendors_w_number_by_VENDOR_ID"."flag_wood_pellet" AS "flag_wood_pellet",
        "wood_pellet_vendors_prepared_w_name"."VENDOR_NAME" AS "VENDOR_NAME",
        "wood_pellet_vendors_prepared_w_name"."flag_wood_pellet_2" AS "flag_wood_pellet_2"
      FROM domestic_shipping_w_date_1 "domestic_shipping_w_date_1"
      LEFT JOIN (
        SELECT 
            "VENDOR_ID" AS "VENDOR_ID",
            1 AS "flag_wood_pellet"
          FROM (
            SELECT *
              FROM "WOOD_PELLET_VENDORS_W_NUMBER_BY_VENDOR_ID" "wood_pellet_vendors_w_number_by_VENDOR_ID"
            ) "withoutcomputedcols_query"
        ) "wood_pellet_vendors_w_number_by_VENDOR_ID"
        ON "domestic_shipping_w_date_1"."O_FACILITY_NAME" = "wood_pellet_vendors_w_number_by_VENDOR_ID"."VENDOR_ID"
      LEFT JOIN (
        SELECT 
            "VENDOR_NAME" AS "VENDOR_NAME",
            1 AS "flag_wood_pellet_2"
          FROM (
            SELECT *
              FROM "WOOD_PELLET_VENDORS_PREPARED_W_NAME" "wood_pellet_vendors_prepared_w_name"
            ) "withoutcomputedcols_query"
        ) "wood_pellet_vendors_prepared_w_name"
        ON "domestic_shipping_w_date_1"."O_NAME" = "wood_pellet_vendors_prepared_w_name"."VENDOR_NAME"
    ) "withoutcomputedcols_query" ;

<br>  
--SC_TLM_SHIPMENT_JOINED
</br>
CREATE OR REPLACE TEMP TABLE "SC_TLM_SHIPMENT_JOINED"
AS
WITH sc_tlm_shipment_joined AS 
(
SELECT 
    "sc_tlm_shipment"."SHIPMENT_ID" AS "SHIPMENT_ID",
    "sc_tlm_shipment"."TC_COMPANY_ID" AS "TC_COMPANY_ID",
    "sc_tlm_shipment"."RS_AREA_ID" AS "RS_AREA_ID",
    "sc_tlm_shipment"."TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID",
    "sc_tlm_shipment"."PP_SHIPMENT_ID" AS "PP_SHIPMENT_ID",
    "sc_tlm_shipment"."SHIPMENT_STATUS" AS "SHIPMENT_STATUS",
    "sc_tlm_shipment"."UPDATE_SENT" AS "UPDATE_SENT",
    "sc_tlm_shipment"."BUSINESS_PROCESS" AS "BUSINESS_PROCESS",
    "sc_tlm_shipment"."CREATION_TYPE" AS "CREATION_TYPE",
    "sc_tlm_shipment"."CONS_RUN_ID" AS "CONS_RUN_ID",
    "sc_tlm_shipment"."IS_CANCELLED" AS "IS_CANCELLED",
    "sc_tlm_shipment"."RS_TYPE" AS "RS_TYPE",
    "sc_tlm_shipment"."RS_CONFIG_ID" AS "RS_CONFIG_ID",
    "sc_tlm_shipment"."RS_CONFIG_CYCLE_ID" AS "RS_CONFIG_CYCLE_ID",
    "sc_tlm_shipment"."CONFIG_CYCLE_SEQ" AS "CONFIG_CYCLE_SEQ",
    "sc_tlm_shipment"."CYCLE_DEADLINE_DTTM" AS "CYCLE_DEADLINE_DTTM",
    "sc_tlm_shipment"."CYCLE_EXECUTION_DTTM" AS "CYCLE_EXECUTION_DTTM",
    "sc_tlm_shipment"."LAST_RS_NOTIFICATION_DTTM" AS "LAST_RS_NOTIFICATION_DTTM",
    "sc_tlm_shipment"."CFMF_STATUS" AS "CFMF_STATUS",
    "sc_tlm_shipment"."AVAILABLE_DTTM" AS "AVAILABLE_DTTM",
    "sc_tlm_shipment"."CMID" AS "CMID",
    "sc_tlm_shipment"."CM_DISCOUNT" AS "CM_DISCOUNT",
    "sc_tlm_shipment"."O_FACILITY_NUMBER" AS "O_FACILITY_NUMBER",
    "sc_tlm_shipment"."O_FACILITY_ID" AS "O_FACILITY_ID",
    "sc_tlm_shipment"."O_ADDRESS" AS "O_ADDRESS",
    "sc_tlm_shipment"."O_CITY" AS "O_CITY",
    "sc_tlm_shipment"."O_STATE_PROV" AS "O_STATE_PROV",
    "sc_tlm_shipment"."O_POSTAL_CODE" AS "O_POSTAL_CODE",
    "sc_tlm_shipment"."O_COUNTY" AS "O_COUNTY",
    "sc_tlm_shipment"."O_COUNTRY_CODE" AS "O_COUNTRY_CODE",
    "sc_tlm_shipment"."D_FACILITY_NUMBER" AS "D_FACILITY_NUMBER",
    "sc_tlm_shipment"."D_FACILITY_ID" AS "D_FACILITY_ID",
    "sc_tlm_shipment"."D_ADDRESS" AS "D_ADDRESS",
    "sc_tlm_shipment"."D_CITY" AS "D_CITY",
    "sc_tlm_shipment"."D_STATE_PROV" AS "D_STATE_PROV",
    "sc_tlm_shipment"."D_POSTAL_CODE" AS "D_POSTAL_CODE",
    "sc_tlm_shipment"."D_COUNTY" AS "D_COUNTY",
    "sc_tlm_shipment"."D_COUNTRY_CODE" AS "D_COUNTRY_CODE",
    "sc_tlm_shipment"."DISTANCE" AS "DISTANCE",
    "sc_tlm_shipment"."DIRECT_DISTANCE" AS "DIRECT_DISTANCE",
    "sc_tlm_shipment"."OUT_OF_ROUTE_DISTANCE" AS "OUT_OF_ROUTE_DISTANCE",
    "sc_tlm_shipment"."DISTANCE_UOM" AS "DISTANCE_UOM",
    "sc_tlm_shipment"."BUSINESS_PARTNER_ID" AS "BUSINESS_PARTNER_ID",
    "sc_tlm_shipment"."COMMODITY_CLASS" AS "COMMODITY_CLASS",
    "sc_tlm_shipment"."IS_HAZMAT" AS "IS_HAZMAT",
    "sc_tlm_shipment"."IS_PERISHABLE" AS "IS_PERISHABLE",
    "sc_tlm_shipment"."BILLING_METHOD" AS "BILLING_METHOD",
    "sc_tlm_shipment"."DSG_CARRIER_CODE" AS "DSG_CARRIER_CODE",
    "sc_tlm_shipment"."REC_CMID" AS "REC_CMID",
    "sc_tlm_shipment"."REC_CM_SHIPMENT_ID" AS "REC_CM_SHIPMENT_ID",
    "sc_tlm_shipment"."ASSIGNED_CARRIER_CODE" AS "ASSIGNED_CARRIER_CODE",
    "sc_tlm_shipment"."SHIPMENT_REF_ID" AS "SHIPMENT_REF_ID",
    "sc_tlm_shipment"."BILL_TO_CODE" AS "BILL_TO_CODE",
    "sc_tlm_shipment"."BILL_TO_TITLE" AS "BILL_TO_TITLE",
    "sc_tlm_shipment"."BILL_TO_NAME" AS "BILL_TO_NAME",
    "sc_tlm_shipment"."BILL_TO_ADDRESS" AS "BILL_TO_ADDRESS",
    "sc_tlm_shipment"."BILL_TO_CITY" AS "BILL_TO_CITY",
    "sc_tlm_shipment"."BILL_TO_STATE_PROV" AS "BILL_TO_STATE_PROV",
    "sc_tlm_shipment"."BILL_TO_POSTAL_CODE" AS "BILL_TO_POSTAL_CODE",
    "sc_tlm_shipment"."BILL_TO_COUNTRY_CODE" AS "BILL_TO_COUNTRY_CODE",
    "sc_tlm_shipment"."BILL_TO_PHONE_NUMBER" AS "BILL_TO_PHONE_NUMBER",
    "sc_tlm_shipment"."PURCHASE_ORDER" AS "PURCHASE_ORDER",
    "sc_tlm_shipment"."PRO_NUMBER" AS "PRO_NUMBER",
    "sc_tlm_shipment"."TRANS_RESP_CODE" AS "TRANS_RESP_CODE",
    "sc_tlm_shipment"."BASELINE_COST" AS "BASELINE_COST",
    "sc_tlm_shipment"."ESTIMATED_COST" AS "ESTIMATED_COST",
    "sc_tlm_shipment"."LINEHAUL_COST" AS "LINEHAUL_COST",
    "sc_tlm_shipment"."ACCESSORIAL_COST" AS "ACCESSORIAL_COST",
    "sc_tlm_shipment"."STOP_COST" AS "STOP_COST",
    "sc_tlm_shipment"."ESTIMATED_SAVINGS" AS "ESTIMATED_SAVINGS",
    "sc_tlm_shipment"."SPOT_CHARGE" AS "SPOT_CHARGE",
    "sc_tlm_shipment"."CURRENCY_CODE" AS "CURRENCY_CODE",
    "sc_tlm_shipment"."PICKUP_START_DTTM" AS "PICKUP_START_DTTM",
    "sc_tlm_shipment"."PICKUP_END_DTTM" AS "PICKUP_END_DTTM",
    "sc_tlm_shipment"."DELIVERY_START_DTTM" AS "DELIVERY_START_DTTM",
    "sc_tlm_shipment"."DELIVERY_END_DTTM" AS "DELIVERY_END_DTTM",
    "sc_tlm_shipment"."NUM_STOPS" AS "NUM_STOPS",
    "sc_tlm_shipment"."NUM_DOCKS" AS "NUM_DOCKS",
    "sc_tlm_shipment"."ON_TIME_INDICATOR" AS "ON_TIME_INDICATOR",
    "sc_tlm_shipment"."HAS_NOTES" AS "HAS_NOTES",
    "sc_tlm_shipment"."HAS_ALERTS" AS "HAS_ALERTS",
    "sc_tlm_shipment"."HAS_IMPORT_ERROR" AS "HAS_IMPORT_ERROR",
    "sc_tlm_shipment"."HAS_SOFT_CHECK_ERROR" AS "HAS_SOFT_CHECK_ERROR",
    "sc_tlm_shipment"."HAS_TRACKING_MSG" AS "HAS_TRACKING_MSG",
    "sc_tlm_shipment"."TRACKING_MSG_PROBLEM" AS "TRACKING_MSG_PROBLEM",
    "sc_tlm_shipment"."REC_LINEHAUL_COST" AS "REC_LINEHAUL_COST",
    "sc_tlm_shipment"."REC_ACCESSORIAL_COST" AS "REC_ACCESSORIAL_COST",
    "sc_tlm_shipment"."REC_TOTAL_COST" AS "REC_TOTAL_COST",
    "sc_tlm_shipment"."CYCLE_RESP_DEADLINE_TZ" AS "CYCLE_RESP_DEADLINE_TZ",
    "sc_tlm_shipment"."TENDER_RESP_DEADLINE_TZ" AS "TENDER_RESP_DEADLINE_TZ",
    "sc_tlm_shipment"."PICKUP_TZ" AS "PICKUP_TZ",
    "sc_tlm_shipment"."DELIVERY_TZ" AS "DELIVERY_TZ",
    "sc_tlm_shipment"."ASSIGNED_LANE_ID" AS "ASSIGNED_LANE_ID",
    "sc_tlm_shipment"."ASSIGNED_LANE_DETAIL_ID" AS "ASSIGNED_LANE_DETAIL_ID",
    "sc_tlm_shipment"."REC_SPOT_CHARGE" AS "REC_SPOT_CHARGE",
    "sc_tlm_shipment"."REC_LANE_ID" AS "REC_LANE_ID",
    "sc_tlm_shipment"."REC_LANE_DETAIL_ID" AS "REC_LANE_DETAIL_ID",
    "sc_tlm_shipment"."TENDER_DTTM" AS "TENDER_DTTM",
    "sc_tlm_shipment"."O_STOP_LOCATION_NAME" AS "O_STOP_LOCATION_NAME",
    "sc_tlm_shipment"."D_STOP_LOCATION_NAME" AS "D_STOP_LOCATION_NAME",
    "sc_tlm_shipment"."ASSIGNED_CM_SHIPMENT_ID" AS "ASSIGNED_CM_SHIPMENT_ID",
    "sc_tlm_shipment"."REC_CM_DISCOUNT" AS "REC_CM_DISCOUNT",
    "sc_tlm_shipment"."REC_STOP_COST" AS "REC_STOP_COST",
    "sc_tlm_shipment"."LAST_SELECTOR_RUN_DTTM" AS "LAST_SELECTOR_RUN_DTTM",
    "sc_tlm_shipment"."LAST_CM_OPTION_GEN_DTTM" AS "LAST_CM_OPTION_GEN_DTTM",
    "sc_tlm_shipment"."IS_CM_OPTION_GEN_ACTIVE" AS "IS_CM_OPTION_GEN_ACTIVE",
    "sc_tlm_shipment"."RS_CYCLE_REMAINING" AS "RS_CYCLE_REMAINING",
    "sc_tlm_shipment"."IS_TIME_FEAS_ENABLED" AS "IS_TIME_FEAS_ENABLED",
    "sc_tlm_shipment"."EXT_SYS_SHIPMENT_ID" AS "EXT_SYS_SHIPMENT_ID",
    "sc_tlm_shipment"."EXTRACTION_DTTM" AS "EXTRACTION_DTTM",
    "sc_tlm_shipment"."ASSIGNED_BROKER_CARRIER_CODE" AS "ASSIGNED_BROKER_CARRIER_CODE",
    "sc_tlm_shipment"."USE_BROKER_AS_CARRIER" AS "USE_BROKER_AS_CARRIER",
    "sc_tlm_shipment"."BROKER_REF" AS "BROKER_REF",
    "sc_tlm_shipment"."RATING_QUALIFIER" AS "RATING_QUALIFIER",
    "sc_tlm_shipment"."STATUS_CHANGE_DTTM" AS "STATUS_CHANGE_DTTM",
    "sc_tlm_shipment"."BUDG_TOTAL_COST" AS "BUDG_TOTAL_COST",
    "sc_tlm_shipment"."NORMALIZED_MARGIN" AS "NORMALIZED_MARGIN",
    "sc_tlm_shipment"."NORMALIZED_TOTAL_COST" AS "NORMALIZED_TOTAL_COST",
    "sc_tlm_shipment"."BUDG_NORMALIZED_TOTAL_COST" AS "BUDG_NORMALIZED_TOTAL_COST",
    "sc_tlm_shipment"."REC_BUDG_LINEHAUL_COST" AS "REC_BUDG_LINEHAUL_COST",
    "sc_tlm_shipment"."REC_BUDG_STOP_COST" AS "REC_BUDG_STOP_COST",
    "sc_tlm_shipment"."REC_BUDG_CM_DISCOUNT" AS "REC_BUDG_CM_DISCOUNT",
    "sc_tlm_shipment"."REC_BUDG_ACCESSORIAL_COST" AS "REC_BUDG_ACCESSORIAL_COST",
    "sc_tlm_shipment"."REC_BUDG_TOTAL_COST" AS "REC_BUDG_TOTAL_COST",
    "sc_tlm_shipment"."REC_MARGIN" AS "REC_MARGIN",
    "sc_tlm_shipment"."REC_NORMALIZED_MARGIN" AS "REC_NORMALIZED_MARGIN",
    "sc_tlm_shipment"."REC_NORMALIZED_TOTAL_COST" AS "REC_NORMALIZED_TOTAL_COST",
    "sc_tlm_shipment"."REC_BUDG_NORMALIZED_TOTAL_COST" AS "REC_BUDG_NORMALIZED_TOTAL_COST",
    "sc_tlm_shipment"."BUDG_CURRENCY_CODE" AS "BUDG_CURRENCY_CODE",
    "sc_tlm_shipment"."SPOT_CHARGE_CURRENCY_CODE" AS "SPOT_CHARGE_CURRENCY_CODE",
    "sc_tlm_shipment"."REC_CURRENCY_CODE" AS "REC_CURRENCY_CODE",
    "sc_tlm_shipment"."REC_BUDG_CURRENCY_CODE" AS "REC_BUDG_CURRENCY_CODE",
    "sc_tlm_shipment"."REC_SPOT_CHARGE_CURRENCY_CODE" AS "REC_SPOT_CHARGE_CURRENCY_CODE",
    "sc_tlm_shipment"."RATING_LANE_ID" AS "RATING_LANE_ID",
    "sc_tlm_shipment"."FRT_REV_RATING_LANE_ID" AS "FRT_REV_RATING_LANE_ID",
    "sc_tlm_shipment"."REC_RATING_LANE_ID" AS "REC_RATING_LANE_ID",
    "sc_tlm_shipment"."REC_BUDG_RATING_LANE_ID" AS "REC_BUDG_RATING_LANE_ID",
    "sc_tlm_shipment"."RATING_LANE_DETAIL_ID" AS "RATING_LANE_DETAIL_ID",
    "sc_tlm_shipment"."FRT_REV_RATING_LANE_DETAIL_ID" AS "FRT_REV_RATING_LANE_DETAIL_ID",
    "sc_tlm_shipment"."REC_RATING_LANE_DETAIL_ID" AS "REC_RATING_LANE_DETAIL_ID",
    "sc_tlm_shipment"."REC_BUDG_RATING_LANE_DETAIL_ID" AS "REC_BUDG_RATING_LANE_DETAIL_ID",
    "sc_tlm_shipment"."BUDG_CM_DISCOUNT" AS "BUDG_CM_DISCOUNT",
    "sc_tlm_shipment"."NORMALIZED_BASELINE_COST" AS "NORMALIZED_BASELINE_COST",
    "sc_tlm_shipment"."BASELINE_COST_CURRENCY_CODE" AS "BASELINE_COST_CURRENCY_CODE",
    "sc_tlm_shipment"."REPORTED_COST" AS "REPORTED_COST",
    "sc_tlm_shipment"."TRACTOR_NUMBER" AS "TRACTOR_NUMBER",
    "sc_tlm_shipment"."IS_AUTO_DELIVERED" AS "IS_AUTO_DELIVERED",
    "sc_tlm_shipment"."SHIPMENT_TYPE" AS "SHIPMENT_TYPE",
    "sc_tlm_shipment"."ORIG_BUDG_TOTAL_COST" AS "ORIG_BUDG_TOTAL_COST",
    "sc_tlm_shipment"."ACCESSORIAL_COST_TO_CARRIER" AS "ACCESSORIAL_COST_TO_CARRIER",
    "sc_tlm_shipment"."CARRIER_CHARGE" AS "CARRIER_CHARGE",
    "sc_tlm_shipment"."ACTUAL_COST" AS "ACTUAL_COST",
    "sc_tlm_shipment"."EARNED_INCOME" AS "EARNED_INCOME",
    "sc_tlm_shipment"."SENT_TO_PKMS" AS "SENT_TO_PKMS",
    "sc_tlm_shipment"."IS_SHIPMENT_RECONCILED" AS "IS_SHIPMENT_RECONCILED",
    "sc_tlm_shipment"."DELIVERY_REQ" AS "DELIVERY_REQ",
    "sc_tlm_shipment"."DROPOFF_PICKUP" AS "DROPOFF_PICKUP",
    "sc_tlm_shipment"."PACKAGING" AS "PACKAGING",
    "sc_tlm_shipment"."SENT_TO_PKMS_DTTM" AS "SENT_TO_PKMS_DTTM",
    "sc_tlm_shipment"."WMS_STATUS_CODE" AS "WMS_STATUS_CODE",
    "sc_tlm_shipment"."SPOT_CHARGE_AND_PAYEE_ACC" AS "SPOT_CHARGE_AND_PAYEE_ACC",
    "sc_tlm_shipment"."SPOT_CHARGE_AND_PAYEE_ACC_CC" AS "SPOT_CHARGE_AND_PAYEE_ACC_CC",
    "sc_tlm_shipment"."NORM_SPOT_CHARGE_AND_PAYEE_ACC" AS "NORM_SPOT_CHARGE_AND_PAYEE_ACC",
    "sc_tlm_shipment"."FACILITY_SCHEDULE_ID" AS "FACILITY_SCHEDULE_ID",
    "sc_tlm_shipment"."EARNED_INCOME_CURRENCY_CODE" AS "EARNED_INCOME_CURRENCY_CODE",
    "sc_tlm_shipment"."ACTUAL_COST_CURRENCY_CODE" AS "ACTUAL_COST_CURRENCY_CODE",
    "sc_tlm_shipment"."SHIPMENT_RECON_DTTM" AS "SHIPMENT_RECON_DTTM",
    "sc_tlm_shipment"."PLN_RATING_LANE_ID" AS "PLN_RATING_LANE_ID",
    "sc_tlm_shipment"."PLN_RATING_LANE_DETAIL_ID" AS "PLN_RATING_LANE_DETAIL_ID",
    "sc_tlm_shipment"."PLN_TOTAL_COST" AS "PLN_TOTAL_COST",
    "sc_tlm_shipment"."PLN_LINEHAUL_COST" AS "PLN_LINEHAUL_COST",
    "sc_tlm_shipment"."PLN_TOTAL_ACCESSORIAL_COST" AS "PLN_TOTAL_ACCESSORIAL_COST",
    "sc_tlm_shipment"."PLN_STOP_OFF_COST" AS "PLN_STOP_OFF_COST",
    "sc_tlm_shipment"."PLN_NORMALIZED_TOTAL_COST" AS "PLN_NORMALIZED_TOTAL_COST",
    "sc_tlm_shipment"."PLN_CURRENCY_CODE" AS "PLN_CURRENCY_CODE",
    "sc_tlm_shipment"."PLN_ACCESSORL_COST_TO_CARRIER" AS "PLN_ACCESSORL_COST_TO_CARRIER",
    "sc_tlm_shipment"."PLN_CARRIER_CHARGE" AS "PLN_CARRIER_CHARGE",
    "sc_tlm_shipment"."WAYPOINT_TOTAL_COST" AS "WAYPOINT_TOTAL_COST",
    "sc_tlm_shipment"."WAYPOINT_HANDLING_COST" AS "WAYPOINT_HANDLING_COST",
    "sc_tlm_shipment"."GRS_OPERATION" AS "GRS_OPERATION",
    "sc_tlm_shipment"."IS_GRS_OPT_CYCLE_RUNNING" AS "IS_GRS_OPT_CYCLE_RUNNING",
    "sc_tlm_shipment"."IS_MANUAL_ASSIGN" AS "IS_MANUAL_ASSIGN",
    "sc_tlm_shipment"."LAST_RUN_GRS_DTTM" AS "LAST_RUN_GRS_DTTM",
    "sc_tlm_shipment"."GRS_MAX_SHIPMENT_STATUS" AS "GRS_MAX_SHIPMENT_STATUS",
    "sc_tlm_shipment"."PRIORITY_TYPE" AS "PRIORITY_TYPE",
    "sc_tlm_shipment"."MV_CURRENCY_CODE" AS "MV_CURRENCY_CODE",
    "sc_tlm_shipment"."PROD_SCHED_REF_NUMBER" AS "PROD_SCHED_REF_NUMBER",
    "sc_tlm_shipment"."COMMODITY_CODE_ID" AS "COMMODITY_CODE_ID",
    "sc_tlm_shipment"."UN_NUMBER_ID" AS "UN_NUMBER_ID",
    "sc_tlm_shipment"."CONTRACT_NUMBER" AS "CONTRACT_NUMBER",
    "sc_tlm_shipment"."BOOKING_REF_SHIPPER" AS "BOOKING_REF_SHIPPER",
    "sc_tlm_shipment"."BOOKING_REF_CARRIER" AS "BOOKING_REF_CARRIER",
    "sc_tlm_shipment"."BK_RESOURCE_REF_EXTERNAL" AS "BK_RESOURCE_REF_EXTERNAL",
    "sc_tlm_shipment"."BK_RESOURCE_NAME_EXTERNAL" AS "BK_RESOURCE_NAME_EXTERNAL",
    "sc_tlm_shipment"."BK_O_FACILITY_ID" AS "BK_O_FACILITY_ID",
    "sc_tlm_shipment"."BK_D_FACILITY_ID" AS "BK_D_FACILITY_ID",
    "sc_tlm_shipment"."BK_MASTER_AIRWAY_BILL" AS "BK_MASTER_AIRWAY_BILL",
    "sc_tlm_shipment"."BK_FORWARDER_AIRWAY_BILL" AS "BK_FORWARDER_AIRWAY_BILL",
    "sc_tlm_shipment"."ASSIGNED_SCNDR_CARRIER_CODE" AS "ASSIGNED_SCNDR_CARRIER_CODE",
    "sc_tlm_shipment"."CUSTOMER_CREDIT_LIMIT_ID" AS "CUSTOMER_CREDIT_LIMIT_ID",
    "sc_tlm_shipment"."SHIPMENT_LEG_TYPE" AS "SHIPMENT_LEG_TYPE",
    "sc_tlm_shipment"."SHIPMENT_CLOSED_INDICATOR" AS "SHIPMENT_CLOSED_INDICATOR",
    "sc_tlm_shipment"."OCEAN_ROUTING_STAGE" AS "OCEAN_ROUTING_STAGE",
    "sc_tlm_shipment"."BK_DEPARTURE_DTTM" AS "BK_DEPARTURE_DTTM",
    "sc_tlm_shipment"."BK_DEPARTURE_TZ" AS "BK_DEPARTURE_TZ",
    "sc_tlm_shipment"."BK_ARRIVAL_DTTM" AS "BK_ARRIVAL_DTTM",
    "sc_tlm_shipment"."BK_ARRIVAL_TZ" AS "BK_ARRIVAL_TZ",
    "sc_tlm_shipment"."BK_PICKUP_DTTM" AS "BK_PICKUP_DTTM",
    "sc_tlm_shipment"."BK_PICKUP_TZ" AS "BK_PICKUP_TZ",
    "sc_tlm_shipment"."BK_CUTOFF_DTTM" AS "BK_CUTOFF_DTTM",
    "sc_tlm_shipment"."BK_CUTOFF_TZ" AS "BK_CUTOFF_TZ",
    "sc_tlm_shipment"."NUM_CHARGE_LAYOVERS" AS "NUM_CHARGE_LAYOVERS",
    "sc_tlm_shipment"."RATE_TYPE" AS "RATE_TYPE",
    "sc_tlm_shipment"."RATE_UOM" AS "RATE_UOM",
    "sc_tlm_shipment"."PICK_START_DTTM" AS "PICK_START_DTTM",
    "sc_tlm_shipment"."PAPERWORK_START_DTTM" AS "PAPERWORK_START_DTTM",
    "sc_tlm_shipment"."VEHICLE_CHECK_START_DTTM" AS "VEHICLE_CHECK_START_DTTM",
    "sc_tlm_shipment"."SHIPMENT_START_DTTM" AS "SHIPMENT_START_DTTM",
    "sc_tlm_shipment"."SHIPMENT_END_DTTM" AS "SHIPMENT_END_DTTM",
    "sc_tlm_shipment"."FEASIBLE_DRIVER_TYPE" AS "FEASIBLE_DRIVER_TYPE",
    "sc_tlm_shipment"."WAVE_ID" AS "WAVE_ID",
    "sc_tlm_shipment"."ESTIMATED_DISPATCH_DTTM" AS "ESTIMATED_DISPATCH_DTTM",
    "sc_tlm_shipment"."TOTAL_TIME" AS "TOTAL_TIME",
    "sc_tlm_shipment"."LOC_REFERENCE" AS "LOC_REFERENCE",
    "sc_tlm_shipment"."BK_O_FACILITY_ALIAS_ID" AS "BK_O_FACILITY_ALIAS_ID",
    "sc_tlm_shipment"."BK_D_FACILITY_ALIAS_ID" AS "BK_D_FACILITY_ALIAS_ID",
    "sc_tlm_shipment"."EQUIP_UTIL_PER" AS "EQUIP_UTIL_PER",
    "sc_tlm_shipment"."MOVE_TYPE" AS "MOVE_TYPE",
    "sc_tlm_shipment"."DRIVER_TYPE_ID" AS "DRIVER_TYPE_ID",
    "sc_tlm_shipment"."EQUIPMENT_TYPE" AS "EQUIPMENT_TYPE",
    "sc_tlm_shipment"."RADIAL_DISTANCE" AS "RADIAL_DISTANCE",
    "sc_tlm_shipment"."RADIAL_DISTANCE_UOM" AS "RADIAL_DISTANCE_UOM",
    "sc_tlm_shipment"."DESIGNATED_TRACTOR_CODE" AS "DESIGNATED_TRACTOR_CODE",
    "sc_tlm_shipment"."DESIGNATED_DRIVER_TYPE" AS "DESIGNATED_DRIVER_TYPE",
    "sc_tlm_shipment"."IS_WAVE_MAN_CHANGED" AS "IS_WAVE_MAN_CHANGED",
    "sc_tlm_shipment"."RETAIN_CONSOLIDATOR_TIMES" AS "RETAIN_CONSOLIDATOR_TIMES",
    "sc_tlm_shipment"."TARIFF" AS "TARIFF",
    "sc_tlm_shipment"."MIN_RATE" AS "MIN_RATE",
    "sc_tlm_shipment"."FIRST_UPDATE_SENT_TO_PKMS" AS "FIRST_UPDATE_SENT_TO_PKMS",
    "sc_tlm_shipment"."EVENT_IND_TYPEID" AS "EVENT_IND_TYPEID",
    "sc_tlm_shipment"."TANDEM_PATH_ID" AS "TANDEM_PATH_ID",
    "sc_tlm_shipment"."O_TANDEM_FACILITY" AS "O_TANDEM_FACILITY",
    "sc_tlm_shipment"."D_TANDEM_FACILITY" AS "D_TANDEM_FACILITY",
    "sc_tlm_shipment"."O_TANDEM_FACILITY_ALIAS" AS "O_TANDEM_FACILITY_ALIAS",
    "sc_tlm_shipment"."D_TANDEM_FACILITY_ALIAS" AS "D_TANDEM_FACILITY_ALIAS",
    "sc_tlm_shipment"."DELAY_TYPE" AS "DELAY_TYPE",
    "sc_tlm_shipment"."ASSIGNED_CARRIER_ID" AS "ASSIGNED_CARRIER_ID",
    "sc_tlm_shipment"."DSG_CARRIER_ID" AS "DSG_CARRIER_ID",
    "sc_tlm_shipment"."REC_CARRIER_ID" AS "REC_CARRIER_ID",
    "sc_tlm_shipment"."FEASIBLE_CARRIER_ID" AS "FEASIBLE_CARRIER_ID",
    "sc_tlm_shipment"."PAYEE_CARRIER_ID" AS "PAYEE_CARRIER_ID",
    "sc_tlm_shipment"."SCNDR_CARRIER_ID" AS "SCNDR_CARRIER_ID",
    "sc_tlm_shipment"."BROKER_CARRIER_ID" AS "BROKER_CARRIER_ID",
    "sc_tlm_shipment"."ASSIGNED_SCNDR_CARRIER_ID" AS "ASSIGNED_SCNDR_CARRIER_ID",
    "sc_tlm_shipment"."DSG_SCNDR_CARRIER_ID" AS "DSG_SCNDR_CARRIER_ID",
    "sc_tlm_shipment"."ASSIGNED_BROKER_CARRIER_ID" AS "ASSIGNED_BROKER_CARRIER_ID",
    "sc_tlm_shipment"."LH_PAYEE_CARRIER_ID" AS "LH_PAYEE_CARRIER_ID",
    "sc_tlm_shipment"."REC_BROKER_CARRIER_ID" AS "REC_BROKER_CARRIER_ID",
    "sc_tlm_shipment"."ASSIGNED_EQUIPMENT_ID" AS "ASSIGNED_EQUIPMENT_ID",
    "sc_tlm_shipment"."DSG_EQUIPMENT_ID" AS "DSG_EQUIPMENT_ID",
    "sc_tlm_shipment"."FEASIBLE_EQUIPMENT_ID" AS "FEASIBLE_EQUIPMENT_ID",
    "sc_tlm_shipment"."FEASIBLE_EQUIPMENT2_ID" AS "FEASIBLE_EQUIPMENT2_ID",
    "sc_tlm_shipment"."REC_EQUIPMENT_ID" AS "REC_EQUIPMENT_ID",
    "sc_tlm_shipment"."ASSIGNED_MOT_ID" AS "ASSIGNED_MOT_ID",
    "sc_tlm_shipment"."DSG_MOT_ID" AS "DSG_MOT_ID",
    "sc_tlm_shipment"."FEASIBLE_MOT_ID" AS "FEASIBLE_MOT_ID",
    "sc_tlm_shipment"."REC_MOT_ID" AS "REC_MOT_ID",
    "sc_tlm_shipment"."PRODUCT_CLASS_ID" AS "PRODUCT_CLASS_ID",
    "sc_tlm_shipment"."PROTECTION_LEVEL_ID" AS "PROTECTION_LEVEL_ID",
    "sc_tlm_shipment"."ASSIGNED_SERVICE_LEVEL_ID" AS "ASSIGNED_SERVICE_LEVEL_ID",
    "sc_tlm_shipment"."DSG_SERVICE_LEVEL_ID" AS "DSG_SERVICE_LEVEL_ID",
    "sc_tlm_shipment"."FEASIBLE_SERVICE_LEVEL_ID" AS "FEASIBLE_SERVICE_LEVEL_ID",
    "sc_tlm_shipment"."REC_SERVICE_LEVEL_ID" AS "REC_SERVICE_LEVEL_ID",
    "sc_tlm_shipment"."HAS_EM_NOTIFY_FLAG" AS "HAS_EM_NOTIFY_FLAG",
    "sc_tlm_shipment"."REGION_ID" AS "REGION_ID",
    "sc_tlm_shipment"."INBOUND_REGION_ID" AS "INBOUND_REGION_ID",
    "sc_tlm_shipment"."OUTBOUND_REGION_ID" AS "OUTBOUND_REGION_ID",
    "sc_tlm_shipment"."FINANCIAL_WT" AS "FINANCIAL_WT",
    "sc_tlm_shipment"."IS_BOOKING_REQUIRED" AS "IS_BOOKING_REQUIRED",
    "sc_tlm_shipment"."TOTAL_COST_EXCL_TAX" AS "TOTAL_COST_EXCL_TAX",
    "sc_tlm_shipment"."TOTAL_TAX_AMOUNT" AS "TOTAL_TAX_AMOUNT",
    "sc_tlm_shipment"."IS_ASSOCIATED_TO_OUTBOUND" AS "IS_ASSOCIATED_TO_OUTBOUND",
    "sc_tlm_shipment"."RECEIVED_DTTM" AS "RECEIVED_DTTM",
    "sc_tlm_shipment"."BOOKING_ID" AS "BOOKING_ID",
    "sc_tlm_shipment"."IS_MISROUTED" AS "IS_MISROUTED",
    "sc_tlm_shipment"."FEASIBLE_CARRIER_CODE" AS "FEASIBLE_CARRIER_CODE",
    "sc_tlm_shipment"."SHIPMENT_WIN_ADJ_FLAG" AS "SHIPMENT_WIN_ADJ_FLAG",
    "sc_tlm_shipment"."DT_PARAM_SET_ID" AS "DT_PARAM_SET_ID",
    "sc_tlm_shipment"."MERCHANDIZING_DEPARTMENT_ID" AS "MERCHANDIZING_DEPARTMENT_ID",
    "sc_tlm_shipment"."STATIC_ROUTE_ID" AS "STATIC_ROUTE_ID",
    "sc_tlm_shipment"."IS_FILO" AS "IS_FILO",
    "sc_tlm_shipment"."IS_COOLER_AT_NOSE" AS "IS_COOLER_AT_NOSE",
    "sc_tlm_shipment"."AUTH_NBR" AS "AUTH_NBR",
    "sc_tlm_shipment"."CONS_LOCN_ID" AS "CONS_LOCN_ID",
    "sc_tlm_shipment"."RTE_TYPE" AS "RTE_TYPE",
    "sc_tlm_shipment"."TRLR_TYPE" AS "TRLR_TYPE",
    "sc_tlm_shipment"."TRLR_SIZE" AS "TRLR_SIZE",
    "sc_tlm_shipment"."CONS_ADDR_CODE" AS "CONS_ADDR_CODE",
    "sc_tlm_shipment"."HUB_ID" AS "HUB_ID",
    "sc_tlm_shipment"."TRLR_GEN_CODE" AS "TRLR_GEN_CODE",
    "sc_tlm_shipment"."MAX_NBR_OF_CTNS" AS "MAX_NBR_OF_CTNS",
    "sc_tlm_shipment"."APPT_DOOR_SCHED_TYPE" AS "APPT_DOOR_SCHED_TYPE",
    "sc_tlm_shipment"."CREATED_SOURCE_TYPE" AS "CREATED_SOURCE_TYPE",
    "sc_tlm_shipment"."CREATED_SOURCE" AS "CREATED_SOURCE",
    "sc_tlm_shipment"."CREATED_DTTM" AS "CREATED_DTTM",
    "sc_tlm_shipment"."LAST_UPDATED_SOURCE_TYPE" AS "LAST_UPDATED_SOURCE_TYPE",
    "sc_tlm_shipment"."LAST_UPDATED_SOURCE" AS "LAST_UPDATED_SOURCE",
    "sc_tlm_shipment"."LAST_UPDATED_DTTM" AS "LAST_UPDATED_DTTM",
    "sc_tlm_shipment"."DSG_SCNDR_CARRIER_CODE" AS "DSG_SCNDR_CARRIER_CODE",
    "sc_tlm_shipment"."LH_PAYEE_CARRIER_CODE" AS "LH_PAYEE_CARRIER_CODE",
    "sc_tlm_shipment"."REC_BROKER_CARRIER_CODE" AS "REC_BROKER_CARRIER_CODE",
    "sc_tlm_shipment"."REC_CARRIER_CODE" AS "REC_CARRIER_CODE",
    "sc_tlm_shipment"."LPN_ASSIGNMENT_STOPPED" AS "LPN_ASSIGNMENT_STOPPED",
    "sc_tlm_shipment"."SEAL_NUMBER" AS "SEAL_NUMBER",
    "sc_tlm_shipment"."HIBERNATE_VERSION" AS "HIBERNATE_VERSION",
    "sc_tlm_shipment"."SHIP_GROUP_ID" AS "SHIP_GROUP_ID",
    "sc_tlm_shipment"."RATE" AS "RATE",
    "sc_tlm_shipment"."MONETARY_VALUE" AS "MONETARY_VALUE",
    "sc_tlm_shipment"."DOOR" AS "DOOR",
    "sc_tlm_shipment"."RTE_TYPE_1" AS "RTE_TYPE_1",
    "sc_tlm_shipment"."RTE_TYPE_2" AS "RTE_TYPE_2",
    "sc_tlm_shipment"."SCHEDULED_PICKUP_DTTM" AS "SCHEDULED_PICKUP_DTTM",
    "sc_tlm_shipment"."MANIFEST_ID" AS "MANIFEST_ID",
    "sc_tlm_shipment"."DAYS_TO_DELIVER" AS "DAYS_TO_DELIVER",
    "sc_tlm_shipment"."SED_GENERATED_FLAG" AS "SED_GENERATED_FLAG",
    "sc_tlm_shipment"."SERV_AREA_CODE" AS "SERV_AREA_CODE",
    "sc_tlm_shipment"."TENDER_RESP_DEADLINE_DTTM" AS "TENDER_RESP_DEADLINE_DTTM",
    "sc_tlm_shipment"."PRINT_CONS_BOL" AS "PRINT_CONS_BOL",
    "sc_tlm_shipment"."LEFT_WT" AS "LEFT_WT",
    "sc_tlm_shipment"."RIGHT_WT" AS "RIGHT_WT",
    "sc_tlm_shipment"."LANE_NAME" AS "LANE_NAME",
    "sc_tlm_shipment"."DECLARED_VALUE" AS "DECLARED_VALUE",
    "sc_tlm_shipment"."DV_CURRENCY_CODE" AS "DV_CURRENCY_CODE",
    "sc_tlm_shipment"."COD_AMOUNT" AS "COD_AMOUNT",
    "sc_tlm_shipment"."CUSTOMER_ID" AS "CUSTOMER_ID",
    "sc_tlm_shipment"."CUST_FRGT_CHARGE" AS "CUST_FRGT_CHARGE",
    "sc_tlm_shipment"."COD_CURRENCY_CODE" AS "COD_CURRENCY_CODE",
    "sc_tlm_shipment"."PLANNED_WEIGHT" AS "PLANNED_WEIGHT",
    "sc_tlm_shipment"."WEIGHT_UOM_ID_BASE" AS "WEIGHT_UOM_ID_BASE",
    "sc_tlm_shipment"."PLANNED_VOLUME" AS "PLANNED_VOLUME",
    "sc_tlm_shipment"."VOLUME_UOM_ID_BASE" AS "VOLUME_UOM_ID_BASE",
    "sc_tlm_shipment"."SIZE1_VALUE" AS "SIZE1_VALUE",
    "sc_tlm_shipment"."SIZE1_UOM_ID" AS "SIZE1_UOM_ID",
    "sc_tlm_shipment"."SIZE2_VALUE" AS "SIZE2_VALUE",
    "sc_tlm_shipment"."SIZE2_UOM_ID" AS "SIZE2_UOM_ID",
    "sc_tlm_shipment"."ASSIGNED_SHIP_VIA" AS "ASSIGNED_SHIP_VIA",
    "sc_tlm_shipment"."INSURANCE_STATUS" AS "INSURANCE_STATUS",
    "sc_tlm_shipment"."RTE_SWC_NBR" AS "RTE_SWC_NBR",
    "sc_tlm_shipment"."RTE_TO" AS "RTE_TO",
    "sc_tlm_shipment"."BILL_OF_LADING_NUMBER" AS "BILL_OF_LADING_NUMBER",
    "sc_tlm_shipment"."TRAILER_NUMBER" AS "TRAILER_NUMBER",
    "sc_tlm_shipment"."TRANS_PLAN_OWNER" AS "TRANS_PLAN_OWNER",
    "sc_tlm_shipment"."TOTAL_REVENUE_CURRENCY_CODE" AS "TOTAL_REVENUE_CURRENCY_CODE",
    "sc_tlm_shipment"."TOTAL_REVENUE" AS "TOTAL_REVENUE",
    "sc_tlm_shipment"."FRT_REV_SPOT_CHARGE_CURR_CODE" AS "FRT_REV_SPOT_CHARGE_CURR_CODE",
    "sc_tlm_shipment"."NORMALIZED_TOTAL_REVENUE" AS "NORMALIZED_TOTAL_REVENUE",
    "sc_tlm_shipment"."FRT_REV_SPOT_CHARGE" AS "FRT_REV_SPOT_CHARGE",
    "sc_tlm_shipment"."DSG_VOYAGE_FLIGHT" AS "DSG_VOYAGE_FLIGHT",
    "sc_tlm_shipment"."FEASIBLE_VOYAGE_FLIGHT" AS "FEASIBLE_VOYAGE_FLIGHT",
    "sc_tlm_shipment"."CURRENCY_DTTM" AS "CURRENCY_DTTM",
    "sc_tlm_shipment"."FRT_REV_LINEHAUL_CHARGE" AS "FRT_REV_LINEHAUL_CHARGE",
    "sc_tlm_shipment"."FRT_REV_STOP_CHARGE" AS "FRT_REV_STOP_CHARGE",
    "sc_tlm_shipment"."FRT_REV_ACCESSORIAL_CHARGE" AS "FRT_REV_ACCESSORIAL_CHARGE",
    "sc_tlm_shipment"."MARGIN" AS "MARGIN",
    "sc_tlm_shipment"."TOTAL_COST" AS "TOTAL_COST",
    "sc_tlm_shipment"."INCOTERM_ID" AS "INCOTERM_ID",
    "sc_tlm_shipment"."ORDER_QTY" AS "ORDER_QTY",
    "sc_tlm_shipment"."QTY_UOM_ID" AS "QTY_UOM_ID",
    "sc_tlm_shipment"."REF_SHIPMENT_NBR" AS "REF_SHIPMENT_NBR",
    "sc_tlm_shipment"."STAGING_LOCN_ID" AS "STAGING_LOCN_ID",
    "sc_tlm_shipment"."LOADING_SEQ_ORD" AS "LOADING_SEQ_ORD",
    "sc_tlm_shipment"."HAZMAT_CERT_CONTACT" AS "HAZMAT_CERT_CONTACT",
    "sc_tlm_shipment"."HAZMAT_CERT_DECLARATION" AS "HAZMAT_CERT_DECLARATION",
    "sc_tlm_shipment"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP",
    "sc_tlm_shipment"."OPERATION_TYPE" AS "OPERATION_TYPE",
    "sc_tlm_shipment"."ARCHIVED_DTTM" AS "ARCHIVED_DTTM",
    "tlm_shipment_actual_delivery_date"."ORIGIN" AS "ORIGIN",
    "tlm_shipment_actual_delivery_date"."FINAL_DESTINATION" AS "FINAL_DESTINATION",
    "tlm_shipment_actual_delivery_date"."ACTUAL_DELIVERY_DATE_PARSED" AS "actual_delivery_date_parsed",
    "wood_pellet_vendors_w_number_by_VENDOR_ID"."wood_pellet" AS "wood_pellet"
  FROM EDW.VW_SC_TLM_SHIPMENT "sc_tlm_shipment"
  LEFT JOIN tlm_shipment_actual_delivery_date "tlm_shipment_actual_delivery_date"
    ON "sc_tlm_shipment"."TC_SHIPMENT_ID" = "tlm_shipment_actual_delivery_date"."SHIPMENT_NUMBER"
  LEFT JOIN (
    SELECT 
        "VENDOR_ID" AS "VENDOR_ID",
        1 AS "wood_pellet"
      FROM (
        SELECT *
          FROM "WOOD_PELLET_VENDORS_W_NUMBER_BY_VENDOR_ID" "wood_pellet_vendors_w_number_by_VENDOR_ID"
        ) "withoutcomputedcols_query"
    ) "wood_pellet_vendors_w_number_by_VENDOR_ID"
    ON "sc_tlm_shipment"."O_FACILITY_ID" = "wood_pellet_vendors_w_number_by_VENDOR_ID"."VENDOR_ID"
)
SELECT * FROM sc_tlm_shipment_joined;


<br>
--SC_TLM_SHIPMENT_JOINED_FILTERED
</br>
CREATE OR REPLACE TEMP TABLE "SC_TLM_SHIPMENT_JOINED_FILTERED"
AS
SELECT 
       sc_tlm_shipment_joined.*,
        wood_pellet_vendors_w_ids_prepared_by_vendor_id."vendor_id" AS "vendor_id",
        wood_pellet_vendors_w_ids_prepared_by_vendor_id."wood_pellet" AS "wood_pellet_2" ,
        COALESCE(wood_pellet_vendors_w_ids_prepared_by_vendor_id."wood_pellet", sc_tlm_shipment_joined."wood_pellet", 0) AS "wood_pellet_combined"
  FROM 
 SC_TLM_SHIPMENT_JOINED sc_tlm_shipment_joined
      LEFT JOIN (
        SELECT 
            "VENDOR_ID" AS "vendor_id",
            1 AS "wood_pellet"
          FROM (
            SELECT *
              FROM "WOOD_PELLET_VENDORS_W_IDS_PREPARED_BY_VENDOR_ID" "wood_pellet_vendors_w_ids_prepared_by_vendor_id"
            ) "withoutcomputedcols_query"
        ) wood_pellet_vendors_w_ids_prepared_by_vendor_id
        ON sc_tlm_shipment_joined."ORIGIN" = wood_pellet_vendors_w_ids_prepared_by_vendor_id."vendor_id"
WHERE  (COALESCE(wood_pellet_vendors_w_ids_prepared_by_vendor_id."wood_pellet", sc_tlm_shipment_joined."wood_pellet", 0)) != 1 OR (COALESCE(wood_pellet_vendors_w_ids_prepared_by_vendor_id."wood_pellet", sc_tlm_shipment_joined."wood_pellet", 0)) IS NULL AND 1 IS NOT NULL OR (COALESCE(wood_pellet_vendors_w_ids_prepared_by_vendor_id."wood_pellet", sc_tlm_shipment_joined."wood_pellet", 0)) IS NOT NULL AND 1 IS NULL

<br>
--TIME_DIMENSION_PREPARED
</br>
CREATE OR REPLACE TEMPORARY TABLE TIME_DIMENSION_PREPARED
 AS
   SELECT  *,To_varchar(Date_trunc('SECOND', Convert_timezone('UTC', 'UTC', (DATE_FROM_PARTS(YEAR_,Month_,Day_)))), 'YYYY-MM-DD"T"HH24:MI:SS"."FF3"Z"') AS date
    FROM (
    SELECT  *,LEFT(TIME_DIM_KEY,4)  AS YEAR_,
      RIGHT( TIME_DIM_KEY,2) as Day_,
      SUBSTRING( TIME_DIM_KEY,5,2) as Month_,
      DATE_FROM_PARTS((LEFT(TIME_DIM_KEY,4) ),(SUBSTRING( TIME_DIM_KEY,5,2)),(RIGHT( TIME_DIM_KEY,2))) Full_Date
    FROM EDW.vw_TIME_DIMENSION)A;

<br>
--TLM_SHIPMENT_W_CAl_FILTERED	
</br>


CREATE OR REPLACE TEMP TABLE "TLM_SHIPMENT_W_CAl_FILTERED"
AS
SELECT 
    tlm_shipment_joined_filtered."SHIPMENT_ID" AS "SHIPMENT_ID",
    tlm_shipment_joined_filtered."TC_COMPANY_ID" AS "TC_COMPANY_ID",
    tlm_shipment_joined_filtered."RS_AREA_ID" AS "RS_AREA_ID",
    tlm_shipment_joined_filtered."TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID",
    tlm_shipment_joined_filtered."PP_SHIPMENT_ID" AS "PP_SHIPMENT_ID",
    tlm_shipment_joined_filtered."SHIPMENT_STATUS" AS "SHIPMENT_STATUS",
    tlm_shipment_joined_filtered."UPDATE_SENT" AS "UPDATE_SENT",
    tlm_shipment_joined_filtered."BUSINESS_PROCESS" AS "BUSINESS_PROCESS",
    tlm_shipment_joined_filtered."CREATION_TYPE" AS "CREATION_TYPE",
    tlm_shipment_joined_filtered."CONS_RUN_ID" AS "CONS_RUN_ID",
    tlm_shipment_joined_filtered."IS_CANCELLED" AS "IS_CANCELLED",
    tlm_shipment_joined_filtered."RS_TYPE" AS "RS_TYPE",
    tlm_shipment_joined_filtered."RS_CONFIG_ID" AS "RS_CONFIG_ID",
    tlm_shipment_joined_filtered."RS_CONFIG_CYCLE_ID" AS "RS_CONFIG_CYCLE_ID",
    tlm_shipment_joined_filtered."CONFIG_CYCLE_SEQ" AS "CONFIG_CYCLE_SEQ",
    tlm_shipment_joined_filtered."CYCLE_DEADLINE_DTTM" AS "CYCLE_DEADLINE_DTTM",
    tlm_shipment_joined_filtered."CYCLE_EXECUTION_DTTM" AS "CYCLE_EXECUTION_DTTM",
    tlm_shipment_joined_filtered."LAST_RS_NOTIFICATION_DTTM" AS "LAST_RS_NOTIFICATION_DTTM",
    tlm_shipment_joined_filtered."CFMF_STATUS" AS "CFMF_STATUS",
    tlm_shipment_joined_filtered."AVAILABLE_DTTM" AS "AVAILABLE_DTTM",
    tlm_shipment_joined_filtered."CMID" AS "CMID",
    tlm_shipment_joined_filtered."CM_DISCOUNT" AS "CM_DISCOUNT",
    tlm_shipment_joined_filtered."O_FACILITY_NUMBER" AS "O_FACILITY_NUMBER",
    tlm_shipment_joined_filtered."O_FACILITY_ID" AS "O_FACILITY_ID",
    tlm_shipment_joined_filtered."O_ADDRESS" AS "O_ADDRESS",
    tlm_shipment_joined_filtered."O_CITY" AS "O_CITY",
    tlm_shipment_joined_filtered."O_STATE_PROV" AS "O_STATE_PROV",
    tlm_shipment_joined_filtered."O_POSTAL_CODE" AS "O_POSTAL_CODE",
    tlm_shipment_joined_filtered."O_COUNTY" AS "O_COUNTY",
    tlm_shipment_joined_filtered."O_COUNTRY_CODE" AS "O_COUNTRY_CODE",
    tlm_shipment_joined_filtered."D_FACILITY_NUMBER" AS "D_FACILITY_NUMBER",
    tlm_shipment_joined_filtered."D_FACILITY_ID" AS "D_FACILITY_ID",
    tlm_shipment_joined_filtered."D_ADDRESS" AS "D_ADDRESS",
    tlm_shipment_joined_filtered."D_CITY" AS "D_CITY",
    tlm_shipment_joined_filtered."D_STATE_PROV" AS "D_STATE_PROV",
    tlm_shipment_joined_filtered."D_POSTAL_CODE" AS "D_POSTAL_CODE",
    tlm_shipment_joined_filtered."D_COUNTY" AS "D_COUNTY",
    tlm_shipment_joined_filtered."D_COUNTRY_CODE" AS "D_COUNTRY_CODE",
    tlm_shipment_joined_filtered."DISTANCE" AS "DISTANCE",
    tlm_shipment_joined_filtered."DIRECT_DISTANCE" AS "DIRECT_DISTANCE",
    tlm_shipment_joined_filtered."OUT_OF_ROUTE_DISTANCE" AS "OUT_OF_ROUTE_DISTANCE",
    tlm_shipment_joined_filtered."DISTANCE_UOM" AS "DISTANCE_UOM",
    tlm_shipment_joined_filtered."BUSINESS_PARTNER_ID" AS "BUSINESS_PARTNER_ID",
    tlm_shipment_joined_filtered."COMMODITY_CLASS" AS "COMMODITY_CLASS",
    tlm_shipment_joined_filtered."IS_HAZMAT" AS "IS_HAZMAT",
    tlm_shipment_joined_filtered."IS_PERISHABLE" AS "IS_PERISHABLE",
    tlm_shipment_joined_filtered."BILLING_METHOD" AS "BILLING_METHOD",
    tlm_shipment_joined_filtered."DSG_CARRIER_CODE" AS "DSG_CARRIER_CODE",
    tlm_shipment_joined_filtered."REC_CMID" AS "REC_CMID",
    tlm_shipment_joined_filtered."REC_CM_SHIPMENT_ID" AS "REC_CM_SHIPMENT_ID",
    tlm_shipment_joined_filtered."ASSIGNED_CARRIER_CODE" AS "ASSIGNED_CARRIER_CODE",
    tlm_shipment_joined_filtered."SHIPMENT_REF_ID" AS "SHIPMENT_REF_ID",
    tlm_shipment_joined_filtered."BILL_TO_CODE" AS "BILL_TO_CODE",
    tlm_shipment_joined_filtered."BILL_TO_TITLE" AS "BILL_TO_TITLE",
    tlm_shipment_joined_filtered."BILL_TO_NAME" AS "BILL_TO_NAME",
    tlm_shipment_joined_filtered."BILL_TO_ADDRESS" AS "BILL_TO_ADDRESS",
    tlm_shipment_joined_filtered."BILL_TO_CITY" AS "BILL_TO_CITY",
    tlm_shipment_joined_filtered."BILL_TO_STATE_PROV" AS "BILL_TO_STATE_PROV",
    tlm_shipment_joined_filtered."BILL_TO_POSTAL_CODE" AS "BILL_TO_POSTAL_CODE",
    tlm_shipment_joined_filtered."BILL_TO_COUNTRY_CODE" AS "BILL_TO_COUNTRY_CODE",
    tlm_shipment_joined_filtered."BILL_TO_PHONE_NUMBER" AS "BILL_TO_PHONE_NUMBER",
    tlm_shipment_joined_filtered."PURCHASE_ORDER" AS "PURCHASE_ORDER",
    tlm_shipment_joined_filtered."PRO_NUMBER" AS "PRO_NUMBER",
    tlm_shipment_joined_filtered."TRANS_RESP_CODE" AS "TRANS_RESP_CODE",
    tlm_shipment_joined_filtered."BASELINE_COST" AS "BASELINE_COST",
    tlm_shipment_joined_filtered."ESTIMATED_COST" AS "ESTIMATED_COST",
    tlm_shipment_joined_filtered."LINEHAUL_COST" AS "LINEHAUL_COST",
    tlm_shipment_joined_filtered."ACCESSORIAL_COST" AS "ACCESSORIAL_COST",
    tlm_shipment_joined_filtered."STOP_COST" AS "STOP_COST",
    tlm_shipment_joined_filtered."ESTIMATED_SAVINGS" AS "ESTIMATED_SAVINGS",
    tlm_shipment_joined_filtered."SPOT_CHARGE" AS "SPOT_CHARGE",
    tlm_shipment_joined_filtered."CURRENCY_CODE" AS "CURRENCY_CODE",
    tlm_shipment_joined_filtered."PICKUP_START_DTTM" AS "PICKUP_START_DTTM",
    tlm_shipment_joined_filtered."PICKUP_END_DTTM" AS "PICKUP_END_DTTM",
    tlm_shipment_joined_filtered."DELIVERY_START_DTTM" AS "DELIVERY_START_DTTM",
    tlm_shipment_joined_filtered."DELIVERY_END_DTTM" AS "DELIVERY_END_DTTM",
    tlm_shipment_joined_filtered."NUM_STOPS" AS "NUM_STOPS",
    tlm_shipment_joined_filtered."NUM_DOCKS" AS "NUM_DOCKS",
    tlm_shipment_joined_filtered."ON_TIME_INDICATOR" AS "ON_TIME_INDICATOR",
    tlm_shipment_joined_filtered."HAS_NOTES" AS "HAS_NOTES",
    tlm_shipment_joined_filtered."HAS_ALERTS" AS "HAS_ALERTS",
    tlm_shipment_joined_filtered."HAS_IMPORT_ERROR" AS "HAS_IMPORT_ERROR",
    tlm_shipment_joined_filtered."HAS_SOFT_CHECK_ERROR" AS "HAS_SOFT_CHECK_ERROR",
    tlm_shipment_joined_filtered."HAS_TRACKING_MSG" AS "HAS_TRACKING_MSG",
    tlm_shipment_joined_filtered."TRACKING_MSG_PROBLEM" AS "TRACKING_MSG_PROBLEM",
    tlm_shipment_joined_filtered."REC_LINEHAUL_COST" AS "REC_LINEHAUL_COST",
    tlm_shipment_joined_filtered."REC_ACCESSORIAL_COST" AS "REC_ACCESSORIAL_COST",
    tlm_shipment_joined_filtered."REC_TOTAL_COST" AS "REC_TOTAL_COST",
    tlm_shipment_joined_filtered."CYCLE_RESP_DEADLINE_TZ" AS "CYCLE_RESP_DEADLINE_TZ",
    tlm_shipment_joined_filtered."TENDER_RESP_DEADLINE_TZ" AS "TENDER_RESP_DEADLINE_TZ",
    tlm_shipment_joined_filtered."PICKUP_TZ" AS "PICKUP_TZ",
    tlm_shipment_joined_filtered."DELIVERY_TZ" AS "DELIVERY_TZ",
    tlm_shipment_joined_filtered."ASSIGNED_LANE_ID" AS "ASSIGNED_LANE_ID",
    tlm_shipment_joined_filtered."ASSIGNED_LANE_DETAIL_ID" AS "ASSIGNED_LANE_DETAIL_ID",
    tlm_shipment_joined_filtered."REC_SPOT_CHARGE" AS "REC_SPOT_CHARGE",
    tlm_shipment_joined_filtered."REC_LANE_ID" AS "REC_LANE_ID",
    tlm_shipment_joined_filtered."REC_LANE_DETAIL_ID" AS "REC_LANE_DETAIL_ID",
    tlm_shipment_joined_filtered."TENDER_DTTM" AS "TENDER_DTTM",
    tlm_shipment_joined_filtered."O_STOP_LOCATION_NAME" AS "O_STOP_LOCATION_NAME",
    tlm_shipment_joined_filtered."D_STOP_LOCATION_NAME" AS "D_STOP_LOCATION_NAME",
    tlm_shipment_joined_filtered."ASSIGNED_CM_SHIPMENT_ID" AS "ASSIGNED_CM_SHIPMENT_ID",
    tlm_shipment_joined_filtered."REC_CM_DISCOUNT" AS "REC_CM_DISCOUNT",
    tlm_shipment_joined_filtered."REC_STOP_COST" AS "REC_STOP_COST",
    tlm_shipment_joined_filtered."LAST_SELECTOR_RUN_DTTM" AS "LAST_SELECTOR_RUN_DTTM",
    tlm_shipment_joined_filtered."LAST_CM_OPTION_GEN_DTTM" AS "LAST_CM_OPTION_GEN_DTTM",
    tlm_shipment_joined_filtered."IS_CM_OPTION_GEN_ACTIVE" AS "IS_CM_OPTION_GEN_ACTIVE",
    tlm_shipment_joined_filtered."RS_CYCLE_REMAINING" AS "RS_CYCLE_REMAINING",
    tlm_shipment_joined_filtered."IS_TIME_FEAS_ENABLED" AS "IS_TIME_FEAS_ENABLED",
    tlm_shipment_joined_filtered."EXT_SYS_SHIPMENT_ID" AS "EXT_SYS_SHIPMENT_ID",
    tlm_shipment_joined_filtered."EXTRACTION_DTTM" AS "EXTRACTION_DTTM",
    tlm_shipment_joined_filtered."ASSIGNED_BROKER_CARRIER_CODE" AS "ASSIGNED_BROKER_CARRIER_CODE",
    tlm_shipment_joined_filtered."USE_BROKER_AS_CARRIER" AS "USE_BROKER_AS_CARRIER",
    tlm_shipment_joined_filtered."BROKER_REF" AS "BROKER_REF",
    tlm_shipment_joined_filtered."RATING_QUALIFIER" AS "RATING_QUALIFIER",
    tlm_shipment_joined_filtered."STATUS_CHANGE_DTTM" AS "STATUS_CHANGE_DTTM",
    tlm_shipment_joined_filtered."BUDG_TOTAL_COST" AS "BUDG_TOTAL_COST",
    tlm_shipment_joined_filtered."NORMALIZED_MARGIN" AS "NORMALIZED_MARGIN",
    tlm_shipment_joined_filtered."NORMALIZED_TOTAL_COST" AS "NORMALIZED_TOTAL_COST",
    tlm_shipment_joined_filtered."BUDG_NORMALIZED_TOTAL_COST" AS "BUDG_NORMALIZED_TOTAL_COST",
    tlm_shipment_joined_filtered."REC_BUDG_LINEHAUL_COST" AS "REC_BUDG_LINEHAUL_COST",
    tlm_shipment_joined_filtered."REC_BUDG_STOP_COST" AS "REC_BUDG_STOP_COST",
    tlm_shipment_joined_filtered."REC_BUDG_CM_DISCOUNT" AS "REC_BUDG_CM_DISCOUNT",
    tlm_shipment_joined_filtered."REC_BUDG_ACCESSORIAL_COST" AS "REC_BUDG_ACCESSORIAL_COST",
    tlm_shipment_joined_filtered."REC_BUDG_TOTAL_COST" AS "REC_BUDG_TOTAL_COST",
    tlm_shipment_joined_filtered."REC_MARGIN" AS "REC_MARGIN",
    tlm_shipment_joined_filtered."REC_NORMALIZED_MARGIN" AS "REC_NORMALIZED_MARGIN",
    tlm_shipment_joined_filtered."REC_NORMALIZED_TOTAL_COST" AS "REC_NORMALIZED_TOTAL_COST",
    tlm_shipment_joined_filtered."REC_BUDG_NORMALIZED_TOTAL_COST" AS "REC_BUDG_NORMALIZED_TOTAL_COST",
    tlm_shipment_joined_filtered."BUDG_CURRENCY_CODE" AS "BUDG_CURRENCY_CODE",
    tlm_shipment_joined_filtered."SPOT_CHARGE_CURRENCY_CODE" AS "SPOT_CHARGE_CURRENCY_CODE",
    tlm_shipment_joined_filtered."REC_CURRENCY_CODE" AS "REC_CURRENCY_CODE",
    tlm_shipment_joined_filtered."REC_BUDG_CURRENCY_CODE" AS "REC_BUDG_CURRENCY_CODE",
    tlm_shipment_joined_filtered."REC_SPOT_CHARGE_CURRENCY_CODE" AS "REC_SPOT_CHARGE_CURRENCY_CODE",
    tlm_shipment_joined_filtered."RATING_LANE_ID" AS "RATING_LANE_ID",
    tlm_shipment_joined_filtered."FRT_REV_RATING_LANE_ID" AS "FRT_REV_RATING_LANE_ID",
    tlm_shipment_joined_filtered."REC_RATING_LANE_ID" AS "REC_RATING_LANE_ID",
    tlm_shipment_joined_filtered."REC_BUDG_RATING_LANE_ID" AS "REC_BUDG_RATING_LANE_ID",
    tlm_shipment_joined_filtered."RATING_LANE_DETAIL_ID" AS "RATING_LANE_DETAIL_ID",
    tlm_shipment_joined_filtered."FRT_REV_RATING_LANE_DETAIL_ID" AS "FRT_REV_RATING_LANE_DETAIL_ID",
    tlm_shipment_joined_filtered."REC_RATING_LANE_DETAIL_ID" AS "REC_RATING_LANE_DETAIL_ID",
    tlm_shipment_joined_filtered."REC_BUDG_RATING_LANE_DETAIL_ID" AS "REC_BUDG_RATING_LANE_DETAIL_ID",
    tlm_shipment_joined_filtered."BUDG_CM_DISCOUNT" AS "BUDG_CM_DISCOUNT",
    tlm_shipment_joined_filtered."NORMALIZED_BASELINE_COST" AS "NORMALIZED_BASELINE_COST",
    tlm_shipment_joined_filtered."BASELINE_COST_CURRENCY_CODE" AS "BASELINE_COST_CURRENCY_CODE",
    tlm_shipment_joined_filtered."REPORTED_COST" AS "REPORTED_COST",
    tlm_shipment_joined_filtered."TRACTOR_NUMBER" AS "TRACTOR_NUMBER",
    tlm_shipment_joined_filtered."IS_AUTO_DELIVERED" AS "IS_AUTO_DELIVERED",
    tlm_shipment_joined_filtered."SHIPMENT_TYPE" AS "SHIPMENT_TYPE",
    tlm_shipment_joined_filtered."ORIG_BUDG_TOTAL_COST" AS "ORIG_BUDG_TOTAL_COST",
    tlm_shipment_joined_filtered."ACCESSORIAL_COST_TO_CARRIER" AS "ACCESSORIAL_COST_TO_CARRIER",
    tlm_shipment_joined_filtered."CARRIER_CHARGE" AS "CARRIER_CHARGE",
    tlm_shipment_joined_filtered."ACTUAL_COST" AS "ACTUAL_COST",
    tlm_shipment_joined_filtered."EARNED_INCOME" AS "EARNED_INCOME",
    tlm_shipment_joined_filtered."SENT_TO_PKMS" AS "SENT_TO_PKMS",
    tlm_shipment_joined_filtered."IS_SHIPMENT_RECONCILED" AS "IS_SHIPMENT_RECONCILED",
    tlm_shipment_joined_filtered."DELIVERY_REQ" AS "DELIVERY_REQ",
    tlm_shipment_joined_filtered."DROPOFF_PICKUP" AS "DROPOFF_PICKUP",
    tlm_shipment_joined_filtered."PACKAGING" AS "PACKAGING",
    tlm_shipment_joined_filtered."SENT_TO_PKMS_DTTM" AS "SENT_TO_PKMS_DTTM",
    tlm_shipment_joined_filtered."WMS_STATUS_CODE" AS "WMS_STATUS_CODE",
    tlm_shipment_joined_filtered."SPOT_CHARGE_AND_PAYEE_ACC" AS "SPOT_CHARGE_AND_PAYEE_ACC",
    tlm_shipment_joined_filtered."SPOT_CHARGE_AND_PAYEE_ACC_CC" AS "SPOT_CHARGE_AND_PAYEE_ACC_CC",
    tlm_shipment_joined_filtered."NORM_SPOT_CHARGE_AND_PAYEE_ACC" AS "NORM_SPOT_CHARGE_AND_PAYEE_ACC",
    tlm_shipment_joined_filtered."FACILITY_SCHEDULE_ID" AS "FACILITY_SCHEDULE_ID",
    tlm_shipment_joined_filtered."EARNED_INCOME_CURRENCY_CODE" AS "EARNED_INCOME_CURRENCY_CODE",
    tlm_shipment_joined_filtered."ACTUAL_COST_CURRENCY_CODE" AS "ACTUAL_COST_CURRENCY_CODE",
    tlm_shipment_joined_filtered."SHIPMENT_RECON_DTTM" AS "SHIPMENT_RECON_DTTM",
    tlm_shipment_joined_filtered."PLN_RATING_LANE_ID" AS "PLN_RATING_LANE_ID",
    tlm_shipment_joined_filtered."PLN_RATING_LANE_DETAIL_ID" AS "PLN_RATING_LANE_DETAIL_ID",
    tlm_shipment_joined_filtered."PLN_TOTAL_COST" AS "PLN_TOTAL_COST",
    tlm_shipment_joined_filtered."PLN_LINEHAUL_COST" AS "PLN_LINEHAUL_COST",
    tlm_shipment_joined_filtered."PLN_TOTAL_ACCESSORIAL_COST" AS "PLN_TOTAL_ACCESSORIAL_COST",
    tlm_shipment_joined_filtered."PLN_STOP_OFF_COST" AS "PLN_STOP_OFF_COST",
    tlm_shipment_joined_filtered."PLN_NORMALIZED_TOTAL_COST" AS "PLN_NORMALIZED_TOTAL_COST",
    tlm_shipment_joined_filtered."PLN_CURRENCY_CODE" AS "PLN_CURRENCY_CODE",
    tlm_shipment_joined_filtered."PLN_ACCESSORL_COST_TO_CARRIER" AS "PLN_ACCESSORL_COST_TO_CARRIER",
    tlm_shipment_joined_filtered."PLN_CARRIER_CHARGE" AS "PLN_CARRIER_CHARGE",
    tlm_shipment_joined_filtered."WAYPOINT_TOTAL_COST" AS "WAYPOINT_TOTAL_COST",
    tlm_shipment_joined_filtered."WAYPOINT_HANDLING_COST" AS "WAYPOINT_HANDLING_COST",
    tlm_shipment_joined_filtered."GRS_OPERATION" AS "GRS_OPERATION",
    tlm_shipment_joined_filtered."IS_GRS_OPT_CYCLE_RUNNING" AS "IS_GRS_OPT_CYCLE_RUNNING",
    tlm_shipment_joined_filtered."IS_MANUAL_ASSIGN" AS "IS_MANUAL_ASSIGN",
    tlm_shipment_joined_filtered."LAST_RUN_GRS_DTTM" AS "LAST_RUN_GRS_DTTM",
    tlm_shipment_joined_filtered."GRS_MAX_SHIPMENT_STATUS" AS "GRS_MAX_SHIPMENT_STATUS",
    tlm_shipment_joined_filtered."PRIORITY_TYPE" AS "PRIORITY_TYPE",
    tlm_shipment_joined_filtered."MV_CURRENCY_CODE" AS "MV_CURRENCY_CODE",
    tlm_shipment_joined_filtered."PROD_SCHED_REF_NUMBER" AS "PROD_SCHED_REF_NUMBER",
    tlm_shipment_joined_filtered."COMMODITY_CODE_ID" AS "COMMODITY_CODE_ID",
    tlm_shipment_joined_filtered."UN_NUMBER_ID" AS "UN_NUMBER_ID",
    tlm_shipment_joined_filtered."CONTRACT_NUMBER" AS "CONTRACT_NUMBER",
    tlm_shipment_joined_filtered."BOOKING_REF_SHIPPER" AS "BOOKING_REF_SHIPPER",
    tlm_shipment_joined_filtered."BOOKING_REF_CARRIER" AS "BOOKING_REF_CARRIER",
    tlm_shipment_joined_filtered."BK_RESOURCE_REF_EXTERNAL" AS "BK_RESOURCE_REF_EXTERNAL",
    tlm_shipment_joined_filtered."BK_RESOURCE_NAME_EXTERNAL" AS "BK_RESOURCE_NAME_EXTERNAL",
    tlm_shipment_joined_filtered."BK_O_FACILITY_ID" AS "BK_O_FACILITY_ID",
    tlm_shipment_joined_filtered."BK_D_FACILITY_ID" AS "BK_D_FACILITY_ID",
    tlm_shipment_joined_filtered."BK_MASTER_AIRWAY_BILL" AS "BK_MASTER_AIRWAY_BILL",
    tlm_shipment_joined_filtered."BK_FORWARDER_AIRWAY_BILL" AS "BK_FORWARDER_AIRWAY_BILL",
    tlm_shipment_joined_filtered."ASSIGNED_SCNDR_CARRIER_CODE" AS "ASSIGNED_SCNDR_CARRIER_CODE",
    tlm_shipment_joined_filtered."CUSTOMER_CREDIT_LIMIT_ID" AS "CUSTOMER_CREDIT_LIMIT_ID",
    tlm_shipment_joined_filtered."SHIPMENT_LEG_TYPE" AS "SHIPMENT_LEG_TYPE",
    tlm_shipment_joined_filtered."SHIPMENT_CLOSED_INDICATOR" AS "SHIPMENT_CLOSED_INDICATOR",
    tlm_shipment_joined_filtered."OCEAN_ROUTING_STAGE" AS "OCEAN_ROUTING_STAGE",
    tlm_shipment_joined_filtered."BK_DEPARTURE_DTTM" AS "BK_DEPARTURE_DTTM",
    tlm_shipment_joined_filtered."BK_DEPARTURE_TZ" AS "BK_DEPARTURE_TZ",
    tlm_shipment_joined_filtered."BK_ARRIVAL_DTTM" AS "BK_ARRIVAL_DTTM",
    tlm_shipment_joined_filtered."BK_ARRIVAL_TZ" AS "BK_ARRIVAL_TZ",
    tlm_shipment_joined_filtered."BK_PICKUP_DTTM" AS "BK_PICKUP_DTTM",
    tlm_shipment_joined_filtered."BK_PICKUP_TZ" AS "BK_PICKUP_TZ",
    tlm_shipment_joined_filtered."BK_CUTOFF_DTTM" AS "BK_CUTOFF_DTTM",
    tlm_shipment_joined_filtered."BK_CUTOFF_TZ" AS "BK_CUTOFF_TZ",
    tlm_shipment_joined_filtered."NUM_CHARGE_LAYOVERS" AS "NUM_CHARGE_LAYOVERS",
    tlm_shipment_joined_filtered."RATE_TYPE" AS "RATE_TYPE",
    tlm_shipment_joined_filtered."RATE_UOM" AS "RATE_UOM",
    tlm_shipment_joined_filtered."PICK_START_DTTM" AS "PICK_START_DTTM",
    tlm_shipment_joined_filtered."PAPERWORK_START_DTTM" AS "PAPERWORK_START_DTTM",
    tlm_shipment_joined_filtered."VEHICLE_CHECK_START_DTTM" AS "VEHICLE_CHECK_START_DTTM",
    tlm_shipment_joined_filtered."SHIPMENT_START_DTTM" AS "SHIPMENT_START_DTTM",
    tlm_shipment_joined_filtered."SHIPMENT_END_DTTM" AS "SHIPMENT_END_DTTM",
    tlm_shipment_joined_filtered."FEASIBLE_DRIVER_TYPE" AS "FEASIBLE_DRIVER_TYPE",
    tlm_shipment_joined_filtered."WAVE_ID" AS "WAVE_ID",
    tlm_shipment_joined_filtered."ESTIMATED_DISPATCH_DTTM" AS "ESTIMATED_DISPATCH_DTTM",
    tlm_shipment_joined_filtered."TOTAL_TIME" AS "TOTAL_TIME",
    tlm_shipment_joined_filtered."LOC_REFERENCE" AS "LOC_REFERENCE",
    tlm_shipment_joined_filtered."BK_O_FACILITY_ALIAS_ID" AS "BK_O_FACILITY_ALIAS_ID",
    tlm_shipment_joined_filtered."BK_D_FACILITY_ALIAS_ID" AS "BK_D_FACILITY_ALIAS_ID",
    tlm_shipment_joined_filtered."EQUIP_UTIL_PER" AS "EQUIP_UTIL_PER",
    tlm_shipment_joined_filtered."MOVE_TYPE" AS "MOVE_TYPE",
    tlm_shipment_joined_filtered."DRIVER_TYPE_ID" AS "DRIVER_TYPE_ID",
    tlm_shipment_joined_filtered."EQUIPMENT_TYPE" AS "EQUIPMENT_TYPE",
    tlm_shipment_joined_filtered."RADIAL_DISTANCE" AS "RADIAL_DISTANCE",
    tlm_shipment_joined_filtered."RADIAL_DISTANCE_UOM" AS "RADIAL_DISTANCE_UOM",
    tlm_shipment_joined_filtered."DESIGNATED_TRACTOR_CODE" AS "DESIGNATED_TRACTOR_CODE",
    tlm_shipment_joined_filtered."DESIGNATED_DRIVER_TYPE" AS "DESIGNATED_DRIVER_TYPE",
    tlm_shipment_joined_filtered."IS_WAVE_MAN_CHANGED" AS "IS_WAVE_MAN_CHANGED",
    tlm_shipment_joined_filtered."RETAIN_CONSOLIDATOR_TIMES" AS "RETAIN_CONSOLIDATOR_TIMES",
    tlm_shipment_joined_filtered."TARIFF" AS "TARIFF",
    tlm_shipment_joined_filtered."MIN_RATE" AS "MIN_RATE",
    tlm_shipment_joined_filtered."FIRST_UPDATE_SENT_TO_PKMS" AS "FIRST_UPDATE_SENT_TO_PKMS",
    tlm_shipment_joined_filtered."EVENT_IND_TYPEID" AS "EVENT_IND_TYPEID",
    tlm_shipment_joined_filtered."TANDEM_PATH_ID" AS "TANDEM_PATH_ID",
    tlm_shipment_joined_filtered."O_TANDEM_FACILITY" AS "O_TANDEM_FACILITY",
    tlm_shipment_joined_filtered."D_TANDEM_FACILITY" AS "D_TANDEM_FACILITY",
    tlm_shipment_joined_filtered."O_TANDEM_FACILITY_ALIAS" AS "O_TANDEM_FACILITY_ALIAS",
    tlm_shipment_joined_filtered."D_TANDEM_FACILITY_ALIAS" AS "D_TANDEM_FACILITY_ALIAS",
    tlm_shipment_joined_filtered."DELAY_TYPE" AS "DELAY_TYPE",
    tlm_shipment_joined_filtered."ASSIGNED_CARRIER_ID" AS "ASSIGNED_CARRIER_ID",
    tlm_shipment_joined_filtered."DSG_CARRIER_ID" AS "DSG_CARRIER_ID",
    tlm_shipment_joined_filtered."REC_CARRIER_ID" AS "REC_CARRIER_ID",
    tlm_shipment_joined_filtered."FEASIBLE_CARRIER_ID" AS "FEASIBLE_CARRIER_ID",
    tlm_shipment_joined_filtered."PAYEE_CARRIER_ID" AS "PAYEE_CARRIER_ID",
    tlm_shipment_joined_filtered."SCNDR_CARRIER_ID" AS "SCNDR_CARRIER_ID",
    tlm_shipment_joined_filtered."BROKER_CARRIER_ID" AS "BROKER_CARRIER_ID",
    tlm_shipment_joined_filtered."ASSIGNED_SCNDR_CARRIER_ID" AS "ASSIGNED_SCNDR_CARRIER_ID",
    tlm_shipment_joined_filtered."DSG_SCNDR_CARRIER_ID" AS "DSG_SCNDR_CARRIER_ID",
    tlm_shipment_joined_filtered."ASSIGNED_BROKER_CARRIER_ID" AS "ASSIGNED_BROKER_CARRIER_ID",
    tlm_shipment_joined_filtered."LH_PAYEE_CARRIER_ID" AS "LH_PAYEE_CARRIER_ID",
    tlm_shipment_joined_filtered."REC_BROKER_CARRIER_ID" AS "REC_BROKER_CARRIER_ID",
    tlm_shipment_joined_filtered."ASSIGNED_EQUIPMENT_ID" AS "ASSIGNED_EQUIPMENT_ID",
    tlm_shipment_joined_filtered."DSG_EQUIPMENT_ID" AS "DSG_EQUIPMENT_ID",
    tlm_shipment_joined_filtered."FEASIBLE_EQUIPMENT_ID" AS "FEASIBLE_EQUIPMENT_ID",
    tlm_shipment_joined_filtered."FEASIBLE_EQUIPMENT2_ID" AS "FEASIBLE_EQUIPMENT2_ID",
    tlm_shipment_joined_filtered."REC_EQUIPMENT_ID" AS "REC_EQUIPMENT_ID",
    tlm_shipment_joined_filtered."ASSIGNED_MOT_ID" AS "ASSIGNED_MOT_ID",
    tlm_shipment_joined_filtered."DSG_MOT_ID" AS "DSG_MOT_ID",
    tlm_shipment_joined_filtered."FEASIBLE_MOT_ID" AS "FEASIBLE_MOT_ID",
    tlm_shipment_joined_filtered."REC_MOT_ID" AS "REC_MOT_ID",
    tlm_shipment_joined_filtered."PRODUCT_CLASS_ID" AS "PRODUCT_CLASS_ID",
    tlm_shipment_joined_filtered."PROTECTION_LEVEL_ID" AS "PROTECTION_LEVEL_ID",
    tlm_shipment_joined_filtered."ASSIGNED_SERVICE_LEVEL_ID" AS "ASSIGNED_SERVICE_LEVEL_ID",
    tlm_shipment_joined_filtered."DSG_SERVICE_LEVEL_ID" AS "DSG_SERVICE_LEVEL_ID",
    tlm_shipment_joined_filtered."FEASIBLE_SERVICE_LEVEL_ID" AS "FEASIBLE_SERVICE_LEVEL_ID",
    tlm_shipment_joined_filtered."REC_SERVICE_LEVEL_ID" AS "REC_SERVICE_LEVEL_ID",
    tlm_shipment_joined_filtered."HAS_EM_NOTIFY_FLAG" AS "HAS_EM_NOTIFY_FLAG",
    tlm_shipment_joined_filtered."REGION_ID" AS "REGION_ID",
    tlm_shipment_joined_filtered."INBOUND_REGION_ID" AS "INBOUND_REGION_ID",
    tlm_shipment_joined_filtered."OUTBOUND_REGION_ID" AS "OUTBOUND_REGION_ID",
    tlm_shipment_joined_filtered."FINANCIAL_WT" AS "FINANCIAL_WT",
    tlm_shipment_joined_filtered."IS_BOOKING_REQUIRED" AS "IS_BOOKING_REQUIRED",
    tlm_shipment_joined_filtered."TOTAL_COST_EXCL_TAX" AS "TOTAL_COST_EXCL_TAX",
    tlm_shipment_joined_filtered."TOTAL_TAX_AMOUNT" AS "TOTAL_TAX_AMOUNT",
    tlm_shipment_joined_filtered."IS_ASSOCIATED_TO_OUTBOUND" AS "IS_ASSOCIATED_TO_OUTBOUND",
    tlm_shipment_joined_filtered."RECEIVED_DTTM" AS "RECEIVED_DTTM",
    tlm_shipment_joined_filtered."BOOKING_ID" AS "BOOKING_ID",
    tlm_shipment_joined_filtered."IS_MISROUTED" AS "IS_MISROUTED",
    tlm_shipment_joined_filtered."FEASIBLE_CARRIER_CODE" AS "FEASIBLE_CARRIER_CODE",
    tlm_shipment_joined_filtered."SHIPMENT_WIN_ADJ_FLAG" AS "SHIPMENT_WIN_ADJ_FLAG",
    tlm_shipment_joined_filtered."DT_PARAM_SET_ID" AS "DT_PARAM_SET_ID",
    tlm_shipment_joined_filtered."MERCHANDIZING_DEPARTMENT_ID" AS "MERCHANDIZING_DEPARTMENT_ID",
    tlm_shipment_joined_filtered."STATIC_ROUTE_ID" AS "STATIC_ROUTE_ID",
    tlm_shipment_joined_filtered."IS_FILO" AS "IS_FILO",
    tlm_shipment_joined_filtered."IS_COOLER_AT_NOSE" AS "IS_COOLER_AT_NOSE",
    tlm_shipment_joined_filtered."AUTH_NBR" AS "AUTH_NBR",
    tlm_shipment_joined_filtered."CONS_LOCN_ID" AS "CONS_LOCN_ID",
    tlm_shipment_joined_filtered."RTE_TYPE" AS "RTE_TYPE",
    tlm_shipment_joined_filtered."TRLR_TYPE" AS "TRLR_TYPE",
    tlm_shipment_joined_filtered."TRLR_SIZE" AS "TRLR_SIZE",
    tlm_shipment_joined_filtered."CONS_ADDR_CODE" AS "CONS_ADDR_CODE",
    tlm_shipment_joined_filtered."HUB_ID" AS "HUB_ID",
    tlm_shipment_joined_filtered."TRLR_GEN_CODE" AS "TRLR_GEN_CODE",
    tlm_shipment_joined_filtered."MAX_NBR_OF_CTNS" AS "MAX_NBR_OF_CTNS",
    tlm_shipment_joined_filtered."APPT_DOOR_SCHED_TYPE" AS "APPT_DOOR_SCHED_TYPE",
    tlm_shipment_joined_filtered."CREATED_SOURCE_TYPE" AS "CREATED_SOURCE_TYPE",
    tlm_shipment_joined_filtered."CREATED_SOURCE" AS "CREATED_SOURCE",
    tlm_shipment_joined_filtered."CREATED_DTTM" AS "CREATED_DTTM",
    tlm_shipment_joined_filtered."LAST_UPDATED_SOURCE_TYPE" AS "LAST_UPDATED_SOURCE_TYPE",
    tlm_shipment_joined_filtered."LAST_UPDATED_SOURCE" AS "LAST_UPDATED_SOURCE",
    tlm_shipment_joined_filtered."LAST_UPDATED_DTTM" AS "LAST_UPDATED_DTTM",
    tlm_shipment_joined_filtered."DSG_SCNDR_CARRIER_CODE" AS "DSG_SCNDR_CARRIER_CODE",
    tlm_shipment_joined_filtered."LH_PAYEE_CARRIER_CODE" AS "LH_PAYEE_CARRIER_CODE",
    tlm_shipment_joined_filtered."REC_BROKER_CARRIER_CODE" AS "REC_BROKER_CARRIER_CODE",
    tlm_shipment_joined_filtered."REC_CARRIER_CODE" AS "REC_CARRIER_CODE",
    tlm_shipment_joined_filtered."LPN_ASSIGNMENT_STOPPED" AS "LPN_ASSIGNMENT_STOPPED",
    tlm_shipment_joined_filtered."SEAL_NUMBER" AS "SEAL_NUMBER",
    tlm_shipment_joined_filtered."HIBERNATE_VERSION" AS "HIBERNATE_VERSION",
    tlm_shipment_joined_filtered."SHIP_GROUP_ID" AS "SHIP_GROUP_ID",
    tlm_shipment_joined_filtered."RATE" AS "RATE",
    tlm_shipment_joined_filtered."MONETARY_VALUE" AS "MONETARY_VALUE",
    tlm_shipment_joined_filtered."DOOR" AS "DOOR",
    tlm_shipment_joined_filtered."RTE_TYPE_1" AS "RTE_TYPE_1",
    tlm_shipment_joined_filtered."RTE_TYPE_2" AS "RTE_TYPE_2",
    tlm_shipment_joined_filtered."SCHEDULED_PICKUP_DTTM" AS "SCHEDULED_PICKUP_DTTM",
    tlm_shipment_joined_filtered."MANIFEST_ID" AS "MANIFEST_ID",
    tlm_shipment_joined_filtered."DAYS_TO_DELIVER" AS "DAYS_TO_DELIVER",
    tlm_shipment_joined_filtered."SED_GENERATED_FLAG" AS "SED_GENERATED_FLAG",
    tlm_shipment_joined_filtered."SERV_AREA_CODE" AS "SERV_AREA_CODE",
    tlm_shipment_joined_filtered."TENDER_RESP_DEADLINE_DTTM" AS "TENDER_RESP_DEADLINE_DTTM",
    tlm_shipment_joined_filtered."PRINT_CONS_BOL" AS "PRINT_CONS_BOL",
    tlm_shipment_joined_filtered."LEFT_WT" AS "LEFT_WT",
    tlm_shipment_joined_filtered."RIGHT_WT" AS "RIGHT_WT",
    tlm_shipment_joined_filtered."LANE_NAME" AS "LANE_NAME",
    tlm_shipment_joined_filtered."DECLARED_VALUE" AS "DECLARED_VALUE",
    tlm_shipment_joined_filtered."DV_CURRENCY_CODE" AS "DV_CURRENCY_CODE",
    tlm_shipment_joined_filtered."COD_AMOUNT" AS "COD_AMOUNT",
    tlm_shipment_joined_filtered."CUSTOMER_ID" AS "CUSTOMER_ID",
    tlm_shipment_joined_filtered."CUST_FRGT_CHARGE" AS "CUST_FRGT_CHARGE",
    tlm_shipment_joined_filtered."COD_CURRENCY_CODE" AS "COD_CURRENCY_CODE",
    tlm_shipment_joined_filtered."PLANNED_WEIGHT" AS "PLANNED_WEIGHT",
    tlm_shipment_joined_filtered."WEIGHT_UOM_ID_BASE" AS "WEIGHT_UOM_ID_BASE",
    tlm_shipment_joined_filtered."PLANNED_VOLUME" AS "PLANNED_VOLUME",
    tlm_shipment_joined_filtered."VOLUME_UOM_ID_BASE" AS "VOLUME_UOM_ID_BASE",
    tlm_shipment_joined_filtered."SIZE1_VALUE" AS "SIZE1_VALUE",
    tlm_shipment_joined_filtered."SIZE1_UOM_ID" AS "SIZE1_UOM_ID",
    tlm_shipment_joined_filtered."SIZE2_VALUE" AS "SIZE2_VALUE",
    tlm_shipment_joined_filtered."SIZE2_UOM_ID" AS "SIZE2_UOM_ID",
    tlm_shipment_joined_filtered."ASSIGNED_SHIP_VIA" AS "ASSIGNED_SHIP_VIA",
    tlm_shipment_joined_filtered."INSURANCE_STATUS" AS "INSURANCE_STATUS",
    tlm_shipment_joined_filtered."RTE_SWC_NBR" AS "RTE_SWC_NBR",
    tlm_shipment_joined_filtered."RTE_TO" AS "RTE_TO",
    tlm_shipment_joined_filtered."BILL_OF_LADING_NUMBER" AS "BILL_OF_LADING_NUMBER",
    tlm_shipment_joined_filtered."TRAILER_NUMBER" AS "TRAILER_NUMBER",
    tlm_shipment_joined_filtered."TRANS_PLAN_OWNER" AS "TRANS_PLAN_OWNER",
    tlm_shipment_joined_filtered."TOTAL_REVENUE_CURRENCY_CODE" AS "TOTAL_REVENUE_CURRENCY_CODE",
    tlm_shipment_joined_filtered."TOTAL_REVENUE" AS "TOTAL_REVENUE",
    tlm_shipment_joined_filtered."FRT_REV_SPOT_CHARGE_CURR_CODE" AS "FRT_REV_SPOT_CHARGE_CURR_CODE",
    tlm_shipment_joined_filtered."NORMALIZED_TOTAL_REVENUE" AS "NORMALIZED_TOTAL_REVENUE",
    tlm_shipment_joined_filtered."FRT_REV_SPOT_CHARGE" AS "FRT_REV_SPOT_CHARGE",
    tlm_shipment_joined_filtered."DSG_VOYAGE_FLIGHT" AS "DSG_VOYAGE_FLIGHT",
    tlm_shipment_joined_filtered."FEASIBLE_VOYAGE_FLIGHT" AS "FEASIBLE_VOYAGE_FLIGHT",
    tlm_shipment_joined_filtered."CURRENCY_DTTM" AS "CURRENCY_DTTM",
    tlm_shipment_joined_filtered."FRT_REV_LINEHAUL_CHARGE" AS "FRT_REV_LINEHAUL_CHARGE",
    tlm_shipment_joined_filtered."FRT_REV_STOP_CHARGE" AS "FRT_REV_STOP_CHARGE",
    tlm_shipment_joined_filtered."FRT_REV_ACCESSORIAL_CHARGE" AS "FRT_REV_ACCESSORIAL_CHARGE",
    tlm_shipment_joined_filtered."MARGIN" AS "MARGIN",
    tlm_shipment_joined_filtered."TOTAL_COST" AS "TOTAL_COST",
    tlm_shipment_joined_filtered."INCOTERM_ID" AS "INCOTERM_ID",
    tlm_shipment_joined_filtered."ORDER_QTY" AS "ORDER_QTY",
    tlm_shipment_joined_filtered."QTY_UOM_ID" AS "QTY_UOM_ID",
    tlm_shipment_joined_filtered."REF_SHIPMENT_NBR" AS "REF_SHIPMENT_NBR",
    tlm_shipment_joined_filtered."STAGING_LOCN_ID" AS "STAGING_LOCN_ID",
    tlm_shipment_joined_filtered."LOADING_SEQ_ORD" AS "LOADING_SEQ_ORD",
    tlm_shipment_joined_filtered."HAZMAT_CERT_CONTACT" AS "HAZMAT_CERT_CONTACT",
    tlm_shipment_joined_filtered."HAZMAT_CERT_DECLARATION" AS "HAZMAT_CERT_DECLARATION",
    tlm_shipment_joined_filtered."CDC_TIMESTAMP" AS "CDC_TIMESTAMP",
    tlm_shipment_joined_filtered."OPERATION_TYPE" AS "OPERATION_TYPE",
    tlm_shipment_joined_filtered."ARCHIVED_DTTM" AS "ARCHIVED_DTTM",
    tlm_shipment_joined_filtered."ORIGIN" AS "ORIGIN",
    tlm_shipment_joined_filtered."FINAL_DESTINATION" AS "FINAL_DESTINATION",
    tlm_shipment_joined_filtered."actual_delivery_date_parsed" AS "actual_delivery_date_parsed",
    tlm_shipment_joined_filtered."wood_pellet" AS "wood_pellet",
    time_dimension_prepared."MERCH_YEAR" AS "act_del_MERCH_YEAR",
    time_dimension_prepared."YEAR_WEEK" AS "act_del_YEAR_WEEK",
    time_dimension_prepared."YEAR_QUARTER" AS "act_del_YEAR_QUARTER",
    time_dimension_prepared."YEAR_PERIOD" AS "act_del_YEAR_PERIOD"
  FROM "SC_TLM_SHIPMENT_JOINED_FILTERED" tlm_shipment_joined_filtered
  LEFT JOIN "TIME_DIMENSION_PREPARED" time_dimension_prepared
    ON to_date(tlm_shipment_joined_filtered."actual_delivery_date_parsed") = to_date(date)
      WHERE "act_del_MERCH_YEAR" >= 2020;

<br>
--DOMESTIC_SHIPPING_FREIGHT_W_CAL_FILTERED_TEST_TC_OBJECT_ID
</br>
CREATE OR REPLACE TEMP  TABLE "DOMESTIC_SHIPPING_FREIGHT_W_CAL_FILTERED_TEST_TC_OBJECT_ID"
AS
SELECT   "TC_OBJECT_ID"
FROM (
SELECT 
    ds."TC_OBJECT_ID" AS "TC_OBJECT_ID"
  FROM "DOMESTIC_SHIPPING_FREIGHT_PREPARED_1" ds
  LEFT JOIN "TIME_DIMENSION_PREPARED" t1
    ON CAST(ds."INVOICE_DATE_PARSED" AS DATE) = CAST(t1."DATE" AS DATE)
  LEFT JOIN "TIME_DIMENSION_PREPARED" t2
    ON CAST(ds."DELIVERY_DATE_PARSED"  AS DATE)= CAST(t2."DATE" AS DATE)
  LEFT JOIN "TIME_DIMENSION_PREPARED" t3
    ON CAST(ds."actual_delivery_date_parsed" AS DATE) = CAST(t3."DATE" AS DATE)
  WHERE ds."NUM_REJECTIONS" = 0 AND 
  ( (ds."INV_OBJECT_STATUS" = 40) OR (ds."INV_OBJECT_STATUS" = 20) OR (ds."INV_OBJECT_STATUS" = 30))
  )  GROUP BY "TC_OBJECT_ID";
 
<br>
 --TLM_SHIPMENT_JOINED_W_FACILITIES_INBOUND
</br>
CREATE OR REPLACE TEMP TABLE "TLM_SHIPMENT_JOINED_W_FACILITIES_INBOUND"
AS
WITH TLM_SHIPMENT_JOINED_FILTER_SHIPPING_WINDOWS
AS
(
SELECT  *
  FROM (
    SELECT 
        "tlm_shipment_joined_w_cal_filtered"."SHIPMENT_ID" AS "SHIPMENT_ID",
        "tlm_shipment_joined_w_cal_filtered"."TC_COMPANY_ID" AS "TC_COMPANY_ID",
        "tlm_shipment_joined_w_cal_filtered"."RS_AREA_ID" AS "RS_AREA_ID",
        "tlm_shipment_joined_w_cal_filtered"."TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID",
        "tlm_shipment_joined_w_cal_filtered"."PP_SHIPMENT_ID" AS "PP_SHIPMENT_ID",
        "tlm_shipment_joined_w_cal_filtered"."SHIPMENT_STATUS" AS "SHIPMENT_STATUS",
        "tlm_shipment_joined_w_cal_filtered"."UPDATE_SENT" AS "UPDATE_SENT",
        "tlm_shipment_joined_w_cal_filtered"."BUSINESS_PROCESS" AS "BUSINESS_PROCESS",
        "tlm_shipment_joined_w_cal_filtered"."CREATION_TYPE" AS "CREATION_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."CONS_RUN_ID" AS "CONS_RUN_ID",
        "tlm_shipment_joined_w_cal_filtered"."IS_CANCELLED" AS "IS_CANCELLED",
        "tlm_shipment_joined_w_cal_filtered"."RS_TYPE" AS "RS_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."RS_CONFIG_ID" AS "RS_CONFIG_ID",
        "tlm_shipment_joined_w_cal_filtered"."RS_CONFIG_CYCLE_ID" AS "RS_CONFIG_CYCLE_ID",
        "tlm_shipment_joined_w_cal_filtered"."CONFIG_CYCLE_SEQ" AS "CONFIG_CYCLE_SEQ",
        "tlm_shipment_joined_w_cal_filtered"."CYCLE_DEADLINE_DTTM" AS "CYCLE_DEADLINE_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."CYCLE_EXECUTION_DTTM" AS "CYCLE_EXECUTION_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."LAST_RS_NOTIFICATION_DTTM" AS "LAST_RS_NOTIFICATION_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."CFMF_STATUS" AS "CFMF_STATUS",
        "tlm_shipment_joined_w_cal_filtered"."AVAILABLE_DTTM" AS "AVAILABLE_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."CMID" AS "CMID",
        "tlm_shipment_joined_w_cal_filtered"."CM_DISCOUNT" AS "CM_DISCOUNT",
        "tlm_shipment_joined_w_cal_filtered"."O_FACILITY_NUMBER" AS "O_FACILITY_NUMBER",
        "tlm_shipment_joined_w_cal_filtered"."O_FACILITY_ID" AS "O_FACILITY_ID",
        "tlm_shipment_joined_w_cal_filtered"."O_ADDRESS" AS "O_ADDRESS",
        "tlm_shipment_joined_w_cal_filtered"."O_CITY" AS "O_CITY",
        "tlm_shipment_joined_w_cal_filtered"."O_STATE_PROV" AS "O_STATE_PROV",
        "tlm_shipment_joined_w_cal_filtered"."O_POSTAL_CODE" AS "O_POSTAL_CODE",
        "tlm_shipment_joined_w_cal_filtered"."O_COUNTY" AS "O_COUNTY",
        "tlm_shipment_joined_w_cal_filtered"."O_COUNTRY_CODE" AS "O_COUNTRY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."D_FACILITY_NUMBER" AS "D_FACILITY_NUMBER",
        "tlm_shipment_joined_w_cal_filtered"."D_FACILITY_ID" AS "D_FACILITY_ID",
        "tlm_shipment_joined_w_cal_filtered"."D_ADDRESS" AS "D_ADDRESS",
        "tlm_shipment_joined_w_cal_filtered"."D_CITY" AS "D_CITY",
        "tlm_shipment_joined_w_cal_filtered"."D_STATE_PROV" AS "D_STATE_PROV",
        "tlm_shipment_joined_w_cal_filtered"."D_POSTAL_CODE" AS "D_POSTAL_CODE",
        "tlm_shipment_joined_w_cal_filtered"."D_COUNTY" AS "D_COUNTY",
        "tlm_shipment_joined_w_cal_filtered"."D_COUNTRY_CODE" AS "D_COUNTRY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."DISTANCE" AS "DISTANCE",
        "tlm_shipment_joined_w_cal_filtered"."DIRECT_DISTANCE" AS "DIRECT_DISTANCE",
        "tlm_shipment_joined_w_cal_filtered"."OUT_OF_ROUTE_DISTANCE" AS "OUT_OF_ROUTE_DISTANCE",
        "tlm_shipment_joined_w_cal_filtered"."DISTANCE_UOM" AS "DISTANCE_UOM",
        "tlm_shipment_joined_w_cal_filtered"."BUSINESS_PARTNER_ID" AS "BUSINESS_PARTNER_ID",
        "tlm_shipment_joined_w_cal_filtered"."COMMODITY_CLASS" AS "COMMODITY_CLASS",
        "tlm_shipment_joined_w_cal_filtered"."IS_HAZMAT" AS "IS_HAZMAT",
        "tlm_shipment_joined_w_cal_filtered"."IS_PERISHABLE" AS "IS_PERISHABLE",
        "tlm_shipment_joined_w_cal_filtered"."BILLING_METHOD" AS "BILLING_METHOD",
        "tlm_shipment_joined_w_cal_filtered"."DSG_CARRIER_CODE" AS "DSG_CARRIER_CODE",
        "tlm_shipment_joined_w_cal_filtered"."REC_CMID" AS "REC_CMID",
        "tlm_shipment_joined_w_cal_filtered"."REC_CM_SHIPMENT_ID" AS "REC_CM_SHIPMENT_ID",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_CARRIER_CODE" AS "ASSIGNED_CARRIER_CODE",
        "tlm_shipment_joined_w_cal_filtered"."SHIPMENT_REF_ID" AS "SHIPMENT_REF_ID",
        "tlm_shipment_joined_w_cal_filtered"."BILL_TO_CODE" AS "BILL_TO_CODE",
        "tlm_shipment_joined_w_cal_filtered"."BILL_TO_TITLE" AS "BILL_TO_TITLE",
        "tlm_shipment_joined_w_cal_filtered"."BILL_TO_NAME" AS "BILL_TO_NAME",
        "tlm_shipment_joined_w_cal_filtered"."BILL_TO_ADDRESS" AS "BILL_TO_ADDRESS",
        "tlm_shipment_joined_w_cal_filtered"."BILL_TO_CITY" AS "BILL_TO_CITY",
        "tlm_shipment_joined_w_cal_filtered"."BILL_TO_STATE_PROV" AS "BILL_TO_STATE_PROV",
        "tlm_shipment_joined_w_cal_filtered"."BILL_TO_POSTAL_CODE" AS "BILL_TO_POSTAL_CODE",
        "tlm_shipment_joined_w_cal_filtered"."BILL_TO_COUNTRY_CODE" AS "BILL_TO_COUNTRY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."BILL_TO_PHONE_NUMBER" AS "BILL_TO_PHONE_NUMBER",
        "tlm_shipment_joined_w_cal_filtered"."PURCHASE_ORDER" AS "PURCHASE_ORDER",
        "tlm_shipment_joined_w_cal_filtered"."PRO_NUMBER" AS "PRO_NUMBER",
        "tlm_shipment_joined_w_cal_filtered"."TRANS_RESP_CODE" AS "TRANS_RESP_CODE",
        "tlm_shipment_joined_w_cal_filtered"."BASELINE_COST" AS "BASELINE_COST",
        "tlm_shipment_joined_w_cal_filtered"."ESTIMATED_COST" AS "ESTIMATED_COST",
        "tlm_shipment_joined_w_cal_filtered"."LINEHAUL_COST" AS "LINEHAUL_COST",
        "tlm_shipment_joined_w_cal_filtered"."ACCESSORIAL_COST" AS "ACCESSORIAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."STOP_COST" AS "STOP_COST",
        "tlm_shipment_joined_w_cal_filtered"."ESTIMATED_SAVINGS" AS "ESTIMATED_SAVINGS",
        "tlm_shipment_joined_w_cal_filtered"."SPOT_CHARGE" AS "SPOT_CHARGE",
        "tlm_shipment_joined_w_cal_filtered"."CURRENCY_CODE" AS "CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."PICKUP_START_DTTM" AS "PICKUP_START_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."PICKUP_END_DTTM" AS "PICKUP_END_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."DELIVERY_START_DTTM" AS "DELIVERY_START_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."DELIVERY_END_DTTM" AS "DELIVERY_END_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."NUM_STOPS" AS "NUM_STOPS",
        "tlm_shipment_joined_w_cal_filtered"."NUM_DOCKS" AS "NUM_DOCKS",
        "tlm_shipment_joined_w_cal_filtered"."ON_TIME_INDICATOR" AS "ON_TIME_INDICATOR",
        "tlm_shipment_joined_w_cal_filtered"."HAS_NOTES" AS "HAS_NOTES",
        "tlm_shipment_joined_w_cal_filtered"."HAS_ALERTS" AS "HAS_ALERTS",
        "tlm_shipment_joined_w_cal_filtered"."HAS_IMPORT_ERROR" AS "HAS_IMPORT_ERROR",
        "tlm_shipment_joined_w_cal_filtered"."HAS_SOFT_CHECK_ERROR" AS "HAS_SOFT_CHECK_ERROR",
        "tlm_shipment_joined_w_cal_filtered"."HAS_TRACKING_MSG" AS "HAS_TRACKING_MSG",
        "tlm_shipment_joined_w_cal_filtered"."TRACKING_MSG_PROBLEM" AS "TRACKING_MSG_PROBLEM",
        "tlm_shipment_joined_w_cal_filtered"."REC_LINEHAUL_COST" AS "REC_LINEHAUL_COST",
        "tlm_shipment_joined_w_cal_filtered"."REC_ACCESSORIAL_COST" AS "REC_ACCESSORIAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."REC_TOTAL_COST" AS "REC_TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."CYCLE_RESP_DEADLINE_TZ" AS "CYCLE_RESP_DEADLINE_TZ",
        "tlm_shipment_joined_w_cal_filtered"."TENDER_RESP_DEADLINE_TZ" AS "TENDER_RESP_DEADLINE_TZ",
        "tlm_shipment_joined_w_cal_filtered"."PICKUP_TZ" AS "PICKUP_TZ",
        "tlm_shipment_joined_w_cal_filtered"."DELIVERY_TZ" AS "DELIVERY_TZ",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_LANE_ID" AS "ASSIGNED_LANE_ID",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_LANE_DETAIL_ID" AS "ASSIGNED_LANE_DETAIL_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_SPOT_CHARGE" AS "REC_SPOT_CHARGE",
        "tlm_shipment_joined_w_cal_filtered"."REC_LANE_ID" AS "REC_LANE_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_LANE_DETAIL_ID" AS "REC_LANE_DETAIL_ID",
        "tlm_shipment_joined_w_cal_filtered"."TENDER_DTTM" AS "TENDER_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."O_STOP_LOCATION_NAME" AS "O_STOP_LOCATION_NAME",
        "tlm_shipment_joined_w_cal_filtered"."D_STOP_LOCATION_NAME" AS "D_STOP_LOCATION_NAME",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_CM_SHIPMENT_ID" AS "ASSIGNED_CM_SHIPMENT_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_CM_DISCOUNT" AS "REC_CM_DISCOUNT",
        "tlm_shipment_joined_w_cal_filtered"."REC_STOP_COST" AS "REC_STOP_COST",
        "tlm_shipment_joined_w_cal_filtered"."LAST_SELECTOR_RUN_DTTM" AS "LAST_SELECTOR_RUN_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."LAST_CM_OPTION_GEN_DTTM" AS "LAST_CM_OPTION_GEN_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."IS_CM_OPTION_GEN_ACTIVE" AS "IS_CM_OPTION_GEN_ACTIVE",
        "tlm_shipment_joined_w_cal_filtered"."RS_CYCLE_REMAINING" AS "RS_CYCLE_REMAINING",
        "tlm_shipment_joined_w_cal_filtered"."IS_TIME_FEAS_ENABLED" AS "IS_TIME_FEAS_ENABLED",
        "tlm_shipment_joined_w_cal_filtered"."EXT_SYS_SHIPMENT_ID" AS "EXT_SYS_SHIPMENT_ID",
        "tlm_shipment_joined_w_cal_filtered"."EXTRACTION_DTTM" AS "EXTRACTION_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_BROKER_CARRIER_CODE" AS "ASSIGNED_BROKER_CARRIER_CODE",
        "tlm_shipment_joined_w_cal_filtered"."USE_BROKER_AS_CARRIER" AS "USE_BROKER_AS_CARRIER",
        "tlm_shipment_joined_w_cal_filtered"."BROKER_REF" AS "BROKER_REF",
        "tlm_shipment_joined_w_cal_filtered"."RATING_QUALIFIER" AS "RATING_QUALIFIER",
        "tlm_shipment_joined_w_cal_filtered"."STATUS_CHANGE_DTTM" AS "STATUS_CHANGE_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."BUDG_TOTAL_COST" AS "BUDG_TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."NORMALIZED_MARGIN" AS "NORMALIZED_MARGIN",
        "tlm_shipment_joined_w_cal_filtered"."NORMALIZED_TOTAL_COST" AS "NORMALIZED_TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."BUDG_NORMALIZED_TOTAL_COST" AS "BUDG_NORMALIZED_TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."REC_BUDG_LINEHAUL_COST" AS "REC_BUDG_LINEHAUL_COST",
        "tlm_shipment_joined_w_cal_filtered"."REC_BUDG_STOP_COST" AS "REC_BUDG_STOP_COST",
        "tlm_shipment_joined_w_cal_filtered"."REC_BUDG_CM_DISCOUNT" AS "REC_BUDG_CM_DISCOUNT",
        "tlm_shipment_joined_w_cal_filtered"."REC_BUDG_ACCESSORIAL_COST" AS "REC_BUDG_ACCESSORIAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."REC_BUDG_TOTAL_COST" AS "REC_BUDG_TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."REC_MARGIN" AS "REC_MARGIN",
        "tlm_shipment_joined_w_cal_filtered"."REC_NORMALIZED_MARGIN" AS "REC_NORMALIZED_MARGIN",
        "tlm_shipment_joined_w_cal_filtered"."REC_NORMALIZED_TOTAL_COST" AS "REC_NORMALIZED_TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."REC_BUDG_NORMALIZED_TOTAL_COST" AS "REC_BUDG_NORMALIZED_TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."BUDG_CURRENCY_CODE" AS "BUDG_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."SPOT_CHARGE_CURRENCY_CODE" AS "SPOT_CHARGE_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."REC_CURRENCY_CODE" AS "REC_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."REC_BUDG_CURRENCY_CODE" AS "REC_BUDG_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."REC_SPOT_CHARGE_CURRENCY_CODE" AS "REC_SPOT_CHARGE_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."RATING_LANE_ID" AS "RATING_LANE_ID",
        "tlm_shipment_joined_w_cal_filtered"."FRT_REV_RATING_LANE_ID" AS "FRT_REV_RATING_LANE_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_RATING_LANE_ID" AS "REC_RATING_LANE_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_BUDG_RATING_LANE_ID" AS "REC_BUDG_RATING_LANE_ID",
        "tlm_shipment_joined_w_cal_filtered"."RATING_LANE_DETAIL_ID" AS "RATING_LANE_DETAIL_ID",
        "tlm_shipment_joined_w_cal_filtered"."FRT_REV_RATING_LANE_DETAIL_ID" AS "FRT_REV_RATING_LANE_DETAIL_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_RATING_LANE_DETAIL_ID" AS "REC_RATING_LANE_DETAIL_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_BUDG_RATING_LANE_DETAIL_ID" AS "REC_BUDG_RATING_LANE_DETAIL_ID",
        "tlm_shipment_joined_w_cal_filtered"."BUDG_CM_DISCOUNT" AS "BUDG_CM_DISCOUNT",
        "tlm_shipment_joined_w_cal_filtered"."NORMALIZED_BASELINE_COST" AS "NORMALIZED_BASELINE_COST",
        "tlm_shipment_joined_w_cal_filtered"."BASELINE_COST_CURRENCY_CODE" AS "BASELINE_COST_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."REPORTED_COST" AS "REPORTED_COST",
        "tlm_shipment_joined_w_cal_filtered"."TRACTOR_NUMBER" AS "TRACTOR_NUMBER",
        "tlm_shipment_joined_w_cal_filtered"."IS_AUTO_DELIVERED" AS "IS_AUTO_DELIVERED",
        "tlm_shipment_joined_w_cal_filtered"."SHIPMENT_TYPE" AS "SHIPMENT_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."ORIG_BUDG_TOTAL_COST" AS "ORIG_BUDG_TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."ACCESSORIAL_COST_TO_CARRIER" AS "ACCESSORIAL_COST_TO_CARRIER",
        "tlm_shipment_joined_w_cal_filtered"."CARRIER_CHARGE" AS "CARRIER_CHARGE",
        "tlm_shipment_joined_w_cal_filtered"."ACTUAL_COST" AS "ACTUAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."EARNED_INCOME" AS "EARNED_INCOME",
        "tlm_shipment_joined_w_cal_filtered"."SENT_TO_PKMS" AS "SENT_TO_PKMS",
        "tlm_shipment_joined_w_cal_filtered"."IS_SHIPMENT_RECONCILED" AS "IS_SHIPMENT_RECONCILED",
        "tlm_shipment_joined_w_cal_filtered"."DELIVERY_REQ" AS "DELIVERY_REQ",
        "tlm_shipment_joined_w_cal_filtered"."DROPOFF_PICKUP" AS "DROPOFF_PICKUP",
        "tlm_shipment_joined_w_cal_filtered"."PACKAGING" AS "PACKAGING",
        "tlm_shipment_joined_w_cal_filtered"."SENT_TO_PKMS_DTTM" AS "SENT_TO_PKMS_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."WMS_STATUS_CODE" AS "WMS_STATUS_CODE",
        "tlm_shipment_joined_w_cal_filtered"."SPOT_CHARGE_AND_PAYEE_ACC" AS "SPOT_CHARGE_AND_PAYEE_ACC",
        "tlm_shipment_joined_w_cal_filtered"."SPOT_CHARGE_AND_PAYEE_ACC_CC" AS "SPOT_CHARGE_AND_PAYEE_ACC_CC",
        "tlm_shipment_joined_w_cal_filtered"."NORM_SPOT_CHARGE_AND_PAYEE_ACC" AS "NORM_SPOT_CHARGE_AND_PAYEE_ACC",
        "tlm_shipment_joined_w_cal_filtered"."FACILITY_SCHEDULE_ID" AS "FACILITY_SCHEDULE_ID",
        "tlm_shipment_joined_w_cal_filtered"."EARNED_INCOME_CURRENCY_CODE" AS "EARNED_INCOME_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."ACTUAL_COST_CURRENCY_CODE" AS "ACTUAL_COST_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."SHIPMENT_RECON_DTTM" AS "SHIPMENT_RECON_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."PLN_RATING_LANE_ID" AS "PLN_RATING_LANE_ID",
        "tlm_shipment_joined_w_cal_filtered"."PLN_RATING_LANE_DETAIL_ID" AS "PLN_RATING_LANE_DETAIL_ID",
        "tlm_shipment_joined_w_cal_filtered"."PLN_TOTAL_COST" AS "PLN_TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."PLN_LINEHAUL_COST" AS "PLN_LINEHAUL_COST",
        "tlm_shipment_joined_w_cal_filtered"."PLN_TOTAL_ACCESSORIAL_COST" AS "PLN_TOTAL_ACCESSORIAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."PLN_STOP_OFF_COST" AS "PLN_STOP_OFF_COST",
        "tlm_shipment_joined_w_cal_filtered"."PLN_NORMALIZED_TOTAL_COST" AS "PLN_NORMALIZED_TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."PLN_CURRENCY_CODE" AS "PLN_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."PLN_ACCESSORL_COST_TO_CARRIER" AS "PLN_ACCESSORL_COST_TO_CARRIER",
        "tlm_shipment_joined_w_cal_filtered"."PLN_CARRIER_CHARGE" AS "PLN_CARRIER_CHARGE",
        "tlm_shipment_joined_w_cal_filtered"."WAYPOINT_TOTAL_COST" AS "WAYPOINT_TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."WAYPOINT_HANDLING_COST" AS "WAYPOINT_HANDLING_COST",
        "tlm_shipment_joined_w_cal_filtered"."GRS_OPERATION" AS "GRS_OPERATION",
        "tlm_shipment_joined_w_cal_filtered"."IS_GRS_OPT_CYCLE_RUNNING" AS "IS_GRS_OPT_CYCLE_RUNNING",
        "tlm_shipment_joined_w_cal_filtered"."IS_MANUAL_ASSIGN" AS "IS_MANUAL_ASSIGN",
        "tlm_shipment_joined_w_cal_filtered"."LAST_RUN_GRS_DTTM" AS "LAST_RUN_GRS_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."GRS_MAX_SHIPMENT_STATUS" AS "GRS_MAX_SHIPMENT_STATUS",
        "tlm_shipment_joined_w_cal_filtered"."PRIORITY_TYPE" AS "PRIORITY_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."MV_CURRENCY_CODE" AS "MV_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."PROD_SCHED_REF_NUMBER" AS "PROD_SCHED_REF_NUMBER",
        "tlm_shipment_joined_w_cal_filtered"."COMMODITY_CODE_ID" AS "COMMODITY_CODE_ID",
        "tlm_shipment_joined_w_cal_filtered"."UN_NUMBER_ID" AS "UN_NUMBER_ID",
        "tlm_shipment_joined_w_cal_filtered"."CONTRACT_NUMBER" AS "CONTRACT_NUMBER",
        "tlm_shipment_joined_w_cal_filtered"."BOOKING_REF_SHIPPER" AS "BOOKING_REF_SHIPPER",
        "tlm_shipment_joined_w_cal_filtered"."BOOKING_REF_CARRIER" AS "BOOKING_REF_CARRIER",
        "tlm_shipment_joined_w_cal_filtered"."BK_RESOURCE_REF_EXTERNAL" AS "BK_RESOURCE_REF_EXTERNAL",
        "tlm_shipment_joined_w_cal_filtered"."BK_RESOURCE_NAME_EXTERNAL" AS "BK_RESOURCE_NAME_EXTERNAL",
        "tlm_shipment_joined_w_cal_filtered"."BK_O_FACILITY_ID" AS "BK_O_FACILITY_ID",
        "tlm_shipment_joined_w_cal_filtered"."BK_D_FACILITY_ID" AS "BK_D_FACILITY_ID",
        "tlm_shipment_joined_w_cal_filtered"."BK_MASTER_AIRWAY_BILL" AS "BK_MASTER_AIRWAY_BILL",
        "tlm_shipment_joined_w_cal_filtered"."BK_FORWARDER_AIRWAY_BILL" AS "BK_FORWARDER_AIRWAY_BILL",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_SCNDR_CARRIER_CODE" AS "ASSIGNED_SCNDR_CARRIER_CODE",
        "tlm_shipment_joined_w_cal_filtered"."CUSTOMER_CREDIT_LIMIT_ID" AS "CUSTOMER_CREDIT_LIMIT_ID",
        "tlm_shipment_joined_w_cal_filtered"."SHIPMENT_LEG_TYPE" AS "SHIPMENT_LEG_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."SHIPMENT_CLOSED_INDICATOR" AS "SHIPMENT_CLOSED_INDICATOR",
        "tlm_shipment_joined_w_cal_filtered"."OCEAN_ROUTING_STAGE" AS "OCEAN_ROUTING_STAGE",
        "tlm_shipment_joined_w_cal_filtered"."BK_DEPARTURE_DTTM" AS "BK_DEPARTURE_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."BK_DEPARTURE_TZ" AS "BK_DEPARTURE_TZ",
        "tlm_shipment_joined_w_cal_filtered"."BK_ARRIVAL_DTTM" AS "BK_ARRIVAL_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."BK_ARRIVAL_TZ" AS "BK_ARRIVAL_TZ",
        "tlm_shipment_joined_w_cal_filtered"."BK_PICKUP_DTTM" AS "BK_PICKUP_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."BK_PICKUP_TZ" AS "BK_PICKUP_TZ",
        "tlm_shipment_joined_w_cal_filtered"."BK_CUTOFF_DTTM" AS "BK_CUTOFF_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."BK_CUTOFF_TZ" AS "BK_CUTOFF_TZ",
        "tlm_shipment_joined_w_cal_filtered"."NUM_CHARGE_LAYOVERS" AS "NUM_CHARGE_LAYOVERS",
        "tlm_shipment_joined_w_cal_filtered"."RATE_TYPE" AS "RATE_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."RATE_UOM" AS "RATE_UOM",
        "tlm_shipment_joined_w_cal_filtered"."PICK_START_DTTM" AS "PICK_START_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."PAPERWORK_START_DTTM" AS "PAPERWORK_START_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."VEHICLE_CHECK_START_DTTM" AS "VEHICLE_CHECK_START_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."SHIPMENT_START_DTTM" AS "SHIPMENT_START_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."SHIPMENT_END_DTTM" AS "SHIPMENT_END_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."FEASIBLE_DRIVER_TYPE" AS "FEASIBLE_DRIVER_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."WAVE_ID" AS "WAVE_ID",
        "tlm_shipment_joined_w_cal_filtered"."ESTIMATED_DISPATCH_DTTM" AS "ESTIMATED_DISPATCH_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."TOTAL_TIME" AS "TOTAL_TIME",
        "tlm_shipment_joined_w_cal_filtered"."LOC_REFERENCE" AS "LOC_REFERENCE",
        "tlm_shipment_joined_w_cal_filtered"."BK_O_FACILITY_ALIAS_ID" AS "BK_O_FACILITY_ALIAS_ID",
        "tlm_shipment_joined_w_cal_filtered"."BK_D_FACILITY_ALIAS_ID" AS "BK_D_FACILITY_ALIAS_ID",
        "tlm_shipment_joined_w_cal_filtered"."EQUIP_UTIL_PER" AS "EQUIP_UTIL_PER",
        "tlm_shipment_joined_w_cal_filtered"."MOVE_TYPE" AS "MOVE_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."DRIVER_TYPE_ID" AS "DRIVER_TYPE_ID",
        "tlm_shipment_joined_w_cal_filtered"."EQUIPMENT_TYPE" AS "EQUIPMENT_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."RADIAL_DISTANCE" AS "RADIAL_DISTANCE",
        "tlm_shipment_joined_w_cal_filtered"."RADIAL_DISTANCE_UOM" AS "RADIAL_DISTANCE_UOM",
        "tlm_shipment_joined_w_cal_filtered"."DESIGNATED_TRACTOR_CODE" AS "DESIGNATED_TRACTOR_CODE",
        "tlm_shipment_joined_w_cal_filtered"."DESIGNATED_DRIVER_TYPE" AS "DESIGNATED_DRIVER_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."IS_WAVE_MAN_CHANGED" AS "IS_WAVE_MAN_CHANGED",
        "tlm_shipment_joined_w_cal_filtered"."RETAIN_CONSOLIDATOR_TIMES" AS "RETAIN_CONSOLIDATOR_TIMES",
        "tlm_shipment_joined_w_cal_filtered"."TARIFF" AS "TARIFF",
        "tlm_shipment_joined_w_cal_filtered"."MIN_RATE" AS "MIN_RATE",
        "tlm_shipment_joined_w_cal_filtered"."FIRST_UPDATE_SENT_TO_PKMS" AS "FIRST_UPDATE_SENT_TO_PKMS",
        "tlm_shipment_joined_w_cal_filtered"."EVENT_IND_TYPEID" AS "EVENT_IND_TYPEID",
        "tlm_shipment_joined_w_cal_filtered"."TANDEM_PATH_ID" AS "TANDEM_PATH_ID",
        "tlm_shipment_joined_w_cal_filtered"."O_TANDEM_FACILITY" AS "O_TANDEM_FACILITY",
        "tlm_shipment_joined_w_cal_filtered"."D_TANDEM_FACILITY" AS "D_TANDEM_FACILITY",
        "tlm_shipment_joined_w_cal_filtered"."O_TANDEM_FACILITY_ALIAS" AS "O_TANDEM_FACILITY_ALIAS",
        "tlm_shipment_joined_w_cal_filtered"."D_TANDEM_FACILITY_ALIAS" AS "D_TANDEM_FACILITY_ALIAS",
        "tlm_shipment_joined_w_cal_filtered"."DELAY_TYPE" AS "DELAY_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_CARRIER_ID" AS "ASSIGNED_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."DSG_CARRIER_ID" AS "DSG_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_CARRIER_ID" AS "REC_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."FEASIBLE_CARRIER_ID" AS "FEASIBLE_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."PAYEE_CARRIER_ID" AS "PAYEE_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."SCNDR_CARRIER_ID" AS "SCNDR_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."BROKER_CARRIER_ID" AS "BROKER_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_SCNDR_CARRIER_ID" AS "ASSIGNED_SCNDR_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."DSG_SCNDR_CARRIER_ID" AS "DSG_SCNDR_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_BROKER_CARRIER_ID" AS "ASSIGNED_BROKER_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."LH_PAYEE_CARRIER_ID" AS "LH_PAYEE_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_BROKER_CARRIER_ID" AS "REC_BROKER_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_EQUIPMENT_ID" AS "ASSIGNED_EQUIPMENT_ID",
        "tlm_shipment_joined_w_cal_filtered"."DSG_EQUIPMENT_ID" AS "DSG_EQUIPMENT_ID",
        "tlm_shipment_joined_w_cal_filtered"."FEASIBLE_EQUIPMENT_ID" AS "FEASIBLE_EQUIPMENT_ID",
        "tlm_shipment_joined_w_cal_filtered"."FEASIBLE_EQUIPMENT2_ID" AS "FEASIBLE_EQUIPMENT2_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_EQUIPMENT_ID" AS "REC_EQUIPMENT_ID",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_MOT_ID" AS "ASSIGNED_MOT_ID",
        "tlm_shipment_joined_w_cal_filtered"."DSG_MOT_ID" AS "DSG_MOT_ID",
        "tlm_shipment_joined_w_cal_filtered"."FEASIBLE_MOT_ID" AS "FEASIBLE_MOT_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_MOT_ID" AS "REC_MOT_ID",
        "tlm_shipment_joined_w_cal_filtered"."PRODUCT_CLASS_ID" AS "PRODUCT_CLASS_ID",
        "tlm_shipment_joined_w_cal_filtered"."PROTECTION_LEVEL_ID" AS "PROTECTION_LEVEL_ID",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_SERVICE_LEVEL_ID" AS "ASSIGNED_SERVICE_LEVEL_ID",
        "tlm_shipment_joined_w_cal_filtered"."DSG_SERVICE_LEVEL_ID" AS "DSG_SERVICE_LEVEL_ID",
        "tlm_shipment_joined_w_cal_filtered"."FEASIBLE_SERVICE_LEVEL_ID" AS "FEASIBLE_SERVICE_LEVEL_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_SERVICE_LEVEL_ID" AS "REC_SERVICE_LEVEL_ID",
        "tlm_shipment_joined_w_cal_filtered"."HAS_EM_NOTIFY_FLAG" AS "HAS_EM_NOTIFY_FLAG",
        "tlm_shipment_joined_w_cal_filtered"."REGION_ID" AS "REGION_ID",
        "tlm_shipment_joined_w_cal_filtered"."INBOUND_REGION_ID" AS "INBOUND_REGION_ID",
        "tlm_shipment_joined_w_cal_filtered"."OUTBOUND_REGION_ID" AS "OUTBOUND_REGION_ID",
        "tlm_shipment_joined_w_cal_filtered"."FINANCIAL_WT" AS "FINANCIAL_WT",
        "tlm_shipment_joined_w_cal_filtered"."IS_BOOKING_REQUIRED" AS "IS_BOOKING_REQUIRED",
        "tlm_shipment_joined_w_cal_filtered"."TOTAL_COST_EXCL_TAX" AS "TOTAL_COST_EXCL_TAX",
        "tlm_shipment_joined_w_cal_filtered"."TOTAL_TAX_AMOUNT" AS "TOTAL_TAX_AMOUNT",
        "tlm_shipment_joined_w_cal_filtered"."IS_ASSOCIATED_TO_OUTBOUND" AS "IS_ASSOCIATED_TO_OUTBOUND",
        "tlm_shipment_joined_w_cal_filtered"."RECEIVED_DTTM" AS "RECEIVED_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."BOOKING_ID" AS "BOOKING_ID",
        "tlm_shipment_joined_w_cal_filtered"."IS_MISROUTED" AS "IS_MISROUTED",
        "tlm_shipment_joined_w_cal_filtered"."FEASIBLE_CARRIER_CODE" AS "FEASIBLE_CARRIER_CODE",
        "tlm_shipment_joined_w_cal_filtered"."SHIPMENT_WIN_ADJ_FLAG" AS "SHIPMENT_WIN_ADJ_FLAG",
        "tlm_shipment_joined_w_cal_filtered"."DT_PARAM_SET_ID" AS "DT_PARAM_SET_ID",
        "tlm_shipment_joined_w_cal_filtered"."MERCHANDIZING_DEPARTMENT_ID" AS "MERCHANDIZING_DEPARTMENT_ID",
        "tlm_shipment_joined_w_cal_filtered"."STATIC_ROUTE_ID" AS "STATIC_ROUTE_ID",
        "tlm_shipment_joined_w_cal_filtered"."IS_FILO" AS "IS_FILO",
        "tlm_shipment_joined_w_cal_filtered"."IS_COOLER_AT_NOSE" AS "IS_COOLER_AT_NOSE",
        "tlm_shipment_joined_w_cal_filtered"."AUTH_NBR" AS "AUTH_NBR",
        "tlm_shipment_joined_w_cal_filtered"."CONS_LOCN_ID" AS "CONS_LOCN_ID",
        "tlm_shipment_joined_w_cal_filtered"."RTE_TYPE" AS "RTE_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."TRLR_TYPE" AS "TRLR_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."TRLR_SIZE" AS "TRLR_SIZE",
        "tlm_shipment_joined_w_cal_filtered"."CONS_ADDR_CODE" AS "CONS_ADDR_CODE",
        "tlm_shipment_joined_w_cal_filtered"."HUB_ID" AS "HUB_ID",
        "tlm_shipment_joined_w_cal_filtered"."TRLR_GEN_CODE" AS "TRLR_GEN_CODE",
        "tlm_shipment_joined_w_cal_filtered"."MAX_NBR_OF_CTNS" AS "MAX_NBR_OF_CTNS",
        "tlm_shipment_joined_w_cal_filtered"."APPT_DOOR_SCHED_TYPE" AS "APPT_DOOR_SCHED_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."CREATED_SOURCE_TYPE" AS "CREATED_SOURCE_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."CREATED_SOURCE" AS "CREATED_SOURCE",
        "tlm_shipment_joined_w_cal_filtered"."CREATED_DTTM" AS "CREATED_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."LAST_UPDATED_SOURCE_TYPE" AS "LAST_UPDATED_SOURCE_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."LAST_UPDATED_SOURCE" AS "LAST_UPDATED_SOURCE",
        "tlm_shipment_joined_w_cal_filtered"."LAST_UPDATED_DTTM" AS "LAST_UPDATED_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."DSG_SCNDR_CARRIER_CODE" AS "DSG_SCNDR_CARRIER_CODE",
        "tlm_shipment_joined_w_cal_filtered"."LH_PAYEE_CARRIER_CODE" AS "LH_PAYEE_CARRIER_CODE",
        "tlm_shipment_joined_w_cal_filtered"."REC_BROKER_CARRIER_CODE" AS "REC_BROKER_CARRIER_CODE",
        "tlm_shipment_joined_w_cal_filtered"."REC_CARRIER_CODE" AS "REC_CARRIER_CODE",
        "tlm_shipment_joined_w_cal_filtered"."LPN_ASSIGNMENT_STOPPED" AS "LPN_ASSIGNMENT_STOPPED",
        "tlm_shipment_joined_w_cal_filtered"."SEAL_NUMBER" AS "SEAL_NUMBER",
        "tlm_shipment_joined_w_cal_filtered"."HIBERNATE_VERSION" AS "HIBERNATE_VERSION",
        "tlm_shipment_joined_w_cal_filtered"."SHIP_GROUP_ID" AS "SHIP_GROUP_ID",
        "tlm_shipment_joined_w_cal_filtered"."RATE" AS "RATE",
        "tlm_shipment_joined_w_cal_filtered"."MONETARY_VALUE" AS "MONETARY_VALUE",
        "tlm_shipment_joined_w_cal_filtered"."DOOR" AS "DOOR",
        "tlm_shipment_joined_w_cal_filtered"."RTE_TYPE_1" AS "RTE_TYPE_1",
        "tlm_shipment_joined_w_cal_filtered"."RTE_TYPE_2" AS "RTE_TYPE_2",
        "tlm_shipment_joined_w_cal_filtered"."SCHEDULED_PICKUP_DTTM" AS "SCHEDULED_PICKUP_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."MANIFEST_ID" AS "MANIFEST_ID",
        "tlm_shipment_joined_w_cal_filtered"."DAYS_TO_DELIVER" AS "DAYS_TO_DELIVER",
        "tlm_shipment_joined_w_cal_filtered"."SED_GENERATED_FLAG" AS "SED_GENERATED_FLAG",
        "tlm_shipment_joined_w_cal_filtered"."SERV_AREA_CODE" AS "SERV_AREA_CODE",
        "tlm_shipment_joined_w_cal_filtered"."TENDER_RESP_DEADLINE_DTTM" AS "TENDER_RESP_DEADLINE_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."PRINT_CONS_BOL" AS "PRINT_CONS_BOL",
        "tlm_shipment_joined_w_cal_filtered"."LEFT_WT" AS "LEFT_WT",
        "tlm_shipment_joined_w_cal_filtered"."RIGHT_WT" AS "RIGHT_WT",
        "tlm_shipment_joined_w_cal_filtered"."LANE_NAME" AS "LANE_NAME",
        "tlm_shipment_joined_w_cal_filtered"."DECLARED_VALUE" AS "DECLARED_VALUE",
        "tlm_shipment_joined_w_cal_filtered"."DV_CURRENCY_CODE" AS "DV_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."COD_AMOUNT" AS "COD_AMOUNT",
        "tlm_shipment_joined_w_cal_filtered"."CUSTOMER_ID" AS "CUSTOMER_ID",
        "tlm_shipment_joined_w_cal_filtered"."CUST_FRGT_CHARGE" AS "CUST_FRGT_CHARGE",
        "tlm_shipment_joined_w_cal_filtered"."COD_CURRENCY_CODE" AS "COD_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."PLANNED_WEIGHT" AS "PLANNED_WEIGHT",
        "tlm_shipment_joined_w_cal_filtered"."WEIGHT_UOM_ID_BASE" AS "WEIGHT_UOM_ID_BASE",
        "tlm_shipment_joined_w_cal_filtered"."PLANNED_VOLUME" AS "PLANNED_VOLUME",
        "tlm_shipment_joined_w_cal_filtered"."VOLUME_UOM_ID_BASE" AS "VOLUME_UOM_ID_BASE",
        "tlm_shipment_joined_w_cal_filtered"."SIZE1_VALUE" AS "SIZE1_VALUE",
        "tlm_shipment_joined_w_cal_filtered"."SIZE1_UOM_ID" AS "SIZE1_UOM_ID",
        "tlm_shipment_joined_w_cal_filtered"."SIZE2_VALUE" AS "SIZE2_VALUE",
        "tlm_shipment_joined_w_cal_filtered"."SIZE2_UOM_ID" AS "SIZE2_UOM_ID",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_SHIP_VIA" AS "ASSIGNED_SHIP_VIA",
        "tlm_shipment_joined_w_cal_filtered"."INSURANCE_STATUS" AS "INSURANCE_STATUS",
        "tlm_shipment_joined_w_cal_filtered"."RTE_SWC_NBR" AS "RTE_SWC_NBR",
        "tlm_shipment_joined_w_cal_filtered"."RTE_TO" AS "RTE_TO",
        "tlm_shipment_joined_w_cal_filtered"."BILL_OF_LADING_NUMBER" AS "BILL_OF_LADING_NUMBER",
        "tlm_shipment_joined_w_cal_filtered"."TRAILER_NUMBER" AS "TRAILER_NUMBER",
        "tlm_shipment_joined_w_cal_filtered"."TRANS_PLAN_OWNER" AS "TRANS_PLAN_OWNER",
        "tlm_shipment_joined_w_cal_filtered"."TOTAL_REVENUE_CURRENCY_CODE" AS "TOTAL_REVENUE_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."TOTAL_REVENUE" AS "TOTAL_REVENUE",
        "tlm_shipment_joined_w_cal_filtered"."FRT_REV_SPOT_CHARGE_CURR_CODE" AS "FRT_REV_SPOT_CHARGE_CURR_CODE",
        "tlm_shipment_joined_w_cal_filtered"."NORMALIZED_TOTAL_REVENUE" AS "NORMALIZED_TOTAL_REVENUE",
        "tlm_shipment_joined_w_cal_filtered"."FRT_REV_SPOT_CHARGE" AS "FRT_REV_SPOT_CHARGE",
        "tlm_shipment_joined_w_cal_filtered"."DSG_VOYAGE_FLIGHT" AS "DSG_VOYAGE_FLIGHT",
        "tlm_shipment_joined_w_cal_filtered"."FEASIBLE_VOYAGE_FLIGHT" AS "FEASIBLE_VOYAGE_FLIGHT",
        "tlm_shipment_joined_w_cal_filtered"."CURRENCY_DTTM" AS "CURRENCY_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."FRT_REV_LINEHAUL_CHARGE" AS "FRT_REV_LINEHAUL_CHARGE",
        "tlm_shipment_joined_w_cal_filtered"."FRT_REV_STOP_CHARGE" AS "FRT_REV_STOP_CHARGE",
        "tlm_shipment_joined_w_cal_filtered"."FRT_REV_ACCESSORIAL_CHARGE" AS "FRT_REV_ACCESSORIAL_CHARGE",
        "tlm_shipment_joined_w_cal_filtered"."MARGIN" AS "MARGIN",
        "tlm_shipment_joined_w_cal_filtered"."TOTAL_COST" AS "TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."INCOTERM_ID" AS "INCOTERM_ID",
        "tlm_shipment_joined_w_cal_filtered"."ORDER_QTY" AS "ORDER_QTY",
        "tlm_shipment_joined_w_cal_filtered"."QTY_UOM_ID" AS "QTY_UOM_ID",
        "tlm_shipment_joined_w_cal_filtered"."REF_SHIPMENT_NBR" AS "REF_SHIPMENT_NBR",
        "tlm_shipment_joined_w_cal_filtered"."STAGING_LOCN_ID" AS "STAGING_LOCN_ID",
        "tlm_shipment_joined_w_cal_filtered"."LOADING_SEQ_ORD" AS "LOADING_SEQ_ORD",
        "tlm_shipment_joined_w_cal_filtered"."HAZMAT_CERT_CONTACT" AS "HAZMAT_CERT_CONTACT",
        "tlm_shipment_joined_w_cal_filtered"."HAZMAT_CERT_DECLARATION" AS "HAZMAT_CERT_DECLARATION",
        "tlm_shipment_joined_w_cal_filtered"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP",
        "tlm_shipment_joined_w_cal_filtered"."OPERATION_TYPE" AS "OPERATION_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."ARCHIVED_DTTM" AS "ARCHIVED_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."ORIGIN" AS "ORIGIN",
        "tlm_shipment_joined_w_cal_filtered"."FINAL_DESTINATION" AS "FINAL_DESTINATION",
        "tlm_shipment_joined_w_cal_filtered"."actual_delivery_date_parsed" AS "actual_delivery_date_parsed",
        "tlm_shipment_joined_w_cal_filtered"."wood_pellet" AS "wood_pellet",
        "tlm_shipment_joined_w_cal_filtered"."act_del_MERCH_YEAR" AS "act_del_MERCH_YEAR",
        "tlm_shipment_joined_w_cal_filtered"."act_del_YEAR_WEEK" AS "act_del_YEAR_WEEK",
        "tlm_shipment_joined_w_cal_filtered"."act_del_YEAR_QUARTER" AS "act_del_YEAR_QUARTER",
        "tlm_shipment_joined_w_cal_filtered"."act_del_YEAR_PERIOD" AS "act_del_YEAR_PERIOD",
        "domestic_shipping_freight_w_cal_filtered_test_TC_Object_ID"."invoice_shipping_id" AS "invoice_shipping_id",
           SUM("TOTAL_COST") OVER (PARTITION BY "TC_SHIPMENT_ID" ORDER BY "SHIPMENT_ID" ASC NULLS FIRST) AS "TOTAL_COST_sum",
            ROW_NUMBER() OVER (PARTITION BY "TC_SHIPMENT_ID" ORDER BY "SHIPMENT_ID" ASC NULLS FIRST) AS "rownumber"
      FROM "TLM_SHIPMENT_W_CAl_FILTERED" "tlm_shipment_joined_w_cal_filtered"
      LEFT JOIN (
        SELECT 
            "TC_OBJECT_ID" AS "TC_OBJECT_ID",
            1 AS "invoice_shipping_id"
          FROM (
            SELECT *
              FROM "DOMESTIC_SHIPPING_FREIGHT_W_CAL_FILTERED_TEST_TC_OBJECT_ID" "domestic_shipping_freight_w_cal_filtered_test_TC_Object_ID"
            ) "withoutcomputedcols_query"
        ) "domestic_shipping_freight_w_cal_filtered_test_TC_Object_ID"
        ON "tlm_shipment_joined_w_cal_filtered"."TC_SHIPMENT_ID" = "domestic_shipping_freight_w_cal_filtered_test_TC_Object_ID"."TC_OBJECT_ID"
    ) "unfiltered_query"
  WHERE ("invoice_shipping_id" != 1 OR "invoice_shipping_id" IS NULL AND 1 IS NOT NULL OR "invoice_shipping_id" IS NOT NULL AND 1 IS NULL)
        AND "rownumber" = 1
        )

        SELECT * FROM 
        (
        SELECT 
    "SHIPMENT_ID" AS "SHIPMENT_ID",
    "TC_COMPANY_ID" AS "TC_COMPANY_ID",
    "RS_AREA_ID" AS "RS_AREA_ID",
    "TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID",
    "PP_SHIPMENT_ID" AS "PP_SHIPMENT_ID",
    "SHIPMENT_STATUS" AS "SHIPMENT_STATUS",
    "UPDATE_SENT" AS "UPDATE_SENT",
    "BUSINESS_PROCESS" AS "BUSINESS_PROCESS",
    "CREATION_TYPE" AS "CREATION_TYPE",
    "CONS_RUN_ID" AS "CONS_RUN_ID",
    "IS_CANCELLED" AS "IS_CANCELLED",
    "RS_TYPE" AS "RS_TYPE",
    "RS_CONFIG_ID" AS "RS_CONFIG_ID",
    "RS_CONFIG_CYCLE_ID" AS "RS_CONFIG_CYCLE_ID",
    "CONFIG_CYCLE_SEQ" AS "CONFIG_CYCLE_SEQ",
    "CYCLE_DEADLINE_DTTM" AS "CYCLE_DEADLINE_DTTM",
    "CYCLE_EXECUTION_DTTM" AS "CYCLE_EXECUTION_DTTM",
    "LAST_RS_NOTIFICATION_DTTM" AS "LAST_RS_NOTIFICATION_DTTM",
    "CFMF_STATUS" AS "CFMF_STATUS",
    "AVAILABLE_DTTM" AS "AVAILABLE_DTTM",
    "CMID" AS "CMID",
    "CM_DISCOUNT" AS "CM_DISCOUNT",
    "O_FACILITY_NUMBER" AS "O_FACILITY_NUMBER",
    "O_FACILITY_ID" AS "O_FACILITY_ID",
    "O_ADDRESS" AS "O_ADDRESS",
    "O_CITY" AS "O_CITY",
    "O_STATE_PROV" AS "O_STATE_PROV",
    "O_POSTAL_CODE" AS "O_POSTAL_CODE",
    "O_COUNTY" AS "O_COUNTY",
    "O_COUNTRY_CODE" AS "O_COUNTRY_CODE",
    "D_FACILITY_NUMBER" AS "D_FACILITY_NUMBER",
    "D_FACILITY_ID" AS "D_FACILITY_ID",
    "D_ADDRESS" AS "D_ADDRESS",
    "D_CITY" AS "D_CITY",
    "D_STATE_PROV" AS "D_STATE_PROV",
    "D_POSTAL_CODE" AS "D_POSTAL_CODE",
    "D_COUNTY" AS "D_COUNTY",
    "D_COUNTRY_CODE" AS "D_COUNTRY_CODE",
    "DISTANCE" AS "DISTANCE",
    "DIRECT_DISTANCE" AS "DIRECT_DISTANCE",
    "OUT_OF_ROUTE_DISTANCE" AS "OUT_OF_ROUTE_DISTANCE",
    "DISTANCE_UOM" AS "DISTANCE_UOM",
    "BUSINESS_PARTNER_ID" AS "BUSINESS_PARTNER_ID",
    "COMMODITY_CLASS" AS "COMMODITY_CLASS",
    "IS_HAZMAT" AS "IS_HAZMAT",
    "IS_PERISHABLE" AS "IS_PERISHABLE",
    "BILLING_METHOD" AS "BILLING_METHOD",
    "DSG_CARRIER_CODE" AS "DSG_CARRIER_CODE",
    "REC_CMID" AS "REC_CMID",
    "REC_CM_SHIPMENT_ID" AS "REC_CM_SHIPMENT_ID",
    "ASSIGNED_CARRIER_CODE" AS "ASSIGNED_CARRIER_CODE",
    "SHIPMENT_REF_ID" AS "SHIPMENT_REF_ID",
    "BILL_TO_CODE" AS "BILL_TO_CODE",
    "BILL_TO_TITLE" AS "BILL_TO_TITLE",
    "BILL_TO_NAME" AS "BILL_TO_NAME",
    "BILL_TO_ADDRESS" AS "BILL_TO_ADDRESS",
    "BILL_TO_CITY" AS "BILL_TO_CITY",
    "BILL_TO_STATE_PROV" AS "BILL_TO_STATE_PROV",
    "BILL_TO_POSTAL_CODE" AS "BILL_TO_POSTAL_CODE",
    "BILL_TO_COUNTRY_CODE" AS "BILL_TO_COUNTRY_CODE",
    "BILL_TO_PHONE_NUMBER" AS "BILL_TO_PHONE_NUMBER",
    "PURCHASE_ORDER" AS "PURCHASE_ORDER",
    "PRO_NUMBER" AS "PRO_NUMBER",
    "TRANS_RESP_CODE" AS "TRANS_RESP_CODE",
    "BASELINE_COST" AS "BASELINE_COST",
    "ESTIMATED_COST" AS "ESTIMATED_COST",
    "LINEHAUL_COST" AS "LINEHAUL_COST",
    "ACCESSORIAL_COST" AS "ACCESSORIAL_COST",
    "STOP_COST" AS "STOP_COST",
    "ESTIMATED_SAVINGS" AS "ESTIMATED_SAVINGS",
    "SPOT_CHARGE" AS "SPOT_CHARGE",
    "CURRENCY_CODE" AS "CURRENCY_CODE",
    "PICKUP_START_DTTM" AS "PICKUP_START_DTTM",
    "PICKUP_END_DTTM" AS "PICKUP_END_DTTM",
    "DELIVERY_START_DTTM" AS "DELIVERY_START_DTTM",
    "DELIVERY_END_DTTM" AS "DELIVERY_END_DTTM",
    "NUM_STOPS" AS "NUM_STOPS",
    "NUM_DOCKS" AS "NUM_DOCKS",
    "ON_TIME_INDICATOR" AS "ON_TIME_INDICATOR",
    "HAS_NOTES" AS "HAS_NOTES",
    "HAS_ALERTS" AS "HAS_ALERTS",
    "HAS_IMPORT_ERROR" AS "HAS_IMPORT_ERROR",
    "HAS_SOFT_CHECK_ERROR" AS "HAS_SOFT_CHECK_ERROR",
    "HAS_TRACKING_MSG" AS "HAS_TRACKING_MSG",
    "TRACKING_MSG_PROBLEM" AS "TRACKING_MSG_PROBLEM",
    "REC_LINEHAUL_COST" AS "REC_LINEHAUL_COST",
    "REC_ACCESSORIAL_COST" AS "REC_ACCESSORIAL_COST",
    "REC_TOTAL_COST" AS "REC_TOTAL_COST",
    "CYCLE_RESP_DEADLINE_TZ" AS "CYCLE_RESP_DEADLINE_TZ",
    "TENDER_RESP_DEADLINE_TZ" AS "TENDER_RESP_DEADLINE_TZ",
    "PICKUP_TZ" AS "PICKUP_TZ",
    "DELIVERY_TZ" AS "DELIVERY_TZ",
    "ASSIGNED_LANE_ID" AS "ASSIGNED_LANE_ID",
    "ASSIGNED_LANE_DETAIL_ID" AS "ASSIGNED_LANE_DETAIL_ID",
    "REC_SPOT_CHARGE" AS "REC_SPOT_CHARGE",
    "REC_LANE_ID" AS "REC_LANE_ID",
    "REC_LANE_DETAIL_ID" AS "REC_LANE_DETAIL_ID",
    "TENDER_DTTM" AS "TENDER_DTTM",
    "O_STOP_LOCATION_NAME" AS "O_STOP_LOCATION_NAME",
    "D_STOP_LOCATION_NAME" AS "D_STOP_LOCATION_NAME",
    "ASSIGNED_CM_SHIPMENT_ID" AS "ASSIGNED_CM_SHIPMENT_ID",
    "REC_CM_DISCOUNT" AS "REC_CM_DISCOUNT",
    "REC_STOP_COST" AS "REC_STOP_COST",
    "LAST_SELECTOR_RUN_DTTM" AS "LAST_SELECTOR_RUN_DTTM",
    "LAST_CM_OPTION_GEN_DTTM" AS "LAST_CM_OPTION_GEN_DTTM",
    "IS_CM_OPTION_GEN_ACTIVE" AS "IS_CM_OPTION_GEN_ACTIVE",
    "RS_CYCLE_REMAINING" AS "RS_CYCLE_REMAINING",
    "IS_TIME_FEAS_ENABLED" AS "IS_TIME_FEAS_ENABLED",
    "EXT_SYS_SHIPMENT_ID" AS "EXT_SYS_SHIPMENT_ID",
    "EXTRACTION_DTTM" AS "EXTRACTION_DTTM",
    "ASSIGNED_BROKER_CARRIER_CODE" AS "ASSIGNED_BROKER_CARRIER_CODE",
    "USE_BROKER_AS_CARRIER" AS "USE_BROKER_AS_CARRIER",
    "BROKER_REF" AS "BROKER_REF",
    "RATING_QUALIFIER" AS "RATING_QUALIFIER",
    "STATUS_CHANGE_DTTM" AS "STATUS_CHANGE_DTTM",
    "BUDG_TOTAL_COST" AS "BUDG_TOTAL_COST",
    "NORMALIZED_MARGIN" AS "NORMALIZED_MARGIN",
    "NORMALIZED_TOTAL_COST" AS "NORMALIZED_TOTAL_COST",
    "BUDG_NORMALIZED_TOTAL_COST" AS "BUDG_NORMALIZED_TOTAL_COST",
    "REC_BUDG_LINEHAUL_COST" AS "REC_BUDG_LINEHAUL_COST",
    "REC_BUDG_STOP_COST" AS "REC_BUDG_STOP_COST",
    "REC_BUDG_CM_DISCOUNT" AS "REC_BUDG_CM_DISCOUNT",
    "REC_BUDG_ACCESSORIAL_COST" AS "REC_BUDG_ACCESSORIAL_COST",
    "REC_BUDG_TOTAL_COST" AS "REC_BUDG_TOTAL_COST",
    "REC_MARGIN" AS "REC_MARGIN",
    "REC_NORMALIZED_MARGIN" AS "REC_NORMALIZED_MARGIN",
    "REC_NORMALIZED_TOTAL_COST" AS "REC_NORMALIZED_TOTAL_COST",
    "REC_BUDG_NORMALIZED_TOTAL_COST" AS "REC_BUDG_NORMALIZED_TOTAL_COST",
    "BUDG_CURRENCY_CODE" AS "BUDG_CURRENCY_CODE",
    "SPOT_CHARGE_CURRENCY_CODE" AS "SPOT_CHARGE_CURRENCY_CODE",
    "REC_CURRENCY_CODE" AS "REC_CURRENCY_CODE",
    "REC_BUDG_CURRENCY_CODE" AS "REC_BUDG_CURRENCY_CODE",
    "REC_SPOT_CHARGE_CURRENCY_CODE" AS "REC_SPOT_CHARGE_CURRENCY_CODE",
    "RATING_LANE_ID" AS "RATING_LANE_ID",
    "FRT_REV_RATING_LANE_ID" AS "FRT_REV_RATING_LANE_ID",
    "REC_RATING_LANE_ID" AS "REC_RATING_LANE_ID",
    "REC_BUDG_RATING_LANE_ID" AS "REC_BUDG_RATING_LANE_ID",
    "RATING_LANE_DETAIL_ID" AS "RATING_LANE_DETAIL_ID",
    "FRT_REV_RATING_LANE_DETAIL_ID" AS "FRT_REV_RATING_LANE_DETAIL_ID",
    "REC_RATING_LANE_DETAIL_ID" AS "REC_RATING_LANE_DETAIL_ID",
    "REC_BUDG_RATING_LANE_DETAIL_ID" AS "REC_BUDG_RATING_LANE_DETAIL_ID",
    "BUDG_CM_DISCOUNT" AS "BUDG_CM_DISCOUNT",
    "NORMALIZED_BASELINE_COST" AS "NORMALIZED_BASELINE_COST",
    "BASELINE_COST_CURRENCY_CODE" AS "BASELINE_COST_CURRENCY_CODE",
    "REPORTED_COST" AS "REPORTED_COST",
    "TRACTOR_NUMBER" AS "TRACTOR_NUMBER",
    "IS_AUTO_DELIVERED" AS "IS_AUTO_DELIVERED",
    "SHIPMENT_TYPE" AS "SHIPMENT_TYPE",
    "ORIG_BUDG_TOTAL_COST" AS "ORIG_BUDG_TOTAL_COST",
    "ACCESSORIAL_COST_TO_CARRIER" AS "ACCESSORIAL_COST_TO_CARRIER",
    "CARRIER_CHARGE" AS "CARRIER_CHARGE",
    "ACTUAL_COST" AS "ACTUAL_COST",
    "EARNED_INCOME" AS "EARNED_INCOME",
    "SENT_TO_PKMS" AS "SENT_TO_PKMS",
    "IS_SHIPMENT_RECONCILED" AS "IS_SHIPMENT_RECONCILED",
    "DELIVERY_REQ" AS "DELIVERY_REQ",
    "DROPOFF_PICKUP" AS "DROPOFF_PICKUP",
    "PACKAGING" AS "PACKAGING",
    "SENT_TO_PKMS_DTTM" AS "SENT_TO_PKMS_DTTM",
    "WMS_STATUS_CODE" AS "WMS_STATUS_CODE",
    "SPOT_CHARGE_AND_PAYEE_ACC" AS "SPOT_CHARGE_AND_PAYEE_ACC",
    "SPOT_CHARGE_AND_PAYEE_ACC_CC" AS "SPOT_CHARGE_AND_PAYEE_ACC_CC",
    "NORM_SPOT_CHARGE_AND_PAYEE_ACC" AS "NORM_SPOT_CHARGE_AND_PAYEE_ACC",
    "FACILITY_SCHEDULE_ID" AS "FACILITY_SCHEDULE_ID",
    "EARNED_INCOME_CURRENCY_CODE" AS "EARNED_INCOME_CURRENCY_CODE",
    "ACTUAL_COST_CURRENCY_CODE" AS "ACTUAL_COST_CURRENCY_CODE",
    "SHIPMENT_RECON_DTTM" AS "SHIPMENT_RECON_DTTM",
    "PLN_RATING_LANE_ID" AS "PLN_RATING_LANE_ID",
    "PLN_RATING_LANE_DETAIL_ID" AS "PLN_RATING_LANE_DETAIL_ID",
    "PLN_TOTAL_COST" AS "PLN_TOTAL_COST",
    "PLN_LINEHAUL_COST" AS "PLN_LINEHAUL_COST",
    "PLN_TOTAL_ACCESSORIAL_COST" AS "PLN_TOTAL_ACCESSORIAL_COST",
    "PLN_STOP_OFF_COST" AS "PLN_STOP_OFF_COST",
    "PLN_NORMALIZED_TOTAL_COST" AS "PLN_NORMALIZED_TOTAL_COST",
    "PLN_CURRENCY_CODE" AS "PLN_CURRENCY_CODE",
    "PLN_ACCESSORL_COST_TO_CARRIER" AS "PLN_ACCESSORL_COST_TO_CARRIER",
    "PLN_CARRIER_CHARGE" AS "PLN_CARRIER_CHARGE",
    "WAYPOINT_TOTAL_COST" AS "WAYPOINT_TOTAL_COST",
    "WAYPOINT_HANDLING_COST" AS "WAYPOINT_HANDLING_COST",
    "GRS_OPERATION" AS "GRS_OPERATION",
    "IS_GRS_OPT_CYCLE_RUNNING" AS "IS_GRS_OPT_CYCLE_RUNNING",
    "IS_MANUAL_ASSIGN" AS "IS_MANUAL_ASSIGN",
    "LAST_RUN_GRS_DTTM" AS "LAST_RUN_GRS_DTTM",
    "GRS_MAX_SHIPMENT_STATUS" AS "GRS_MAX_SHIPMENT_STATUS",
    "PRIORITY_TYPE" AS "PRIORITY_TYPE",
    "MV_CURRENCY_CODE" AS "MV_CURRENCY_CODE",
    "PROD_SCHED_REF_NUMBER" AS "PROD_SCHED_REF_NUMBER",
    "COMMODITY_CODE_ID" AS "COMMODITY_CODE_ID",
    "UN_NUMBER_ID" AS "UN_NUMBER_ID",
    "CONTRACT_NUMBER" AS "CONTRACT_NUMBER",
    "BOOKING_REF_SHIPPER" AS "BOOKING_REF_SHIPPER",
    "BOOKING_REF_CARRIER" AS "BOOKING_REF_CARRIER",
    "BK_RESOURCE_REF_EXTERNAL" AS "BK_RESOURCE_REF_EXTERNAL",
    "BK_RESOURCE_NAME_EXTERNAL" AS "BK_RESOURCE_NAME_EXTERNAL",
    "BK_O_FACILITY_ID" AS "BK_O_FACILITY_ID",
    "BK_D_FACILITY_ID" AS "BK_D_FACILITY_ID",
    "BK_MASTER_AIRWAY_BILL" AS "BK_MASTER_AIRWAY_BILL",
    "BK_FORWARDER_AIRWAY_BILL" AS "BK_FORWARDER_AIRWAY_BILL",
    "ASSIGNED_SCNDR_CARRIER_CODE" AS "ASSIGNED_SCNDR_CARRIER_CODE",
    "CUSTOMER_CREDIT_LIMIT_ID" AS "CUSTOMER_CREDIT_LIMIT_ID",
    "SHIPMENT_LEG_TYPE" AS "SHIPMENT_LEG_TYPE",
    "SHIPMENT_CLOSED_INDICATOR" AS "SHIPMENT_CLOSED_INDICATOR",
    "OCEAN_ROUTING_STAGE" AS "OCEAN_ROUTING_STAGE",
    "BK_DEPARTURE_DTTM" AS "BK_DEPARTURE_DTTM",
    "BK_DEPARTURE_TZ" AS "BK_DEPARTURE_TZ",
    "BK_ARRIVAL_DTTM" AS "BK_ARRIVAL_DTTM",
    "BK_ARRIVAL_TZ" AS "BK_ARRIVAL_TZ",
    "BK_PICKUP_DTTM" AS "BK_PICKUP_DTTM",
    "BK_PICKUP_TZ" AS "BK_PICKUP_TZ",
    "BK_CUTOFF_DTTM" AS "BK_CUTOFF_DTTM",
    "BK_CUTOFF_TZ" AS "BK_CUTOFF_TZ",
    "NUM_CHARGE_LAYOVERS" AS "NUM_CHARGE_LAYOVERS",
    "RATE_TYPE" AS "RATE_TYPE",
    "RATE_UOM" AS "RATE_UOM",
    "PICK_START_DTTM" AS "PICK_START_DTTM",
    "PAPERWORK_START_DTTM" AS "PAPERWORK_START_DTTM",
    "VEHICLE_CHECK_START_DTTM" AS "VEHICLE_CHECK_START_DTTM",
    "SHIPMENT_START_DTTM" AS "SHIPMENT_START_DTTM",
    "SHIPMENT_END_DTTM" AS "SHIPMENT_END_DTTM",
    "FEASIBLE_DRIVER_TYPE" AS "FEASIBLE_DRIVER_TYPE",
    "WAVE_ID" AS "WAVE_ID",
    "ESTIMATED_DISPATCH_DTTM" AS "ESTIMATED_DISPATCH_DTTM",
    "TOTAL_TIME" AS "TOTAL_TIME",
    "LOC_REFERENCE" AS "LOC_REFERENCE",
    "BK_O_FACILITY_ALIAS_ID" AS "BK_O_FACILITY_ALIAS_ID",
    "BK_D_FACILITY_ALIAS_ID" AS "BK_D_FACILITY_ALIAS_ID",
    "EQUIP_UTIL_PER" AS "EQUIP_UTIL_PER",
    "MOVE_TYPE" AS "MOVE_TYPE",
    "DRIVER_TYPE_ID" AS "DRIVER_TYPE_ID",
    "EQUIPMENT_TYPE" AS "EQUIPMENT_TYPE",
    "RADIAL_DISTANCE" AS "RADIAL_DISTANCE",
    "RADIAL_DISTANCE_UOM" AS "RADIAL_DISTANCE_UOM",
    "DESIGNATED_TRACTOR_CODE" AS "DESIGNATED_TRACTOR_CODE",
    "DESIGNATED_DRIVER_TYPE" AS "DESIGNATED_DRIVER_TYPE",
    "IS_WAVE_MAN_CHANGED" AS "IS_WAVE_MAN_CHANGED",
    "RETAIN_CONSOLIDATOR_TIMES" AS "RETAIN_CONSOLIDATOR_TIMES",
    "TARIFF" AS "TARIFF",
    "MIN_RATE" AS "MIN_RATE",
    "FIRST_UPDATE_SENT_TO_PKMS" AS "FIRST_UPDATE_SENT_TO_PKMS",
    "EVENT_IND_TYPEID" AS "EVENT_IND_TYPEID",
    "TANDEM_PATH_ID" AS "TANDEM_PATH_ID",
    "O_TANDEM_FACILITY" AS "O_TANDEM_FACILITY",
    "D_TANDEM_FACILITY" AS "D_TANDEM_FACILITY",
    "O_TANDEM_FACILITY_ALIAS" AS "O_TANDEM_FACILITY_ALIAS",
    "D_TANDEM_FACILITY_ALIAS" AS "D_TANDEM_FACILITY_ALIAS",
    "DELAY_TYPE" AS "DELAY_TYPE",
    "ASSIGNED_CARRIER_ID" AS "ASSIGNED_CARRIER_ID",
    "DSG_CARRIER_ID" AS "DSG_CARRIER_ID",
    "REC_CARRIER_ID" AS "REC_CARRIER_ID",
    "FEASIBLE_CARRIER_ID" AS "FEASIBLE_CARRIER_ID",
    "PAYEE_CARRIER_ID" AS "PAYEE_CARRIER_ID",
    "SCNDR_CARRIER_ID" AS "SCNDR_CARRIER_ID",
    "BROKER_CARRIER_ID" AS "BROKER_CARRIER_ID",
    "ASSIGNED_SCNDR_CARRIER_ID" AS "ASSIGNED_SCNDR_CARRIER_ID",
    "DSG_SCNDR_CARRIER_ID" AS "DSG_SCNDR_CARRIER_ID",
    "ASSIGNED_BROKER_CARRIER_ID" AS "ASSIGNED_BROKER_CARRIER_ID",
    "LH_PAYEE_CARRIER_ID" AS "LH_PAYEE_CARRIER_ID",
    "REC_BROKER_CARRIER_ID" AS "REC_BROKER_CARRIER_ID",
    "ASSIGNED_EQUIPMENT_ID" AS "ASSIGNED_EQUIPMENT_ID",
    "DSG_EQUIPMENT_ID" AS "DSG_EQUIPMENT_ID",
    "FEASIBLE_EQUIPMENT_ID" AS "FEASIBLE_EQUIPMENT_ID",
    "FEASIBLE_EQUIPMENT2_ID" AS "FEASIBLE_EQUIPMENT2_ID",
    "REC_EQUIPMENT_ID" AS "REC_EQUIPMENT_ID",
    "ASSIGNED_MOT_ID" AS "ASSIGNED_MOT_ID",
    "DSG_MOT_ID" AS "DSG_MOT_ID",
    "FEASIBLE_MOT_ID" AS "FEASIBLE_MOT_ID",
    "REC_MOT_ID" AS "REC_MOT_ID",
    "PRODUCT_CLASS_ID" AS "PRODUCT_CLASS_ID",
    "PROTECTION_LEVEL_ID" AS "PROTECTION_LEVEL_ID",
    "ASSIGNED_SERVICE_LEVEL_ID" AS "ASSIGNED_SERVICE_LEVEL_ID",
    "DSG_SERVICE_LEVEL_ID" AS "DSG_SERVICE_LEVEL_ID",
    "FEASIBLE_SERVICE_LEVEL_ID" AS "FEASIBLE_SERVICE_LEVEL_ID",
    "REC_SERVICE_LEVEL_ID" AS "REC_SERVICE_LEVEL_ID",
    "HAS_EM_NOTIFY_FLAG" AS "HAS_EM_NOTIFY_FLAG",
    "REGION_ID" AS "REGION_ID",
    "INBOUND_REGION_ID" AS "INBOUND_REGION_ID",
    "OUTBOUND_REGION_ID" AS "OUTBOUND_REGION_ID",
    "FINANCIAL_WT" AS "FINANCIAL_WT",
    "IS_BOOKING_REQUIRED" AS "IS_BOOKING_REQUIRED",
    "TOTAL_COST_EXCL_TAX" AS "TOTAL_COST_EXCL_TAX",
    "TOTAL_TAX_AMOUNT" AS "TOTAL_TAX_AMOUNT",
    "IS_ASSOCIATED_TO_OUTBOUND" AS "IS_ASSOCIATED_TO_OUTBOUND",
    "RECEIVED_DTTM" AS "RECEIVED_DTTM",
    "BOOKING_ID" AS "BOOKING_ID",
    "IS_MISROUTED" AS "IS_MISROUTED",
    "FEASIBLE_CARRIER_CODE" AS "FEASIBLE_CARRIER_CODE",
    "SHIPMENT_WIN_ADJ_FLAG" AS "SHIPMENT_WIN_ADJ_FLAG",
    "DT_PARAM_SET_ID" AS "DT_PARAM_SET_ID",
    "MERCHANDIZING_DEPARTMENT_ID" AS "MERCHANDIZING_DEPARTMENT_ID",
    "STATIC_ROUTE_ID" AS "STATIC_ROUTE_ID",
    "IS_FILO" AS "IS_FILO",
    "IS_COOLER_AT_NOSE" AS "IS_COOLER_AT_NOSE",
    "AUTH_NBR" AS "AUTH_NBR",
    "CONS_LOCN_ID" AS "CONS_LOCN_ID",
    "RTE_TYPE" AS "RTE_TYPE",
    "TRLR_TYPE" AS "TRLR_TYPE",
    "TRLR_SIZE" AS "TRLR_SIZE",
    "CONS_ADDR_CODE" AS "CONS_ADDR_CODE",
    "HUB_ID" AS "HUB_ID",
    "TRLR_GEN_CODE" AS "TRLR_GEN_CODE",
    "MAX_NBR_OF_CTNS" AS "MAX_NBR_OF_CTNS",
    "APPT_DOOR_SCHED_TYPE" AS "APPT_DOOR_SCHED_TYPE",
    "CREATED_SOURCE_TYPE" AS "CREATED_SOURCE_TYPE",
    "CREATED_SOURCE" AS "CREATED_SOURCE",
    "CREATED_DTTM" AS "CREATED_DTTM",
    "LAST_UPDATED_SOURCE_TYPE" AS "LAST_UPDATED_SOURCE_TYPE",
    "LAST_UPDATED_SOURCE" AS "LAST_UPDATED_SOURCE",
    "LAST_UPDATED_DTTM" AS "LAST_UPDATED_DTTM",
    "DSG_SCNDR_CARRIER_CODE" AS "DSG_SCNDR_CARRIER_CODE",
    "LH_PAYEE_CARRIER_CODE" AS "LH_PAYEE_CARRIER_CODE",
    "REC_BROKER_CARRIER_CODE" AS "REC_BROKER_CARRIER_CODE",
    "REC_CARRIER_CODE" AS "REC_CARRIER_CODE",
    "LPN_ASSIGNMENT_STOPPED" AS "LPN_ASSIGNMENT_STOPPED",
    "SEAL_NUMBER" AS "SEAL_NUMBER",
    "HIBERNATE_VERSION" AS "HIBERNATE_VERSION",
    "SHIP_GROUP_ID" AS "SHIP_GROUP_ID",
    "RATE" AS "RATE",
    "MONETARY_VALUE" AS "MONETARY_VALUE",
    "DOOR" AS "DOOR",
    "RTE_TYPE_1" AS "RTE_TYPE_1",
    "RTE_TYPE_2" AS "RTE_TYPE_2",
    "SCHEDULED_PICKUP_DTTM" AS "SCHEDULED_PICKUP_DTTM",
    "MANIFEST_ID" AS "MANIFEST_ID",
    "DAYS_TO_DELIVER" AS "DAYS_TO_DELIVER",
    "SED_GENERATED_FLAG" AS "SED_GENERATED_FLAG",
    "SERV_AREA_CODE" AS "SERV_AREA_CODE",
    "TENDER_RESP_DEADLINE_DTTM" AS "TENDER_RESP_DEADLINE_DTTM",
    "PRINT_CONS_BOL" AS "PRINT_CONS_BOL",
    "LEFT_WT" AS "LEFT_WT",
    "RIGHT_WT" AS "RIGHT_WT",
    "LANE_NAME" AS "LANE_NAME",
    "DECLARED_VALUE" AS "DECLARED_VALUE",
    "DV_CURRENCY_CODE" AS "DV_CURRENCY_CODE",
    "COD_AMOUNT" AS "COD_AMOUNT",
    "CUSTOMER_ID" AS "CUSTOMER_ID",
    "CUST_FRGT_CHARGE" AS "CUST_FRGT_CHARGE",
    "COD_CURRENCY_CODE" AS "COD_CURRENCY_CODE",
    "PLANNED_WEIGHT" AS "PLANNED_WEIGHT",
    "WEIGHT_UOM_ID_BASE" AS "WEIGHT_UOM_ID_BASE",
    "PLANNED_VOLUME" AS "PLANNED_VOLUME",
    "VOLUME_UOM_ID_BASE" AS "VOLUME_UOM_ID_BASE",
    "SIZE1_VALUE" AS "SIZE1_VALUE",
    "SIZE1_UOM_ID" AS "SIZE1_UOM_ID",
    "SIZE2_VALUE" AS "SIZE2_VALUE",
    "SIZE2_UOM_ID" AS "SIZE2_UOM_ID",
    "ASSIGNED_SHIP_VIA" AS "ASSIGNED_SHIP_VIA",
    "INSURANCE_STATUS" AS "INSURANCE_STATUS",
    "RTE_SWC_NBR" AS "RTE_SWC_NBR",
    "RTE_TO" AS "RTE_TO",
    "BILL_OF_LADING_NUMBER" AS "BILL_OF_LADING_NUMBER",
    "TRAILER_NUMBER" AS "TRAILER_NUMBER",
    "TRANS_PLAN_OWNER" AS "TRANS_PLAN_OWNER",
    "TOTAL_REVENUE_CURRENCY_CODE" AS "TOTAL_REVENUE_CURRENCY_CODE",
    "TOTAL_REVENUE" AS "TOTAL_REVENUE",
    "FRT_REV_SPOT_CHARGE_CURR_CODE" AS "FRT_REV_SPOT_CHARGE_CURR_CODE",
    "NORMALIZED_TOTAL_REVENUE" AS "NORMALIZED_TOTAL_REVENUE",
    "FRT_REV_SPOT_CHARGE" AS "FRT_REV_SPOT_CHARGE",
    "DSG_VOYAGE_FLIGHT" AS "DSG_VOYAGE_FLIGHT",
    "FEASIBLE_VOYAGE_FLIGHT" AS "FEASIBLE_VOYAGE_FLIGHT",
    "CURRENCY_DTTM" AS "CURRENCY_DTTM",
    "FRT_REV_LINEHAUL_CHARGE" AS "FRT_REV_LINEHAUL_CHARGE",
    "FRT_REV_STOP_CHARGE" AS "FRT_REV_STOP_CHARGE",
    "FRT_REV_ACCESSORIAL_CHARGE" AS "FRT_REV_ACCESSORIAL_CHARGE",
    "MARGIN" AS "MARGIN",
    "INCOTERM_ID" AS "INCOTERM_ID",
    "ORDER_QTY" AS "ORDER_QTY",
    "QTY_UOM_ID" AS "QTY_UOM_ID",
    "REF_SHIPMENT_NBR" AS "REF_SHIPMENT_NBR",
    "STAGING_LOCN_ID" AS "STAGING_LOCN_ID",
    "LOADING_SEQ_ORD" AS "LOADING_SEQ_ORD",
    "HAZMAT_CERT_CONTACT" AS "HAZMAT_CERT_CONTACT",
    "HAZMAT_CERT_DECLARATION" AS "HAZMAT_CERT_DECLARATION",
    "CDC_TIMESTAMP" AS "CDC_TIMESTAMP",
    "OPERATION_TYPE" AS "OPERATION_TYPE",
    "ARCHIVED_DTTM" AS "ARCHIVED_DTTM",
    "ORIGIN" AS "ORIGIN",
    "FINAL_DESTINATION" AS "FINAL_DESTINATION",
    "actual_delivery_date_parsed" AS "actual_delivery_date_parsed",
    "wood_pellet" AS "wood_pellet",
    "act_del_MERCH_YEAR" AS "act_del_MERCH_YEAR",
    "act_del_YEAR_WEEK" AS "act_del_YEAR_WEEK",
    "act_del_YEAR_QUARTER" AS "act_del_YEAR_QUARTER",
    "act_del_YEAR_PERIOD" AS "act_del_YEAR_PERIOD",
    "invoice_shipping_id" AS "invoice_shipping_id",
    "TOTAL_COST" AS "TOTAL_COST",
    "org_Facility_Code" AS "org_Facility_Code",
    "org_Facility_Name" AS "org_Facility_Name",
    "org_Facility_Type" AS "org_Facility_Type",
    "dest_Facility_Code" AS "dest_Facility_Code",
    "dest_Facility_Name" AS "dest_Facility_Name",
    "dest_Facility_Type" AS "dest_Facility_Type",
    CASE WHEN "org_Facility_Type" = 'VENDOR' THEN 'Inbound' ELSE 'Outbound' END AS "inbound_flag"
  FROM (
    SELECT 
        tsw."SHIPMENT_ID" AS "SHIPMENT_ID",
        tsw."TC_COMPANY_ID" AS "TC_COMPANY_ID",
        tsw."RS_AREA_ID" AS "RS_AREA_ID",
        tsw."TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID",
        tsw."PP_SHIPMENT_ID" AS "PP_SHIPMENT_ID",
        tsw."SHIPMENT_STATUS" AS "SHIPMENT_STATUS",
        tsw."UPDATE_SENT" AS "UPDATE_SENT",
        tsw."BUSINESS_PROCESS" AS "BUSINESS_PROCESS",
        tsw."CREATION_TYPE" AS "CREATION_TYPE",
        tsw."CONS_RUN_ID" AS "CONS_RUN_ID",
        tsw."IS_CANCELLED" AS "IS_CANCELLED",
        tsw."RS_TYPE" AS "RS_TYPE",
        tsw."RS_CONFIG_ID" AS "RS_CONFIG_ID",
        tsw."RS_CONFIG_CYCLE_ID" AS "RS_CONFIG_CYCLE_ID",
        tsw."CONFIG_CYCLE_SEQ" AS "CONFIG_CYCLE_SEQ",
        tsw."CYCLE_DEADLINE_DTTM" AS "CYCLE_DEADLINE_DTTM",
        tsw."CYCLE_EXECUTION_DTTM" AS "CYCLE_EXECUTION_DTTM",
        tsw."LAST_RS_NOTIFICATION_DTTM" AS "LAST_RS_NOTIFICATION_DTTM",
        tsw."CFMF_STATUS" AS "CFMF_STATUS",
        tsw."AVAILABLE_DTTM" AS "AVAILABLE_DTTM",
        tsw."CMID" AS "CMID",
        tsw."CM_DISCOUNT" AS "CM_DISCOUNT",
        tsw."O_FACILITY_NUMBER" AS "O_FACILITY_NUMBER",
        tsw."O_FACILITY_ID" AS "O_FACILITY_ID",
        tsw."O_ADDRESS" AS "O_ADDRESS",
        tsw."O_CITY" AS "O_CITY",
        tsw."O_STATE_PROV" AS "O_STATE_PROV",
        tsw."O_POSTAL_CODE" AS "O_POSTAL_CODE",
        tsw."O_COUNTY" AS "O_COUNTY",
        tsw."O_COUNTRY_CODE" AS "O_COUNTRY_CODE",
        tsw."D_FACILITY_NUMBER" AS "D_FACILITY_NUMBER",
        tsw."D_FACILITY_ID" AS "D_FACILITY_ID",
        tsw."D_ADDRESS" AS "D_ADDRESS",
        tsw."D_CITY" AS "D_CITY",
        tsw."D_STATE_PROV" AS "D_STATE_PROV",
        tsw."D_POSTAL_CODE" AS "D_POSTAL_CODE",
        tsw."D_COUNTY" AS "D_COUNTY",
        tsw."D_COUNTRY_CODE" AS "D_COUNTRY_CODE",
        tsw."DISTANCE" AS "DISTANCE",
        tsw."DIRECT_DISTANCE" AS "DIRECT_DISTANCE",
        tsw."OUT_OF_ROUTE_DISTANCE" AS "OUT_OF_ROUTE_DISTANCE",
        tsw."DISTANCE_UOM" AS "DISTANCE_UOM",
        tsw."BUSINESS_PARTNER_ID" AS "BUSINESS_PARTNER_ID",
        tsw."COMMODITY_CLASS" AS "COMMODITY_CLASS",
        tsw."IS_HAZMAT" AS "IS_HAZMAT",
        tsw."IS_PERISHABLE" AS "IS_PERISHABLE",
        tsw."BILLING_METHOD" AS "BILLING_METHOD",
        tsw."DSG_CARRIER_CODE" AS "DSG_CARRIER_CODE",
        tsw."REC_CMID" AS "REC_CMID",
        tsw."REC_CM_SHIPMENT_ID" AS "REC_CM_SHIPMENT_ID",
        tsw."ASSIGNED_CARRIER_CODE" AS "ASSIGNED_CARRIER_CODE",
        tsw."SHIPMENT_REF_ID" AS "SHIPMENT_REF_ID",
        tsw."BILL_TO_CODE" AS "BILL_TO_CODE",
        tsw."BILL_TO_TITLE" AS "BILL_TO_TITLE",
        tsw."BILL_TO_NAME" AS "BILL_TO_NAME",
        tsw."BILL_TO_ADDRESS" AS "BILL_TO_ADDRESS",
        tsw."BILL_TO_CITY" AS "BILL_TO_CITY",
        tsw."BILL_TO_STATE_PROV" AS "BILL_TO_STATE_PROV",
        tsw."BILL_TO_POSTAL_CODE" AS "BILL_TO_POSTAL_CODE",
        tsw."BILL_TO_COUNTRY_CODE" AS "BILL_TO_COUNTRY_CODE",
        tsw."BILL_TO_PHONE_NUMBER" AS "BILL_TO_PHONE_NUMBER",
        tsw."PURCHASE_ORDER" AS "PURCHASE_ORDER",
        tsw."PRO_NUMBER" AS "PRO_NUMBER",
        tsw."TRANS_RESP_CODE" AS "TRANS_RESP_CODE",
        tsw."BASELINE_COST" AS "BASELINE_COST",
        tsw."ESTIMATED_COST" AS "ESTIMATED_COST",
        tsw."LINEHAUL_COST" AS "LINEHAUL_COST",
        tsw."ACCESSORIAL_COST" AS "ACCESSORIAL_COST",
        tsw."STOP_COST" AS "STOP_COST",
        tsw."ESTIMATED_SAVINGS" AS "ESTIMATED_SAVINGS",
        tsw."SPOT_CHARGE" AS "SPOT_CHARGE",
        tsw."CURRENCY_CODE" AS "CURRENCY_CODE",
        tsw."PICKUP_START_DTTM" AS "PICKUP_START_DTTM",
        tsw."PICKUP_END_DTTM" AS "PICKUP_END_DTTM",
        tsw."DELIVERY_START_DTTM" AS "DELIVERY_START_DTTM",
        tsw."DELIVERY_END_DTTM" AS "DELIVERY_END_DTTM",
        tsw."NUM_STOPS" AS "NUM_STOPS",
        tsw."NUM_DOCKS" AS "NUM_DOCKS",
        tsw."ON_TIME_INDICATOR" AS "ON_TIME_INDICATOR",
        tsw."HAS_NOTES" AS "HAS_NOTES",
        tsw."HAS_ALERTS" AS "HAS_ALERTS",
        tsw."HAS_IMPORT_ERROR" AS "HAS_IMPORT_ERROR",
        tsw."HAS_SOFT_CHECK_ERROR" AS "HAS_SOFT_CHECK_ERROR",
        tsw."HAS_TRACKING_MSG" AS "HAS_TRACKING_MSG",
        tsw."TRACKING_MSG_PROBLEM" AS "TRACKING_MSG_PROBLEM",
        tsw."REC_LINEHAUL_COST" AS "REC_LINEHAUL_COST",
        tsw."REC_ACCESSORIAL_COST" AS "REC_ACCESSORIAL_COST",
        tsw."REC_TOTAL_COST" AS "REC_TOTAL_COST",
        tsw."CYCLE_RESP_DEADLINE_TZ" AS "CYCLE_RESP_DEADLINE_TZ",
        tsw."TENDER_RESP_DEADLINE_TZ" AS "TENDER_RESP_DEADLINE_TZ",
        tsw."PICKUP_TZ" AS "PICKUP_TZ",
        tsw."DELIVERY_TZ" AS "DELIVERY_TZ",
        tsw."ASSIGNED_LANE_ID" AS "ASSIGNED_LANE_ID",
        tsw."ASSIGNED_LANE_DETAIL_ID" AS "ASSIGNED_LANE_DETAIL_ID",
        tsw."REC_SPOT_CHARGE" AS "REC_SPOT_CHARGE",
        tsw."REC_LANE_ID" AS "REC_LANE_ID",
        tsw."REC_LANE_DETAIL_ID" AS "REC_LANE_DETAIL_ID",
        tsw."TENDER_DTTM" AS "TENDER_DTTM",
        tsw."O_STOP_LOCATION_NAME" AS "O_STOP_LOCATION_NAME",
        tsw."D_STOP_LOCATION_NAME" AS "D_STOP_LOCATION_NAME",
        tsw."ASSIGNED_CM_SHIPMENT_ID" AS "ASSIGNED_CM_SHIPMENT_ID",
        tsw."REC_CM_DISCOUNT" AS "REC_CM_DISCOUNT",
        tsw."REC_STOP_COST" AS "REC_STOP_COST",
        tsw."LAST_SELECTOR_RUN_DTTM" AS "LAST_SELECTOR_RUN_DTTM",
        tsw."LAST_CM_OPTION_GEN_DTTM" AS "LAST_CM_OPTION_GEN_DTTM",
        tsw."IS_CM_OPTION_GEN_ACTIVE" AS "IS_CM_OPTION_GEN_ACTIVE",
        tsw."RS_CYCLE_REMAINING" AS "RS_CYCLE_REMAINING",
        tsw."IS_TIME_FEAS_ENABLED" AS "IS_TIME_FEAS_ENABLED",
        tsw."EXT_SYS_SHIPMENT_ID" AS "EXT_SYS_SHIPMENT_ID",
        tsw."EXTRACTION_DTTM" AS "EXTRACTION_DTTM",
        tsw."ASSIGNED_BROKER_CARRIER_CODE" AS "ASSIGNED_BROKER_CARRIER_CODE",
        tsw."USE_BROKER_AS_CARRIER" AS "USE_BROKER_AS_CARRIER",
        tsw."BROKER_REF" AS "BROKER_REF",
        tsw."RATING_QUALIFIER" AS "RATING_QUALIFIER",
        tsw."STATUS_CHANGE_DTTM" AS "STATUS_CHANGE_DTTM",
        tsw."BUDG_TOTAL_COST" AS "BUDG_TOTAL_COST",
        tsw."NORMALIZED_MARGIN" AS "NORMALIZED_MARGIN",
        tsw."NORMALIZED_TOTAL_COST" AS "NORMALIZED_TOTAL_COST",
        tsw."BUDG_NORMALIZED_TOTAL_COST" AS "BUDG_NORMALIZED_TOTAL_COST",
        tsw."REC_BUDG_LINEHAUL_COST" AS "REC_BUDG_LINEHAUL_COST",
        tsw."REC_BUDG_STOP_COST" AS "REC_BUDG_STOP_COST",
        tsw."REC_BUDG_CM_DISCOUNT" AS "REC_BUDG_CM_DISCOUNT",
        tsw."REC_BUDG_ACCESSORIAL_COST" AS "REC_BUDG_ACCESSORIAL_COST",
        tsw."REC_BUDG_TOTAL_COST" AS "REC_BUDG_TOTAL_COST",
        tsw."REC_MARGIN" AS "REC_MARGIN",
        tsw."REC_NORMALIZED_MARGIN" AS "REC_NORMALIZED_MARGIN",
        tsw."REC_NORMALIZED_TOTAL_COST" AS "REC_NORMALIZED_TOTAL_COST",
        tsw."REC_BUDG_NORMALIZED_TOTAL_COST" AS "REC_BUDG_NORMALIZED_TOTAL_COST",
        tsw."BUDG_CURRENCY_CODE" AS "BUDG_CURRENCY_CODE",
        tsw."SPOT_CHARGE_CURRENCY_CODE" AS "SPOT_CHARGE_CURRENCY_CODE",
        tsw."REC_CURRENCY_CODE" AS "REC_CURRENCY_CODE",
        tsw."REC_BUDG_CURRENCY_CODE" AS "REC_BUDG_CURRENCY_CODE",
        tsw."REC_SPOT_CHARGE_CURRENCY_CODE" AS "REC_SPOT_CHARGE_CURRENCY_CODE",
        tsw."RATING_LANE_ID" AS "RATING_LANE_ID",
        tsw."FRT_REV_RATING_LANE_ID" AS "FRT_REV_RATING_LANE_ID",
        tsw."REC_RATING_LANE_ID" AS "REC_RATING_LANE_ID",
        tsw."REC_BUDG_RATING_LANE_ID" AS "REC_BUDG_RATING_LANE_ID",
        tsw."RATING_LANE_DETAIL_ID" AS "RATING_LANE_DETAIL_ID",
        tsw."FRT_REV_RATING_LANE_DETAIL_ID" AS "FRT_REV_RATING_LANE_DETAIL_ID",
        tsw."REC_RATING_LANE_DETAIL_ID" AS "REC_RATING_LANE_DETAIL_ID",
        tsw."REC_BUDG_RATING_LANE_DETAIL_ID" AS "REC_BUDG_RATING_LANE_DETAIL_ID",
        tsw."BUDG_CM_DISCOUNT" AS "BUDG_CM_DISCOUNT",
        tsw."NORMALIZED_BASELINE_COST" AS "NORMALIZED_BASELINE_COST",
        tsw."BASELINE_COST_CURRENCY_CODE" AS "BASELINE_COST_CURRENCY_CODE",
        tsw."REPORTED_COST" AS "REPORTED_COST",
        tsw."TRACTOR_NUMBER" AS "TRACTOR_NUMBER",
        tsw."IS_AUTO_DELIVERED" AS "IS_AUTO_DELIVERED",
        tsw."SHIPMENT_TYPE" AS "SHIPMENT_TYPE",
        tsw."ORIG_BUDG_TOTAL_COST" AS "ORIG_BUDG_TOTAL_COST",
        tsw."ACCESSORIAL_COST_TO_CARRIER" AS "ACCESSORIAL_COST_TO_CARRIER",
        tsw."CARRIER_CHARGE" AS "CARRIER_CHARGE",
        tsw."ACTUAL_COST" AS "ACTUAL_COST",
        tsw."EARNED_INCOME" AS "EARNED_INCOME",
        tsw."SENT_TO_PKMS" AS "SENT_TO_PKMS",
        tsw."IS_SHIPMENT_RECONCILED" AS "IS_SHIPMENT_RECONCILED",
        tsw."DELIVERY_REQ" AS "DELIVERY_REQ",
        tsw."DROPOFF_PICKUP" AS "DROPOFF_PICKUP",
        tsw."PACKAGING" AS "PACKAGING",
        tsw."SENT_TO_PKMS_DTTM" AS "SENT_TO_PKMS_DTTM",
        tsw."WMS_STATUS_CODE" AS "WMS_STATUS_CODE",
        tsw."SPOT_CHARGE_AND_PAYEE_ACC" AS "SPOT_CHARGE_AND_PAYEE_ACC",
        tsw."SPOT_CHARGE_AND_PAYEE_ACC_CC" AS "SPOT_CHARGE_AND_PAYEE_ACC_CC",
        tsw."NORM_SPOT_CHARGE_AND_PAYEE_ACC" AS "NORM_SPOT_CHARGE_AND_PAYEE_ACC",
        tsw."FACILITY_SCHEDULE_ID" AS "FACILITY_SCHEDULE_ID",
        tsw."EARNED_INCOME_CURRENCY_CODE" AS "EARNED_INCOME_CURRENCY_CODE",
        tsw."ACTUAL_COST_CURRENCY_CODE" AS "ACTUAL_COST_CURRENCY_CODE",
        tsw."SHIPMENT_RECON_DTTM" AS "SHIPMENT_RECON_DTTM",
        tsw."PLN_RATING_LANE_ID" AS "PLN_RATING_LANE_ID",
        tsw."PLN_RATING_LANE_DETAIL_ID" AS "PLN_RATING_LANE_DETAIL_ID",
        tsw."PLN_TOTAL_COST" AS "PLN_TOTAL_COST",
        tsw."PLN_LINEHAUL_COST" AS "PLN_LINEHAUL_COST",
        tsw."PLN_TOTAL_ACCESSORIAL_COST" AS "PLN_TOTAL_ACCESSORIAL_COST",
        tsw."PLN_STOP_OFF_COST" AS "PLN_STOP_OFF_COST",
        tsw."PLN_NORMALIZED_TOTAL_COST" AS "PLN_NORMALIZED_TOTAL_COST",
        tsw."PLN_CURRENCY_CODE" AS "PLN_CURRENCY_CODE",
        tsw."PLN_ACCESSORL_COST_TO_CARRIER" AS "PLN_ACCESSORL_COST_TO_CARRIER",
        tsw."PLN_CARRIER_CHARGE" AS "PLN_CARRIER_CHARGE",
        tsw."WAYPOINT_TOTAL_COST" AS "WAYPOINT_TOTAL_COST",
        tsw."WAYPOINT_HANDLING_COST" AS "WAYPOINT_HANDLING_COST",
        tsw."GRS_OPERATION" AS "GRS_OPERATION",
        tsw."IS_GRS_OPT_CYCLE_RUNNING" AS "IS_GRS_OPT_CYCLE_RUNNING",
        tsw."IS_MANUAL_ASSIGN" AS "IS_MANUAL_ASSIGN",
        tsw."LAST_RUN_GRS_DTTM" AS "LAST_RUN_GRS_DTTM",
        tsw."GRS_MAX_SHIPMENT_STATUS" AS "GRS_MAX_SHIPMENT_STATUS",
        tsw."PRIORITY_TYPE" AS "PRIORITY_TYPE",
        tsw."MV_CURRENCY_CODE" AS "MV_CURRENCY_CODE",
        tsw."PROD_SCHED_REF_NUMBER" AS "PROD_SCHED_REF_NUMBER",
        tsw."COMMODITY_CODE_ID" AS "COMMODITY_CODE_ID",
        tsw."UN_NUMBER_ID" AS "UN_NUMBER_ID",
        tsw."CONTRACT_NUMBER" AS "CONTRACT_NUMBER",
        tsw."BOOKING_REF_SHIPPER" AS "BOOKING_REF_SHIPPER",
        tsw."BOOKING_REF_CARRIER" AS "BOOKING_REF_CARRIER",
        tsw."BK_RESOURCE_REF_EXTERNAL" AS "BK_RESOURCE_REF_EXTERNAL",
        tsw."BK_RESOURCE_NAME_EXTERNAL" AS "BK_RESOURCE_NAME_EXTERNAL",
        tsw."BK_O_FACILITY_ID" AS "BK_O_FACILITY_ID",
        tsw."BK_D_FACILITY_ID" AS "BK_D_FACILITY_ID",
        tsw."BK_MASTER_AIRWAY_BILL" AS "BK_MASTER_AIRWAY_BILL",
        tsw."BK_FORWARDER_AIRWAY_BILL" AS "BK_FORWARDER_AIRWAY_BILL",
        tsw."ASSIGNED_SCNDR_CARRIER_CODE" AS "ASSIGNED_SCNDR_CARRIER_CODE",
        tsw."CUSTOMER_CREDIT_LIMIT_ID" AS "CUSTOMER_CREDIT_LIMIT_ID",
        tsw."SHIPMENT_LEG_TYPE" AS "SHIPMENT_LEG_TYPE",
        tsw."SHIPMENT_CLOSED_INDICATOR" AS "SHIPMENT_CLOSED_INDICATOR",
        tsw."OCEAN_ROUTING_STAGE" AS "OCEAN_ROUTING_STAGE",
        tsw."BK_DEPARTURE_DTTM" AS "BK_DEPARTURE_DTTM",
        tsw."BK_DEPARTURE_TZ" AS "BK_DEPARTURE_TZ",
        tsw."BK_ARRIVAL_DTTM" AS "BK_ARRIVAL_DTTM",
        tsw."BK_ARRIVAL_TZ" AS "BK_ARRIVAL_TZ",
        tsw."BK_PICKUP_DTTM" AS "BK_PICKUP_DTTM",
        tsw."BK_PICKUP_TZ" AS "BK_PICKUP_TZ",
        tsw."BK_CUTOFF_DTTM" AS "BK_CUTOFF_DTTM",
        tsw."BK_CUTOFF_TZ" AS "BK_CUTOFF_TZ",
        tsw."NUM_CHARGE_LAYOVERS" AS "NUM_CHARGE_LAYOVERS",
        tsw."RATE_TYPE" AS "RATE_TYPE",
        tsw."RATE_UOM" AS "RATE_UOM",
        tsw."PICK_START_DTTM" AS "PICK_START_DTTM",
        tsw."PAPERWORK_START_DTTM" AS "PAPERWORK_START_DTTM",
        tsw."VEHICLE_CHECK_START_DTTM" AS "VEHICLE_CHECK_START_DTTM",
        tsw."SHIPMENT_START_DTTM" AS "SHIPMENT_START_DTTM",
        tsw."SHIPMENT_END_DTTM" AS "SHIPMENT_END_DTTM",
        tsw."FEASIBLE_DRIVER_TYPE" AS "FEASIBLE_DRIVER_TYPE",
        tsw."WAVE_ID" AS "WAVE_ID",
        tsw."ESTIMATED_DISPATCH_DTTM" AS "ESTIMATED_DISPATCH_DTTM",
        tsw."TOTAL_TIME" AS "TOTAL_TIME",
        tsw."LOC_REFERENCE" AS "LOC_REFERENCE",
        tsw."BK_O_FACILITY_ALIAS_ID" AS "BK_O_FACILITY_ALIAS_ID",
        tsw."BK_D_FACILITY_ALIAS_ID" AS "BK_D_FACILITY_ALIAS_ID",
        tsw."EQUIP_UTIL_PER" AS "EQUIP_UTIL_PER",
        tsw."MOVE_TYPE" AS "MOVE_TYPE",
        tsw."DRIVER_TYPE_ID" AS "DRIVER_TYPE_ID",
        tsw."EQUIPMENT_TYPE" AS "EQUIPMENT_TYPE",
        tsw."RADIAL_DISTANCE" AS "RADIAL_DISTANCE",
        tsw."RADIAL_DISTANCE_UOM" AS "RADIAL_DISTANCE_UOM",
        tsw."DESIGNATED_TRACTOR_CODE" AS "DESIGNATED_TRACTOR_CODE",
        tsw."DESIGNATED_DRIVER_TYPE" AS "DESIGNATED_DRIVER_TYPE",
        tsw."IS_WAVE_MAN_CHANGED" AS "IS_WAVE_MAN_CHANGED",
        tsw."RETAIN_CONSOLIDATOR_TIMES" AS "RETAIN_CONSOLIDATOR_TIMES",
        tsw."TARIFF" AS "TARIFF",
        tsw."MIN_RATE" AS "MIN_RATE",
        tsw."FIRST_UPDATE_SENT_TO_PKMS" AS "FIRST_UPDATE_SENT_TO_PKMS",
        tsw."EVENT_IND_TYPEID" AS "EVENT_IND_TYPEID",
        tsw."TANDEM_PATH_ID" AS "TANDEM_PATH_ID",
        tsw."O_TANDEM_FACILITY" AS "O_TANDEM_FACILITY",
        tsw."D_TANDEM_FACILITY" AS "D_TANDEM_FACILITY",
        tsw."O_TANDEM_FACILITY_ALIAS" AS "O_TANDEM_FACILITY_ALIAS",
        tsw."D_TANDEM_FACILITY_ALIAS" AS "D_TANDEM_FACILITY_ALIAS",
        tsw."DELAY_TYPE" AS "DELAY_TYPE",
        tsw."ASSIGNED_CARRIER_ID" AS "ASSIGNED_CARRIER_ID",
        tsw."DSG_CARRIER_ID" AS "DSG_CARRIER_ID",
        tsw."REC_CARRIER_ID" AS "REC_CARRIER_ID",
        tsw."FEASIBLE_CARRIER_ID" AS "FEASIBLE_CARRIER_ID",
        tsw."PAYEE_CARRIER_ID" AS "PAYEE_CARRIER_ID",
        tsw."SCNDR_CARRIER_ID" AS "SCNDR_CARRIER_ID",
        tsw."BROKER_CARRIER_ID" AS "BROKER_CARRIER_ID",
        tsw."ASSIGNED_SCNDR_CARRIER_ID" AS "ASSIGNED_SCNDR_CARRIER_ID",
        tsw."DSG_SCNDR_CARRIER_ID" AS "DSG_SCNDR_CARRIER_ID",
        tsw."ASSIGNED_BROKER_CARRIER_ID" AS "ASSIGNED_BROKER_CARRIER_ID",
        tsw."LH_PAYEE_CARRIER_ID" AS "LH_PAYEE_CARRIER_ID",
        tsw."REC_BROKER_CARRIER_ID" AS "REC_BROKER_CARRIER_ID",
        tsw."ASSIGNED_EQUIPMENT_ID" AS "ASSIGNED_EQUIPMENT_ID",
        tsw."DSG_EQUIPMENT_ID" AS "DSG_EQUIPMENT_ID",
        tsw."FEASIBLE_EQUIPMENT_ID" AS "FEASIBLE_EQUIPMENT_ID",
        tsw."FEASIBLE_EQUIPMENT2_ID" AS "FEASIBLE_EQUIPMENT2_ID",
        tsw."REC_EQUIPMENT_ID" AS "REC_EQUIPMENT_ID",
        tsw."ASSIGNED_MOT_ID" AS "ASSIGNED_MOT_ID",
        tsw."DSG_MOT_ID" AS "DSG_MOT_ID",
        tsw."FEASIBLE_MOT_ID" AS "FEASIBLE_MOT_ID",
        tsw."REC_MOT_ID" AS "REC_MOT_ID",
        tsw."PRODUCT_CLASS_ID" AS "PRODUCT_CLASS_ID",
        tsw."PROTECTION_LEVEL_ID" AS "PROTECTION_LEVEL_ID",
        tsw."ASSIGNED_SERVICE_LEVEL_ID" AS "ASSIGNED_SERVICE_LEVEL_ID",
        tsw."DSG_SERVICE_LEVEL_ID" AS "DSG_SERVICE_LEVEL_ID",
        tsw."FEASIBLE_SERVICE_LEVEL_ID" AS "FEASIBLE_SERVICE_LEVEL_ID",
        tsw."REC_SERVICE_LEVEL_ID" AS "REC_SERVICE_LEVEL_ID",
        tsw."HAS_EM_NOTIFY_FLAG" AS "HAS_EM_NOTIFY_FLAG",
        tsw."REGION_ID" AS "REGION_ID",
        tsw."INBOUND_REGION_ID" AS "INBOUND_REGION_ID",
        tsw."OUTBOUND_REGION_ID" AS "OUTBOUND_REGION_ID",
        tsw."FINANCIAL_WT" AS "FINANCIAL_WT",
        tsw."IS_BOOKING_REQUIRED" AS "IS_BOOKING_REQUIRED",
        tsw."TOTAL_COST_EXCL_TAX" AS "TOTAL_COST_EXCL_TAX",
        tsw."TOTAL_TAX_AMOUNT" AS "TOTAL_TAX_AMOUNT",
        tsw."IS_ASSOCIATED_TO_OUTBOUND" AS "IS_ASSOCIATED_TO_OUTBOUND",
        tsw."RECEIVED_DTTM" AS "RECEIVED_DTTM",
        tsw."BOOKING_ID" AS "BOOKING_ID",
        tsw."IS_MISROUTED" AS "IS_MISROUTED",
        tsw."FEASIBLE_CARRIER_CODE" AS "FEASIBLE_CARRIER_CODE",
        tsw."SHIPMENT_WIN_ADJ_FLAG" AS "SHIPMENT_WIN_ADJ_FLAG",
        tsw."DT_PARAM_SET_ID" AS "DT_PARAM_SET_ID",
        tsw."MERCHANDIZING_DEPARTMENT_ID" AS "MERCHANDIZING_DEPARTMENT_ID",
        tsw."STATIC_ROUTE_ID" AS "STATIC_ROUTE_ID",
        tsw."IS_FILO" AS "IS_FILO",
        tsw."IS_COOLER_AT_NOSE" AS "IS_COOLER_AT_NOSE",
        tsw."AUTH_NBR" AS "AUTH_NBR",
        tsw."CONS_LOCN_ID" AS "CONS_LOCN_ID",
        tsw."RTE_TYPE" AS "RTE_TYPE",
        tsw."TRLR_TYPE" AS "TRLR_TYPE",
        tsw."TRLR_SIZE" AS "TRLR_SIZE",
        tsw."CONS_ADDR_CODE" AS "CONS_ADDR_CODE",
        tsw."HUB_ID" AS "HUB_ID",
        tsw."TRLR_GEN_CODE" AS "TRLR_GEN_CODE",
        tsw."MAX_NBR_OF_CTNS" AS "MAX_NBR_OF_CTNS",
        tsw."APPT_DOOR_SCHED_TYPE" AS "APPT_DOOR_SCHED_TYPE",
        tsw."CREATED_SOURCE_TYPE" AS "CREATED_SOURCE_TYPE",
        tsw."CREATED_SOURCE" AS "CREATED_SOURCE",
        tsw."CREATED_DTTM" AS "CREATED_DTTM",
        tsw."LAST_UPDATED_SOURCE_TYPE" AS "LAST_UPDATED_SOURCE_TYPE",
        tsw."LAST_UPDATED_SOURCE" AS "LAST_UPDATED_SOURCE",
        tsw."LAST_UPDATED_DTTM" AS "LAST_UPDATED_DTTM",
        tsw."DSG_SCNDR_CARRIER_CODE" AS "DSG_SCNDR_CARRIER_CODE",
        tsw."LH_PAYEE_CARRIER_CODE" AS "LH_PAYEE_CARRIER_CODE",
        tsw."REC_BROKER_CARRIER_CODE" AS "REC_BROKER_CARRIER_CODE",
        tsw."REC_CARRIER_CODE" AS "REC_CARRIER_CODE",
        tsw."LPN_ASSIGNMENT_STOPPED" AS "LPN_ASSIGNMENT_STOPPED",
        tsw."SEAL_NUMBER" AS "SEAL_NUMBER",
        tsw."HIBERNATE_VERSION" AS "HIBERNATE_VERSION",
        tsw."SHIP_GROUP_ID" AS "SHIP_GROUP_ID",
        tsw."RATE" AS "RATE",
        tsw."MONETARY_VALUE" AS "MONETARY_VALUE",
        tsw."DOOR" AS "DOOR",
        tsw."RTE_TYPE_1" AS "RTE_TYPE_1",
        tsw."RTE_TYPE_2" AS "RTE_TYPE_2",
        tsw."SCHEDULED_PICKUP_DTTM" AS "SCHEDULED_PICKUP_DTTM",
        tsw."MANIFEST_ID" AS "MANIFEST_ID",
        tsw."DAYS_TO_DELIVER" AS "DAYS_TO_DELIVER",
        tsw."SED_GENERATED_FLAG" AS "SED_GENERATED_FLAG",
        tsw."SERV_AREA_CODE" AS "SERV_AREA_CODE",
        tsw."TENDER_RESP_DEADLINE_DTTM" AS "TENDER_RESP_DEADLINE_DTTM",
        tsw."PRINT_CONS_BOL" AS "PRINT_CONS_BOL",
        tsw."LEFT_WT" AS "LEFT_WT",
        tsw."RIGHT_WT" AS "RIGHT_WT",
        tsw."LANE_NAME" AS "LANE_NAME",
        tsw."DECLARED_VALUE" AS "DECLARED_VALUE",
        tsw."DV_CURRENCY_CODE" AS "DV_CURRENCY_CODE",
        tsw."COD_AMOUNT" AS "COD_AMOUNT",
        tsw."CUSTOMER_ID" AS "CUSTOMER_ID",
        tsw."CUST_FRGT_CHARGE" AS "CUST_FRGT_CHARGE",
        tsw."COD_CURRENCY_CODE" AS "COD_CURRENCY_CODE",
        tsw."PLANNED_WEIGHT" AS "PLANNED_WEIGHT",
        tsw."WEIGHT_UOM_ID_BASE" AS "WEIGHT_UOM_ID_BASE",
        tsw."PLANNED_VOLUME" AS "PLANNED_VOLUME",
        tsw."VOLUME_UOM_ID_BASE" AS "VOLUME_UOM_ID_BASE",
        tsw."SIZE1_VALUE" AS "SIZE1_VALUE",
        tsw."SIZE1_UOM_ID" AS "SIZE1_UOM_ID",
        tsw."SIZE2_VALUE" AS "SIZE2_VALUE",
        tsw."SIZE2_UOM_ID" AS "SIZE2_UOM_ID",
        tsw."ASSIGNED_SHIP_VIA" AS "ASSIGNED_SHIP_VIA",
        tsw."INSURANCE_STATUS" AS "INSURANCE_STATUS",
        tsw."RTE_SWC_NBR" AS "RTE_SWC_NBR",
        tsw."RTE_TO" AS "RTE_TO",
        tsw."BILL_OF_LADING_NUMBER" AS "BILL_OF_LADING_NUMBER",
        tsw."TRAILER_NUMBER" AS "TRAILER_NUMBER",
        tsw."TRANS_PLAN_OWNER" AS "TRANS_PLAN_OWNER",
        tsw."TOTAL_REVENUE_CURRENCY_CODE" AS "TOTAL_REVENUE_CURRENCY_CODE",
        tsw."TOTAL_REVENUE" AS "TOTAL_REVENUE",
        tsw."FRT_REV_SPOT_CHARGE_CURR_CODE" AS "FRT_REV_SPOT_CHARGE_CURR_CODE",
        tsw."NORMALIZED_TOTAL_REVENUE" AS "NORMALIZED_TOTAL_REVENUE",
        tsw."FRT_REV_SPOT_CHARGE" AS "FRT_REV_SPOT_CHARGE",
        tsw."DSG_VOYAGE_FLIGHT" AS "DSG_VOYAGE_FLIGHT",
        tsw."FEASIBLE_VOYAGE_FLIGHT" AS "FEASIBLE_VOYAGE_FLIGHT",
        tsw."CURRENCY_DTTM" AS "CURRENCY_DTTM",
        tsw."FRT_REV_LINEHAUL_CHARGE" AS "FRT_REV_LINEHAUL_CHARGE",
        tsw."FRT_REV_STOP_CHARGE" AS "FRT_REV_STOP_CHARGE",
        tsw."FRT_REV_ACCESSORIAL_CHARGE" AS "FRT_REV_ACCESSORIAL_CHARGE",
        tsw."MARGIN" AS "MARGIN",
        tsw."INCOTERM_ID" AS "INCOTERM_ID",
        tsw."ORDER_QTY" AS "ORDER_QTY",
        tsw."QTY_UOM_ID" AS "QTY_UOM_ID",
        tsw."REF_SHIPMENT_NBR" AS "REF_SHIPMENT_NBR",
        tsw."STAGING_LOCN_ID" AS "STAGING_LOCN_ID",
        tsw."LOADING_SEQ_ORD" AS "LOADING_SEQ_ORD",
        tsw."HAZMAT_CERT_CONTACT" AS "HAZMAT_CERT_CONTACT",
        tsw."HAZMAT_CERT_DECLARATION" AS "HAZMAT_CERT_DECLARATION",
        tsw."CDC_TIMESTAMP" AS "CDC_TIMESTAMP",
        tsw."OPERATION_TYPE" AS "OPERATION_TYPE",
        tsw."ARCHIVED_DTTM" AS "ARCHIVED_DTTM",
        tsw."ORIGIN" AS "ORIGIN",
        tsw."FINAL_DESTINATION" AS "FINAL_DESTINATION",
        tsw."actual_delivery_date_parsed" AS "actual_delivery_date_parsed",
        tsw."wood_pellet" AS "wood_pellet",
        tsw."act_del_MERCH_YEAR" AS "act_del_MERCH_YEAR",
        tsw."act_del_YEAR_WEEK" AS "act_del_YEAR_WEEK",
        tsw."act_del_YEAR_QUARTER" AS "act_del_YEAR_QUARTER",
        tsw."act_del_YEAR_PERIOD" AS "act_del_YEAR_PERIOD",
        tsw."invoice_shipping_id" AS "invoice_shipping_id",
        tsw."TOTAL_COST_sum" AS "TOTAL_COST",
        tscfinal."FACILITY_CODE" AS "org_Facility_Code",
        tscfinal."FACILITY_NAME" AS "org_Facility_Name",
        tscfinal."FACILITY_TYPE" AS "org_Facility_Type",
        tscfinal2."FACILITY_CODE" AS "dest_Facility_Code",
        tscfinal2."FACILITY_NAME" AS "dest_Facility_Name",
        tscfinal2."FACILITY_TYPE" AS "dest_Facility_Type"
      FROM "TLM_SHIPMENT_JOINED_FILTER_SHIPPING_WINDOWS" tsw
      LEFT JOIN "TSC_FACILITIES_FINAL" tscfinal
        ON tsw."ORIGIN" = CAST(tscfinal."FACILITY_CODE" AS NUMERIC)
      LEFT JOIN "TSC_FACILITIES_FINAL" tscfinal2
        ON tsw."FINAL_DESTINATION" = CAST(tscfinal2."FACILITY_CODE" AS NUMERIC)
    ) "withoutcomputedcols_query")A
  WHERE ("inbound_flag" = 'Inbound') AND "org_Facility_Code" IS NOT NULL AND "dest_Facility_Code" IS NOT NULL;

<br>
 --SC_TLM_ORDERS_PREPARED_BY_ORDER_ID_FILTER
</br>
CREATE OR REPLACE TEMP TABLE "SC_TLM_ORDERS_PREPARED_BY_ORDER_ID_FILTER"
AS
SELECT  order_id_po, "TC_SHIPMENT_ID" FROM (
SELECT 
CASE WHEN (CHARINDEX('_', TC_ORDER_ID)) >0 THEN SPLIT_PART(TC_ORDER_ID,'_',0) ELSE '' END as order_id_po,
"TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID"
FROM  EDW.VW_SC_TLM_ORDERS
) WHERE (CAST(order_id_po AS VARCHAR) != '' OR CAST(order_id_po AS VARCHAR) IS NULL AND '' IS NOT NULL OR CAST(order_id_po AS VARCHAR) IS NOT NULL AND '' IS NULL) AND order_id_po IS NOT NULL AND (CAST("TC_SHIPMENT_ID" AS VARCHAR) != '' OR CAST("TC_SHIPMENT_ID" AS VARCHAR) IS NULL AND '' IS NOT NULL OR CAST("TC_SHIPMENT_ID" AS VARCHAR) IS NOT NULL AND '' IS NULL) AND "TC_SHIPMENT_ID" IS NOT NULL
GROUP BY order_id_po, "TC_SHIPMENT_ID";

<br>
--TLM_SHIPMENT_JOINED_PO_VOL_WGT_WINDOWS
</br>
CREATE OR REPLACE TEMP  TABLE "TLM_SHIPMENT_JOINED_PO_VOL_WGT_WINDOWS"
AS 
WITH TLM_SHIPMENT_JOINED_W_PO_PREPARED AS
(
SELECT 
    tlmin."SHIPMENT_ID" AS "SHIPMENT_ID",
    tlmin."TC_COMPANY_ID" AS "TC_COMPANY_ID",
    tlmin."RS_AREA_ID" AS "RS_AREA_ID",
    tlmin."TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID",
    tlmin."PP_SHIPMENT_ID" AS "PP_SHIPMENT_ID",
    tlmin."SHIPMENT_STATUS" AS "SHIPMENT_STATUS",
    tlmin."UPDATE_SENT" AS "UPDATE_SENT",
    tlmin."BUSINESS_PROCESS" AS "BUSINESS_PROCESS",
    tlmin."CREATION_TYPE" AS "CREATION_TYPE",
    tlmin."CONS_RUN_ID" AS "CONS_RUN_ID",
    tlmin."IS_CANCELLED" AS "IS_CANCELLED",
    tlmin."RS_TYPE" AS "RS_TYPE",
    tlmin."RS_CONFIG_ID" AS "RS_CONFIG_ID",
    tlmin."RS_CONFIG_CYCLE_ID" AS "RS_CONFIG_CYCLE_ID",
    tlmin."CONFIG_CYCLE_SEQ" AS "CONFIG_CYCLE_SEQ",
    tlmin."CYCLE_DEADLINE_DTTM" AS "CYCLE_DEADLINE_DTTM",
    tlmin."CYCLE_EXECUTION_DTTM" AS "CYCLE_EXECUTION_DTTM",
    tlmin."LAST_RS_NOTIFICATION_DTTM" AS "LAST_RS_NOTIFICATION_DTTM",
    tlmin."CFMF_STATUS" AS "CFMF_STATUS",
    tlmin."AVAILABLE_DTTM" AS "AVAILABLE_DTTM",
    tlmin."CMID" AS "CMID",
    tlmin."CM_DISCOUNT" AS "CM_DISCOUNT",
    tlmin."O_FACILITY_NUMBER" AS "O_FACILITY_NUMBER",
    tlmin."O_FACILITY_ID" AS "O_FACILITY_ID",
    tlmin."O_ADDRESS" AS "O_ADDRESS",
    tlmin."O_CITY" AS "O_CITY",
    tlmin."O_STATE_PROV" AS "O_STATE_PROV",
    tlmin."O_POSTAL_CODE" AS "O_POSTAL_CODE",
    tlmin."O_COUNTY" AS "O_COUNTY",
    tlmin."O_COUNTRY_CODE" AS "O_COUNTRY_CODE",
    tlmin."D_FACILITY_NUMBER" AS "D_FACILITY_NUMBER",
    tlmin."D_FACILITY_ID" AS "D_FACILITY_ID",
    tlmin."D_ADDRESS" AS "D_ADDRESS",
    tlmin."D_CITY" AS "D_CITY",
    tlmin."D_STATE_PROV" AS "D_STATE_PROV",
    tlmin."D_POSTAL_CODE" AS "D_POSTAL_CODE",
    tlmin."D_COUNTY" AS "D_COUNTY",
    tlmin."D_COUNTRY_CODE" AS "D_COUNTRY_CODE",
    tlmin."DISTANCE" AS "DISTANCE",
    tlmin."DIRECT_DISTANCE" AS "DIRECT_DISTANCE",
    tlmin."OUT_OF_ROUTE_DISTANCE" AS "OUT_OF_ROUTE_DISTANCE",
    tlmin."DISTANCE_UOM" AS "DISTANCE_UOM",
    tlmin."BUSINESS_PARTNER_ID" AS "BUSINESS_PARTNER_ID",
    tlmin."COMMODITY_CLASS" AS "COMMODITY_CLASS",
    tlmin."IS_HAZMAT" AS "IS_HAZMAT",
    tlmin."IS_PERISHABLE" AS "IS_PERISHABLE",
    tlmin."BILLING_METHOD" AS "BILLING_METHOD",
    tlmin."DSG_CARRIER_CODE" AS "DSG_CARRIER_CODE",
    tlmin."REC_CMID" AS "REC_CMID",
    tlmin."REC_CM_SHIPMENT_ID" AS "REC_CM_SHIPMENT_ID",
    tlmin."ASSIGNED_CARRIER_CODE" AS "ASSIGNED_CARRIER_CODE",
    tlmin."SHIPMENT_REF_ID" AS "SHIPMENT_REF_ID",
    tlmin."BILL_TO_CODE" AS "BILL_TO_CODE",
    tlmin."BILL_TO_TITLE" AS "BILL_TO_TITLE",
    tlmin."BILL_TO_NAME" AS "BILL_TO_NAME",
    tlmin."BILL_TO_ADDRESS" AS "BILL_TO_ADDRESS",
    tlmin."BILL_TO_CITY" AS "BILL_TO_CITY",
    tlmin."BILL_TO_STATE_PROV" AS "BILL_TO_STATE_PROV",
    tlmin."BILL_TO_POSTAL_CODE" AS "BILL_TO_POSTAL_CODE",
    tlmin."BILL_TO_COUNTRY_CODE" AS "BILL_TO_COUNTRY_CODE",
    tlmin."BILL_TO_PHONE_NUMBER" AS "BILL_TO_PHONE_NUMBER",
    tlmin."PURCHASE_ORDER" AS "PURCHASE_ORDER",
    tlmin."PRO_NUMBER" AS "PRO_NUMBER",
    tlmin."TRANS_RESP_CODE" AS "TRANS_RESP_CODE",
    tlmin."BASELINE_COST" AS "BASELINE_COST",
    tlmin."ESTIMATED_COST" AS "ESTIMATED_COST",
    tlmin."LINEHAUL_COST" AS "LINEHAUL_COST",
    tlmin."ACCESSORIAL_COST" AS "ACCESSORIAL_COST",
    tlmin."STOP_COST" AS "STOP_COST",
    tlmin."ESTIMATED_SAVINGS" AS "ESTIMATED_SAVINGS",
    tlmin."SPOT_CHARGE" AS "SPOT_CHARGE",
    tlmin."CURRENCY_CODE" AS "CURRENCY_CODE",
    tlmin."PICKUP_START_DTTM" AS "PICKUP_START_DTTM",
    tlmin."PICKUP_END_DTTM" AS "PICKUP_END_DTTM",
    tlmin."DELIVERY_START_DTTM" AS "DELIVERY_START_DTTM",
    tlmin."DELIVERY_END_DTTM" AS "DELIVERY_END_DTTM",
    tlmin."NUM_STOPS" AS "NUM_STOPS",
    tlmin."NUM_DOCKS" AS "NUM_DOCKS",
    tlmin."ON_TIME_INDICATOR" AS "ON_TIME_INDICATOR",
    tlmin."HAS_NOTES" AS "HAS_NOTES",
    tlmin."HAS_ALERTS" AS "HAS_ALERTS",
    tlmin."HAS_IMPORT_ERROR" AS "HAS_IMPORT_ERROR",
    tlmin."HAS_SOFT_CHECK_ERROR" AS "HAS_SOFT_CHECK_ERROR",
    tlmin."HAS_TRACKING_MSG" AS "HAS_TRACKING_MSG",
    tlmin."TRACKING_MSG_PROBLEM" AS "TRACKING_MSG_PROBLEM",
    tlmin."REC_LINEHAUL_COST" AS "REC_LINEHAUL_COST",
    tlmin."REC_ACCESSORIAL_COST" AS "REC_ACCESSORIAL_COST",
    tlmin."REC_TOTAL_COST" AS "REC_TOTAL_COST",
    tlmin."CYCLE_RESP_DEADLINE_TZ" AS "CYCLE_RESP_DEADLINE_TZ",
    tlmin."TENDER_RESP_DEADLINE_TZ" AS "TENDER_RESP_DEADLINE_TZ",
    tlmin."PICKUP_TZ" AS "PICKUP_TZ",
    tlmin."DELIVERY_TZ" AS "DELIVERY_TZ",
    tlmin."ASSIGNED_LANE_ID" AS "ASSIGNED_LANE_ID",
    tlmin."ASSIGNED_LANE_DETAIL_ID" AS "ASSIGNED_LANE_DETAIL_ID",
    tlmin."REC_SPOT_CHARGE" AS "REC_SPOT_CHARGE",
    tlmin."REC_LANE_ID" AS "REC_LANE_ID",
    tlmin."REC_LANE_DETAIL_ID" AS "REC_LANE_DETAIL_ID",
    tlmin."TENDER_DTTM" AS "TENDER_DTTM",
    tlmin."O_STOP_LOCATION_NAME" AS "O_STOP_LOCATION_NAME",
    tlmin."D_STOP_LOCATION_NAME" AS "D_STOP_LOCATION_NAME",
    tlmin."ASSIGNED_CM_SHIPMENT_ID" AS "ASSIGNED_CM_SHIPMENT_ID",
    tlmin."REC_CM_DISCOUNT" AS "REC_CM_DISCOUNT",
    tlmin."REC_STOP_COST" AS "REC_STOP_COST",
    tlmin."LAST_SELECTOR_RUN_DTTM" AS "LAST_SELECTOR_RUN_DTTM",
    tlmin."LAST_CM_OPTION_GEN_DTTM" AS "LAST_CM_OPTION_GEN_DTTM",
    tlmin."IS_CM_OPTION_GEN_ACTIVE" AS "IS_CM_OPTION_GEN_ACTIVE",
    tlmin."RS_CYCLE_REMAINING" AS "RS_CYCLE_REMAINING",
    tlmin."IS_TIME_FEAS_ENABLED" AS "IS_TIME_FEAS_ENABLED",
    tlmin."EXT_SYS_SHIPMENT_ID" AS "EXT_SYS_SHIPMENT_ID",
    tlmin."EXTRACTION_DTTM" AS "EXTRACTION_DTTM",
    tlmin."ASSIGNED_BROKER_CARRIER_CODE" AS "ASSIGNED_BROKER_CARRIER_CODE",
    tlmin."USE_BROKER_AS_CARRIER" AS "USE_BROKER_AS_CARRIER",
    tlmin."BROKER_REF" AS "BROKER_REF",
    tlmin."RATING_QUALIFIER" AS "RATING_QUALIFIER",
    tlmin."STATUS_CHANGE_DTTM" AS "STATUS_CHANGE_DTTM",
    tlmin."BUDG_TOTAL_COST" AS "BUDG_TOTAL_COST",
    tlmin."NORMALIZED_MARGIN" AS "NORMALIZED_MARGIN",
    tlmin."NORMALIZED_TOTAL_COST" AS "NORMALIZED_TOTAL_COST",
    tlmin."BUDG_NORMALIZED_TOTAL_COST" AS "BUDG_NORMALIZED_TOTAL_COST",
    tlmin."REC_BUDG_LINEHAUL_COST" AS "REC_BUDG_LINEHAUL_COST",
    tlmin."REC_BUDG_STOP_COST" AS "REC_BUDG_STOP_COST",
    tlmin."REC_BUDG_CM_DISCOUNT" AS "REC_BUDG_CM_DISCOUNT",
    tlmin."REC_BUDG_ACCESSORIAL_COST" AS "REC_BUDG_ACCESSORIAL_COST",
    tlmin."REC_BUDG_TOTAL_COST" AS "REC_BUDG_TOTAL_COST",
    tlmin."REC_MARGIN" AS "REC_MARGIN",
    tlmin."REC_NORMALIZED_MARGIN" AS "REC_NORMALIZED_MARGIN",
    tlmin."REC_NORMALIZED_TOTAL_COST" AS "REC_NORMALIZED_TOTAL_COST",
    tlmin."REC_BUDG_NORMALIZED_TOTAL_COST" AS "REC_BUDG_NORMALIZED_TOTAL_COST",
    tlmin."BUDG_CURRENCY_CODE" AS "BUDG_CURRENCY_CODE",
    tlmin."SPOT_CHARGE_CURRENCY_CODE" AS "SPOT_CHARGE_CURRENCY_CODE",
    tlmin."REC_CURRENCY_CODE" AS "REC_CURRENCY_CODE",
    tlmin."REC_BUDG_CURRENCY_CODE" AS "REC_BUDG_CURRENCY_CODE",
    tlmin."REC_SPOT_CHARGE_CURRENCY_CODE" AS "REC_SPOT_CHARGE_CURRENCY_CODE",
    tlmin."RATING_LANE_ID" AS "RATING_LANE_ID",
    tlmin."FRT_REV_RATING_LANE_ID" AS "FRT_REV_RATING_LANE_ID",
    tlmin."REC_RATING_LANE_ID" AS "REC_RATING_LANE_ID",
    tlmin."REC_BUDG_RATING_LANE_ID" AS "REC_BUDG_RATING_LANE_ID",
    tlmin."RATING_LANE_DETAIL_ID" AS "RATING_LANE_DETAIL_ID",
    tlmin."FRT_REV_RATING_LANE_DETAIL_ID" AS "FRT_REV_RATING_LANE_DETAIL_ID",
    tlmin."REC_RATING_LANE_DETAIL_ID" AS "REC_RATING_LANE_DETAIL_ID",
    tlmin."REC_BUDG_RATING_LANE_DETAIL_ID" AS "REC_BUDG_RATING_LANE_DETAIL_ID",
    tlmin."BUDG_CM_DISCOUNT" AS "BUDG_CM_DISCOUNT",
    tlmin."NORMALIZED_BASELINE_COST" AS "NORMALIZED_BASELINE_COST",
    tlmin."BASELINE_COST_CURRENCY_CODE" AS "BASELINE_COST_CURRENCY_CODE",
    tlmin."REPORTED_COST" AS "REPORTED_COST",
    tlmin."TRACTOR_NUMBER" AS "TRACTOR_NUMBER",
    tlmin."IS_AUTO_DELIVERED" AS "IS_AUTO_DELIVERED",
    tlmin."SHIPMENT_TYPE" AS "SHIPMENT_TYPE",
    tlmin."ORIG_BUDG_TOTAL_COST" AS "ORIG_BUDG_TOTAL_COST",
    tlmin."ACCESSORIAL_COST_TO_CARRIER" AS "ACCESSORIAL_COST_TO_CARRIER",
    tlmin."CARRIER_CHARGE" AS "CARRIER_CHARGE",
    tlmin."ACTUAL_COST" AS "ACTUAL_COST",
    tlmin."EARNED_INCOME" AS "EARNED_INCOME",
    tlmin."SENT_TO_PKMS" AS "SENT_TO_PKMS",
    tlmin."IS_SHIPMENT_RECONCILED" AS "IS_SHIPMENT_RECONCILED",
    tlmin."DELIVERY_REQ" AS "DELIVERY_REQ",
    tlmin."DROPOFF_PICKUP" AS "DROPOFF_PICKUP",
    tlmin."PACKAGING" AS "PACKAGING",
    tlmin."SENT_TO_PKMS_DTTM" AS "SENT_TO_PKMS_DTTM",
    tlmin."WMS_STATUS_CODE" AS "WMS_STATUS_CODE",
    tlmin."SPOT_CHARGE_AND_PAYEE_ACC" AS "SPOT_CHARGE_AND_PAYEE_ACC",
    tlmin."SPOT_CHARGE_AND_PAYEE_ACC_CC" AS "SPOT_CHARGE_AND_PAYEE_ACC_CC",
    tlmin."NORM_SPOT_CHARGE_AND_PAYEE_ACC" AS "NORM_SPOT_CHARGE_AND_PAYEE_ACC",
    tlmin."FACILITY_SCHEDULE_ID" AS "FACILITY_SCHEDULE_ID",
    tlmin."EARNED_INCOME_CURRENCY_CODE" AS "EARNED_INCOME_CURRENCY_CODE",
    tlmin."ACTUAL_COST_CURRENCY_CODE" AS "ACTUAL_COST_CURRENCY_CODE",
    tlmin."SHIPMENT_RECON_DTTM" AS "SHIPMENT_RECON_DTTM",
    tlmin."PLN_RATING_LANE_ID" AS "PLN_RATING_LANE_ID",
    tlmin."PLN_RATING_LANE_DETAIL_ID" AS "PLN_RATING_LANE_DETAIL_ID",
    tlmin."PLN_TOTAL_COST" AS "PLN_TOTAL_COST",
    tlmin."PLN_LINEHAUL_COST" AS "PLN_LINEHAUL_COST",
    tlmin."PLN_TOTAL_ACCESSORIAL_COST" AS "PLN_TOTAL_ACCESSORIAL_COST",
    tlmin."PLN_STOP_OFF_COST" AS "PLN_STOP_OFF_COST",
    tlmin."PLN_NORMALIZED_TOTAL_COST" AS "PLN_NORMALIZED_TOTAL_COST",
    tlmin."PLN_CURRENCY_CODE" AS "PLN_CURRENCY_CODE",
    tlmin."PLN_ACCESSORL_COST_TO_CARRIER" AS "PLN_ACCESSORL_COST_TO_CARRIER",
    tlmin."PLN_CARRIER_CHARGE" AS "PLN_CARRIER_CHARGE",
    tlmin."WAYPOINT_TOTAL_COST" AS "WAYPOINT_TOTAL_COST",
    tlmin."WAYPOINT_HANDLING_COST" AS "WAYPOINT_HANDLING_COST",
    tlmin."GRS_OPERATION" AS "GRS_OPERATION",
    tlmin."IS_GRS_OPT_CYCLE_RUNNING" AS "IS_GRS_OPT_CYCLE_RUNNING",
    tlmin."IS_MANUAL_ASSIGN" AS "IS_MANUAL_ASSIGN",
    tlmin."LAST_RUN_GRS_DTTM" AS "LAST_RUN_GRS_DTTM",
    tlmin."GRS_MAX_SHIPMENT_STATUS" AS "GRS_MAX_SHIPMENT_STATUS",
    tlmin."PRIORITY_TYPE" AS "PRIORITY_TYPE",
    tlmin."MV_CURRENCY_CODE" AS "MV_CURRENCY_CODE",
    tlmin."PROD_SCHED_REF_NUMBER" AS "PROD_SCHED_REF_NUMBER",
    tlmin."COMMODITY_CODE_ID" AS "COMMODITY_CODE_ID",
    tlmin."UN_NUMBER_ID" AS "UN_NUMBER_ID",
    tlmin."CONTRACT_NUMBER" AS "CONTRACT_NUMBER",
    tlmin."BOOKING_REF_SHIPPER" AS "BOOKING_REF_SHIPPER",
    tlmin."BOOKING_REF_CARRIER" AS "BOOKING_REF_CARRIER",
    tlmin."BK_RESOURCE_REF_EXTERNAL" AS "BK_RESOURCE_REF_EXTERNAL",
    tlmin."BK_RESOURCE_NAME_EXTERNAL" AS "BK_RESOURCE_NAME_EXTERNAL",
    tlmin."BK_O_FACILITY_ID" AS "BK_O_FACILITY_ID",
    tlmin."BK_D_FACILITY_ID" AS "BK_D_FACILITY_ID",
    tlmin."BK_MASTER_AIRWAY_BILL" AS "BK_MASTER_AIRWAY_BILL",
    tlmin."BK_FORWARDER_AIRWAY_BILL" AS "BK_FORWARDER_AIRWAY_BILL",
    tlmin."ASSIGNED_SCNDR_CARRIER_CODE" AS "ASSIGNED_SCNDR_CARRIER_CODE",
    tlmin."CUSTOMER_CREDIT_LIMIT_ID" AS "CUSTOMER_CREDIT_LIMIT_ID",
    tlmin."SHIPMENT_LEG_TYPE" AS "SHIPMENT_LEG_TYPE",
    tlmin."SHIPMENT_CLOSED_INDICATOR" AS "SHIPMENT_CLOSED_INDICATOR",
    tlmin."OCEAN_ROUTING_STAGE" AS "OCEAN_ROUTING_STAGE",
    tlmin."BK_DEPARTURE_DTTM" AS "BK_DEPARTURE_DTTM",
    tlmin."BK_DEPARTURE_TZ" AS "BK_DEPARTURE_TZ",
    tlmin."BK_ARRIVAL_DTTM" AS "BK_ARRIVAL_DTTM",
    tlmin."BK_ARRIVAL_TZ" AS "BK_ARRIVAL_TZ",
    tlmin."BK_PICKUP_DTTM" AS "BK_PICKUP_DTTM",
    tlmin."BK_PICKUP_TZ" AS "BK_PICKUP_TZ",
    tlmin."BK_CUTOFF_DTTM" AS "BK_CUTOFF_DTTM",
    tlmin."BK_CUTOFF_TZ" AS "BK_CUTOFF_TZ",
    tlmin."NUM_CHARGE_LAYOVERS" AS "NUM_CHARGE_LAYOVERS",
    tlmin."RATE_TYPE" AS "RATE_TYPE",
    tlmin."RATE_UOM" AS "RATE_UOM",
    tlmin."PICK_START_DTTM" AS "PICK_START_DTTM",
    tlmin."PAPERWORK_START_DTTM" AS "PAPERWORK_START_DTTM",
    tlmin."VEHICLE_CHECK_START_DTTM" AS "VEHICLE_CHECK_START_DTTM",
    tlmin."SHIPMENT_START_DTTM" AS "SHIPMENT_START_DTTM",
    tlmin."SHIPMENT_END_DTTM" AS "SHIPMENT_END_DTTM",
    tlmin."FEASIBLE_DRIVER_TYPE" AS "FEASIBLE_DRIVER_TYPE",
    tlmin."WAVE_ID" AS "WAVE_ID",
    tlmin."ESTIMATED_DISPATCH_DTTM" AS "ESTIMATED_DISPATCH_DTTM",
    tlmin."TOTAL_TIME" AS "TOTAL_TIME",
    tlmin."LOC_REFERENCE" AS "LOC_REFERENCE",
    tlmin."BK_O_FACILITY_ALIAS_ID" AS "BK_O_FACILITY_ALIAS_ID",
    tlmin."BK_D_FACILITY_ALIAS_ID" AS "BK_D_FACILITY_ALIAS_ID",
    tlmin."EQUIP_UTIL_PER" AS "EQUIP_UTIL_PER",
    tlmin."MOVE_TYPE" AS "MOVE_TYPE",
    tlmin."DRIVER_TYPE_ID" AS "DRIVER_TYPE_ID",
    tlmin."EQUIPMENT_TYPE" AS "EQUIPMENT_TYPE",
    tlmin."RADIAL_DISTANCE" AS "RADIAL_DISTANCE",
    tlmin."RADIAL_DISTANCE_UOM" AS "RADIAL_DISTANCE_UOM",
    tlmin."DESIGNATED_TRACTOR_CODE" AS "DESIGNATED_TRACTOR_CODE",
    tlmin."DESIGNATED_DRIVER_TYPE" AS "DESIGNATED_DRIVER_TYPE",
    tlmin."IS_WAVE_MAN_CHANGED" AS "IS_WAVE_MAN_CHANGED",
    tlmin."RETAIN_CONSOLIDATOR_TIMES" AS "RETAIN_CONSOLIDATOR_TIMES",
    tlmin."TARIFF" AS "TARIFF",
    tlmin."MIN_RATE" AS "MIN_RATE",
    tlmin."FIRST_UPDATE_SENT_TO_PKMS" AS "FIRST_UPDATE_SENT_TO_PKMS",
    tlmin."EVENT_IND_TYPEID" AS "EVENT_IND_TYPEID",
    tlmin."TANDEM_PATH_ID" AS "TANDEM_PATH_ID",
    tlmin."O_TANDEM_FACILITY" AS "O_TANDEM_FACILITY",
    tlmin."D_TANDEM_FACILITY" AS "D_TANDEM_FACILITY",
    tlmin."O_TANDEM_FACILITY_ALIAS" AS "O_TANDEM_FACILITY_ALIAS",
    tlmin."D_TANDEM_FACILITY_ALIAS" AS "D_TANDEM_FACILITY_ALIAS",
    tlmin."DELAY_TYPE" AS "DELAY_TYPE",
    tlmin."ASSIGNED_CARRIER_ID" AS "ASSIGNED_CARRIER_ID",
    tlmin."DSG_CARRIER_ID" AS "DSG_CARRIER_ID",
    tlmin."REC_CARRIER_ID" AS "REC_CARRIER_ID",
    tlmin."FEASIBLE_CARRIER_ID" AS "FEASIBLE_CARRIER_ID",
    tlmin."PAYEE_CARRIER_ID" AS "PAYEE_CARRIER_ID",
    tlmin."SCNDR_CARRIER_ID" AS "SCNDR_CARRIER_ID",
    tlmin."BROKER_CARRIER_ID" AS "BROKER_CARRIER_ID",
    tlmin."ASSIGNED_SCNDR_CARRIER_ID" AS "ASSIGNED_SCNDR_CARRIER_ID",
    tlmin."DSG_SCNDR_CARRIER_ID" AS "DSG_SCNDR_CARRIER_ID",
    tlmin."ASSIGNED_BROKER_CARRIER_ID" AS "ASSIGNED_BROKER_CARRIER_ID",
    tlmin."LH_PAYEE_CARRIER_ID" AS "LH_PAYEE_CARRIER_ID",
    tlmin."REC_BROKER_CARRIER_ID" AS "REC_BROKER_CARRIER_ID",
    tlmin."ASSIGNED_EQUIPMENT_ID" AS "ASSIGNED_EQUIPMENT_ID",
    tlmin."DSG_EQUIPMENT_ID" AS "DSG_EQUIPMENT_ID",
    tlmin."FEASIBLE_EQUIPMENT_ID" AS "FEASIBLE_EQUIPMENT_ID",
    tlmin."FEASIBLE_EQUIPMENT2_ID" AS "FEASIBLE_EQUIPMENT2_ID",
    tlmin."REC_EQUIPMENT_ID" AS "REC_EQUIPMENT_ID",
    tlmin."ASSIGNED_MOT_ID" AS "ASSIGNED_MOT_ID",
    tlmin."DSG_MOT_ID" AS "DSG_MOT_ID",
    tlmin."FEASIBLE_MOT_ID" AS "FEASIBLE_MOT_ID",
    tlmin."REC_MOT_ID" AS "REC_MOT_ID",
    tlmin."PRODUCT_CLASS_ID" AS "PRODUCT_CLASS_ID",
    tlmin."PROTECTION_LEVEL_ID" AS "PROTECTION_LEVEL_ID",
    tlmin."ASSIGNED_SERVICE_LEVEL_ID" AS "ASSIGNED_SERVICE_LEVEL_ID",
    tlmin."DSG_SERVICE_LEVEL_ID" AS "DSG_SERVICE_LEVEL_ID",
    tlmin."FEASIBLE_SERVICE_LEVEL_ID" AS "FEASIBLE_SERVICE_LEVEL_ID",
    tlmin."REC_SERVICE_LEVEL_ID" AS "REC_SERVICE_LEVEL_ID",
    tlmin."HAS_EM_NOTIFY_FLAG" AS "HAS_EM_NOTIFY_FLAG",
    tlmin."REGION_ID" AS "REGION_ID",
    tlmin."INBOUND_REGION_ID" AS "INBOUND_REGION_ID",
    tlmin."OUTBOUND_REGION_ID" AS "OUTBOUND_REGION_ID",
    tlmin."FINANCIAL_WT" AS "FINANCIAL_WT",
    tlmin."IS_BOOKING_REQUIRED" AS "IS_BOOKING_REQUIRED",
    tlmin."TOTAL_COST_EXCL_TAX" AS "TOTAL_COST_EXCL_TAX",
    tlmin."TOTAL_TAX_AMOUNT" AS "TOTAL_TAX_AMOUNT",
    tlmin."IS_ASSOCIATED_TO_OUTBOUND" AS "IS_ASSOCIATED_TO_OUTBOUND",
    tlmin."RECEIVED_DTTM" AS "RECEIVED_DTTM",
    tlmin."BOOKING_ID" AS "BOOKING_ID",
    tlmin."IS_MISROUTED" AS "IS_MISROUTED",
    tlmin."FEASIBLE_CARRIER_CODE" AS "FEASIBLE_CARRIER_CODE",
    tlmin."SHIPMENT_WIN_ADJ_FLAG" AS "SHIPMENT_WIN_ADJ_FLAG",
    tlmin."DT_PARAM_SET_ID" AS "DT_PARAM_SET_ID",
    tlmin."MERCHANDIZING_DEPARTMENT_ID" AS "MERCHANDIZING_DEPARTMENT_ID",
    tlmin."STATIC_ROUTE_ID" AS "STATIC_ROUTE_ID",
    tlmin."IS_FILO" AS "IS_FILO",
    tlmin."IS_COOLER_AT_NOSE" AS "IS_COOLER_AT_NOSE",
    tlmin."AUTH_NBR" AS "AUTH_NBR",
    tlmin."CONS_LOCN_ID" AS "CONS_LOCN_ID",
    tlmin."RTE_TYPE" AS "RTE_TYPE",
    tlmin."TRLR_TYPE" AS "TRLR_TYPE",
    tlmin."TRLR_SIZE" AS "TRLR_SIZE",
    tlmin."CONS_ADDR_CODE" AS "CONS_ADDR_CODE",
    tlmin."HUB_ID" AS "HUB_ID",
    tlmin."TRLR_GEN_CODE" AS "TRLR_GEN_CODE",
    tlmin."MAX_NBR_OF_CTNS" AS "MAX_NBR_OF_CTNS",
    tlmin."APPT_DOOR_SCHED_TYPE" AS "APPT_DOOR_SCHED_TYPE",
    tlmin."CREATED_SOURCE_TYPE" AS "CREATED_SOURCE_TYPE",
    tlmin."CREATED_SOURCE" AS "CREATED_SOURCE",
    tlmin."CREATED_DTTM" AS "CREATED_DTTM",
    tlmin."LAST_UPDATED_SOURCE_TYPE" AS "LAST_UPDATED_SOURCE_TYPE",
    tlmin."LAST_UPDATED_SOURCE" AS "LAST_UPDATED_SOURCE",
    tlmin."LAST_UPDATED_DTTM" AS "LAST_UPDATED_DTTM",
    tlmin."DSG_SCNDR_CARRIER_CODE" AS "DSG_SCNDR_CARRIER_CODE",
    tlmin."LH_PAYEE_CARRIER_CODE" AS "LH_PAYEE_CARRIER_CODE",
    tlmin."REC_BROKER_CARRIER_CODE" AS "REC_BROKER_CARRIER_CODE",
    tlmin."REC_CARRIER_CODE" AS "REC_CARRIER_CODE",
    tlmin."LPN_ASSIGNMENT_STOPPED" AS "LPN_ASSIGNMENT_STOPPED",
    tlmin."SEAL_NUMBER" AS "SEAL_NUMBER",
    tlmin."HIBERNATE_VERSION" AS "HIBERNATE_VERSION",
    tlmin."SHIP_GROUP_ID" AS "SHIP_GROUP_ID",
    tlmin."RATE" AS "RATE",
    tlmin."MONETARY_VALUE" AS "MONETARY_VALUE",
    tlmin."DOOR" AS "DOOR",
    tlmin."RTE_TYPE_1" AS "RTE_TYPE_1",
    tlmin."RTE_TYPE_2" AS "RTE_TYPE_2",
    tlmin."SCHEDULED_PICKUP_DTTM" AS "SCHEDULED_PICKUP_DTTM",
    tlmin."MANIFEST_ID" AS "MANIFEST_ID",
    tlmin."DAYS_TO_DELIVER" AS "DAYS_TO_DELIVER",
    tlmin."SED_GENERATED_FLAG" AS "SED_GENERATED_FLAG",
    tlmin."SERV_AREA_CODE" AS "SERV_AREA_CODE",
    tlmin."TENDER_RESP_DEADLINE_DTTM" AS "TENDER_RESP_DEADLINE_DTTM",
    tlmin."PRINT_CONS_BOL" AS "PRINT_CONS_BOL",
    tlmin."LEFT_WT" AS "LEFT_WT",
    tlmin."RIGHT_WT" AS "RIGHT_WT",
    tlmin."LANE_NAME" AS "LANE_NAME",
    tlmin."DECLARED_VALUE" AS "DECLARED_VALUE",
    tlmin."DV_CURRENCY_CODE" AS "DV_CURRENCY_CODE",
    tlmin."COD_AMOUNT" AS "COD_AMOUNT",
    tlmin."CUSTOMER_ID" AS "CUSTOMER_ID",
    tlmin."CUST_FRGT_CHARGE" AS "CUST_FRGT_CHARGE",
    tlmin."COD_CURRENCY_CODE" AS "COD_CURRENCY_CODE",
    tlmin."PLANNED_WEIGHT" AS "PLANNED_WEIGHT",
    tlmin."WEIGHT_UOM_ID_BASE" AS "WEIGHT_UOM_ID_BASE",
    tlmin."PLANNED_VOLUME" AS "PLANNED_VOLUME",
    tlmin."VOLUME_UOM_ID_BASE" AS "VOLUME_UOM_ID_BASE",
    tlmin."SIZE1_VALUE" AS "SIZE1_VALUE",
    tlmin."SIZE1_UOM_ID" AS "SIZE1_UOM_ID",
    tlmin."SIZE2_VALUE" AS "SIZE2_VALUE",
    tlmin."SIZE2_UOM_ID" AS "SIZE2_UOM_ID",
    tlmin."ASSIGNED_SHIP_VIA" AS "ASSIGNED_SHIP_VIA",
    tlmin."INSURANCE_STATUS" AS "INSURANCE_STATUS",
    tlmin."RTE_SWC_NBR" AS "RTE_SWC_NBR",
    tlmin."RTE_TO" AS "RTE_TO",
    tlmin."BILL_OF_LADING_NUMBER" AS "BILL_OF_LADING_NUMBER",
    tlmin."TRAILER_NUMBER" AS "TRAILER_NUMBER",
    tlmin."TRANS_PLAN_OWNER" AS "TRANS_PLAN_OWNER",
    tlmin."TOTAL_REVENUE_CURRENCY_CODE" AS "TOTAL_REVENUE_CURRENCY_CODE",
    tlmin."TOTAL_REVENUE" AS "TOTAL_REVENUE",
    tlmin."FRT_REV_SPOT_CHARGE_CURR_CODE" AS "FRT_REV_SPOT_CHARGE_CURR_CODE",
    tlmin."NORMALIZED_TOTAL_REVENUE" AS "NORMALIZED_TOTAL_REVENUE",
    tlmin."FRT_REV_SPOT_CHARGE" AS "FRT_REV_SPOT_CHARGE",
    tlmin."DSG_VOYAGE_FLIGHT" AS "DSG_VOYAGE_FLIGHT",
    tlmin."FEASIBLE_VOYAGE_FLIGHT" AS "FEASIBLE_VOYAGE_FLIGHT",
    tlmin."CURRENCY_DTTM" AS "CURRENCY_DTTM",
    tlmin."FRT_REV_LINEHAUL_CHARGE" AS "FRT_REV_LINEHAUL_CHARGE",
    tlmin."FRT_REV_STOP_CHARGE" AS "FRT_REV_STOP_CHARGE",
    tlmin."FRT_REV_ACCESSORIAL_CHARGE" AS "FRT_REV_ACCESSORIAL_CHARGE",
    tlmin."MARGIN" AS "MARGIN",
    tlmin."INCOTERM_ID" AS "INCOTERM_ID",
    tlmin."ORDER_QTY" AS "ORDER_QTY",
    tlmin."QTY_UOM_ID" AS "QTY_UOM_ID",
    tlmin."REF_SHIPMENT_NBR" AS "REF_SHIPMENT_NBR",
    tlmin."STAGING_LOCN_ID" AS "STAGING_LOCN_ID",
    tlmin."LOADING_SEQ_ORD" AS "LOADING_SEQ_ORD",
    tlmin."HAZMAT_CERT_CONTACT" AS "HAZMAT_CERT_CONTACT",
    tlmin."HAZMAT_CERT_DECLARATION" AS "HAZMAT_CERT_DECLARATION",
    tlmin."CDC_TIMESTAMP" AS "CDC_TIMESTAMP",
    tlmin."OPERATION_TYPE" AS "OPERATION_TYPE",
    tlmin."ARCHIVED_DTTM" AS "ARCHIVED_DTTM",
    tlmin."ORIGIN" AS "ORIGIN",
    tlmin."FINAL_DESTINATION" AS "FINAL_DESTINATION",
    tlmin."actual_delivery_date_parsed" AS "actual_delivery_date_parsed",
    tlmin."wood_pellet" AS "wood_pellet",
    tlmin."act_del_MERCH_YEAR" AS "act_del_MERCH_YEAR",
    tlmin."act_del_YEAR_WEEK" AS "act_del_YEAR_WEEK",
    tlmin."act_del_YEAR_QUARTER" AS "act_del_YEAR_QUARTER",
    tlmin."act_del_YEAR_PERIOD" AS "act_del_YEAR_PERIOD",
    tlmin."invoice_shipping_id" AS "invoice_shipping_id",
    tlmin."TOTAL_COST" AS "TOTAL_COST",
    tlmin."org_Facility_Code" AS "org_Facility_Code",
    tlmin."org_Facility_Name" AS "org_Facility_Name",
    tlmin."org_Facility_Type" AS "org_Facility_Type",
    tlmin."dest_Facility_Code" AS "dest_Facility_Code",
    tlmin."dest_Facility_Name" AS "dest_Facility_Name",
    tlmin."dest_Facility_Type" AS "dest_Facility_Type",
    tlmin."inbound_flag" AS "inbound_flag",
    scfilter.order_id_po AS order_id_po,
   TRY_TO_NUMBER(scfilter.order_id_po) order_id_po_int
  FROM "TLM_SHIPMENT_JOINED_W_FACILITIES_INBOUND"  tlmin
  LEFT JOIN "SC_TLM_ORDERS_PREPARED_BY_ORDER_ID_FILTER" scfilter
    ON tlmin."TC_SHIPMENT_ID" = scfilter."TC_SHIPMENT_ID"

)

SELECT  
    "SHIPMENT_ID" AS "SHIPMENT_ID",
    "TC_COMPANY_ID" AS "TC_COMPANY_ID",
    "RS_AREA_ID" AS "RS_AREA_ID",
    "TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID",
    "PP_SHIPMENT_ID" AS "PP_SHIPMENT_ID",
    "SHIPMENT_STATUS" AS "SHIPMENT_STATUS",
    "UPDATE_SENT" AS "UPDATE_SENT",
    "BUSINESS_PROCESS" AS "BUSINESS_PROCESS",
    "CREATION_TYPE" AS "CREATION_TYPE",
    "CONS_RUN_ID" AS "CONS_RUN_ID",
    "IS_CANCELLED" AS "IS_CANCELLED",
    "RS_TYPE" AS "RS_TYPE",
    "RS_CONFIG_ID" AS "RS_CONFIG_ID",
    "RS_CONFIG_CYCLE_ID" AS "RS_CONFIG_CYCLE_ID",
    "CONFIG_CYCLE_SEQ" AS "CONFIG_CYCLE_SEQ",
    "CYCLE_DEADLINE_DTTM" AS "CYCLE_DEADLINE_DTTM",
    "CYCLE_EXECUTION_DTTM" AS "CYCLE_EXECUTION_DTTM",
    "LAST_RS_NOTIFICATION_DTTM" AS "LAST_RS_NOTIFICATION_DTTM",
    "CFMF_STATUS" AS "CFMF_STATUS",
    "AVAILABLE_DTTM" AS "AVAILABLE_DTTM",
    "CMID" AS "CMID",
    "CM_DISCOUNT" AS "CM_DISCOUNT",
    "O_FACILITY_NUMBER" AS "O_FACILITY_NUMBER",
    "O_FACILITY_ID" AS "O_FACILITY_ID",
    "O_ADDRESS" AS "O_ADDRESS",
    "O_CITY" AS "O_CITY",
    "O_STATE_PROV" AS "O_STATE_PROV",
    "O_POSTAL_CODE" AS "O_POSTAL_CODE",
    "O_COUNTY" AS "O_COUNTY",
    "O_COUNTRY_CODE" AS "O_COUNTRY_CODE",
    "D_FACILITY_NUMBER" AS "D_FACILITY_NUMBER",
    "D_FACILITY_ID" AS "D_FACILITY_ID",
    "D_ADDRESS" AS "D_ADDRESS",
    "D_CITY" AS "D_CITY",
    "D_STATE_PROV" AS "D_STATE_PROV",
    "D_POSTAL_CODE" AS "D_POSTAL_CODE",
    "D_COUNTY" AS "D_COUNTY",
    "D_COUNTRY_CODE" AS "D_COUNTRY_CODE",
    "DISTANCE" AS "DISTANCE",
    "DIRECT_DISTANCE" AS "DIRECT_DISTANCE",
    "OUT_OF_ROUTE_DISTANCE" AS "OUT_OF_ROUTE_DISTANCE",
    "DISTANCE_UOM" AS "DISTANCE_UOM",
    "BUSINESS_PARTNER_ID" AS "BUSINESS_PARTNER_ID",
    "COMMODITY_CLASS" AS "COMMODITY_CLASS",
    "IS_HAZMAT" AS "IS_HAZMAT",
    "IS_PERISHABLE" AS "IS_PERISHABLE",
    "BILLING_METHOD" AS "BILLING_METHOD",
    "DSG_CARRIER_CODE" AS "DSG_CARRIER_CODE",
    "REC_CMID" AS "REC_CMID",
    "REC_CM_SHIPMENT_ID" AS "REC_CM_SHIPMENT_ID",
    "ASSIGNED_CARRIER_CODE" AS "ASSIGNED_CARRIER_CODE",
    "SHIPMENT_REF_ID" AS "SHIPMENT_REF_ID",
    "BILL_TO_CODE" AS "BILL_TO_CODE",
    "BILL_TO_TITLE" AS "BILL_TO_TITLE",
    "BILL_TO_NAME" AS "BILL_TO_NAME",
    "BILL_TO_ADDRESS" AS "BILL_TO_ADDRESS",
    "BILL_TO_CITY" AS "BILL_TO_CITY",
    "BILL_TO_STATE_PROV" AS "BILL_TO_STATE_PROV",
    "BILL_TO_POSTAL_CODE" AS "BILL_TO_POSTAL_CODE",
    "BILL_TO_COUNTRY_CODE" AS "BILL_TO_COUNTRY_CODE",
    "BILL_TO_PHONE_NUMBER" AS "BILL_TO_PHONE_NUMBER",
    "PURCHASE_ORDER" AS "PURCHASE_ORDER",
    "PRO_NUMBER" AS "PRO_NUMBER",
    "TRANS_RESP_CODE" AS "TRANS_RESP_CODE",
    "BASELINE_COST" AS "BASELINE_COST",
    "ESTIMATED_COST" AS "ESTIMATED_COST",
    "LINEHAUL_COST" AS "LINEHAUL_COST",
    "ACCESSORIAL_COST" AS "ACCESSORIAL_COST",
    "STOP_COST" AS "STOP_COST",
    "ESTIMATED_SAVINGS" AS "ESTIMATED_SAVINGS",
    "SPOT_CHARGE" AS "SPOT_CHARGE",
    "CURRENCY_CODE" AS "CURRENCY_CODE",
    "PICKUP_START_DTTM" AS "PICKUP_START_DTTM",
    "PICKUP_END_DTTM" AS "PICKUP_END_DTTM",
    "DELIVERY_START_DTTM" AS "DELIVERY_START_DTTM",
    "DELIVERY_END_DTTM" AS "DELIVERY_END_DTTM",
    "NUM_STOPS" AS "NUM_STOPS",
    "NUM_DOCKS" AS "NUM_DOCKS",
    "ON_TIME_INDICATOR" AS "ON_TIME_INDICATOR",
    "HAS_NOTES" AS "HAS_NOTES",
    "HAS_ALERTS" AS "HAS_ALERTS",
    "HAS_IMPORT_ERROR" AS "HAS_IMPORT_ERROR",
    "HAS_SOFT_CHECK_ERROR" AS "HAS_SOFT_CHECK_ERROR",
    "HAS_TRACKING_MSG" AS "HAS_TRACKING_MSG",
    "TRACKING_MSG_PROBLEM" AS "TRACKING_MSG_PROBLEM",
    "REC_LINEHAUL_COST" AS "REC_LINEHAUL_COST",
    "REC_ACCESSORIAL_COST" AS "REC_ACCESSORIAL_COST",
    "REC_TOTAL_COST" AS "REC_TOTAL_COST",
    "CYCLE_RESP_DEADLINE_TZ" AS "CYCLE_RESP_DEADLINE_TZ",
    "TENDER_RESP_DEADLINE_TZ" AS "TENDER_RESP_DEADLINE_TZ",
    "PICKUP_TZ" AS "PICKUP_TZ",
    "DELIVERY_TZ" AS "DELIVERY_TZ",
    "ASSIGNED_LANE_ID" AS "ASSIGNED_LANE_ID",
    "ASSIGNED_LANE_DETAIL_ID" AS "ASSIGNED_LANE_DETAIL_ID",
    "REC_SPOT_CHARGE" AS "REC_SPOT_CHARGE",
    "REC_LANE_ID" AS "REC_LANE_ID",
    "REC_LANE_DETAIL_ID" AS "REC_LANE_DETAIL_ID",
    "TENDER_DTTM" AS "TENDER_DTTM",
    "O_STOP_LOCATION_NAME" AS "O_STOP_LOCATION_NAME",
    "D_STOP_LOCATION_NAME" AS "D_STOP_LOCATION_NAME",
    "ASSIGNED_CM_SHIPMENT_ID" AS "ASSIGNED_CM_SHIPMENT_ID",
    "REC_CM_DISCOUNT" AS "REC_CM_DISCOUNT",
    "REC_STOP_COST" AS "REC_STOP_COST",
    "LAST_SELECTOR_RUN_DTTM" AS "LAST_SELECTOR_RUN_DTTM",
    "LAST_CM_OPTION_GEN_DTTM" AS "LAST_CM_OPTION_GEN_DTTM",
    "IS_CM_OPTION_GEN_ACTIVE" AS "IS_CM_OPTION_GEN_ACTIVE",
    "RS_CYCLE_REMAINING" AS "RS_CYCLE_REMAINING",
    "IS_TIME_FEAS_ENABLED" AS "IS_TIME_FEAS_ENABLED",
    "EXT_SYS_SHIPMENT_ID" AS "EXT_SYS_SHIPMENT_ID",
    "EXTRACTION_DTTM" AS "EXTRACTION_DTTM",
    "ASSIGNED_BROKER_CARRIER_CODE" AS "ASSIGNED_BROKER_CARRIER_CODE",
    "USE_BROKER_AS_CARRIER" AS "USE_BROKER_AS_CARRIER",
    "BROKER_REF" AS "BROKER_REF",
    "RATING_QUALIFIER" AS "RATING_QUALIFIER",
    "STATUS_CHANGE_DTTM" AS "STATUS_CHANGE_DTTM",
    "BUDG_TOTAL_COST" AS "BUDG_TOTAL_COST",
    "NORMALIZED_MARGIN" AS "NORMALIZED_MARGIN",
    "NORMALIZED_TOTAL_COST" AS "NORMALIZED_TOTAL_COST",
    "BUDG_NORMALIZED_TOTAL_COST" AS "BUDG_NORMALIZED_TOTAL_COST",
    "REC_BUDG_LINEHAUL_COST" AS "REC_BUDG_LINEHAUL_COST",
    "REC_BUDG_STOP_COST" AS "REC_BUDG_STOP_COST",
    "REC_BUDG_CM_DISCOUNT" AS "REC_BUDG_CM_DISCOUNT",
    "REC_BUDG_ACCESSORIAL_COST" AS "REC_BUDG_ACCESSORIAL_COST",
    "REC_BUDG_TOTAL_COST" AS "REC_BUDG_TOTAL_COST",
    "REC_MARGIN" AS "REC_MARGIN",
    "REC_NORMALIZED_MARGIN" AS "REC_NORMALIZED_MARGIN",
    "REC_NORMALIZED_TOTAL_COST" AS "REC_NORMALIZED_TOTAL_COST",
    "REC_BUDG_NORMALIZED_TOTAL_COST" AS "REC_BUDG_NORMALIZED_TOTAL_COST",
    "BUDG_CURRENCY_CODE" AS "BUDG_CURRENCY_CODE",
    "SPOT_CHARGE_CURRENCY_CODE" AS "SPOT_CHARGE_CURRENCY_CODE",
    "REC_CURRENCY_CODE" AS "REC_CURRENCY_CODE",
    "REC_BUDG_CURRENCY_CODE" AS "REC_BUDG_CURRENCY_CODE",
    "REC_SPOT_CHARGE_CURRENCY_CODE" AS "REC_SPOT_CHARGE_CURRENCY_CODE",
    "RATING_LANE_ID" AS "RATING_LANE_ID",
    "FRT_REV_RATING_LANE_ID" AS "FRT_REV_RATING_LANE_ID",
    "REC_RATING_LANE_ID" AS "REC_RATING_LANE_ID",
    "REC_BUDG_RATING_LANE_ID" AS "REC_BUDG_RATING_LANE_ID",
    "RATING_LANE_DETAIL_ID" AS "RATING_LANE_DETAIL_ID",
    "FRT_REV_RATING_LANE_DETAIL_ID" AS "FRT_REV_RATING_LANE_DETAIL_ID",
    "REC_RATING_LANE_DETAIL_ID" AS "REC_RATING_LANE_DETAIL_ID",
    "REC_BUDG_RATING_LANE_DETAIL_ID" AS "REC_BUDG_RATING_LANE_DETAIL_ID",
    "BUDG_CM_DISCOUNT" AS "BUDG_CM_DISCOUNT",
    "NORMALIZED_BASELINE_COST" AS "NORMALIZED_BASELINE_COST",
    "BASELINE_COST_CURRENCY_CODE" AS "BASELINE_COST_CURRENCY_CODE",
    "REPORTED_COST" AS "REPORTED_COST",
    "TRACTOR_NUMBER" AS "TRACTOR_NUMBER",
    "IS_AUTO_DELIVERED" AS "IS_AUTO_DELIVERED",
    "SHIPMENT_TYPE" AS "SHIPMENT_TYPE",
    "ORIG_BUDG_TOTAL_COST" AS "ORIG_BUDG_TOTAL_COST",
    "ACCESSORIAL_COST_TO_CARRIER" AS "ACCESSORIAL_COST_TO_CARRIER",
    "CARRIER_CHARGE" AS "CARRIER_CHARGE",
    "ACTUAL_COST" AS "ACTUAL_COST",
    "EARNED_INCOME" AS "EARNED_INCOME",
    "SENT_TO_PKMS" AS "SENT_TO_PKMS",
    "IS_SHIPMENT_RECONCILED" AS "IS_SHIPMENT_RECONCILED",
    "DELIVERY_REQ" AS "DELIVERY_REQ",
    "DROPOFF_PICKUP" AS "DROPOFF_PICKUP",
    "PACKAGING" AS "PACKAGING",
    "SENT_TO_PKMS_DTTM" AS "SENT_TO_PKMS_DTTM",
    "WMS_STATUS_CODE" AS "WMS_STATUS_CODE",
    "SPOT_CHARGE_AND_PAYEE_ACC" AS "SPOT_CHARGE_AND_PAYEE_ACC",
    "SPOT_CHARGE_AND_PAYEE_ACC_CC" AS "SPOT_CHARGE_AND_PAYEE_ACC_CC",
    "NORM_SPOT_CHARGE_AND_PAYEE_ACC" AS "NORM_SPOT_CHARGE_AND_PAYEE_ACC",
    "FACILITY_SCHEDULE_ID" AS "FACILITY_SCHEDULE_ID",
    "EARNED_INCOME_CURRENCY_CODE" AS "EARNED_INCOME_CURRENCY_CODE",
    "ACTUAL_COST_CURRENCY_CODE" AS "ACTUAL_COST_CURRENCY_CODE",
    "SHIPMENT_RECON_DTTM" AS "SHIPMENT_RECON_DTTM",
    "PLN_RATING_LANE_ID" AS "PLN_RATING_LANE_ID",
    "PLN_RATING_LANE_DETAIL_ID" AS "PLN_RATING_LANE_DETAIL_ID",
    "PLN_TOTAL_COST" AS "PLN_TOTAL_COST",
    "PLN_LINEHAUL_COST" AS "PLN_LINEHAUL_COST",
    "PLN_TOTAL_ACCESSORIAL_COST" AS "PLN_TOTAL_ACCESSORIAL_COST",
    "PLN_STOP_OFF_COST" AS "PLN_STOP_OFF_COST",
    "PLN_NORMALIZED_TOTAL_COST" AS "PLN_NORMALIZED_TOTAL_COST",
    "PLN_CURRENCY_CODE" AS "PLN_CURRENCY_CODE",
    "PLN_ACCESSORL_COST_TO_CARRIER" AS "PLN_ACCESSORL_COST_TO_CARRIER",
    "PLN_CARRIER_CHARGE" AS "PLN_CARRIER_CHARGE",
    "WAYPOINT_TOTAL_COST" AS "WAYPOINT_TOTAL_COST",
    "WAYPOINT_HANDLING_COST" AS "WAYPOINT_HANDLING_COST",
    "GRS_OPERATION" AS "GRS_OPERATION",
    "IS_GRS_OPT_CYCLE_RUNNING" AS "IS_GRS_OPT_CYCLE_RUNNING",
    "IS_MANUAL_ASSIGN" AS "IS_MANUAL_ASSIGN",
    "LAST_RUN_GRS_DTTM" AS "LAST_RUN_GRS_DTTM",
    "GRS_MAX_SHIPMENT_STATUS" AS "GRS_MAX_SHIPMENT_STATUS",
    "PRIORITY_TYPE" AS "PRIORITY_TYPE",
    "MV_CURRENCY_CODE" AS "MV_CURRENCY_CODE",
    "PROD_SCHED_REF_NUMBER" AS "PROD_SCHED_REF_NUMBER",
    "COMMODITY_CODE_ID" AS "COMMODITY_CODE_ID",
    "UN_NUMBER_ID" AS "UN_NUMBER_ID",
    "CONTRACT_NUMBER" AS "CONTRACT_NUMBER",
    "BOOKING_REF_SHIPPER" AS "BOOKING_REF_SHIPPER",
    "BOOKING_REF_CARRIER" AS "BOOKING_REF_CARRIER",
    "BK_RESOURCE_REF_EXTERNAL" AS "BK_RESOURCE_REF_EXTERNAL",
    "BK_RESOURCE_NAME_EXTERNAL" AS "BK_RESOURCE_NAME_EXTERNAL",
    "BK_O_FACILITY_ID" AS "BK_O_FACILITY_ID",
    "BK_D_FACILITY_ID" AS "BK_D_FACILITY_ID",
    "BK_MASTER_AIRWAY_BILL" AS "BK_MASTER_AIRWAY_BILL",
    "BK_FORWARDER_AIRWAY_BILL" AS "BK_FORWARDER_AIRWAY_BILL",
    "ASSIGNED_SCNDR_CARRIER_CODE" AS "ASSIGNED_SCNDR_CARRIER_CODE",
    "CUSTOMER_CREDIT_LIMIT_ID" AS "CUSTOMER_CREDIT_LIMIT_ID",
    "SHIPMENT_LEG_TYPE" AS "SHIPMENT_LEG_TYPE",
    "SHIPMENT_CLOSED_INDICATOR" AS "SHIPMENT_CLOSED_INDICATOR",
    "OCEAN_ROUTING_STAGE" AS "OCEAN_ROUTING_STAGE",
    "BK_DEPARTURE_DTTM" AS "BK_DEPARTURE_DTTM",
    "BK_DEPARTURE_TZ" AS "BK_DEPARTURE_TZ",
    "BK_ARRIVAL_DTTM" AS "BK_ARRIVAL_DTTM",
    "BK_ARRIVAL_TZ" AS "BK_ARRIVAL_TZ",
    "BK_PICKUP_DTTM" AS "BK_PICKUP_DTTM",
    "BK_PICKUP_TZ" AS "BK_PICKUP_TZ",
    "BK_CUTOFF_DTTM" AS "BK_CUTOFF_DTTM",
    "BK_CUTOFF_TZ" AS "BK_CUTOFF_TZ",
    "NUM_CHARGE_LAYOVERS" AS "NUM_CHARGE_LAYOVERS",
    "RATE_TYPE" AS "RATE_TYPE",
    "RATE_UOM" AS "RATE_UOM",
    "PICK_START_DTTM" AS "PICK_START_DTTM",
    "PAPERWORK_START_DTTM" AS "PAPERWORK_START_DTTM",
    "VEHICLE_CHECK_START_DTTM" AS "VEHICLE_CHECK_START_DTTM",
    "SHIPMENT_START_DTTM" AS "SHIPMENT_START_DTTM",
    "SHIPMENT_END_DTTM" AS "SHIPMENT_END_DTTM",
    "FEASIBLE_DRIVER_TYPE" AS "FEASIBLE_DRIVER_TYPE",
    "WAVE_ID" AS "WAVE_ID",
    "ESTIMATED_DISPATCH_DTTM" AS "ESTIMATED_DISPATCH_DTTM",
    "TOTAL_TIME" AS "TOTAL_TIME",
    "LOC_REFERENCE" AS "LOC_REFERENCE",
    "BK_O_FACILITY_ALIAS_ID" AS "BK_O_FACILITY_ALIAS_ID",
    "BK_D_FACILITY_ALIAS_ID" AS "BK_D_FACILITY_ALIAS_ID",
    "EQUIP_UTIL_PER" AS "EQUIP_UTIL_PER",
    "MOVE_TYPE" AS "MOVE_TYPE",
    "DRIVER_TYPE_ID" AS "DRIVER_TYPE_ID",
    "EQUIPMENT_TYPE" AS "EQUIPMENT_TYPE",
    "RADIAL_DISTANCE" AS "RADIAL_DISTANCE",
    "RADIAL_DISTANCE_UOM" AS "RADIAL_DISTANCE_UOM",
    "DESIGNATED_TRACTOR_CODE" AS "DESIGNATED_TRACTOR_CODE",
    "DESIGNATED_DRIVER_TYPE" AS "DESIGNATED_DRIVER_TYPE",
    "IS_WAVE_MAN_CHANGED" AS "IS_WAVE_MAN_CHANGED",
    "RETAIN_CONSOLIDATOR_TIMES" AS "RETAIN_CONSOLIDATOR_TIMES",
    "TARIFF" AS "TARIFF",
    "MIN_RATE" AS "MIN_RATE",
    "FIRST_UPDATE_SENT_TO_PKMS" AS "FIRST_UPDATE_SENT_TO_PKMS",
    "EVENT_IND_TYPEID" AS "EVENT_IND_TYPEID",
    "TANDEM_PATH_ID" AS "TANDEM_PATH_ID",
    "O_TANDEM_FACILITY" AS "O_TANDEM_FACILITY",
    "D_TANDEM_FACILITY" AS "D_TANDEM_FACILITY",
    "O_TANDEM_FACILITY_ALIAS" AS "O_TANDEM_FACILITY_ALIAS",
    "D_TANDEM_FACILITY_ALIAS" AS "D_TANDEM_FACILITY_ALIAS",
    "DELAY_TYPE" AS "DELAY_TYPE",
    "ASSIGNED_CARRIER_ID" AS "ASSIGNED_CARRIER_ID",
    "DSG_CARRIER_ID" AS "DSG_CARRIER_ID",
    "REC_CARRIER_ID" AS "REC_CARRIER_ID",
    "FEASIBLE_CARRIER_ID" AS "FEASIBLE_CARRIER_ID",
    "PAYEE_CARRIER_ID" AS "PAYEE_CARRIER_ID",
    "SCNDR_CARRIER_ID" AS "SCNDR_CARRIER_ID",
    "BROKER_CARRIER_ID" AS "BROKER_CARRIER_ID",
    "ASSIGNED_SCNDR_CARRIER_ID" AS "ASSIGNED_SCNDR_CARRIER_ID",
    "DSG_SCNDR_CARRIER_ID" AS "DSG_SCNDR_CARRIER_ID",
    "ASSIGNED_BROKER_CARRIER_ID" AS "ASSIGNED_BROKER_CARRIER_ID",
    "LH_PAYEE_CARRIER_ID" AS "LH_PAYEE_CARRIER_ID",
    "REC_BROKER_CARRIER_ID" AS "REC_BROKER_CARRIER_ID",
    "ASSIGNED_EQUIPMENT_ID" AS "ASSIGNED_EQUIPMENT_ID",
    "DSG_EQUIPMENT_ID" AS "DSG_EQUIPMENT_ID",
    "FEASIBLE_EQUIPMENT_ID" AS "FEASIBLE_EQUIPMENT_ID",
    "FEASIBLE_EQUIPMENT2_ID" AS "FEASIBLE_EQUIPMENT2_ID",
    "REC_EQUIPMENT_ID" AS "REC_EQUIPMENT_ID",
    "ASSIGNED_MOT_ID" AS "ASSIGNED_MOT_ID",
    "DSG_MOT_ID" AS "DSG_MOT_ID",
    "FEASIBLE_MOT_ID" AS "FEASIBLE_MOT_ID",
    "REC_MOT_ID" AS "REC_MOT_ID",
    "PRODUCT_CLASS_ID" AS "PRODUCT_CLASS_ID",
    "PROTECTION_LEVEL_ID" AS "PROTECTION_LEVEL_ID",
    "ASSIGNED_SERVICE_LEVEL_ID" AS "ASSIGNED_SERVICE_LEVEL_ID",
    "DSG_SERVICE_LEVEL_ID" AS "DSG_SERVICE_LEVEL_ID",
    "FEASIBLE_SERVICE_LEVEL_ID" AS "FEASIBLE_SERVICE_LEVEL_ID",
    "REC_SERVICE_LEVEL_ID" AS "REC_SERVICE_LEVEL_ID",
    "HAS_EM_NOTIFY_FLAG" AS "HAS_EM_NOTIFY_FLAG",
    "REGION_ID" AS "REGION_ID",
    "INBOUND_REGION_ID" AS "INBOUND_REGION_ID",
    "OUTBOUND_REGION_ID" AS "OUTBOUND_REGION_ID",
    "FINANCIAL_WT" AS "FINANCIAL_WT",
    "IS_BOOKING_REQUIRED" AS "IS_BOOKING_REQUIRED",
    "TOTAL_COST_EXCL_TAX" AS "TOTAL_COST_EXCL_TAX",
    "TOTAL_TAX_AMOUNT" AS "TOTAL_TAX_AMOUNT",
    "IS_ASSOCIATED_TO_OUTBOUND" AS "IS_ASSOCIATED_TO_OUTBOUND",
    "RECEIVED_DTTM" AS "RECEIVED_DTTM",
    "BOOKING_ID" AS "BOOKING_ID",
    "IS_MISROUTED" AS "IS_MISROUTED",
    "FEASIBLE_CARRIER_CODE" AS "FEASIBLE_CARRIER_CODE",
    "SHIPMENT_WIN_ADJ_FLAG" AS "SHIPMENT_WIN_ADJ_FLAG",
    "DT_PARAM_SET_ID" AS "DT_PARAM_SET_ID",
    "MERCHANDIZING_DEPARTMENT_ID" AS "MERCHANDIZING_DEPARTMENT_ID",
    "STATIC_ROUTE_ID" AS "STATIC_ROUTE_ID",
    "IS_FILO" AS "IS_FILO",
    "IS_COOLER_AT_NOSE" AS "IS_COOLER_AT_NOSE",
    "AUTH_NBR" AS "AUTH_NBR",
    "CONS_LOCN_ID" AS "CONS_LOCN_ID",
    "RTE_TYPE" AS "RTE_TYPE",
    "TRLR_TYPE" AS "TRLR_TYPE",
    "TRLR_SIZE" AS "TRLR_SIZE",
    "CONS_ADDR_CODE" AS "CONS_ADDR_CODE",
    "HUB_ID" AS "HUB_ID",
    "TRLR_GEN_CODE" AS "TRLR_GEN_CODE",
    "MAX_NBR_OF_CTNS" AS "MAX_NBR_OF_CTNS",
    "APPT_DOOR_SCHED_TYPE" AS "APPT_DOOR_SCHED_TYPE",
    "CREATED_SOURCE_TYPE" AS "CREATED_SOURCE_TYPE",
    "CREATED_SOURCE" AS "CREATED_SOURCE",
    "CREATED_DTTM" AS "CREATED_DTTM",
    "LAST_UPDATED_SOURCE_TYPE" AS "LAST_UPDATED_SOURCE_TYPE",
    "LAST_UPDATED_SOURCE" AS "LAST_UPDATED_SOURCE",
    "LAST_UPDATED_DTTM" AS "LAST_UPDATED_DTTM",
    "DSG_SCNDR_CARRIER_CODE" AS "DSG_SCNDR_CARRIER_CODE",
    "LH_PAYEE_CARRIER_CODE" AS "LH_PAYEE_CARRIER_CODE",
    "REC_BROKER_CARRIER_CODE" AS "REC_BROKER_CARRIER_CODE",
    "REC_CARRIER_CODE" AS "REC_CARRIER_CODE",
    "LPN_ASSIGNMENT_STOPPED" AS "LPN_ASSIGNMENT_STOPPED",
    "SEAL_NUMBER" AS "SEAL_NUMBER",
    "HIBERNATE_VERSION" AS "HIBERNATE_VERSION",
    "SHIP_GROUP_ID" AS "SHIP_GROUP_ID",
    "RATE" AS "RATE",
    "MONETARY_VALUE" AS "MONETARY_VALUE",
    "DOOR" AS "DOOR",
    "RTE_TYPE_1" AS "RTE_TYPE_1",
    "RTE_TYPE_2" AS "RTE_TYPE_2",
    "SCHEDULED_PICKUP_DTTM" AS "SCHEDULED_PICKUP_DTTM",
    "MANIFEST_ID" AS "MANIFEST_ID",
    "DAYS_TO_DELIVER" AS "DAYS_TO_DELIVER",
    "SED_GENERATED_FLAG" AS "SED_GENERATED_FLAG",
    "SERV_AREA_CODE" AS "SERV_AREA_CODE",
    "TENDER_RESP_DEADLINE_DTTM" AS "TENDER_RESP_DEADLINE_DTTM",
    "PRINT_CONS_BOL" AS "PRINT_CONS_BOL",
    "LEFT_WT" AS "LEFT_WT",
    "RIGHT_WT" AS "RIGHT_WT",
    "LANE_NAME" AS "LANE_NAME",
    "DECLARED_VALUE" AS "DECLARED_VALUE",
    "DV_CURRENCY_CODE" AS "DV_CURRENCY_CODE",
    "COD_AMOUNT" AS "COD_AMOUNT",
    "CUSTOMER_ID" AS "CUSTOMER_ID",
    "CUST_FRGT_CHARGE" AS "CUST_FRGT_CHARGE",
    "COD_CURRENCY_CODE" AS "COD_CURRENCY_CODE",
    "PLANNED_WEIGHT" AS "PLANNED_WEIGHT",
    "WEIGHT_UOM_ID_BASE" AS "WEIGHT_UOM_ID_BASE",
    "PLANNED_VOLUME" AS "PLANNED_VOLUME",
    "VOLUME_UOM_ID_BASE" AS "VOLUME_UOM_ID_BASE",
    "SIZE1_VALUE" AS "SIZE1_VALUE",
    "SIZE1_UOM_ID" AS "SIZE1_UOM_ID",
    "SIZE2_VALUE" AS "SIZE2_VALUE",
    "SIZE2_UOM_ID" AS "SIZE2_UOM_ID",
    "ASSIGNED_SHIP_VIA" AS "ASSIGNED_SHIP_VIA",
    "INSURANCE_STATUS" AS "INSURANCE_STATUS",
    "RTE_SWC_NBR" AS "RTE_SWC_NBR",
    "RTE_TO" AS "RTE_TO",
    "BILL_OF_LADING_NUMBER" AS "BILL_OF_LADING_NUMBER",
    "TRAILER_NUMBER" AS "TRAILER_NUMBER",
    "TRANS_PLAN_OWNER" AS "TRANS_PLAN_OWNER",
    "TOTAL_REVENUE_CURRENCY_CODE" AS "TOTAL_REVENUE_CURRENCY_CODE",
    "TOTAL_REVENUE" AS "TOTAL_REVENUE",
    "FRT_REV_SPOT_CHARGE_CURR_CODE" AS "FRT_REV_SPOT_CHARGE_CURR_CODE",
    "NORMALIZED_TOTAL_REVENUE" AS "NORMALIZED_TOTAL_REVENUE",
    "FRT_REV_SPOT_CHARGE" AS "FRT_REV_SPOT_CHARGE",
    "DSG_VOYAGE_FLIGHT" AS "DSG_VOYAGE_FLIGHT",
    "FEASIBLE_VOYAGE_FLIGHT" AS "FEASIBLE_VOYAGE_FLIGHT",
    "CURRENCY_DTTM" AS "CURRENCY_DTTM",
    "FRT_REV_LINEHAUL_CHARGE" AS "FRT_REV_LINEHAUL_CHARGE",
    "FRT_REV_STOP_CHARGE" AS "FRT_REV_STOP_CHARGE",
    "FRT_REV_ACCESSORIAL_CHARGE" AS "FRT_REV_ACCESSORIAL_CHARGE",
    "MARGIN" AS "MARGIN",
    "TOTAL_COST" AS "TOTAL_COST",
    "INCOTERM_ID" AS "INCOTERM_ID",
    "ORDER_QTY" AS "ORDER_QTY",
    "QTY_UOM_ID" AS "QTY_UOM_ID",
    "REF_SHIPMENT_NBR" AS "REF_SHIPMENT_NBR",
    "STAGING_LOCN_ID" AS "STAGING_LOCN_ID",
    "LOADING_SEQ_ORD" AS "LOADING_SEQ_ORD",
    "HAZMAT_CERT_CONTACT" AS "HAZMAT_CERT_CONTACT",
    "HAZMAT_CERT_DECLARATION" AS "HAZMAT_CERT_DECLARATION",
    "CDC_TIMESTAMP" AS "CDC_TIMESTAMP",
    "OPERATION_TYPE" AS "OPERATION_TYPE",
    "ARCHIVED_DTTM" AS "ARCHIVED_DTTM",
    "ORIGIN" AS "ORIGIN",
    "FINAL_DESTINATION" AS "FINAL_DESTINATION",
    "actual_delivery_date_parsed" AS "actual_delivery_date_parsed",
    "wood_pellet" AS "wood_pellet",
    "act_del_MERCH_YEAR" AS "act_del_MERCH_YEAR",
    "act_del_YEAR_WEEK" AS "act_del_YEAR_WEEK",
    "act_del_YEAR_QUARTER" AS "act_del_YEAR_QUARTER",
    "act_del_YEAR_PERIOD" AS "act_del_YEAR_PERIOD",
    "invoice_shipping_id" AS "invoice_shipping_id",
    "org_Facility_Code" AS "org_Facility_Code",
    "org_Facility_Name" AS "org_Facility_Name",
    "org_Facility_Type" AS "org_Facility_Type",
    "dest_Facility_Code" AS "dest_Facility_Code",
    "dest_Facility_Name" AS "dest_Facility_Name",
    "dest_Facility_Type" AS "dest_Facility_Type",
    "inbound_flag" AS "inbound_flag",
    "order_id_po" AS "order_id_po",
    "order_id_po_int" AS "order_id_po_int",
    "po_STORE_NO" AS "po_STORE_NO",
    "po_CO_CODE" AS "po_CO_CODE",
    "po_ARTICLE_NO" AS "po_ARTICLE_NO",
    "po_PO_NO" AS "po_PO_NO",
    "po_PO_LINE_NO" AS "po_PO_LINE_NO",
    "po_PO_DATE" AS "po_PO_DATE",
    "po_po_date_parsed" AS "po_po_date_parsed",
    "po_DELIV_DATE" AS "po_DELIV_DATE",
    "po_deliv_date_parsed" AS "po_deliv_date_parsed",
    "po_PO_TYPE_CODE" AS "po_PO_TYPE_CODE",
    "po_VENDOR_ID" AS "po_VENDOR_ID",
    "po_VSR_CODE" AS "po_VSR_CODE",
    "po_PO_LINE_CANCELLED_FLAG" AS "po_PO_LINE_CANCELLED_FLAG",
    "po_PO_LINE_ORDER_QTY" AS "po_PO_LINE_ORDER_QTY",
    "po_PO_LINE_ISSUE_QTY" AS "po_PO_LINE_ISSUE_QTY",
    "po_PO_LINE_RCVD_QTY" AS "po_PO_LINE_RCVD_QTY",
    "po_PO_LINE_UNIT_PRICE" AS "po_PO_LINE_UNIT_PRICE",
    "po_DC_NO" AS "po_DC_NO",
    "po_PO_TRACKING_NO" AS "po_PO_TRACKING_NO",
    "po_PO_LINE_TRACKING_NO" AS "po_PO_LINE_TRACKING_NO",
    "po_CURRENT_REPL_TYPE_CODE" AS "po_CURRENT_REPL_TYPE_CODE",
    "po_FREIGHT_TYPE_CODE" AS "po_FREIGHT_TYPE_CODE",
    "po_SHIP_START_DATE" AS "po_SHIP_START_DATE",
    "po_SHIP_END_DATE" AS "po_SHIP_END_DATE",
    "po_DELIV_START_DATE" AS "po_DELIV_START_DATE",
    "po_DELIV_END_DATE" AS "po_DELIV_END_DATE",
    "po_PO_LINE_UNIT_FREIGHT_AMT" AS "po_PO_LINE_UNIT_FREIGHT_AMT",
    "po_PO_LINE_MANUFACTURER" AS "po_PO_LINE_MANUFACTURER",
    "po_PO_LINE_ORIGIN_COUNTRY_CODE" AS "po_PO_LINE_ORIGIN_COUNTRY_CODE",
    "po_PO_LINE_PORT_OF_ORIGIN" AS "po_PO_LINE_PORT_OF_ORIGIN",
    "po_PO_LINE_MIN_RCVD_DATE" AS "po_PO_LINE_MIN_RCVD_DATE",
    "po_PO_LINE_MAX_RCVD_DATE" AS "po_PO_LINE_MAX_RCVD_DATE",
    "po_PO_LINE_DELIVERED_FLAG" AS "po_PO_LINE_DELIVERED_FLAG",
    "po_PO_LINE_CONFIRMED_ON_BOARD_DATE" AS "po_PO_LINE_CONFIRMED_ON_BOARD_DATE",
    "po_PO_LINE_BOOKED_FOR_SHIPMENT_DATE" AS "po_PO_LINE_BOOKED_FOR_SHIPMENT_DATE",
    "po_PO_LINE_TRANSIT_RESN_CODE" AS "po_PO_LINE_TRANSIT_RESN_CODE",
    "po_PO_LINE_MOVE_TYPE_CODE" AS "po_PO_LINE_MOVE_TYPE_CODE",
    "po_PO_LINE_AGENT_COMMISSION_RATE" AS "po_PO_LINE_AGENT_COMMISSION_RATE",
    "po_PO_LINE_AGENT_COMMISSION_AMT" AS "po_PO_LINE_AGENT_COMMISSION_AMT",
    "po_PO_LINE_ADDL_ARTICLE_NO" AS "po_PO_LINE_ADDL_ARTICLE_NO",
    "po_PO_LINE_ADDL_ARTICLE_QTY" AS "po_PO_LINE_ADDL_ARTICLE_QTY",
    "po_PO_LINE_FACTORY_VENDOR_ID" AS "po_PO_LINE_FACTORY_VENDOR_ID",
    "po_PO_LINE_STUFFING_LOC_VENDOR_ID" AS "po_PO_LINE_STUFFING_LOC_VENDOR_ID",
    "po_PO_LINE_SOURCING_AGENT_VENDOR_ID" AS "po_PO_LINE_SOURCING_AGENT_VENDOR_ID",
    "po_PO_LINE_FREIGHT_FORWARDER_VENDOR_ID" AS "po_PO_LINE_FREIGHT_FORWARDER_VENDOR_ID",
    "po_PO_LINE_LETTER_OF_CREDIT_NO" AS "po_PO_LINE_LETTER_OF_CREDIT_NO",
    "po_PO_LINE_OPEN_ACCT_NO" AS "po_PO_LINE_OPEN_ACCT_NO",
    "po_PO_LINE_ARTICLE_LENGTH" AS "po_PO_LINE_ARTICLE_LENGTH",
    "po_PO_LINE_ARTICLE_WIDTH" AS "po_PO_LINE_ARTICLE_WIDTH",
    "po_PO_LINE_ARTICLE_HEIGHT" AS "po_PO_LINE_ARTICLE_HEIGHT",
    "po_PO_LINE_ARTICLE_DIMENSIONS_UOM" AS "po_PO_LINE_ARTICLE_DIMENSIONS_UOM",
    "po_PO_LINE_ARTICLE_WEIGHT" AS "po_PO_LINE_ARTICLE_WEIGHT",
    "po_PO_LINE_ARTICLE_WEIGHT_UOM" AS "po_PO_LINE_ARTICLE_WEIGHT_UOM",
    "po_PO_TOTAL_WEIGHT" AS "po_PO_TOTAL_WEIGHT",
    "po_PO_LINE_ARTICLE_VOLUME" AS "po_PO_LINE_ARTICLE_VOLUME",
    "po_PO_LINE_ARTICLE_VOLUME_UOM" AS "po_PO_LINE_ARTICLE_VOLUME_UOM",
    "po_PO_TOTAL_VOLUME" AS "po_PO_TOTAL_VOLUME",
    "po_HTS_CODE" AS "po_HTS_CODE",
    "po_PO_LINE_DUTY_RATE" AS "po_PO_LINE_DUTY_RATE",
    "po_PO_LINE_DUTY_AMT" AS "po_PO_LINE_DUTY_AMT",
    "po_PO_LINE_ADDL_HTS_CODE_1" AS "po_PO_LINE_ADDL_HTS_CODE_1",
    "po_PO_LINE_ADDL_DUTY_RATE_1" AS "po_PO_LINE_ADDL_DUTY_RATE_1",
    "po_PO_LINE_ADDL_DUTY_AMT_1" AS "po_PO_LINE_ADDL_DUTY_AMT_1",
    "po_PO_LINE_ADDL_HTS_CODE_2" AS "po_PO_LINE_ADDL_HTS_CODE_2",
    "po_PO_LINE_ADDL_DUTY_RATE_2" AS "po_PO_LINE_ADDL_DUTY_RATE_2",
    "po_PO_LINE_ADDL_DUTY_AMT_2" AS "po_PO_LINE_ADDL_DUTY_AMT_2",
    "po_PO_HELD_FLAG" AS "po_PO_HELD_FLAG",
    "po_PO_VENDOR_DOC_DATE" AS "po_PO_VENDOR_DOC_DATE",
    "po_cal_MERCH_YEAR" AS "po_cal_MERCH_YEAR",
    "po_cal_YEAR_WEEK" AS "po_cal_YEAR_WEEK",
    "po_cal_YEAR_QUARTER" AS "po_cal_YEAR_QUARTER",
    "po_cal_YEAR_PERIOD" AS "po_cal_YEAR_PERIOD",
    "a_ARTICLE_LENGTH" AS "a_ARTICLE_LENGTH",
    "a_ARTICLE_WIDTH" AS "a_ARTICLE_WIDTH",
    "a_ARTICLE_HEIGHT" AS "a_ARTICLE_HEIGHT",
    item_volume AS "item_volume",
    "a_ARTICLE_WEIGHT" AS "a_ARTICLE_WEIGHT",
    item_weight AS "item_weight",
    "a_ARTICLE_SIZE" AS "a_ARTICLE_SIZE",
    "a_ARTICLE_40HC_QTY" AS "a_ARTICLE_40HC_QTY",
    "a_ARTICLE_40GP_QTY" AS "a_ARTICLE_40GP_QTY",
    SUM("item_volume") OVER (PARTITION BY "TC_SHIPMENT_ID") AS "item_volume_sum",
    SUM("item_weight") OVER (PARTITION BY "TC_SHIPMENT_ID") AS "item_weight_sum"
FROM (
SELECT 
    "tlm_shipment_joined_w_po_prepared"."SHIPMENT_ID" AS "SHIPMENT_ID",
    "tlm_shipment_joined_w_po_prepared"."TC_COMPANY_ID" AS "TC_COMPANY_ID",
    "tlm_shipment_joined_w_po_prepared"."RS_AREA_ID" AS "RS_AREA_ID",
    "tlm_shipment_joined_w_po_prepared"."TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID",
    "tlm_shipment_joined_w_po_prepared"."PP_SHIPMENT_ID" AS "PP_SHIPMENT_ID",
    "tlm_shipment_joined_w_po_prepared"."SHIPMENT_STATUS" AS "SHIPMENT_STATUS",
    "tlm_shipment_joined_w_po_prepared"."UPDATE_SENT" AS "UPDATE_SENT",
    "tlm_shipment_joined_w_po_prepared"."BUSINESS_PROCESS" AS "BUSINESS_PROCESS",
    "tlm_shipment_joined_w_po_prepared"."CREATION_TYPE" AS "CREATION_TYPE",
    "tlm_shipment_joined_w_po_prepared"."CONS_RUN_ID" AS "CONS_RUN_ID",
    "tlm_shipment_joined_w_po_prepared"."IS_CANCELLED" AS "IS_CANCELLED",
    "tlm_shipment_joined_w_po_prepared"."RS_TYPE" AS "RS_TYPE",
    "tlm_shipment_joined_w_po_prepared"."RS_CONFIG_ID" AS "RS_CONFIG_ID",
    "tlm_shipment_joined_w_po_prepared"."RS_CONFIG_CYCLE_ID" AS "RS_CONFIG_CYCLE_ID",
    "tlm_shipment_joined_w_po_prepared"."CONFIG_CYCLE_SEQ" AS "CONFIG_CYCLE_SEQ",
    "tlm_shipment_joined_w_po_prepared"."CYCLE_DEADLINE_DTTM" AS "CYCLE_DEADLINE_DTTM",
    "tlm_shipment_joined_w_po_prepared"."CYCLE_EXECUTION_DTTM" AS "CYCLE_EXECUTION_DTTM",
    "tlm_shipment_joined_w_po_prepared"."LAST_RS_NOTIFICATION_DTTM" AS "LAST_RS_NOTIFICATION_DTTM",
    "tlm_shipment_joined_w_po_prepared"."CFMF_STATUS" AS "CFMF_STATUS",
    "tlm_shipment_joined_w_po_prepared"."AVAILABLE_DTTM" AS "AVAILABLE_DTTM",
    "tlm_shipment_joined_w_po_prepared"."CMID" AS "CMID",
    "tlm_shipment_joined_w_po_prepared"."CM_DISCOUNT" AS "CM_DISCOUNT",
    "tlm_shipment_joined_w_po_prepared"."O_FACILITY_NUMBER" AS "O_FACILITY_NUMBER",
    "tlm_shipment_joined_w_po_prepared"."O_FACILITY_ID" AS "O_FACILITY_ID",
    "tlm_shipment_joined_w_po_prepared"."O_ADDRESS" AS "O_ADDRESS",
    "tlm_shipment_joined_w_po_prepared"."O_CITY" AS "O_CITY",
    "tlm_shipment_joined_w_po_prepared"."O_STATE_PROV" AS "O_STATE_PROV",
    "tlm_shipment_joined_w_po_prepared"."O_POSTAL_CODE" AS "O_POSTAL_CODE",
    "tlm_shipment_joined_w_po_prepared"."O_COUNTY" AS "O_COUNTY",
    "tlm_shipment_joined_w_po_prepared"."O_COUNTRY_CODE" AS "O_COUNTRY_CODE",
    "tlm_shipment_joined_w_po_prepared"."D_FACILITY_NUMBER" AS "D_FACILITY_NUMBER",
    "tlm_shipment_joined_w_po_prepared"."D_FACILITY_ID" AS "D_FACILITY_ID",
    "tlm_shipment_joined_w_po_prepared"."D_ADDRESS" AS "D_ADDRESS",
    "tlm_shipment_joined_w_po_prepared"."D_CITY" AS "D_CITY",
    "tlm_shipment_joined_w_po_prepared"."D_STATE_PROV" AS "D_STATE_PROV",
    "tlm_shipment_joined_w_po_prepared"."D_POSTAL_CODE" AS "D_POSTAL_CODE",
    "tlm_shipment_joined_w_po_prepared"."D_COUNTY" AS "D_COUNTY",
    "tlm_shipment_joined_w_po_prepared"."D_COUNTRY_CODE" AS "D_COUNTRY_CODE",
    "tlm_shipment_joined_w_po_prepared"."DISTANCE" AS "DISTANCE",
    "tlm_shipment_joined_w_po_prepared"."DIRECT_DISTANCE" AS "DIRECT_DISTANCE",
    "tlm_shipment_joined_w_po_prepared"."OUT_OF_ROUTE_DISTANCE" AS "OUT_OF_ROUTE_DISTANCE",
    "tlm_shipment_joined_w_po_prepared"."DISTANCE_UOM" AS "DISTANCE_UOM",
    "tlm_shipment_joined_w_po_prepared"."BUSINESS_PARTNER_ID" AS "BUSINESS_PARTNER_ID",
    "tlm_shipment_joined_w_po_prepared"."COMMODITY_CLASS" AS "COMMODITY_CLASS",
    "tlm_shipment_joined_w_po_prepared"."IS_HAZMAT" AS "IS_HAZMAT",
    "tlm_shipment_joined_w_po_prepared"."IS_PERISHABLE" AS "IS_PERISHABLE",
    "tlm_shipment_joined_w_po_prepared"."BILLING_METHOD" AS "BILLING_METHOD",
    "tlm_shipment_joined_w_po_prepared"."DSG_CARRIER_CODE" AS "DSG_CARRIER_CODE",
    "tlm_shipment_joined_w_po_prepared"."REC_CMID" AS "REC_CMID",
    "tlm_shipment_joined_w_po_prepared"."REC_CM_SHIPMENT_ID" AS "REC_CM_SHIPMENT_ID",
    "tlm_shipment_joined_w_po_prepared"."ASSIGNED_CARRIER_CODE" AS "ASSIGNED_CARRIER_CODE",
    "tlm_shipment_joined_w_po_prepared"."SHIPMENT_REF_ID" AS "SHIPMENT_REF_ID",
    "tlm_shipment_joined_w_po_prepared"."BILL_TO_CODE" AS "BILL_TO_CODE",
    "tlm_shipment_joined_w_po_prepared"."BILL_TO_TITLE" AS "BILL_TO_TITLE",
    "tlm_shipment_joined_w_po_prepared"."BILL_TO_NAME" AS "BILL_TO_NAME",
    "tlm_shipment_joined_w_po_prepared"."BILL_TO_ADDRESS" AS "BILL_TO_ADDRESS",
    "tlm_shipment_joined_w_po_prepared"."BILL_TO_CITY" AS "BILL_TO_CITY",
    "tlm_shipment_joined_w_po_prepared"."BILL_TO_STATE_PROV" AS "BILL_TO_STATE_PROV",
    "tlm_shipment_joined_w_po_prepared"."BILL_TO_POSTAL_CODE" AS "BILL_TO_POSTAL_CODE",
    "tlm_shipment_joined_w_po_prepared"."BILL_TO_COUNTRY_CODE" AS "BILL_TO_COUNTRY_CODE",
    "tlm_shipment_joined_w_po_prepared"."BILL_TO_PHONE_NUMBER" AS "BILL_TO_PHONE_NUMBER",
    "tlm_shipment_joined_w_po_prepared"."PURCHASE_ORDER" AS "PURCHASE_ORDER",
    "tlm_shipment_joined_w_po_prepared"."PRO_NUMBER" AS "PRO_NUMBER",
    "tlm_shipment_joined_w_po_prepared"."TRANS_RESP_CODE" AS "TRANS_RESP_CODE",
    "tlm_shipment_joined_w_po_prepared"."BASELINE_COST" AS "BASELINE_COST",
    "tlm_shipment_joined_w_po_prepared"."ESTIMATED_COST" AS "ESTIMATED_COST",
    "tlm_shipment_joined_w_po_prepared"."LINEHAUL_COST" AS "LINEHAUL_COST",
    "tlm_shipment_joined_w_po_prepared"."ACCESSORIAL_COST" AS "ACCESSORIAL_COST",
    "tlm_shipment_joined_w_po_prepared"."STOP_COST" AS "STOP_COST",
    "tlm_shipment_joined_w_po_prepared"."ESTIMATED_SAVINGS" AS "ESTIMATED_SAVINGS",
    "tlm_shipment_joined_w_po_prepared"."SPOT_CHARGE" AS "SPOT_CHARGE",
    "tlm_shipment_joined_w_po_prepared"."CURRENCY_CODE" AS "CURRENCY_CODE",
    "tlm_shipment_joined_w_po_prepared"."PICKUP_START_DTTM" AS "PICKUP_START_DTTM",
    "tlm_shipment_joined_w_po_prepared"."PICKUP_END_DTTM" AS "PICKUP_END_DTTM",
    "tlm_shipment_joined_w_po_prepared"."DELIVERY_START_DTTM" AS "DELIVERY_START_DTTM",
    "tlm_shipment_joined_w_po_prepared"."DELIVERY_END_DTTM" AS "DELIVERY_END_DTTM",
    "tlm_shipment_joined_w_po_prepared"."NUM_STOPS" AS "NUM_STOPS",
    "tlm_shipment_joined_w_po_prepared"."NUM_DOCKS" AS "NUM_DOCKS",
    "tlm_shipment_joined_w_po_prepared"."ON_TIME_INDICATOR" AS "ON_TIME_INDICATOR",
    "tlm_shipment_joined_w_po_prepared"."HAS_NOTES" AS "HAS_NOTES",
    "tlm_shipment_joined_w_po_prepared"."HAS_ALERTS" AS "HAS_ALERTS",
    "tlm_shipment_joined_w_po_prepared"."HAS_IMPORT_ERROR" AS "HAS_IMPORT_ERROR",
    "tlm_shipment_joined_w_po_prepared"."HAS_SOFT_CHECK_ERROR" AS "HAS_SOFT_CHECK_ERROR",
    "tlm_shipment_joined_w_po_prepared"."HAS_TRACKING_MSG" AS "HAS_TRACKING_MSG",
    "tlm_shipment_joined_w_po_prepared"."TRACKING_MSG_PROBLEM" AS "TRACKING_MSG_PROBLEM",
    "tlm_shipment_joined_w_po_prepared"."REC_LINEHAUL_COST" AS "REC_LINEHAUL_COST",
    "tlm_shipment_joined_w_po_prepared"."REC_ACCESSORIAL_COST" AS "REC_ACCESSORIAL_COST",
    "tlm_shipment_joined_w_po_prepared"."REC_TOTAL_COST" AS "REC_TOTAL_COST",
    "tlm_shipment_joined_w_po_prepared"."CYCLE_RESP_DEADLINE_TZ" AS "CYCLE_RESP_DEADLINE_TZ",
    "tlm_shipment_joined_w_po_prepared"."TENDER_RESP_DEADLINE_TZ" AS "TENDER_RESP_DEADLINE_TZ",
    "tlm_shipment_joined_w_po_prepared"."PICKUP_TZ" AS "PICKUP_TZ",
    "tlm_shipment_joined_w_po_prepared"."DELIVERY_TZ" AS "DELIVERY_TZ",
    "tlm_shipment_joined_w_po_prepared"."ASSIGNED_LANE_ID" AS "ASSIGNED_LANE_ID",
    "tlm_shipment_joined_w_po_prepared"."ASSIGNED_LANE_DETAIL_ID" AS "ASSIGNED_LANE_DETAIL_ID",
    "tlm_shipment_joined_w_po_prepared"."REC_SPOT_CHARGE" AS "REC_SPOT_CHARGE",
    "tlm_shipment_joined_w_po_prepared"."REC_LANE_ID" AS "REC_LANE_ID",
    "tlm_shipment_joined_w_po_prepared"."REC_LANE_DETAIL_ID" AS "REC_LANE_DETAIL_ID",
    "tlm_shipment_joined_w_po_prepared"."TENDER_DTTM" AS "TENDER_DTTM",
    "tlm_shipment_joined_w_po_prepared"."O_STOP_LOCATION_NAME" AS "O_STOP_LOCATION_NAME",
    "tlm_shipment_joined_w_po_prepared"."D_STOP_LOCATION_NAME" AS "D_STOP_LOCATION_NAME",
    "tlm_shipment_joined_w_po_prepared"."ASSIGNED_CM_SHIPMENT_ID" AS "ASSIGNED_CM_SHIPMENT_ID",
    "tlm_shipment_joined_w_po_prepared"."REC_CM_DISCOUNT" AS "REC_CM_DISCOUNT",
    "tlm_shipment_joined_w_po_prepared"."REC_STOP_COST" AS "REC_STOP_COST",
    "tlm_shipment_joined_w_po_prepared"."LAST_SELECTOR_RUN_DTTM" AS "LAST_SELECTOR_RUN_DTTM",
    "tlm_shipment_joined_w_po_prepared"."LAST_CM_OPTION_GEN_DTTM" AS "LAST_CM_OPTION_GEN_DTTM",
    "tlm_shipment_joined_w_po_prepared"."IS_CM_OPTION_GEN_ACTIVE" AS "IS_CM_OPTION_GEN_ACTIVE",
    "tlm_shipment_joined_w_po_prepared"."RS_CYCLE_REMAINING" AS "RS_CYCLE_REMAINING",
    "tlm_shipment_joined_w_po_prepared"."IS_TIME_FEAS_ENABLED" AS "IS_TIME_FEAS_ENABLED",
    "tlm_shipment_joined_w_po_prepared"."EXT_SYS_SHIPMENT_ID" AS "EXT_SYS_SHIPMENT_ID",
    "tlm_shipment_joined_w_po_prepared"."EXTRACTION_DTTM" AS "EXTRACTION_DTTM",
    "tlm_shipment_joined_w_po_prepared"."ASSIGNED_BROKER_CARRIER_CODE" AS "ASSIGNED_BROKER_CARRIER_CODE",
    "tlm_shipment_joined_w_po_prepared"."USE_BROKER_AS_CARRIER" AS "USE_BROKER_AS_CARRIER",
    "tlm_shipment_joined_w_po_prepared"."BROKER_REF" AS "BROKER_REF",
    "tlm_shipment_joined_w_po_prepared"."RATING_QUALIFIER" AS "RATING_QUALIFIER",
    "tlm_shipment_joined_w_po_prepared"."STATUS_CHANGE_DTTM" AS "STATUS_CHANGE_DTTM",
    "tlm_shipment_joined_w_po_prepared"."BUDG_TOTAL_COST" AS "BUDG_TOTAL_COST",
    "tlm_shipment_joined_w_po_prepared"."NORMALIZED_MARGIN" AS "NORMALIZED_MARGIN",
    "tlm_shipment_joined_w_po_prepared"."NORMALIZED_TOTAL_COST" AS "NORMALIZED_TOTAL_COST",
    "tlm_shipment_joined_w_po_prepared"."BUDG_NORMALIZED_TOTAL_COST" AS "BUDG_NORMALIZED_TOTAL_COST",
    "tlm_shipment_joined_w_po_prepared"."REC_BUDG_LINEHAUL_COST" AS "REC_BUDG_LINEHAUL_COST",
    "tlm_shipment_joined_w_po_prepared"."REC_BUDG_STOP_COST" AS "REC_BUDG_STOP_COST",
    "tlm_shipment_joined_w_po_prepared"."REC_BUDG_CM_DISCOUNT" AS "REC_BUDG_CM_DISCOUNT",
    "tlm_shipment_joined_w_po_prepared"."REC_BUDG_ACCESSORIAL_COST" AS "REC_BUDG_ACCESSORIAL_COST",
    "tlm_shipment_joined_w_po_prepared"."REC_BUDG_TOTAL_COST" AS "REC_BUDG_TOTAL_COST",
    "tlm_shipment_joined_w_po_prepared"."REC_MARGIN" AS "REC_MARGIN",
    "tlm_shipment_joined_w_po_prepared"."REC_NORMALIZED_MARGIN" AS "REC_NORMALIZED_MARGIN",
    "tlm_shipment_joined_w_po_prepared"."REC_NORMALIZED_TOTAL_COST" AS "REC_NORMALIZED_TOTAL_COST",
    "tlm_shipment_joined_w_po_prepared"."REC_BUDG_NORMALIZED_TOTAL_COST" AS "REC_BUDG_NORMALIZED_TOTAL_COST",
    "tlm_shipment_joined_w_po_prepared"."BUDG_CURRENCY_CODE" AS "BUDG_CURRENCY_CODE",
    "tlm_shipment_joined_w_po_prepared"."SPOT_CHARGE_CURRENCY_CODE" AS "SPOT_CHARGE_CURRENCY_CODE",
    "tlm_shipment_joined_w_po_prepared"."REC_CURRENCY_CODE" AS "REC_CURRENCY_CODE",
    "tlm_shipment_joined_w_po_prepared"."REC_BUDG_CURRENCY_CODE" AS "REC_BUDG_CURRENCY_CODE",
    "tlm_shipment_joined_w_po_prepared"."REC_SPOT_CHARGE_CURRENCY_CODE" AS "REC_SPOT_CHARGE_CURRENCY_CODE",
    "tlm_shipment_joined_w_po_prepared"."RATING_LANE_ID" AS "RATING_LANE_ID",
    "tlm_shipment_joined_w_po_prepared"."FRT_REV_RATING_LANE_ID" AS "FRT_REV_RATING_LANE_ID",
    "tlm_shipment_joined_w_po_prepared"."REC_RATING_LANE_ID" AS "REC_RATING_LANE_ID",
    "tlm_shipment_joined_w_po_prepared"."REC_BUDG_RATING_LANE_ID" AS "REC_BUDG_RATING_LANE_ID",
    "tlm_shipment_joined_w_po_prepared"."RATING_LANE_DETAIL_ID" AS "RATING_LANE_DETAIL_ID",
    "tlm_shipment_joined_w_po_prepared"."FRT_REV_RATING_LANE_DETAIL_ID" AS "FRT_REV_RATING_LANE_DETAIL_ID",
    "tlm_shipment_joined_w_po_prepared"."REC_RATING_LANE_DETAIL_ID" AS "REC_RATING_LANE_DETAIL_ID",
    "tlm_shipment_joined_w_po_prepared"."REC_BUDG_RATING_LANE_DETAIL_ID" AS "REC_BUDG_RATING_LANE_DETAIL_ID",
    "tlm_shipment_joined_w_po_prepared"."BUDG_CM_DISCOUNT" AS "BUDG_CM_DISCOUNT",
    "tlm_shipment_joined_w_po_prepared"."NORMALIZED_BASELINE_COST" AS "NORMALIZED_BASELINE_COST",
    "tlm_shipment_joined_w_po_prepared"."BASELINE_COST_CURRENCY_CODE" AS "BASELINE_COST_CURRENCY_CODE",
    "tlm_shipment_joined_w_po_prepared"."REPORTED_COST" AS "REPORTED_COST",
    "tlm_shipment_joined_w_po_prepared"."TRACTOR_NUMBER" AS "TRACTOR_NUMBER",
    "tlm_shipment_joined_w_po_prepared"."IS_AUTO_DELIVERED" AS "IS_AUTO_DELIVERED",
    "tlm_shipment_joined_w_po_prepared"."SHIPMENT_TYPE" AS "SHIPMENT_TYPE",
    "tlm_shipment_joined_w_po_prepared"."ORIG_BUDG_TOTAL_COST" AS "ORIG_BUDG_TOTAL_COST",
    "tlm_shipment_joined_w_po_prepared"."ACCESSORIAL_COST_TO_CARRIER" AS "ACCESSORIAL_COST_TO_CARRIER",
    "tlm_shipment_joined_w_po_prepared"."CARRIER_CHARGE" AS "CARRIER_CHARGE",
    "tlm_shipment_joined_w_po_prepared"."ACTUAL_COST" AS "ACTUAL_COST",
    "tlm_shipment_joined_w_po_prepared"."EARNED_INCOME" AS "EARNED_INCOME",
    "tlm_shipment_joined_w_po_prepared"."SENT_TO_PKMS" AS "SENT_TO_PKMS",
    "tlm_shipment_joined_w_po_prepared"."IS_SHIPMENT_RECONCILED" AS "IS_SHIPMENT_RECONCILED",
    "tlm_shipment_joined_w_po_prepared"."DELIVERY_REQ" AS "DELIVERY_REQ",
    "tlm_shipment_joined_w_po_prepared"."DROPOFF_PICKUP" AS "DROPOFF_PICKUP",
    "tlm_shipment_joined_w_po_prepared"."PACKAGING" AS "PACKAGING",
    "tlm_shipment_joined_w_po_prepared"."SENT_TO_PKMS_DTTM" AS "SENT_TO_PKMS_DTTM",
    "tlm_shipment_joined_w_po_prepared"."WMS_STATUS_CODE" AS "WMS_STATUS_CODE",
    "tlm_shipment_joined_w_po_prepared"."SPOT_CHARGE_AND_PAYEE_ACC" AS "SPOT_CHARGE_AND_PAYEE_ACC",
    "tlm_shipment_joined_w_po_prepared"."SPOT_CHARGE_AND_PAYEE_ACC_CC" AS "SPOT_CHARGE_AND_PAYEE_ACC_CC",
    "tlm_shipment_joined_w_po_prepared"."NORM_SPOT_CHARGE_AND_PAYEE_ACC" AS "NORM_SPOT_CHARGE_AND_PAYEE_ACC",
    "tlm_shipment_joined_w_po_prepared"."FACILITY_SCHEDULE_ID" AS "FACILITY_SCHEDULE_ID",
    "tlm_shipment_joined_w_po_prepared"."EARNED_INCOME_CURRENCY_CODE" AS "EARNED_INCOME_CURRENCY_CODE",
    "tlm_shipment_joined_w_po_prepared"."ACTUAL_COST_CURRENCY_CODE" AS "ACTUAL_COST_CURRENCY_CODE",
    "tlm_shipment_joined_w_po_prepared"."SHIPMENT_RECON_DTTM" AS "SHIPMENT_RECON_DTTM",
    "tlm_shipment_joined_w_po_prepared"."PLN_RATING_LANE_ID" AS "PLN_RATING_LANE_ID",
    "tlm_shipment_joined_w_po_prepared"."PLN_RATING_LANE_DETAIL_ID" AS "PLN_RATING_LANE_DETAIL_ID",
    "tlm_shipment_joined_w_po_prepared"."PLN_TOTAL_COST" AS "PLN_TOTAL_COST",
    "tlm_shipment_joined_w_po_prepared"."PLN_LINEHAUL_COST" AS "PLN_LINEHAUL_COST",
    "tlm_shipment_joined_w_po_prepared"."PLN_TOTAL_ACCESSORIAL_COST" AS "PLN_TOTAL_ACCESSORIAL_COST",
    "tlm_shipment_joined_w_po_prepared"."PLN_STOP_OFF_COST" AS "PLN_STOP_OFF_COST",
    "tlm_shipment_joined_w_po_prepared"."PLN_NORMALIZED_TOTAL_COST" AS "PLN_NORMALIZED_TOTAL_COST",
    "tlm_shipment_joined_w_po_prepared"."PLN_CURRENCY_CODE" AS "PLN_CURRENCY_CODE",
    "tlm_shipment_joined_w_po_prepared"."PLN_ACCESSORL_COST_TO_CARRIER" AS "PLN_ACCESSORL_COST_TO_CARRIER",
    "tlm_shipment_joined_w_po_prepared"."PLN_CARRIER_CHARGE" AS "PLN_CARRIER_CHARGE",
    "tlm_shipment_joined_w_po_prepared"."WAYPOINT_TOTAL_COST" AS "WAYPOINT_TOTAL_COST",
    "tlm_shipment_joined_w_po_prepared"."WAYPOINT_HANDLING_COST" AS "WAYPOINT_HANDLING_COST",
    "tlm_shipment_joined_w_po_prepared"."GRS_OPERATION" AS "GRS_OPERATION",
    "tlm_shipment_joined_w_po_prepared"."IS_GRS_OPT_CYCLE_RUNNING" AS "IS_GRS_OPT_CYCLE_RUNNING",
    "tlm_shipment_joined_w_po_prepared"."IS_MANUAL_ASSIGN" AS "IS_MANUAL_ASSIGN",
    "tlm_shipment_joined_w_po_prepared"."LAST_RUN_GRS_DTTM" AS "LAST_RUN_GRS_DTTM",
    "tlm_shipment_joined_w_po_prepared"."GRS_MAX_SHIPMENT_STATUS" AS "GRS_MAX_SHIPMENT_STATUS",
    "tlm_shipment_joined_w_po_prepared"."PRIORITY_TYPE" AS "PRIORITY_TYPE",
    "tlm_shipment_joined_w_po_prepared"."MV_CURRENCY_CODE" AS "MV_CURRENCY_CODE",
    "tlm_shipment_joined_w_po_prepared"."PROD_SCHED_REF_NUMBER" AS "PROD_SCHED_REF_NUMBER",
    "tlm_shipment_joined_w_po_prepared"."COMMODITY_CODE_ID" AS "COMMODITY_CODE_ID",
    "tlm_shipment_joined_w_po_prepared"."UN_NUMBER_ID" AS "UN_NUMBER_ID",
    "tlm_shipment_joined_w_po_prepared"."CONTRACT_NUMBER" AS "CONTRACT_NUMBER",
    "tlm_shipment_joined_w_po_prepared"."BOOKING_REF_SHIPPER" AS "BOOKING_REF_SHIPPER",
    "tlm_shipment_joined_w_po_prepared"."BOOKING_REF_CARRIER" AS "BOOKING_REF_CARRIER",
    "tlm_shipment_joined_w_po_prepared"."BK_RESOURCE_REF_EXTERNAL" AS "BK_RESOURCE_REF_EXTERNAL",
    "tlm_shipment_joined_w_po_prepared"."BK_RESOURCE_NAME_EXTERNAL" AS "BK_RESOURCE_NAME_EXTERNAL",
    "tlm_shipment_joined_w_po_prepared"."BK_O_FACILITY_ID" AS "BK_O_FACILITY_ID",
    "tlm_shipment_joined_w_po_prepared"."BK_D_FACILITY_ID" AS "BK_D_FACILITY_ID",
    "tlm_shipment_joined_w_po_prepared"."BK_MASTER_AIRWAY_BILL" AS "BK_MASTER_AIRWAY_BILL",
    "tlm_shipment_joined_w_po_prepared"."BK_FORWARDER_AIRWAY_BILL" AS "BK_FORWARDER_AIRWAY_BILL",
    "tlm_shipment_joined_w_po_prepared"."ASSIGNED_SCNDR_CARRIER_CODE" AS "ASSIGNED_SCNDR_CARRIER_CODE",
    "tlm_shipment_joined_w_po_prepared"."CUSTOMER_CREDIT_LIMIT_ID" AS "CUSTOMER_CREDIT_LIMIT_ID",
    "tlm_shipment_joined_w_po_prepared"."SHIPMENT_LEG_TYPE" AS "SHIPMENT_LEG_TYPE",
    "tlm_shipment_joined_w_po_prepared"."SHIPMENT_CLOSED_INDICATOR" AS "SHIPMENT_CLOSED_INDICATOR",
    "tlm_shipment_joined_w_po_prepared"."OCEAN_ROUTING_STAGE" AS "OCEAN_ROUTING_STAGE",
    "tlm_shipment_joined_w_po_prepared"."BK_DEPARTURE_DTTM" AS "BK_DEPARTURE_DTTM",
    "tlm_shipment_joined_w_po_prepared"."BK_DEPARTURE_TZ" AS "BK_DEPARTURE_TZ",
    "tlm_shipment_joined_w_po_prepared"."BK_ARRIVAL_DTTM" AS "BK_ARRIVAL_DTTM",
    "tlm_shipment_joined_w_po_prepared"."BK_ARRIVAL_TZ" AS "BK_ARRIVAL_TZ",
    "tlm_shipment_joined_w_po_prepared"."BK_PICKUP_DTTM" AS "BK_PICKUP_DTTM",
    "tlm_shipment_joined_w_po_prepared"."BK_PICKUP_TZ" AS "BK_PICKUP_TZ",
    "tlm_shipment_joined_w_po_prepared"."BK_CUTOFF_DTTM" AS "BK_CUTOFF_DTTM",
    "tlm_shipment_joined_w_po_prepared"."BK_CUTOFF_TZ" AS "BK_CUTOFF_TZ",
    "tlm_shipment_joined_w_po_prepared"."NUM_CHARGE_LAYOVERS" AS "NUM_CHARGE_LAYOVERS",
    "tlm_shipment_joined_w_po_prepared"."RATE_TYPE" AS "RATE_TYPE",
    "tlm_shipment_joined_w_po_prepared"."RATE_UOM" AS "RATE_UOM",
    "tlm_shipment_joined_w_po_prepared"."PICK_START_DTTM" AS "PICK_START_DTTM",
    "tlm_shipment_joined_w_po_prepared"."PAPERWORK_START_DTTM" AS "PAPERWORK_START_DTTM",
    "tlm_shipment_joined_w_po_prepared"."VEHICLE_CHECK_START_DTTM" AS "VEHICLE_CHECK_START_DTTM",
    "tlm_shipment_joined_w_po_prepared"."SHIPMENT_START_DTTM" AS "SHIPMENT_START_DTTM",
    "tlm_shipment_joined_w_po_prepared"."SHIPMENT_END_DTTM" AS "SHIPMENT_END_DTTM",
    "tlm_shipment_joined_w_po_prepared"."FEASIBLE_DRIVER_TYPE" AS "FEASIBLE_DRIVER_TYPE",
    "tlm_shipment_joined_w_po_prepared"."WAVE_ID" AS "WAVE_ID",
    "tlm_shipment_joined_w_po_prepared"."ESTIMATED_DISPATCH_DTTM" AS "ESTIMATED_DISPATCH_DTTM",
    "tlm_shipment_joined_w_po_prepared"."TOTAL_TIME" AS "TOTAL_TIME",
    "tlm_shipment_joined_w_po_prepared"."LOC_REFERENCE" AS "LOC_REFERENCE",
    "tlm_shipment_joined_w_po_prepared"."BK_O_FACILITY_ALIAS_ID" AS "BK_O_FACILITY_ALIAS_ID",
    "tlm_shipment_joined_w_po_prepared"."BK_D_FACILITY_ALIAS_ID" AS "BK_D_FACILITY_ALIAS_ID",
    "tlm_shipment_joined_w_po_prepared"."EQUIP_UTIL_PER" AS "EQUIP_UTIL_PER",
    "tlm_shipment_joined_w_po_prepared"."MOVE_TYPE" AS "MOVE_TYPE",
    "tlm_shipment_joined_w_po_prepared"."DRIVER_TYPE_ID" AS "DRIVER_TYPE_ID",
    "tlm_shipment_joined_w_po_prepared"."EQUIPMENT_TYPE" AS "EQUIPMENT_TYPE",
    "tlm_shipment_joined_w_po_prepared"."RADIAL_DISTANCE" AS "RADIAL_DISTANCE",
    "tlm_shipment_joined_w_po_prepared"."RADIAL_DISTANCE_UOM" AS "RADIAL_DISTANCE_UOM",
    "tlm_shipment_joined_w_po_prepared"."DESIGNATED_TRACTOR_CODE" AS "DESIGNATED_TRACTOR_CODE",
    "tlm_shipment_joined_w_po_prepared"."DESIGNATED_DRIVER_TYPE" AS "DESIGNATED_DRIVER_TYPE",
    "tlm_shipment_joined_w_po_prepared"."IS_WAVE_MAN_CHANGED" AS "IS_WAVE_MAN_CHANGED",
    "tlm_shipment_joined_w_po_prepared"."RETAIN_CONSOLIDATOR_TIMES" AS "RETAIN_CONSOLIDATOR_TIMES",
    "tlm_shipment_joined_w_po_prepared"."TARIFF" AS "TARIFF",
    "tlm_shipment_joined_w_po_prepared"."MIN_RATE" AS "MIN_RATE",
    "tlm_shipment_joined_w_po_prepared"."FIRST_UPDATE_SENT_TO_PKMS" AS "FIRST_UPDATE_SENT_TO_PKMS",
    "tlm_shipment_joined_w_po_prepared"."EVENT_IND_TYPEID" AS "EVENT_IND_TYPEID",
    "tlm_shipment_joined_w_po_prepared"."TANDEM_PATH_ID" AS "TANDEM_PATH_ID",
    "tlm_shipment_joined_w_po_prepared"."O_TANDEM_FACILITY" AS "O_TANDEM_FACILITY",
    "tlm_shipment_joined_w_po_prepared"."D_TANDEM_FACILITY" AS "D_TANDEM_FACILITY",
    "tlm_shipment_joined_w_po_prepared"."O_TANDEM_FACILITY_ALIAS" AS "O_TANDEM_FACILITY_ALIAS",
    "tlm_shipment_joined_w_po_prepared"."D_TANDEM_FACILITY_ALIAS" AS "D_TANDEM_FACILITY_ALIAS",
    "tlm_shipment_joined_w_po_prepared"."DELAY_TYPE" AS "DELAY_TYPE",
    "tlm_shipment_joined_w_po_prepared"."ASSIGNED_CARRIER_ID" AS "ASSIGNED_CARRIER_ID",
    "tlm_shipment_joined_w_po_prepared"."DSG_CARRIER_ID" AS "DSG_CARRIER_ID",
    "tlm_shipment_joined_w_po_prepared"."REC_CARRIER_ID" AS "REC_CARRIER_ID",
    "tlm_shipment_joined_w_po_prepared"."FEASIBLE_CARRIER_ID" AS "FEASIBLE_CARRIER_ID",
    "tlm_shipment_joined_w_po_prepared"."PAYEE_CARRIER_ID" AS "PAYEE_CARRIER_ID",
    "tlm_shipment_joined_w_po_prepared"."SCNDR_CARRIER_ID" AS "SCNDR_CARRIER_ID",
    "tlm_shipment_joined_w_po_prepared"."BROKER_CARRIER_ID" AS "BROKER_CARRIER_ID",
    "tlm_shipment_joined_w_po_prepared"."ASSIGNED_SCNDR_CARRIER_ID" AS "ASSIGNED_SCNDR_CARRIER_ID",
    "tlm_shipment_joined_w_po_prepared"."DSG_SCNDR_CARRIER_ID" AS "DSG_SCNDR_CARRIER_ID",
    "tlm_shipment_joined_w_po_prepared"."ASSIGNED_BROKER_CARRIER_ID" AS "ASSIGNED_BROKER_CARRIER_ID",
    "tlm_shipment_joined_w_po_prepared"."LH_PAYEE_CARRIER_ID" AS "LH_PAYEE_CARRIER_ID",
    "tlm_shipment_joined_w_po_prepared"."REC_BROKER_CARRIER_ID" AS "REC_BROKER_CARRIER_ID",
    "tlm_shipment_joined_w_po_prepared"."ASSIGNED_EQUIPMENT_ID" AS "ASSIGNED_EQUIPMENT_ID",
    "tlm_shipment_joined_w_po_prepared"."DSG_EQUIPMENT_ID" AS "DSG_EQUIPMENT_ID",
    "tlm_shipment_joined_w_po_prepared"."FEASIBLE_EQUIPMENT_ID" AS "FEASIBLE_EQUIPMENT_ID",
    "tlm_shipment_joined_w_po_prepared"."FEASIBLE_EQUIPMENT2_ID" AS "FEASIBLE_EQUIPMENT2_ID",
    "tlm_shipment_joined_w_po_prepared"."REC_EQUIPMENT_ID" AS "REC_EQUIPMENT_ID",
    "tlm_shipment_joined_w_po_prepared"."ASSIGNED_MOT_ID" AS "ASSIGNED_MOT_ID",
    "tlm_shipment_joined_w_po_prepared"."DSG_MOT_ID" AS "DSG_MOT_ID",
    "tlm_shipment_joined_w_po_prepared"."FEASIBLE_MOT_ID" AS "FEASIBLE_MOT_ID",
    "tlm_shipment_joined_w_po_prepared"."REC_MOT_ID" AS "REC_MOT_ID",
    "tlm_shipment_joined_w_po_prepared"."PRODUCT_CLASS_ID" AS "PRODUCT_CLASS_ID",
    "tlm_shipment_joined_w_po_prepared"."PROTECTION_LEVEL_ID" AS "PROTECTION_LEVEL_ID",
    "tlm_shipment_joined_w_po_prepared"."ASSIGNED_SERVICE_LEVEL_ID" AS "ASSIGNED_SERVICE_LEVEL_ID",
    "tlm_shipment_joined_w_po_prepared"."DSG_SERVICE_LEVEL_ID" AS "DSG_SERVICE_LEVEL_ID",
    "tlm_shipment_joined_w_po_prepared"."FEASIBLE_SERVICE_LEVEL_ID" AS "FEASIBLE_SERVICE_LEVEL_ID",
    "tlm_shipment_joined_w_po_prepared"."REC_SERVICE_LEVEL_ID" AS "REC_SERVICE_LEVEL_ID",
    "tlm_shipment_joined_w_po_prepared"."HAS_EM_NOTIFY_FLAG" AS "HAS_EM_NOTIFY_FLAG",
    "tlm_shipment_joined_w_po_prepared"."REGION_ID" AS "REGION_ID",
    "tlm_shipment_joined_w_po_prepared"."INBOUND_REGION_ID" AS "INBOUND_REGION_ID",
    "tlm_shipment_joined_w_po_prepared"."OUTBOUND_REGION_ID" AS "OUTBOUND_REGION_ID",
    "tlm_shipment_joined_w_po_prepared"."FINANCIAL_WT" AS "FINANCIAL_WT",
    "tlm_shipment_joined_w_po_prepared"."IS_BOOKING_REQUIRED" AS "IS_BOOKING_REQUIRED",
    "tlm_shipment_joined_w_po_prepared"."TOTAL_COST_EXCL_TAX" AS "TOTAL_COST_EXCL_TAX",
    "tlm_shipment_joined_w_po_prepared"."TOTAL_TAX_AMOUNT" AS "TOTAL_TAX_AMOUNT",
    "tlm_shipment_joined_w_po_prepared"."IS_ASSOCIATED_TO_OUTBOUND" AS "IS_ASSOCIATED_TO_OUTBOUND",
    "tlm_shipment_joined_w_po_prepared"."RECEIVED_DTTM" AS "RECEIVED_DTTM",
    "tlm_shipment_joined_w_po_prepared"."BOOKING_ID" AS "BOOKING_ID",
    "tlm_shipment_joined_w_po_prepared"."IS_MISROUTED" AS "IS_MISROUTED",
    "tlm_shipment_joined_w_po_prepared"."FEASIBLE_CARRIER_CODE" AS "FEASIBLE_CARRIER_CODE",
    "tlm_shipment_joined_w_po_prepared"."SHIPMENT_WIN_ADJ_FLAG" AS "SHIPMENT_WIN_ADJ_FLAG",
    "tlm_shipment_joined_w_po_prepared"."DT_PARAM_SET_ID" AS "DT_PARAM_SET_ID",
    "tlm_shipment_joined_w_po_prepared"."MERCHANDIZING_DEPARTMENT_ID" AS "MERCHANDIZING_DEPARTMENT_ID",
    "tlm_shipment_joined_w_po_prepared"."STATIC_ROUTE_ID" AS "STATIC_ROUTE_ID",
    "tlm_shipment_joined_w_po_prepared"."IS_FILO" AS "IS_FILO",
    "tlm_shipment_joined_w_po_prepared"."IS_COOLER_AT_NOSE" AS "IS_COOLER_AT_NOSE",
    "tlm_shipment_joined_w_po_prepared"."AUTH_NBR" AS "AUTH_NBR",
    "tlm_shipment_joined_w_po_prepared"."CONS_LOCN_ID" AS "CONS_LOCN_ID",
    "tlm_shipment_joined_w_po_prepared"."RTE_TYPE" AS "RTE_TYPE",
    "tlm_shipment_joined_w_po_prepared"."TRLR_TYPE" AS "TRLR_TYPE",
    "tlm_shipment_joined_w_po_prepared"."TRLR_SIZE" AS "TRLR_SIZE",
    "tlm_shipment_joined_w_po_prepared"."CONS_ADDR_CODE" AS "CONS_ADDR_CODE",
    "tlm_shipment_joined_w_po_prepared"."HUB_ID" AS "HUB_ID",
    "tlm_shipment_joined_w_po_prepared"."TRLR_GEN_CODE" AS "TRLR_GEN_CODE",
    "tlm_shipment_joined_w_po_prepared"."MAX_NBR_OF_CTNS" AS "MAX_NBR_OF_CTNS",
    "tlm_shipment_joined_w_po_prepared"."APPT_DOOR_SCHED_TYPE" AS "APPT_DOOR_SCHED_TYPE",
    "tlm_shipment_joined_w_po_prepared"."CREATED_SOURCE_TYPE" AS "CREATED_SOURCE_TYPE",
    "tlm_shipment_joined_w_po_prepared"."CREATED_SOURCE" AS "CREATED_SOURCE",
    "tlm_shipment_joined_w_po_prepared"."CREATED_DTTM" AS "CREATED_DTTM",
    "tlm_shipment_joined_w_po_prepared"."LAST_UPDATED_SOURCE_TYPE" AS "LAST_UPDATED_SOURCE_TYPE",
    "tlm_shipment_joined_w_po_prepared"."LAST_UPDATED_SOURCE" AS "LAST_UPDATED_SOURCE",
    "tlm_shipment_joined_w_po_prepared"."LAST_UPDATED_DTTM" AS "LAST_UPDATED_DTTM",
    "tlm_shipment_joined_w_po_prepared"."DSG_SCNDR_CARRIER_CODE" AS "DSG_SCNDR_CARRIER_CODE",
    "tlm_shipment_joined_w_po_prepared"."LH_PAYEE_CARRIER_CODE" AS "LH_PAYEE_CARRIER_CODE",
    "tlm_shipment_joined_w_po_prepared"."REC_BROKER_CARRIER_CODE" AS "REC_BROKER_CARRIER_CODE",
    "tlm_shipment_joined_w_po_prepared"."REC_CARRIER_CODE" AS "REC_CARRIER_CODE",
    "tlm_shipment_joined_w_po_prepared"."LPN_ASSIGNMENT_STOPPED" AS "LPN_ASSIGNMENT_STOPPED",
    "tlm_shipment_joined_w_po_prepared"."SEAL_NUMBER" AS "SEAL_NUMBER",
    "tlm_shipment_joined_w_po_prepared"."HIBERNATE_VERSION" AS "HIBERNATE_VERSION",
    "tlm_shipment_joined_w_po_prepared"."SHIP_GROUP_ID" AS "SHIP_GROUP_ID",
    "tlm_shipment_joined_w_po_prepared"."RATE" AS "RATE",
    "tlm_shipment_joined_w_po_prepared"."MONETARY_VALUE" AS "MONETARY_VALUE",
    "tlm_shipment_joined_w_po_prepared"."DOOR" AS "DOOR",
    "tlm_shipment_joined_w_po_prepared"."RTE_TYPE_1" AS "RTE_TYPE_1",
    "tlm_shipment_joined_w_po_prepared"."RTE_TYPE_2" AS "RTE_TYPE_2",
    "tlm_shipment_joined_w_po_prepared"."SCHEDULED_PICKUP_DTTM" AS "SCHEDULED_PICKUP_DTTM",
    "tlm_shipment_joined_w_po_prepared"."MANIFEST_ID" AS "MANIFEST_ID",
    "tlm_shipment_joined_w_po_prepared"."DAYS_TO_DELIVER" AS "DAYS_TO_DELIVER",
    "tlm_shipment_joined_w_po_prepared"."SED_GENERATED_FLAG" AS "SED_GENERATED_FLAG",
    "tlm_shipment_joined_w_po_prepared"."SERV_AREA_CODE" AS "SERV_AREA_CODE",
    "tlm_shipment_joined_w_po_prepared"."TENDER_RESP_DEADLINE_DTTM" AS "TENDER_RESP_DEADLINE_DTTM",
    "tlm_shipment_joined_w_po_prepared"."PRINT_CONS_BOL" AS "PRINT_CONS_BOL",
    "tlm_shipment_joined_w_po_prepared"."LEFT_WT" AS "LEFT_WT",
    "tlm_shipment_joined_w_po_prepared"."RIGHT_WT" AS "RIGHT_WT",
    "tlm_shipment_joined_w_po_prepared"."LANE_NAME" AS "LANE_NAME",
    "tlm_shipment_joined_w_po_prepared"."DECLARED_VALUE" AS "DECLARED_VALUE",
    "tlm_shipment_joined_w_po_prepared"."DV_CURRENCY_CODE" AS "DV_CURRENCY_CODE",
    "tlm_shipment_joined_w_po_prepared"."COD_AMOUNT" AS "COD_AMOUNT",
    "tlm_shipment_joined_w_po_prepared"."CUSTOMER_ID" AS "CUSTOMER_ID",
    "tlm_shipment_joined_w_po_prepared"."CUST_FRGT_CHARGE" AS "CUST_FRGT_CHARGE",
    "tlm_shipment_joined_w_po_prepared"."COD_CURRENCY_CODE" AS "COD_CURRENCY_CODE",
    "tlm_shipment_joined_w_po_prepared"."PLANNED_WEIGHT" AS "PLANNED_WEIGHT",
    "tlm_shipment_joined_w_po_prepared"."WEIGHT_UOM_ID_BASE" AS "WEIGHT_UOM_ID_BASE",
    "tlm_shipment_joined_w_po_prepared"."PLANNED_VOLUME" AS "PLANNED_VOLUME",
    "tlm_shipment_joined_w_po_prepared"."VOLUME_UOM_ID_BASE" AS "VOLUME_UOM_ID_BASE",
    "tlm_shipment_joined_w_po_prepared"."SIZE1_VALUE" AS "SIZE1_VALUE",
    "tlm_shipment_joined_w_po_prepared"."SIZE1_UOM_ID" AS "SIZE1_UOM_ID",
    "tlm_shipment_joined_w_po_prepared"."SIZE2_VALUE" AS "SIZE2_VALUE",
    "tlm_shipment_joined_w_po_prepared"."SIZE2_UOM_ID" AS "SIZE2_UOM_ID",
    "tlm_shipment_joined_w_po_prepared"."ASSIGNED_SHIP_VIA" AS "ASSIGNED_SHIP_VIA",
    "tlm_shipment_joined_w_po_prepared"."INSURANCE_STATUS" AS "INSURANCE_STATUS",
    "tlm_shipment_joined_w_po_prepared"."RTE_SWC_NBR" AS "RTE_SWC_NBR",
    "tlm_shipment_joined_w_po_prepared"."RTE_TO" AS "RTE_TO",
    "tlm_shipment_joined_w_po_prepared"."BILL_OF_LADING_NUMBER" AS "BILL_OF_LADING_NUMBER",
    "tlm_shipment_joined_w_po_prepared"."TRAILER_NUMBER" AS "TRAILER_NUMBER",
    "tlm_shipment_joined_w_po_prepared"."TRANS_PLAN_OWNER" AS "TRANS_PLAN_OWNER",
    "tlm_shipment_joined_w_po_prepared"."TOTAL_REVENUE_CURRENCY_CODE" AS "TOTAL_REVENUE_CURRENCY_CODE",
    "tlm_shipment_joined_w_po_prepared"."TOTAL_REVENUE" AS "TOTAL_REVENUE",
    "tlm_shipment_joined_w_po_prepared"."FRT_REV_SPOT_CHARGE_CURR_CODE" AS "FRT_REV_SPOT_CHARGE_CURR_CODE",
    "tlm_shipment_joined_w_po_prepared"."NORMALIZED_TOTAL_REVENUE" AS "NORMALIZED_TOTAL_REVENUE",
    "tlm_shipment_joined_w_po_prepared"."FRT_REV_SPOT_CHARGE" AS "FRT_REV_SPOT_CHARGE",
    "tlm_shipment_joined_w_po_prepared"."DSG_VOYAGE_FLIGHT" AS "DSG_VOYAGE_FLIGHT",
    "tlm_shipment_joined_w_po_prepared"."FEASIBLE_VOYAGE_FLIGHT" AS "FEASIBLE_VOYAGE_FLIGHT",
    "tlm_shipment_joined_w_po_prepared"."CURRENCY_DTTM" AS "CURRENCY_DTTM",
    "tlm_shipment_joined_w_po_prepared"."FRT_REV_LINEHAUL_CHARGE" AS "FRT_REV_LINEHAUL_CHARGE",
    "tlm_shipment_joined_w_po_prepared"."FRT_REV_STOP_CHARGE" AS "FRT_REV_STOP_CHARGE",
    "tlm_shipment_joined_w_po_prepared"."FRT_REV_ACCESSORIAL_CHARGE" AS "FRT_REV_ACCESSORIAL_CHARGE",
    "tlm_shipment_joined_w_po_prepared"."MARGIN" AS "MARGIN",
    "tlm_shipment_joined_w_po_prepared"."TOTAL_COST" AS "TOTAL_COST",
    "tlm_shipment_joined_w_po_prepared"."INCOTERM_ID" AS "INCOTERM_ID",
    "tlm_shipment_joined_w_po_prepared"."ORDER_QTY" AS "ORDER_QTY",
    "tlm_shipment_joined_w_po_prepared"."QTY_UOM_ID" AS "QTY_UOM_ID",
    "tlm_shipment_joined_w_po_prepared"."REF_SHIPMENT_NBR" AS "REF_SHIPMENT_NBR",
    "tlm_shipment_joined_w_po_prepared"."STAGING_LOCN_ID" AS "STAGING_LOCN_ID",
    "tlm_shipment_joined_w_po_prepared"."LOADING_SEQ_ORD" AS "LOADING_SEQ_ORD",
    "tlm_shipment_joined_w_po_prepared"."HAZMAT_CERT_CONTACT" AS "HAZMAT_CERT_CONTACT",
    "tlm_shipment_joined_w_po_prepared"."HAZMAT_CERT_DECLARATION" AS "HAZMAT_CERT_DECLARATION",
    "tlm_shipment_joined_w_po_prepared"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP",
    "tlm_shipment_joined_w_po_prepared"."OPERATION_TYPE" AS "OPERATION_TYPE",
    "tlm_shipment_joined_w_po_prepared"."ARCHIVED_DTTM" AS "ARCHIVED_DTTM",
    "tlm_shipment_joined_w_po_prepared"."ORIGIN" AS "ORIGIN",
    "tlm_shipment_joined_w_po_prepared"."FINAL_DESTINATION" AS "FINAL_DESTINATION",
    "tlm_shipment_joined_w_po_prepared"."actual_delivery_date_parsed" AS "actual_delivery_date_parsed",
    "tlm_shipment_joined_w_po_prepared"."wood_pellet" AS "wood_pellet",
    "tlm_shipment_joined_w_po_prepared"."act_del_MERCH_YEAR" AS "act_del_MERCH_YEAR",
    "tlm_shipment_joined_w_po_prepared"."act_del_YEAR_WEEK" AS "act_del_YEAR_WEEK",
    "tlm_shipment_joined_w_po_prepared"."act_del_YEAR_QUARTER" AS "act_del_YEAR_QUARTER",
    "tlm_shipment_joined_w_po_prepared"."act_del_YEAR_PERIOD" AS "act_del_YEAR_PERIOD",
    "tlm_shipment_joined_w_po_prepared"."invoice_shipping_id" AS "invoice_shipping_id",
    "tlm_shipment_joined_w_po_prepared"."org_Facility_Code" AS "org_Facility_Code",
    "tlm_shipment_joined_w_po_prepared"."org_Facility_Name" AS "org_Facility_Name",
    "tlm_shipment_joined_w_po_prepared"."org_Facility_Type" AS "org_Facility_Type",
    "tlm_shipment_joined_w_po_prepared"."dest_Facility_Code" AS "dest_Facility_Code",
    "tlm_shipment_joined_w_po_prepared"."dest_Facility_Name" AS "dest_Facility_Name",
    "tlm_shipment_joined_w_po_prepared"."dest_Facility_Type" AS "dest_Facility_Type",
    "tlm_shipment_joined_w_po_prepared"."inbound_flag" AS "inbound_flag",
    "tlm_shipment_joined_w_po_prepared".order_id_po AS "order_id_po",
    "tlm_shipment_joined_w_po_prepared".order_id_po_int AS "order_id_po_int",
    "purchase_order_line_w_cal"."STORE_NO" AS "po_STORE_NO",
    "purchase_order_line_w_cal"."CO_CODE" AS "po_CO_CODE",
    "purchase_order_line_w_cal"."ARTICLE_NO" AS "po_ARTICLE_NO",
    "purchase_order_line_w_cal"."PO_NO" AS "po_PO_NO",
    "purchase_order_line_w_cal"."PO_LINE_NO" AS "po_PO_LINE_NO",
    "purchase_order_line_w_cal"."PO_DATE" AS "po_PO_DATE",
    "purchase_order_line_w_cal"."po_date_parsed" AS "po_po_date_parsed",
    "purchase_order_line_w_cal"."DELIV_DATE" AS "po_DELIV_DATE",
    "purchase_order_line_w_cal"."deliv_date_parsed" AS "po_deliv_date_parsed",
    "purchase_order_line_w_cal"."PO_TYPE_CODE" AS "po_PO_TYPE_CODE",
    "purchase_order_line_w_cal"."VENDOR_ID" AS "po_VENDOR_ID",
    "purchase_order_line_w_cal"."VSR_CODE" AS "po_VSR_CODE",
    "purchase_order_line_w_cal"."PO_LINE_CANCELLED_FLAG" AS "po_PO_LINE_CANCELLED_FLAG",
    "purchase_order_line_w_cal"."PO_LINE_ORDER_QTY" AS "po_PO_LINE_ORDER_QTY",
    "purchase_order_line_w_cal"."PO_LINE_ISSUE_QTY" AS "po_PO_LINE_ISSUE_QTY",
    "purchase_order_line_w_cal"."PO_LINE_RCVD_QTY" AS "po_PO_LINE_RCVD_QTY",
    "purchase_order_line_w_cal"."PO_LINE_UNIT_PRICE" AS "po_PO_LINE_UNIT_PRICE",
    "purchase_order_line_w_cal"."DC_NO" AS "po_DC_NO",
    "purchase_order_line_w_cal"."PO_TRACKING_NO" AS "po_PO_TRACKING_NO",
    "purchase_order_line_w_cal"."PO_LINE_TRACKING_NO" AS "po_PO_LINE_TRACKING_NO",
    "purchase_order_line_w_cal"."CURRENT_REPL_TYPE_CODE" AS "po_CURRENT_REPL_TYPE_CODE",
    "purchase_order_line_w_cal"."FREIGHT_TYPE_CODE" AS "po_FREIGHT_TYPE_CODE",
    "purchase_order_line_w_cal"."SHIP_START_DATE" AS "po_SHIP_START_DATE",
    "purchase_order_line_w_cal"."SHIP_END_DATE" AS "po_SHIP_END_DATE",
    "purchase_order_line_w_cal"."DELIV_START_DATE" AS "po_DELIV_START_DATE",
    "purchase_order_line_w_cal"."DELIV_END_DATE" AS "po_DELIV_END_DATE",
    "purchase_order_line_w_cal"."PO_LINE_UNIT_FREIGHT_AMT" AS "po_PO_LINE_UNIT_FREIGHT_AMT",
    "purchase_order_line_w_cal"."PO_LINE_MANUFACTURER" AS "po_PO_LINE_MANUFACTURER",
    "purchase_order_line_w_cal"."PO_LINE_ORIGIN_COUNTRY_CODE" AS "po_PO_LINE_ORIGIN_COUNTRY_CODE",
    "purchase_order_line_w_cal"."PO_LINE_PORT_OF_ORIGIN" AS "po_PO_LINE_PORT_OF_ORIGIN",
    "purchase_order_line_w_cal"."PO_LINE_MIN_RCVD_DATE" AS "po_PO_LINE_MIN_RCVD_DATE",
    "purchase_order_line_w_cal"."PO_LINE_MAX_RCVD_DATE" AS "po_PO_LINE_MAX_RCVD_DATE",
    "purchase_order_line_w_cal"."PO_LINE_DELIVERED_FLAG" AS "po_PO_LINE_DELIVERED_FLAG",
    "purchase_order_line_w_cal"."PO_LINE_CONFIRMED_ON_BOARD_DATE" AS "po_PO_LINE_CONFIRMED_ON_BOARD_DATE",
    "purchase_order_line_w_cal"."PO_LINE_BOOKED_FOR_SHIPMENT_DATE" AS "po_PO_LINE_BOOKED_FOR_SHIPMENT_DATE",
    "purchase_order_line_w_cal"."PO_LINE_TRANSIT_RESN_CODE" AS "po_PO_LINE_TRANSIT_RESN_CODE",
    "purchase_order_line_w_cal"."PO_LINE_MOVE_TYPE_CODE" AS "po_PO_LINE_MOVE_TYPE_CODE",
    "purchase_order_line_w_cal"."PO_LINE_AGENT_COMMISSION_RATE" AS "po_PO_LINE_AGENT_COMMISSION_RATE",
    "purchase_order_line_w_cal"."PO_LINE_AGENT_COMMISSION_AMT" AS "po_PO_LINE_AGENT_COMMISSION_AMT",
    "purchase_order_line_w_cal"."PO_LINE_ADDL_ARTICLE_NO" AS "po_PO_LINE_ADDL_ARTICLE_NO",
    "purchase_order_line_w_cal"."PO_LINE_ADDL_ARTICLE_QTY" AS "po_PO_LINE_ADDL_ARTICLE_QTY",
    "purchase_order_line_w_cal"."PO_LINE_FACTORY_VENDOR_ID" AS "po_PO_LINE_FACTORY_VENDOR_ID",
    "purchase_order_line_w_cal"."PO_LINE_STUFFING_LOC_VENDOR_ID" AS "po_PO_LINE_STUFFING_LOC_VENDOR_ID",
    "purchase_order_line_w_cal"."PO_LINE_SOURCING_AGENT_VENDOR_ID" AS "po_PO_LINE_SOURCING_AGENT_VENDOR_ID",
    "purchase_order_line_w_cal"."PO_LINE_FREIGHT_FORWARDER_VENDOR_ID" AS "po_PO_LINE_FREIGHT_FORWARDER_VENDOR_ID",
    "purchase_order_line_w_cal"."PO_LINE_LETTER_OF_CREDIT_NO" AS "po_PO_LINE_LETTER_OF_CREDIT_NO",
    "purchase_order_line_w_cal"."PO_LINE_OPEN_ACCT_NO" AS "po_PO_LINE_OPEN_ACCT_NO",
    "purchase_order_line_w_cal"."PO_LINE_ARTICLE_LENGTH" AS "po_PO_LINE_ARTICLE_LENGTH",
    "purchase_order_line_w_cal"."PO_LINE_ARTICLE_WIDTH" AS "po_PO_LINE_ARTICLE_WIDTH",
    "purchase_order_line_w_cal"."PO_LINE_ARTICLE_HEIGHT" AS "po_PO_LINE_ARTICLE_HEIGHT",
    "purchase_order_line_w_cal"."PO_LINE_ARTICLE_DIMENSIONS_UOM" AS "po_PO_LINE_ARTICLE_DIMENSIONS_UOM",
    "purchase_order_line_w_cal"."PO_LINE_ARTICLE_WEIGHT" AS "po_PO_LINE_ARTICLE_WEIGHT",
    "purchase_order_line_w_cal"."PO_LINE_ARTICLE_WEIGHT_UOM" AS "po_PO_LINE_ARTICLE_WEIGHT_UOM",
    "purchase_order_line_w_cal"."PO_TOTAL_WEIGHT" AS "po_PO_TOTAL_WEIGHT",
    "purchase_order_line_w_cal"."PO_LINE_ARTICLE_VOLUME" AS "po_PO_LINE_ARTICLE_VOLUME",
    "purchase_order_line_w_cal"."PO_LINE_ARTICLE_VOLUME_UOM" AS "po_PO_LINE_ARTICLE_VOLUME_UOM",
    "purchase_order_line_w_cal"."PO_TOTAL_VOLUME" AS "po_PO_TOTAL_VOLUME",
    "purchase_order_line_w_cal"."HTS_CODE" AS "po_HTS_CODE",
    "purchase_order_line_w_cal"."PO_LINE_DUTY_RATE" AS "po_PO_LINE_DUTY_RATE",
    "purchase_order_line_w_cal"."PO_LINE_DUTY_AMT" AS "po_PO_LINE_DUTY_AMT",
    "purchase_order_line_w_cal"."PO_LINE_ADDL_HTS_CODE_1" AS "po_PO_LINE_ADDL_HTS_CODE_1",
    "purchase_order_line_w_cal"."PO_LINE_ADDL_DUTY_RATE_1" AS "po_PO_LINE_ADDL_DUTY_RATE_1",
    "purchase_order_line_w_cal"."PO_LINE_ADDL_DUTY_AMT_1" AS "po_PO_LINE_ADDL_DUTY_AMT_1",
    "purchase_order_line_w_cal"."PO_LINE_ADDL_HTS_CODE_2" AS "po_PO_LINE_ADDL_HTS_CODE_2",
    "purchase_order_line_w_cal"."PO_LINE_ADDL_DUTY_RATE_2" AS "po_PO_LINE_ADDL_DUTY_RATE_2",
    "purchase_order_line_w_cal"."PO_LINE_ADDL_DUTY_AMT_2" AS "po_PO_LINE_ADDL_DUTY_AMT_2",
    "purchase_order_line_w_cal"."PO_HELD_FLAG" AS "po_PO_HELD_FLAG",
    "purchase_order_line_w_cal"."PO_VENDOR_DOC_DATE" AS "po_PO_VENDOR_DOC_DATE",
    "purchase_order_line_w_cal"."cal_MERCH_YEAR" AS "po_cal_MERCH_YEAR",
    "purchase_order_line_w_cal"."cal_YEAR_WEEK" AS "po_cal_YEAR_WEEK",
    "purchase_order_line_w_cal"."cal_YEAR_QUARTER" AS "po_cal_YEAR_QUARTER",
    "purchase_order_line_w_cal"."cal_YEAR_PERIOD" AS "po_cal_YEAR_PERIOD",
     "article"."ARTICLE_LENGTH" AS "a_ARTICLE_LENGTH",
    "article"."ARTICLE_WIDTH" AS "a_ARTICLE_WIDTH",
    "article"."ARTICLE_HEIGHT" AS "a_ARTICLE_HEIGHT",
    "article"."ARTICLE_WEIGHT" AS "a_ARTICLE_WEIGHT",
    "article"."ARTICLE_SIZE" AS "a_ARTICLE_SIZE",
    "article"."ARTICLE_40HC_QTY" AS "a_ARTICLE_40HC_QTY",
    "article"."ARTICLE_40GP_QTY" AS "a_ARTICLE_40GP_QTY",    round(coalesce("article"."ARTICLE_LENGTH",0)*coalesce("article"."ARTICLE_WIDTH",0)*coalesce("article"."ARTICLE_HEIGHT",0)*coalesce("purchase_order_line_w_cal"."PO_LINE_ORDER_QTY",0)/1728) AS item_volume,
 round(coalesce("article"."ARTICLE_WEIGHT",0)*coalesce("purchase_order_line_w_cal"."PO_LINE_ORDER_QTY",0)) AS item_weight
  FROM "TLM_SHIPMENT_JOINED_W_PO_PREPARED" "tlm_shipment_joined_w_po_prepared"
  LEFT JOIN "PURCHASE_ORDER_LINE_W_CAL" "purchase_order_line_w_cal"
    ON "tlm_shipment_joined_w_po_prepared".order_id_po_int = "purchase_order_line_w_cal"."PO_NO"
  LEFT JOIN "EDW"."ARTICLE" "article"
    ON "purchase_order_line_w_cal"."ARTICLE_NO" = "article"."ARTICLE_NO"
    ) tlm_shipment_joined_po_vol_wgt_windows;


<br>
 --TLM_SHIPMENT_JOINED_PO_ALLOCATION   
</br>
CREATE OR REPLACE TEMP TABLE "TLM_SHIPMENT_JOINED_PO_ALLOCATION"
AS 
SELECT  DISTINCT 
    "SHIPMENT_ID",
    "TC_COMPANY_ID",
    "RS_AREA_ID",
    "TC_SHIPMENT_ID",
    "PP_SHIPMENT_ID",
    "SHIPMENT_STATUS",
    "UPDATE_SENT",
    "BUSINESS_PROCESS",
    "CREATION_TYPE",
    "CONS_RUN_ID",
    "IS_CANCELLED",
    "RS_TYPE",
    "RS_CONFIG_ID",
    "RS_CONFIG_CYCLE_ID",
    "CONFIG_CYCLE_SEQ",
    "CYCLE_DEADLINE_DTTM",
    "CYCLE_EXECUTION_DTTM",
    "LAST_RS_NOTIFICATION_DTTM",
    "CFMF_STATUS",
    "AVAILABLE_DTTM",
    "CMID",
    "CM_DISCOUNT",
    "O_FACILITY_NUMBER",
    "O_FACILITY_ID",
    "O_ADDRESS",
    "O_CITY",
    "O_STATE_PROV",
    "O_POSTAL_CODE",
    "O_COUNTY",
    "O_COUNTRY_CODE",
    "D_FACILITY_NUMBER",
    "D_FACILITY_ID",
    "D_ADDRESS",
    "D_CITY",
    "D_STATE_PROV",
    "D_POSTAL_CODE",
    "D_COUNTY",
    "D_COUNTRY_CODE",
    "DISTANCE",
    "DIRECT_DISTANCE",
    "OUT_OF_ROUTE_DISTANCE",
    "DISTANCE_UOM",
    "BUSINESS_PARTNER_ID",
    "COMMODITY_CLASS",
    "IS_HAZMAT",
    "IS_PERISHABLE",
    "BILLING_METHOD",
    "DSG_CARRIER_CODE",
    "REC_CMID",
    "REC_CM_SHIPMENT_ID",
    "ASSIGNED_CARRIER_CODE",
    "SHIPMENT_REF_ID",
    "BILL_TO_CODE",
    "BILL_TO_TITLE",
    "BILL_TO_NAME",
    "BILL_TO_ADDRESS",
    "BILL_TO_CITY",
    "BILL_TO_STATE_PROV",
    "BILL_TO_POSTAL_CODE",
    "BILL_TO_COUNTRY_CODE",
    "BILL_TO_PHONE_NUMBER",
    "PURCHASE_ORDER",
    "PRO_NUMBER",
    "TRANS_RESP_CODE",
    "BASELINE_COST",
    "ESTIMATED_COST",
    "LINEHAUL_COST",
    "ACCESSORIAL_COST",
    "STOP_COST",
    "ESTIMATED_SAVINGS",
    "SPOT_CHARGE",
    "CURRENCY_CODE",
    "PICKUP_START_DTTM",
    "PICKUP_END_DTTM",
    "DELIVERY_START_DTTM",
    "DELIVERY_END_DTTM",
    "NUM_STOPS",
    "NUM_DOCKS",
    "ON_TIME_INDICATOR",
    "HAS_NOTES",
    "HAS_ALERTS",
    "HAS_IMPORT_ERROR",
    "HAS_SOFT_CHECK_ERROR",
    "HAS_TRACKING_MSG",
    "TRACKING_MSG_PROBLEM",
    "REC_LINEHAUL_COST",
    "REC_ACCESSORIAL_COST",
    "REC_TOTAL_COST",
    "CYCLE_RESP_DEADLINE_TZ",
    "TENDER_RESP_DEADLINE_TZ",
    "PICKUP_TZ",
    "DELIVERY_TZ",
    "ASSIGNED_LANE_ID",
    "ASSIGNED_LANE_DETAIL_ID",
    "REC_SPOT_CHARGE",
    "REC_LANE_ID",
    "REC_LANE_DETAIL_ID",
    "TENDER_DTTM",
    "O_STOP_LOCATION_NAME",
    "D_STOP_LOCATION_NAME",
    "ASSIGNED_CM_SHIPMENT_ID",
    "REC_CM_DISCOUNT",
    "REC_STOP_COST",
    "LAST_SELECTOR_RUN_DTTM",
    "LAST_CM_OPTION_GEN_DTTM",
    "IS_CM_OPTION_GEN_ACTIVE",
    "RS_CYCLE_REMAINING",
    "IS_TIME_FEAS_ENABLED",
    "EXT_SYS_SHIPMENT_ID",
    "EXTRACTION_DTTM",
    "ASSIGNED_BROKER_CARRIER_CODE",
    "USE_BROKER_AS_CARRIER",
    "BROKER_REF",
    "RATING_QUALIFIER",
    "STATUS_CHANGE_DTTM",
    "BUDG_TOTAL_COST",
    "NORMALIZED_MARGIN",
    "NORMALIZED_TOTAL_COST",
    "BUDG_NORMALIZED_TOTAL_COST",
    "REC_BUDG_LINEHAUL_COST",
    "REC_BUDG_STOP_COST",
    "REC_BUDG_CM_DISCOUNT",
    "REC_BUDG_ACCESSORIAL_COST",
    "REC_BUDG_TOTAL_COST",
    "REC_MARGIN",
    "REC_NORMALIZED_MARGIN",
    "REC_NORMALIZED_TOTAL_COST",
    "REC_BUDG_NORMALIZED_TOTAL_COST",
    "BUDG_CURRENCY_CODE",
    "SPOT_CHARGE_CURRENCY_CODE",
    "REC_CURRENCY_CODE",
    "REC_BUDG_CURRENCY_CODE",
    "REC_SPOT_CHARGE_CURRENCY_CODE",
    "RATING_LANE_ID",
    "FRT_REV_RATING_LANE_ID",
    "REC_RATING_LANE_ID",
    "REC_BUDG_RATING_LANE_ID",
    "RATING_LANE_DETAIL_ID",
    "FRT_REV_RATING_LANE_DETAIL_ID",
    "REC_RATING_LANE_DETAIL_ID",
    "REC_BUDG_RATING_LANE_DETAIL_ID",
    "BUDG_CM_DISCOUNT",
    "NORMALIZED_BASELINE_COST",
    "BASELINE_COST_CURRENCY_CODE",
    "REPORTED_COST",
    "TRACTOR_NUMBER",
    "IS_AUTO_DELIVERED",
    "SHIPMENT_TYPE",
    "ORIG_BUDG_TOTAL_COST",
    "ACCESSORIAL_COST_TO_CARRIER",
    "CARRIER_CHARGE",
    "ACTUAL_COST",
    "EARNED_INCOME",
    "SENT_TO_PKMS",
    "IS_SHIPMENT_RECONCILED",
    "DELIVERY_REQ",
    "DROPOFF_PICKUP",
    "PACKAGING",
    "SENT_TO_PKMS_DTTM",
    "WMS_STATUS_CODE",
    "SPOT_CHARGE_AND_PAYEE_ACC",
    "SPOT_CHARGE_AND_PAYEE_ACC_CC",
    "NORM_SPOT_CHARGE_AND_PAYEE_ACC",
    "FACILITY_SCHEDULE_ID",
    "EARNED_INCOME_CURRENCY_CODE",
    "ACTUAL_COST_CURRENCY_CODE",
    "SHIPMENT_RECON_DTTM",
    "PLN_RATING_LANE_ID",
    "PLN_RATING_LANE_DETAIL_ID",
    "PLN_TOTAL_COST",
    "PLN_LINEHAUL_COST",
    "PLN_TOTAL_ACCESSORIAL_COST",
    "PLN_STOP_OFF_COST",
    "PLN_NORMALIZED_TOTAL_COST",
    "PLN_CURRENCY_CODE",
    "PLN_ACCESSORL_COST_TO_CARRIER",
    "PLN_CARRIER_CHARGE",
    "WAYPOINT_TOTAL_COST",
    "WAYPOINT_HANDLING_COST",
    "GRS_OPERATION",
    "IS_GRS_OPT_CYCLE_RUNNING",
    "IS_MANUAL_ASSIGN",
    "LAST_RUN_GRS_DTTM",
    "GRS_MAX_SHIPMENT_STATUS",
    "PRIORITY_TYPE",
    "MV_CURRENCY_CODE",
    "PROD_SCHED_REF_NUMBER",
    "COMMODITY_CODE_ID",
    "UN_NUMBER_ID",
    "CONTRACT_NUMBER",
    "BOOKING_REF_SHIPPER",
    "BOOKING_REF_CARRIER",
    "BK_RESOURCE_REF_EXTERNAL",
    "BK_RESOURCE_NAME_EXTERNAL",
    "BK_O_FACILITY_ID",
    "BK_D_FACILITY_ID",
    "BK_MASTER_AIRWAY_BILL",
    "BK_FORWARDER_AIRWAY_BILL",
    "ASSIGNED_SCNDR_CARRIER_CODE",
    "CUSTOMER_CREDIT_LIMIT_ID",
    "SHIPMENT_LEG_TYPE",
    "SHIPMENT_CLOSED_INDICATOR",
    "OCEAN_ROUTING_STAGE",
    "BK_DEPARTURE_DTTM",
    "BK_DEPARTURE_TZ",
    "BK_ARRIVAL_DTTM",
    "BK_ARRIVAL_TZ",
    "BK_PICKUP_DTTM",
    "BK_PICKUP_TZ",
    "BK_CUTOFF_DTTM",
    "BK_CUTOFF_TZ",
    "NUM_CHARGE_LAYOVERS",
    "RATE_TYPE",
    "RATE_UOM",
    "PICK_START_DTTM",
    "PAPERWORK_START_DTTM",
    "VEHICLE_CHECK_START_DTTM",
    "SHIPMENT_START_DTTM",
    "SHIPMENT_END_DTTM",
    "FEASIBLE_DRIVER_TYPE",
    "WAVE_ID",
    "ESTIMATED_DISPATCH_DTTM",
    "TOTAL_TIME",
    "LOC_REFERENCE",
    "BK_O_FACILITY_ALIAS_ID",
    "BK_D_FACILITY_ALIAS_ID",
    "EQUIP_UTIL_PER",
    "MOVE_TYPE",
    "DRIVER_TYPE_ID",
    "EQUIPMENT_TYPE",
    "RADIAL_DISTANCE",
    "RADIAL_DISTANCE_UOM",
    "DESIGNATED_TRACTOR_CODE",
    "DESIGNATED_DRIVER_TYPE",
    "IS_WAVE_MAN_CHANGED",
    "RETAIN_CONSOLIDATOR_TIMES",
    "TARIFF",
    "MIN_RATE",
    "FIRST_UPDATE_SENT_TO_PKMS",
    "EVENT_IND_TYPEID",
    "TANDEM_PATH_ID",
    "O_TANDEM_FACILITY",
    "D_TANDEM_FACILITY",
    "O_TANDEM_FACILITY_ALIAS",
    "D_TANDEM_FACILITY_ALIAS",
    "DELAY_TYPE",
    "ASSIGNED_CARRIER_ID",
    "DSG_CARRIER_ID",
    "REC_CARRIER_ID",
    "FEASIBLE_CARRIER_ID",
    "PAYEE_CARRIER_ID",
    "SCNDR_CARRIER_ID",
    "BROKER_CARRIER_ID",
    "ASSIGNED_SCNDR_CARRIER_ID",
    "DSG_SCNDR_CARRIER_ID",
    "ASSIGNED_BROKER_CARRIER_ID",
    "LH_PAYEE_CARRIER_ID",
    "REC_BROKER_CARRIER_ID",
    "ASSIGNED_EQUIPMENT_ID",
    "DSG_EQUIPMENT_ID",
    "FEASIBLE_EQUIPMENT_ID",
    "FEASIBLE_EQUIPMENT2_ID",
    "REC_EQUIPMENT_ID",
    "ASSIGNED_MOT_ID",
    "DSG_MOT_ID",
    "FEASIBLE_MOT_ID",
    "REC_MOT_ID",
    "PRODUCT_CLASS_ID",
    "PROTECTION_LEVEL_ID",
    "ASSIGNED_SERVICE_LEVEL_ID",
    "DSG_SERVICE_LEVEL_ID",
    "FEASIBLE_SERVICE_LEVEL_ID",
    "REC_SERVICE_LEVEL_ID",
    "HAS_EM_NOTIFY_FLAG",
    "REGION_ID",
    "INBOUND_REGION_ID",
    "OUTBOUND_REGION_ID",
    "FINANCIAL_WT",
    "IS_BOOKING_REQUIRED",
    "TOTAL_COST_EXCL_TAX",
    "TOTAL_TAX_AMOUNT",
    "IS_ASSOCIATED_TO_OUTBOUND",
    "RECEIVED_DTTM",
    "BOOKING_ID",
    "IS_MISROUTED",
    "FEASIBLE_CARRIER_CODE",
    "SHIPMENT_WIN_ADJ_FLAG",
    "DT_PARAM_SET_ID",
    "MERCHANDIZING_DEPARTMENT_ID",
    "STATIC_ROUTE_ID",
    "IS_FILO",
    "IS_COOLER_AT_NOSE",
    "AUTH_NBR",
    "CONS_LOCN_ID",
    "RTE_TYPE",
    "TRLR_TYPE",
    "TRLR_SIZE",
    "CONS_ADDR_CODE",
    "HUB_ID",
    "TRLR_GEN_CODE",
    "MAX_NBR_OF_CTNS",
    "APPT_DOOR_SCHED_TYPE",
    "CREATED_SOURCE_TYPE",
    "CREATED_SOURCE",
    "CREATED_DTTM",
    "LAST_UPDATED_SOURCE_TYPE",
    "LAST_UPDATED_SOURCE",
    "LAST_UPDATED_DTTM",
    "DSG_SCNDR_CARRIER_CODE",
    "LH_PAYEE_CARRIER_CODE",
    "REC_BROKER_CARRIER_CODE",
    "REC_CARRIER_CODE",
    "LPN_ASSIGNMENT_STOPPED",
    "SEAL_NUMBER",
    "HIBERNATE_VERSION",
    "SHIP_GROUP_ID",
    "RATE",
    "MONETARY_VALUE",
    "DOOR",
    "RTE_TYPE_1",
    "RTE_TYPE_2",
    "SCHEDULED_PICKUP_DTTM",
    "MANIFEST_ID",
    "DAYS_TO_DELIVER",
    "SED_GENERATED_FLAG",
    "SERV_AREA_CODE",
    "TENDER_RESP_DEADLINE_DTTM",
    "PRINT_CONS_BOL",
    "LEFT_WT",
    "RIGHT_WT",
    "LANE_NAME",
    "DECLARED_VALUE",
    "DV_CURRENCY_CODE",
    "COD_AMOUNT",
    "CUSTOMER_ID",
    "CUST_FRGT_CHARGE",
    "COD_CURRENCY_CODE",
    "PLANNED_WEIGHT",
    "WEIGHT_UOM_ID_BASE",
    "PLANNED_VOLUME",
    "VOLUME_UOM_ID_BASE",
    "SIZE1_VALUE",
    "SIZE1_UOM_ID",
    "SIZE2_VALUE",
    "SIZE2_UOM_ID",
    "ASSIGNED_SHIP_VIA",
    "INSURANCE_STATUS",
    "RTE_SWC_NBR",
    "RTE_TO",
    "BILL_OF_LADING_NUMBER",
    "TRAILER_NUMBER",
    "TRANS_PLAN_OWNER",
    "TOTAL_REVENUE_CURRENCY_CODE",
    "TOTAL_REVENUE",
    "FRT_REV_SPOT_CHARGE_CURR_CODE",
    "NORMALIZED_TOTAL_REVENUE",
    "FRT_REV_SPOT_CHARGE",
    "DSG_VOYAGE_FLIGHT",
    "FEASIBLE_VOYAGE_FLIGHT",
    "CURRENCY_DTTM",
    "FRT_REV_LINEHAUL_CHARGE",
    "FRT_REV_STOP_CHARGE",
    "FRT_REV_ACCESSORIAL_CHARGE",
    "MARGIN",
    "TOTAL_COST",
    "INCOTERM_ID",
    "ORDER_QTY",
    "QTY_UOM_ID",
    "REF_SHIPMENT_NBR",
    "STAGING_LOCN_ID",
    "LOADING_SEQ_ORD",
    "HAZMAT_CERT_CONTACT",
    "HAZMAT_CERT_DECLARATION",
    "CDC_TIMESTAMP",
    "OPERATION_TYPE",
    "ARCHIVED_DTTM",
    "ORIGIN",
    "FINAL_DESTINATION",
    "actual_delivery_date_parsed",
    "wood_pellet",
    "act_del_MERCH_YEAR",
    "act_del_YEAR_WEEK",
    "act_del_YEAR_QUARTER",
    "act_del_YEAR_PERIOD",
    "invoice_shipping_id",
    "org_Facility_Code",
    "org_Facility_Name",
    "org_Facility_Type",
    "dest_Facility_Code",
    "dest_Facility_Name",
    "dest_Facility_Type",
    "inbound_flag",
    "order_id_po",
    "order_id_po_int",
    "po_STORE_NO",
    "po_CO_CODE",
    "po_ARTICLE_NO",
    "po_PO_NO",
    "po_PO_LINE_NO",
    "po_PO_DATE",
    "po_po_date_parsed",
    "po_DELIV_DATE",
    "po_deliv_date_parsed",
    "po_PO_TYPE_CODE",
    "po_VENDOR_ID",
    "po_VSR_CODE",
    "po_PO_LINE_CANCELLED_FLAG",
    "po_PO_LINE_ORDER_QTY",
    "po_PO_LINE_ISSUE_QTY",
    "po_PO_LINE_RCVD_QTY",
    "po_PO_LINE_UNIT_PRICE",
    "po_DC_NO",
    "po_PO_TRACKING_NO",
    "po_PO_LINE_TRACKING_NO",
    "po_CURRENT_REPL_TYPE_CODE",
    "po_FREIGHT_TYPE_CODE",
    "po_SHIP_START_DATE",
    "po_SHIP_END_DATE",
    "po_DELIV_START_DATE",
    "po_DELIV_END_DATE",
    "po_PO_LINE_UNIT_FREIGHT_AMT",
    "po_PO_LINE_MANUFACTURER",
    "po_PO_LINE_ORIGIN_COUNTRY_CODE",
    "po_PO_LINE_PORT_OF_ORIGIN",
    "po_PO_LINE_MIN_RCVD_DATE",
    "po_PO_LINE_MAX_RCVD_DATE",
    "po_PO_LINE_DELIVERED_FLAG",
    "po_PO_LINE_CONFIRMED_ON_BOARD_DATE",
    "po_PO_LINE_BOOKED_FOR_SHIPMENT_DATE",
    "po_PO_LINE_TRANSIT_RESN_CODE",
    "po_PO_LINE_MOVE_TYPE_CODE",
    "po_PO_LINE_AGENT_COMMISSION_RATE",
    "po_PO_LINE_AGENT_COMMISSION_AMT",
    "po_PO_LINE_ADDL_ARTICLE_NO",
    "po_PO_LINE_ADDL_ARTICLE_QTY",
    "po_PO_LINE_FACTORY_VENDOR_ID",
    "po_PO_LINE_STUFFING_LOC_VENDOR_ID",
    "po_PO_LINE_SOURCING_AGENT_VENDOR_ID",
    "po_PO_LINE_FREIGHT_FORWARDER_VENDOR_ID",
    "po_PO_LINE_LETTER_OF_CREDIT_NO",
    "po_PO_LINE_OPEN_ACCT_NO",
    "po_PO_LINE_ARTICLE_LENGTH",
    "po_PO_LINE_ARTICLE_WIDTH",
    "po_PO_LINE_ARTICLE_HEIGHT",
    "po_PO_LINE_ARTICLE_DIMENSIONS_UOM",
    "po_PO_LINE_ARTICLE_WEIGHT",
    "po_PO_LINE_ARTICLE_WEIGHT_UOM",
    "po_PO_TOTAL_WEIGHT",
    "po_PO_LINE_ARTICLE_VOLUME",
    "po_PO_LINE_ARTICLE_VOLUME_UOM",
    "po_PO_TOTAL_VOLUME",
    "po_HTS_CODE",
    "po_PO_LINE_DUTY_RATE",
    "po_PO_LINE_DUTY_AMT",
    "po_PO_LINE_ADDL_HTS_CODE_1",
    "po_PO_LINE_ADDL_DUTY_RATE_1",
    "po_PO_LINE_ADDL_DUTY_AMT_1",
    "po_PO_LINE_ADDL_HTS_CODE_2",
    "po_PO_LINE_ADDL_DUTY_RATE_2",
    "po_PO_LINE_ADDL_DUTY_AMT_2",
    "po_PO_HELD_FLAG",
    "po_PO_VENDOR_DOC_DATE",
    "po_cal_MERCH_YEAR",
    "po_cal_YEAR_WEEK",
    "po_cal_YEAR_QUARTER",
    "po_cal_YEAR_PERIOD",
    "a_ARTICLE_LENGTH",
    "a_ARTICLE_WIDTH",
    "a_ARTICLE_HEIGHT",
    "item_volume",
    "a_ARTICLE_WEIGHT",
    "item_weight",
    "a_ARTICLE_SIZE",
    "a_ARTICLE_40HC_QTY",
    "a_ARTICLE_40GP_QTY",
    "item_volume_sum",
    "item_weight_sum",
    "allocation_by_vol",
    "allocation_by_wgt",
    "max_volume",
    "max_weight",
    "weight_volume_flag",
    CASE WHEN "weight_volume_flag" = 'V' THEN "allocation_by_vol" ELSE "allocation_by_wgt" END AS "allocation_final"
  FROM (
    SELECT 
        "SHIPMENT_ID",
        "TC_COMPANY_ID",
        "RS_AREA_ID",
        "TC_SHIPMENT_ID",
        "PP_SHIPMENT_ID",
        "SHIPMENT_STATUS",
        "UPDATE_SENT",
        "BUSINESS_PROCESS",
        "CREATION_TYPE",
        "CONS_RUN_ID",
        "IS_CANCELLED",
        "RS_TYPE",
        "RS_CONFIG_ID",
        "RS_CONFIG_CYCLE_ID",
        "CONFIG_CYCLE_SEQ",
        "CYCLE_DEADLINE_DTTM",
        "CYCLE_EXECUTION_DTTM",
        "LAST_RS_NOTIFICATION_DTTM",
        "CFMF_STATUS",
        "AVAILABLE_DTTM",
        "CMID",
        "CM_DISCOUNT",
        "O_FACILITY_NUMBER",
        "O_FACILITY_ID",
        "O_ADDRESS",
        "O_CITY",
        "O_STATE_PROV",
        "O_POSTAL_CODE",
        "O_COUNTY",
        "O_COUNTRY_CODE",
        "D_FACILITY_NUMBER",
        "D_FACILITY_ID",
        "D_ADDRESS",
        "D_CITY",
        "D_STATE_PROV",
        "D_POSTAL_CODE",
        "D_COUNTY",
        "D_COUNTRY_CODE",
        "DISTANCE",
        "DIRECT_DISTANCE",
        "OUT_OF_ROUTE_DISTANCE",
        "DISTANCE_UOM",
        "BUSINESS_PARTNER_ID",
        "COMMODITY_CLASS",
        "IS_HAZMAT",
        "IS_PERISHABLE",
        "BILLING_METHOD",
        "DSG_CARRIER_CODE",
        "REC_CMID",
        "REC_CM_SHIPMENT_ID",
        "ASSIGNED_CARRIER_CODE",
        "SHIPMENT_REF_ID",
        "BILL_TO_CODE",
        "BILL_TO_TITLE",
        "BILL_TO_NAME",
        "BILL_TO_ADDRESS",
        "BILL_TO_CITY",
        "BILL_TO_STATE_PROV",
        "BILL_TO_POSTAL_CODE",
        "BILL_TO_COUNTRY_CODE",
        "BILL_TO_PHONE_NUMBER",
        "PURCHASE_ORDER",
        "PRO_NUMBER",
        "TRANS_RESP_CODE",
        "BASELINE_COST",
        "ESTIMATED_COST",
        "LINEHAUL_COST",
        "ACCESSORIAL_COST",
        "STOP_COST",
        "ESTIMATED_SAVINGS",
        "SPOT_CHARGE",
        "CURRENCY_CODE",
        "PICKUP_START_DTTM",
        "PICKUP_END_DTTM",
        "DELIVERY_START_DTTM",
        "DELIVERY_END_DTTM",
        "NUM_STOPS",
        "NUM_DOCKS",
        "ON_TIME_INDICATOR",
        "HAS_NOTES",
        "HAS_ALERTS",
        "HAS_IMPORT_ERROR",
        "HAS_SOFT_CHECK_ERROR",
        "HAS_TRACKING_MSG",
        "TRACKING_MSG_PROBLEM",
        "REC_LINEHAUL_COST",
        "REC_ACCESSORIAL_COST",
        "REC_TOTAL_COST",
        "CYCLE_RESP_DEADLINE_TZ",
        "TENDER_RESP_DEADLINE_TZ",
        "PICKUP_TZ",
        "DELIVERY_TZ",
        "ASSIGNED_LANE_ID",
        "ASSIGNED_LANE_DETAIL_ID",
        "REC_SPOT_CHARGE",
        "REC_LANE_ID",
        "REC_LANE_DETAIL_ID",
        "TENDER_DTTM",
        "O_STOP_LOCATION_NAME",
        "D_STOP_LOCATION_NAME",
        "ASSIGNED_CM_SHIPMENT_ID",
        "REC_CM_DISCOUNT",
        "REC_STOP_COST",
        "LAST_SELECTOR_RUN_DTTM",
        "LAST_CM_OPTION_GEN_DTTM",
        "IS_CM_OPTION_GEN_ACTIVE",
        "RS_CYCLE_REMAINING",
        "IS_TIME_FEAS_ENABLED",
        "EXT_SYS_SHIPMENT_ID",
        "EXTRACTION_DTTM",
        "ASSIGNED_BROKER_CARRIER_CODE",
        "USE_BROKER_AS_CARRIER",
        "BROKER_REF",
        "RATING_QUALIFIER",
        "STATUS_CHANGE_DTTM",
        "BUDG_TOTAL_COST",
        "NORMALIZED_MARGIN",
        "NORMALIZED_TOTAL_COST",
        "BUDG_NORMALIZED_TOTAL_COST",
        "REC_BUDG_LINEHAUL_COST",
        "REC_BUDG_STOP_COST",
        "REC_BUDG_CM_DISCOUNT",
        "REC_BUDG_ACCESSORIAL_COST",
        "REC_BUDG_TOTAL_COST",
        "REC_MARGIN",
        "REC_NORMALIZED_MARGIN",
        "REC_NORMALIZED_TOTAL_COST",
        "REC_BUDG_NORMALIZED_TOTAL_COST",
        "BUDG_CURRENCY_CODE",
        "SPOT_CHARGE_CURRENCY_CODE",
        "REC_CURRENCY_CODE",
        "REC_BUDG_CURRENCY_CODE",
        "REC_SPOT_CHARGE_CURRENCY_CODE",
        "RATING_LANE_ID",
        "FRT_REV_RATING_LANE_ID",
        "REC_RATING_LANE_ID",
        "REC_BUDG_RATING_LANE_ID",
        "RATING_LANE_DETAIL_ID",
        "FRT_REV_RATING_LANE_DETAIL_ID",
        "REC_RATING_LANE_DETAIL_ID",
        "REC_BUDG_RATING_LANE_DETAIL_ID",
        "BUDG_CM_DISCOUNT",
        "NORMALIZED_BASELINE_COST",
        "BASELINE_COST_CURRENCY_CODE",
        "REPORTED_COST",
        "TRACTOR_NUMBER",
        "IS_AUTO_DELIVERED",
        "SHIPMENT_TYPE",
        "ORIG_BUDG_TOTAL_COST",
        "ACCESSORIAL_COST_TO_CARRIER",
        "CARRIER_CHARGE",
        "ACTUAL_COST",
        "EARNED_INCOME",
        "SENT_TO_PKMS",
        "IS_SHIPMENT_RECONCILED",
        "DELIVERY_REQ",
        "DROPOFF_PICKUP",
        "PACKAGING",
        "SENT_TO_PKMS_DTTM",
        "WMS_STATUS_CODE",
        "SPOT_CHARGE_AND_PAYEE_ACC",
        "SPOT_CHARGE_AND_PAYEE_ACC_CC",
        "NORM_SPOT_CHARGE_AND_PAYEE_ACC",
        "FACILITY_SCHEDULE_ID",
        "EARNED_INCOME_CURRENCY_CODE",
        "ACTUAL_COST_CURRENCY_CODE",
        "SHIPMENT_RECON_DTTM",
        "PLN_RATING_LANE_ID",
        "PLN_RATING_LANE_DETAIL_ID",
        "PLN_TOTAL_COST",
        "PLN_LINEHAUL_COST",
        "PLN_TOTAL_ACCESSORIAL_COST",
        "PLN_STOP_OFF_COST",
        "PLN_NORMALIZED_TOTAL_COST",
        "PLN_CURRENCY_CODE",
        "PLN_ACCESSORL_COST_TO_CARRIER",
        "PLN_CARRIER_CHARGE",
        "WAYPOINT_TOTAL_COST",
        "WAYPOINT_HANDLING_COST",
        "GRS_OPERATION",
        "IS_GRS_OPT_CYCLE_RUNNING",
        "IS_MANUAL_ASSIGN",
        "LAST_RUN_GRS_DTTM",
        "GRS_MAX_SHIPMENT_STATUS",
        "PRIORITY_TYPE",
        "MV_CURRENCY_CODE",
        "PROD_SCHED_REF_NUMBER",
        "COMMODITY_CODE_ID",
        "UN_NUMBER_ID",
        "CONTRACT_NUMBER",
        "BOOKING_REF_SHIPPER",
        "BOOKING_REF_CARRIER",
        "BK_RESOURCE_REF_EXTERNAL",
        "BK_RESOURCE_NAME_EXTERNAL",
        "BK_O_FACILITY_ID",
        "BK_D_FACILITY_ID",
        "BK_MASTER_AIRWAY_BILL",
        "BK_FORWARDER_AIRWAY_BILL",
        "ASSIGNED_SCNDR_CARRIER_CODE",
        "CUSTOMER_CREDIT_LIMIT_ID",
        "SHIPMENT_LEG_TYPE",
        "SHIPMENT_CLOSED_INDICATOR",
        "OCEAN_ROUTING_STAGE",
        "BK_DEPARTURE_DTTM",
        "BK_DEPARTURE_TZ",
        "BK_ARRIVAL_DTTM",
        "BK_ARRIVAL_TZ",
        "BK_PICKUP_DTTM",
        "BK_PICKUP_TZ",
        "BK_CUTOFF_DTTM",
        "BK_CUTOFF_TZ",
        "NUM_CHARGE_LAYOVERS",
        "RATE_TYPE",
        "RATE_UOM",
        "PICK_START_DTTM",
        "PAPERWORK_START_DTTM",
        "VEHICLE_CHECK_START_DTTM",
        "SHIPMENT_START_DTTM",
        "SHIPMENT_END_DTTM",
        "FEASIBLE_DRIVER_TYPE",
        "WAVE_ID",
        "ESTIMATED_DISPATCH_DTTM",
        "TOTAL_TIME",
        "LOC_REFERENCE",
        "BK_O_FACILITY_ALIAS_ID",
        "BK_D_FACILITY_ALIAS_ID",
        "EQUIP_UTIL_PER",
        "MOVE_TYPE",
        "DRIVER_TYPE_ID",
        "EQUIPMENT_TYPE",
        "RADIAL_DISTANCE",
        "RADIAL_DISTANCE_UOM",
        "DESIGNATED_TRACTOR_CODE",
        "DESIGNATED_DRIVER_TYPE",
        "IS_WAVE_MAN_CHANGED",
        "RETAIN_CONSOLIDATOR_TIMES",
        "TARIFF",
        "MIN_RATE",
        "FIRST_UPDATE_SENT_TO_PKMS",
        "EVENT_IND_TYPEID",
        "TANDEM_PATH_ID",
        "O_TANDEM_FACILITY",
        "D_TANDEM_FACILITY",
        "O_TANDEM_FACILITY_ALIAS",
        "D_TANDEM_FACILITY_ALIAS",
        "DELAY_TYPE",
        "ASSIGNED_CARRIER_ID",
        "DSG_CARRIER_ID",
        "REC_CARRIER_ID",
        "FEASIBLE_CARRIER_ID",
        "PAYEE_CARRIER_ID",
        "SCNDR_CARRIER_ID",
        "BROKER_CARRIER_ID",
        "ASSIGNED_SCNDR_CARRIER_ID",
        "DSG_SCNDR_CARRIER_ID",
        "ASSIGNED_BROKER_CARRIER_ID",
        "LH_PAYEE_CARRIER_ID",
        "REC_BROKER_CARRIER_ID",
        "ASSIGNED_EQUIPMENT_ID",
        "DSG_EQUIPMENT_ID",
        "FEASIBLE_EQUIPMENT_ID",
        "FEASIBLE_EQUIPMENT2_ID",
        "REC_EQUIPMENT_ID",
        "ASSIGNED_MOT_ID",
        "DSG_MOT_ID",
        "FEASIBLE_MOT_ID",
        "REC_MOT_ID",
        "PRODUCT_CLASS_ID",
        "PROTECTION_LEVEL_ID",
        "ASSIGNED_SERVICE_LEVEL_ID",
        "DSG_SERVICE_LEVEL_ID",
        "FEASIBLE_SERVICE_LEVEL_ID",
        "REC_SERVICE_LEVEL_ID",
        "HAS_EM_NOTIFY_FLAG",
        "REGION_ID",
        "INBOUND_REGION_ID",
        "OUTBOUND_REGION_ID",
        "FINANCIAL_WT",
        "IS_BOOKING_REQUIRED",
        "TOTAL_COST_EXCL_TAX",
        "TOTAL_TAX_AMOUNT",
        "IS_ASSOCIATED_TO_OUTBOUND",
        "RECEIVED_DTTM",
        "BOOKING_ID",
        "IS_MISROUTED",
        "FEASIBLE_CARRIER_CODE",
        "SHIPMENT_WIN_ADJ_FLAG",
        "DT_PARAM_SET_ID",
        "MERCHANDIZING_DEPARTMENT_ID",
        "STATIC_ROUTE_ID",
        "IS_FILO",
        "IS_COOLER_AT_NOSE",
        "AUTH_NBR",
        "CONS_LOCN_ID",
        "RTE_TYPE",
        "TRLR_TYPE",
        "TRLR_SIZE",
        "CONS_ADDR_CODE",
        "HUB_ID",
        "TRLR_GEN_CODE",
        "MAX_NBR_OF_CTNS",
        "APPT_DOOR_SCHED_TYPE",
        "CREATED_SOURCE_TYPE",
        "CREATED_SOURCE",
        "CREATED_DTTM",
        "LAST_UPDATED_SOURCE_TYPE",
        "LAST_UPDATED_SOURCE",
        "LAST_UPDATED_DTTM",
        "DSG_SCNDR_CARRIER_CODE",
        "LH_PAYEE_CARRIER_CODE",
        "REC_BROKER_CARRIER_CODE",
        "REC_CARRIER_CODE",
        "LPN_ASSIGNMENT_STOPPED",
        "SEAL_NUMBER",
        "HIBERNATE_VERSION",
        "SHIP_GROUP_ID",
        "RATE",
        "MONETARY_VALUE",
        "DOOR",
        "RTE_TYPE_1",
        "RTE_TYPE_2",
        "SCHEDULED_PICKUP_DTTM",
        "MANIFEST_ID",
        "DAYS_TO_DELIVER",
        "SED_GENERATED_FLAG",
        "SERV_AREA_CODE",
        "TENDER_RESP_DEADLINE_DTTM",
        "PRINT_CONS_BOL",
        "LEFT_WT",
        "RIGHT_WT",
        "LANE_NAME",
        "DECLARED_VALUE",
        "DV_CURRENCY_CODE",
        "COD_AMOUNT",
        "CUSTOMER_ID",
        "CUST_FRGT_CHARGE",
        "COD_CURRENCY_CODE",
        "PLANNED_WEIGHT",
        "WEIGHT_UOM_ID_BASE",
        "PLANNED_VOLUME",
        "VOLUME_UOM_ID_BASE",
        "SIZE1_VALUE",
        "SIZE1_UOM_ID",
        "SIZE2_VALUE",
        "SIZE2_UOM_ID",
        "ASSIGNED_SHIP_VIA",
        "INSURANCE_STATUS",
        "RTE_SWC_NBR",
        "RTE_TO",
        "BILL_OF_LADING_NUMBER",
        "TRAILER_NUMBER",
        "TRANS_PLAN_OWNER",
        "TOTAL_REVENUE_CURRENCY_CODE",
        "TOTAL_REVENUE",
        "FRT_REV_SPOT_CHARGE_CURR_CODE",
        "NORMALIZED_TOTAL_REVENUE",
        "FRT_REV_SPOT_CHARGE",
        "DSG_VOYAGE_FLIGHT",
        "FEASIBLE_VOYAGE_FLIGHT",
        "CURRENCY_DTTM",
        "FRT_REV_LINEHAUL_CHARGE",
        "FRT_REV_STOP_CHARGE",
        "FRT_REV_ACCESSORIAL_CHARGE",
        "MARGIN",
        "TOTAL_COST",
        "INCOTERM_ID",
        "ORDER_QTY",
        "QTY_UOM_ID",
        "REF_SHIPMENT_NBR",
        "STAGING_LOCN_ID",
        "LOADING_SEQ_ORD",
        "HAZMAT_CERT_CONTACT",
        "HAZMAT_CERT_DECLARATION",
        "CDC_TIMESTAMP",
        "OPERATION_TYPE",
        "ARCHIVED_DTTM",
        "ORIGIN",
        "FINAL_DESTINATION",
        "actual_delivery_date_parsed",
        "wood_pellet",
        "act_del_MERCH_YEAR",
        "act_del_YEAR_WEEK",
        "act_del_YEAR_QUARTER",
        "act_del_YEAR_PERIOD",
        "invoice_shipping_id",
        "org_Facility_Code",
        "org_Facility_Name",
        "org_Facility_Type",
        "dest_Facility_Code",
        "dest_Facility_Name",
        "dest_Facility_Type",
        "inbound_flag",
        "order_id_po",
        "order_id_po_int",
        "po_STORE_NO",
        "po_CO_CODE",
        "po_ARTICLE_NO",
        "po_PO_NO",
        "po_PO_LINE_NO",
        "po_PO_DATE",
        "po_po_date_parsed",
        "po_DELIV_DATE",
        "po_deliv_date_parsed",
        "po_PO_TYPE_CODE",
        "po_VENDOR_ID",
        "po_VSR_CODE",
        "po_PO_LINE_CANCELLED_FLAG",
        "po_PO_LINE_ORDER_QTY",
        "po_PO_LINE_ISSUE_QTY",
        "po_PO_LINE_RCVD_QTY",
        "po_PO_LINE_UNIT_PRICE",
        "po_DC_NO",
        "po_PO_TRACKING_NO",
        "po_PO_LINE_TRACKING_NO",
        "po_CURRENT_REPL_TYPE_CODE",
        "po_FREIGHT_TYPE_CODE",
        "po_SHIP_START_DATE",
        "po_SHIP_END_DATE",
        "po_DELIV_START_DATE",
        "po_DELIV_END_DATE",
        "po_PO_LINE_UNIT_FREIGHT_AMT",
        "po_PO_LINE_MANUFACTURER",
        "po_PO_LINE_ORIGIN_COUNTRY_CODE",
        "po_PO_LINE_PORT_OF_ORIGIN",
        "po_PO_LINE_MIN_RCVD_DATE",
        "po_PO_LINE_MAX_RCVD_DATE",
        "po_PO_LINE_DELIVERED_FLAG",
        "po_PO_LINE_CONFIRMED_ON_BOARD_DATE",
        "po_PO_LINE_BOOKED_FOR_SHIPMENT_DATE",
        "po_PO_LINE_TRANSIT_RESN_CODE",
        "po_PO_LINE_MOVE_TYPE_CODE",
        "po_PO_LINE_AGENT_COMMISSION_RATE",
        "po_PO_LINE_AGENT_COMMISSION_AMT",
        "po_PO_LINE_ADDL_ARTICLE_NO",
        "po_PO_LINE_ADDL_ARTICLE_QTY",
        "po_PO_LINE_FACTORY_VENDOR_ID",
        "po_PO_LINE_STUFFING_LOC_VENDOR_ID",
        "po_PO_LINE_SOURCING_AGENT_VENDOR_ID",
        "po_PO_LINE_FREIGHT_FORWARDER_VENDOR_ID",
        "po_PO_LINE_LETTER_OF_CREDIT_NO",
        "po_PO_LINE_OPEN_ACCT_NO",
        "po_PO_LINE_ARTICLE_LENGTH",
        "po_PO_LINE_ARTICLE_WIDTH",
        "po_PO_LINE_ARTICLE_HEIGHT",
        "po_PO_LINE_ARTICLE_DIMENSIONS_UOM",
        "po_PO_LINE_ARTICLE_WEIGHT",
        "po_PO_LINE_ARTICLE_WEIGHT_UOM",
        "po_PO_TOTAL_WEIGHT",
        "po_PO_LINE_ARTICLE_VOLUME",
        "po_PO_LINE_ARTICLE_VOLUME_UOM",
        "po_PO_TOTAL_VOLUME",
        "po_HTS_CODE",
        "po_PO_LINE_DUTY_RATE",
        "po_PO_LINE_DUTY_AMT",
        "po_PO_LINE_ADDL_HTS_CODE_1",
        "po_PO_LINE_ADDL_DUTY_RATE_1",
        "po_PO_LINE_ADDL_DUTY_AMT_1",
        "po_PO_LINE_ADDL_HTS_CODE_2",
        "po_PO_LINE_ADDL_DUTY_RATE_2",
        "po_PO_LINE_ADDL_DUTY_AMT_2",
        "po_PO_HELD_FLAG",
        "po_PO_VENDOR_DOC_DATE",
        "po_cal_MERCH_YEAR",
        "po_cal_YEAR_WEEK",
        "po_cal_YEAR_QUARTER",
        "po_cal_YEAR_PERIOD",
        "a_ARTICLE_LENGTH",
        "a_ARTICLE_WIDTH",
        "a_ARTICLE_HEIGHT",
        "item_volume",
        "a_ARTICLE_WEIGHT",
        "item_weight",
        "a_ARTICLE_SIZE",
        "a_ARTICLE_40HC_QTY",
        "a_ARTICLE_40GP_QTY",
        "item_volume_sum",
        "item_weight_sum",
        "allocation_by_vol",
        "allocation_by_wgt",
        "max_volume",
        "max_weight",
        CASE WHEN CAST("item_volume_sum" AS DOUBLE) / NULLIF("max_volume", 0) >= CAST("item_weight_sum" AS DOUBLE) / NULLIF("max_weight", 0) THEN 'V' ELSE 'W' END AS "weight_volume_flag"
      FROM (
        SELECT DISTINCT 
            "SHIPMENT_ID",
            "TC_COMPANY_ID",
            "RS_AREA_ID",
            "TC_SHIPMENT_ID",
            "PP_SHIPMENT_ID",
            "SHIPMENT_STATUS",
            "UPDATE_SENT",
            "BUSINESS_PROCESS",
            "CREATION_TYPE",
            "CONS_RUN_ID",
            "IS_CANCELLED",
            "RS_TYPE",
            "RS_CONFIG_ID",
            "RS_CONFIG_CYCLE_ID",
            "CONFIG_CYCLE_SEQ",
            "CYCLE_DEADLINE_DTTM",
            "CYCLE_EXECUTION_DTTM",
            "LAST_RS_NOTIFICATION_DTTM",
            "CFMF_STATUS",
            "AVAILABLE_DTTM",
            "CMID",
            "CM_DISCOUNT",
            "O_FACILITY_NUMBER",
            "O_FACILITY_ID",
            "O_ADDRESS",
            "O_CITY",
            "O_STATE_PROV",
            "O_POSTAL_CODE",
            "O_COUNTY",
            "O_COUNTRY_CODE",
            "D_FACILITY_NUMBER",
            "D_FACILITY_ID",
            "D_ADDRESS",
            "D_CITY",
            "D_STATE_PROV",
            "D_POSTAL_CODE",
            "D_COUNTY",
            "D_COUNTRY_CODE",
            "DISTANCE",
            "DIRECT_DISTANCE",
            "OUT_OF_ROUTE_DISTANCE",
            "DISTANCE_UOM",
            "BUSINESS_PARTNER_ID",
            "COMMODITY_CLASS",
            "IS_HAZMAT",
            "IS_PERISHABLE",
            "BILLING_METHOD",
            "DSG_CARRIER_CODE",
            "REC_CMID",
            "REC_CM_SHIPMENT_ID",
            "ASSIGNED_CARRIER_CODE",
            "SHIPMENT_REF_ID",
            "BILL_TO_CODE",
            "BILL_TO_TITLE",
            "BILL_TO_NAME",
            "BILL_TO_ADDRESS",
            "BILL_TO_CITY",
            "BILL_TO_STATE_PROV",
            "BILL_TO_POSTAL_CODE",
            "BILL_TO_COUNTRY_CODE",
            "BILL_TO_PHONE_NUMBER",
            "PURCHASE_ORDER",
            "PRO_NUMBER",
            "TRANS_RESP_CODE",
            "BASELINE_COST",
            "ESTIMATED_COST",
            "LINEHAUL_COST",
            "ACCESSORIAL_COST",
            "STOP_COST",
            "ESTIMATED_SAVINGS",
            "SPOT_CHARGE",
            "CURRENCY_CODE",
            "PICKUP_START_DTTM",
            "PICKUP_END_DTTM",
            "DELIVERY_START_DTTM",
            "DELIVERY_END_DTTM",
            "NUM_STOPS",
            "NUM_DOCKS",
            "ON_TIME_INDICATOR",
            "HAS_NOTES",
            "HAS_ALERTS",
            "HAS_IMPORT_ERROR",
            "HAS_SOFT_CHECK_ERROR",
            "HAS_TRACKING_MSG",
            "TRACKING_MSG_PROBLEM",
            "REC_LINEHAUL_COST",
            "REC_ACCESSORIAL_COST",
            "REC_TOTAL_COST",
            "CYCLE_RESP_DEADLINE_TZ",
            "TENDER_RESP_DEADLINE_TZ",
            "PICKUP_TZ",
            "DELIVERY_TZ",
            "ASSIGNED_LANE_ID",
            "ASSIGNED_LANE_DETAIL_ID",
            "REC_SPOT_CHARGE",
            "REC_LANE_ID",
            "REC_LANE_DETAIL_ID",
            "TENDER_DTTM",
            "O_STOP_LOCATION_NAME",
            "D_STOP_LOCATION_NAME",
            "ASSIGNED_CM_SHIPMENT_ID",
            "REC_CM_DISCOUNT",
            "REC_STOP_COST",
            "LAST_SELECTOR_RUN_DTTM",
            "LAST_CM_OPTION_GEN_DTTM",
            "IS_CM_OPTION_GEN_ACTIVE",
            "RS_CYCLE_REMAINING",
            "IS_TIME_FEAS_ENABLED",
            "EXT_SYS_SHIPMENT_ID",
            "EXTRACTION_DTTM",
            "ASSIGNED_BROKER_CARRIER_CODE",
            "USE_BROKER_AS_CARRIER",
            "BROKER_REF",
            "RATING_QUALIFIER",
            "STATUS_CHANGE_DTTM",
            "BUDG_TOTAL_COST",
            "NORMALIZED_MARGIN",
            "NORMALIZED_TOTAL_COST",
            "BUDG_NORMALIZED_TOTAL_COST",
            "REC_BUDG_LINEHAUL_COST",
            "REC_BUDG_STOP_COST",
            "REC_BUDG_CM_DISCOUNT",
            "REC_BUDG_ACCESSORIAL_COST",
            "REC_BUDG_TOTAL_COST",
            "REC_MARGIN",
            "REC_NORMALIZED_MARGIN",
            "REC_NORMALIZED_TOTAL_COST",
            "REC_BUDG_NORMALIZED_TOTAL_COST",
            "BUDG_CURRENCY_CODE",
            "SPOT_CHARGE_CURRENCY_CODE",
            "REC_CURRENCY_CODE",
            "REC_BUDG_CURRENCY_CODE",
            "REC_SPOT_CHARGE_CURRENCY_CODE",
            "RATING_LANE_ID",
            "FRT_REV_RATING_LANE_ID",
            "REC_RATING_LANE_ID",
            "REC_BUDG_RATING_LANE_ID",
            "RATING_LANE_DETAIL_ID",
            "FRT_REV_RATING_LANE_DETAIL_ID",
            "REC_RATING_LANE_DETAIL_ID",
            "REC_BUDG_RATING_LANE_DETAIL_ID",
            "BUDG_CM_DISCOUNT",
            "NORMALIZED_BASELINE_COST",
            "BASELINE_COST_CURRENCY_CODE",
            "REPORTED_COST",
            "TRACTOR_NUMBER",
            "IS_AUTO_DELIVERED",
            "SHIPMENT_TYPE",
            "ORIG_BUDG_TOTAL_COST",
            "ACCESSORIAL_COST_TO_CARRIER",
            "CARRIER_CHARGE",
            "ACTUAL_COST",
            "EARNED_INCOME",
            "SENT_TO_PKMS",
            "IS_SHIPMENT_RECONCILED",
            "DELIVERY_REQ",
            "DROPOFF_PICKUP",
            "PACKAGING",
            "SENT_TO_PKMS_DTTM",
            "WMS_STATUS_CODE",
            "SPOT_CHARGE_AND_PAYEE_ACC",
            "SPOT_CHARGE_AND_PAYEE_ACC_CC",
            "NORM_SPOT_CHARGE_AND_PAYEE_ACC",
            "FACILITY_SCHEDULE_ID",
            "EARNED_INCOME_CURRENCY_CODE",
            "ACTUAL_COST_CURRENCY_CODE",
            "SHIPMENT_RECON_DTTM",
            "PLN_RATING_LANE_ID",
            "PLN_RATING_LANE_DETAIL_ID",
            "PLN_TOTAL_COST",
            "PLN_LINEHAUL_COST",
            "PLN_TOTAL_ACCESSORIAL_COST",
            "PLN_STOP_OFF_COST",
            "PLN_NORMALIZED_TOTAL_COST",
            "PLN_CURRENCY_CODE",
            "PLN_ACCESSORL_COST_TO_CARRIER",
            "PLN_CARRIER_CHARGE",
            "WAYPOINT_TOTAL_COST",
            "WAYPOINT_HANDLING_COST",
            "GRS_OPERATION",
            "IS_GRS_OPT_CYCLE_RUNNING",
            "IS_MANUAL_ASSIGN",
            "LAST_RUN_GRS_DTTM",
            "GRS_MAX_SHIPMENT_STATUS",
            "PRIORITY_TYPE",
            "MV_CURRENCY_CODE",
            "PROD_SCHED_REF_NUMBER",
            "COMMODITY_CODE_ID",
            "UN_NUMBER_ID",
            "CONTRACT_NUMBER",
            "BOOKING_REF_SHIPPER",
            "BOOKING_REF_CARRIER",
            "BK_RESOURCE_REF_EXTERNAL",
            "BK_RESOURCE_NAME_EXTERNAL",
            "BK_O_FACILITY_ID",
            "BK_D_FACILITY_ID",
            "BK_MASTER_AIRWAY_BILL",
            "BK_FORWARDER_AIRWAY_BILL",
            "ASSIGNED_SCNDR_CARRIER_CODE",
            "CUSTOMER_CREDIT_LIMIT_ID",
            "SHIPMENT_LEG_TYPE",
            "SHIPMENT_CLOSED_INDICATOR",
            "OCEAN_ROUTING_STAGE",
            "BK_DEPARTURE_DTTM",
            "BK_DEPARTURE_TZ",
            "BK_ARRIVAL_DTTM",
            "BK_ARRIVAL_TZ",
            "BK_PICKUP_DTTM",
            "BK_PICKUP_TZ",
            "BK_CUTOFF_DTTM",
            "BK_CUTOFF_TZ",
            "NUM_CHARGE_LAYOVERS",
            "RATE_TYPE",
            "RATE_UOM",
            "PICK_START_DTTM",
            "PAPERWORK_START_DTTM",
            "VEHICLE_CHECK_START_DTTM",
            "SHIPMENT_START_DTTM",
            "SHIPMENT_END_DTTM",
            "FEASIBLE_DRIVER_TYPE",
            "WAVE_ID",
            "ESTIMATED_DISPATCH_DTTM",
            "TOTAL_TIME",
            "LOC_REFERENCE",
            "BK_O_FACILITY_ALIAS_ID",
            "BK_D_FACILITY_ALIAS_ID",
            "EQUIP_UTIL_PER",
            "MOVE_TYPE",
            "DRIVER_TYPE_ID",
            "EQUIPMENT_TYPE",
            "RADIAL_DISTANCE",
            "RADIAL_DISTANCE_UOM",
            "DESIGNATED_TRACTOR_CODE",
            "DESIGNATED_DRIVER_TYPE",
            "IS_WAVE_MAN_CHANGED",
            "RETAIN_CONSOLIDATOR_TIMES",
            "TARIFF",
            "MIN_RATE",
            "FIRST_UPDATE_SENT_TO_PKMS",
            "EVENT_IND_TYPEID",
            "TANDEM_PATH_ID",
            "O_TANDEM_FACILITY",
            "D_TANDEM_FACILITY",
            "O_TANDEM_FACILITY_ALIAS",
            "D_TANDEM_FACILITY_ALIAS",
            "DELAY_TYPE",
            "ASSIGNED_CARRIER_ID",
            "DSG_CARRIER_ID",
            "REC_CARRIER_ID",
            "FEASIBLE_CARRIER_ID",
            "PAYEE_CARRIER_ID",
            "SCNDR_CARRIER_ID",
            "BROKER_CARRIER_ID",
            "ASSIGNED_SCNDR_CARRIER_ID",
            "DSG_SCNDR_CARRIER_ID",
            "ASSIGNED_BROKER_CARRIER_ID",
            "LH_PAYEE_CARRIER_ID",
            "REC_BROKER_CARRIER_ID",
            "ASSIGNED_EQUIPMENT_ID",
            "DSG_EQUIPMENT_ID",
            "FEASIBLE_EQUIPMENT_ID",
            "FEASIBLE_EQUIPMENT2_ID",
            "REC_EQUIPMENT_ID",
            "ASSIGNED_MOT_ID",
            "DSG_MOT_ID",
            "FEASIBLE_MOT_ID",
            "REC_MOT_ID",
            "PRODUCT_CLASS_ID",
            "PROTECTION_LEVEL_ID",
            "ASSIGNED_SERVICE_LEVEL_ID",
            "DSG_SERVICE_LEVEL_ID",
            "FEASIBLE_SERVICE_LEVEL_ID",
            "REC_SERVICE_LEVEL_ID",
            "HAS_EM_NOTIFY_FLAG",
            "REGION_ID",
            "INBOUND_REGION_ID",
            "OUTBOUND_REGION_ID",
            "FINANCIAL_WT",
            "IS_BOOKING_REQUIRED",
            "TOTAL_COST_EXCL_TAX",
            "TOTAL_TAX_AMOUNT",
            "IS_ASSOCIATED_TO_OUTBOUND",
            "RECEIVED_DTTM",
            "BOOKING_ID",
            "IS_MISROUTED",
            "FEASIBLE_CARRIER_CODE",
            "SHIPMENT_WIN_ADJ_FLAG",
            "DT_PARAM_SET_ID",
            "MERCHANDIZING_DEPARTMENT_ID",
            "STATIC_ROUTE_ID",
            "IS_FILO",
            "IS_COOLER_AT_NOSE",
            "AUTH_NBR",
            "CONS_LOCN_ID",
            "RTE_TYPE",
            "TRLR_TYPE",
            "TRLR_SIZE",
            "CONS_ADDR_CODE",
            "HUB_ID",
            "TRLR_GEN_CODE",
            "MAX_NBR_OF_CTNS",
            "APPT_DOOR_SCHED_TYPE",
            "CREATED_SOURCE_TYPE",
            "CREATED_SOURCE",
            "CREATED_DTTM",
            "LAST_UPDATED_SOURCE_TYPE",
            "LAST_UPDATED_SOURCE",
            "LAST_UPDATED_DTTM",
            "DSG_SCNDR_CARRIER_CODE",
            "LH_PAYEE_CARRIER_CODE",
            "REC_BROKER_CARRIER_CODE",
            "REC_CARRIER_CODE",
            "LPN_ASSIGNMENT_STOPPED",
            "SEAL_NUMBER",
            "HIBERNATE_VERSION",
            "SHIP_GROUP_ID",
            "RATE",
            "MONETARY_VALUE",
            "DOOR",
            "RTE_TYPE_1",
            "RTE_TYPE_2",
            "SCHEDULED_PICKUP_DTTM",
            "MANIFEST_ID",
            "DAYS_TO_DELIVER",
            "SED_GENERATED_FLAG",
            "SERV_AREA_CODE",
            "TENDER_RESP_DEADLINE_DTTM",
            "PRINT_CONS_BOL",
            "LEFT_WT",
            "RIGHT_WT",
            "LANE_NAME",
            "DECLARED_VALUE",
            "DV_CURRENCY_CODE",
            "COD_AMOUNT",
            "CUSTOMER_ID",
            "CUST_FRGT_CHARGE",
            "COD_CURRENCY_CODE",
            "PLANNED_WEIGHT",
            "WEIGHT_UOM_ID_BASE",
            "PLANNED_VOLUME",
            "VOLUME_UOM_ID_BASE",
            "SIZE1_VALUE",
            "SIZE1_UOM_ID",
            "SIZE2_VALUE",
            "SIZE2_UOM_ID",
            "ASSIGNED_SHIP_VIA",
            "INSURANCE_STATUS",
            "RTE_SWC_NBR",
            "RTE_TO",
            "BILL_OF_LADING_NUMBER",
            "TRAILER_NUMBER",
            "TRANS_PLAN_OWNER",
            "TOTAL_REVENUE_CURRENCY_CODE",
            "TOTAL_REVENUE",
            "FRT_REV_SPOT_CHARGE_CURR_CODE",
            "NORMALIZED_TOTAL_REVENUE",
            "FRT_REV_SPOT_CHARGE",
            "DSG_VOYAGE_FLIGHT",
            "FEASIBLE_VOYAGE_FLIGHT",
            "CURRENCY_DTTM",
            "FRT_REV_LINEHAUL_CHARGE",
            "FRT_REV_STOP_CHARGE",
            "FRT_REV_ACCESSORIAL_CHARGE",
            "MARGIN",
            "TOTAL_COST",
            "INCOTERM_ID",
            "ORDER_QTY",
            "QTY_UOM_ID",
            "REF_SHIPMENT_NBR",
            "STAGING_LOCN_ID",
            "LOADING_SEQ_ORD",
            "HAZMAT_CERT_CONTACT",
            "HAZMAT_CERT_DECLARATION",
            "CDC_TIMESTAMP",
            "OPERATION_TYPE",
            "ARCHIVED_DTTM",
            "ORIGIN",
            "FINAL_DESTINATION",
            "actual_delivery_date_parsed",
            "wood_pellet",
            "act_del_MERCH_YEAR",
            "act_del_YEAR_WEEK",
            "act_del_YEAR_QUARTER",
            "act_del_YEAR_PERIOD",
            "invoice_shipping_id",
            "org_Facility_Code",
            "org_Facility_Name",
            "org_Facility_Type",
            "dest_Facility_Code",
            "dest_Facility_Name",
            "dest_Facility_Type",
            "inbound_flag",
            "order_id_po",
            "order_id_po_int",
            "po_STORE_NO",
            "po_CO_CODE",
            "po_ARTICLE_NO",
            "po_PO_NO",
            "po_PO_LINE_NO",
            "po_PO_DATE",
            "po_po_date_parsed",
            "po_DELIV_DATE",
            "po_deliv_date_parsed",
            "po_PO_TYPE_CODE",
            "po_VENDOR_ID",
            "po_VSR_CODE",
            "po_PO_LINE_CANCELLED_FLAG",
            "po_PO_LINE_ORDER_QTY",
            "po_PO_LINE_ISSUE_QTY",
            "po_PO_LINE_RCVD_QTY",
            "po_PO_LINE_UNIT_PRICE",
            "po_DC_NO",
            "po_PO_TRACKING_NO",
            "po_PO_LINE_TRACKING_NO",
            "po_CURRENT_REPL_TYPE_CODE",
            "po_FREIGHT_TYPE_CODE",
            "po_SHIP_START_DATE",
            "po_SHIP_END_DATE",
            "po_DELIV_START_DATE",
            "po_DELIV_END_DATE",
            "po_PO_LINE_UNIT_FREIGHT_AMT",
            "po_PO_LINE_MANUFACTURER",
            "po_PO_LINE_ORIGIN_COUNTRY_CODE",
            "po_PO_LINE_PORT_OF_ORIGIN",
            "po_PO_LINE_MIN_RCVD_DATE",
            "po_PO_LINE_MAX_RCVD_DATE",
            "po_PO_LINE_DELIVERED_FLAG",
            "po_PO_LINE_CONFIRMED_ON_BOARD_DATE",
            "po_PO_LINE_BOOKED_FOR_SHIPMENT_DATE",
            "po_PO_LINE_TRANSIT_RESN_CODE",
            "po_PO_LINE_MOVE_TYPE_CODE",
            "po_PO_LINE_AGENT_COMMISSION_RATE",
            "po_PO_LINE_AGENT_COMMISSION_AMT",
            "po_PO_LINE_ADDL_ARTICLE_NO",
            "po_PO_LINE_ADDL_ARTICLE_QTY",
            "po_PO_LINE_FACTORY_VENDOR_ID",
            "po_PO_LINE_STUFFING_LOC_VENDOR_ID",
            "po_PO_LINE_SOURCING_AGENT_VENDOR_ID",
            "po_PO_LINE_FREIGHT_FORWARDER_VENDOR_ID",
            "po_PO_LINE_LETTER_OF_CREDIT_NO",
            "po_PO_LINE_OPEN_ACCT_NO",
            "po_PO_LINE_ARTICLE_LENGTH",
            "po_PO_LINE_ARTICLE_WIDTH",
            "po_PO_LINE_ARTICLE_HEIGHT",
            "po_PO_LINE_ARTICLE_DIMENSIONS_UOM",
            "po_PO_LINE_ARTICLE_WEIGHT",
            "po_PO_LINE_ARTICLE_WEIGHT_UOM",
            "po_PO_TOTAL_WEIGHT",
            "po_PO_LINE_ARTICLE_VOLUME",
            "po_PO_LINE_ARTICLE_VOLUME_UOM",
            "po_PO_TOTAL_VOLUME",
            "po_HTS_CODE",
            "po_PO_LINE_DUTY_RATE",
            "po_PO_LINE_DUTY_AMT",
            "po_PO_LINE_ADDL_HTS_CODE_1",
            "po_PO_LINE_ADDL_DUTY_RATE_1",
            "po_PO_LINE_ADDL_DUTY_AMT_1",
            "po_PO_LINE_ADDL_HTS_CODE_2",
            "po_PO_LINE_ADDL_DUTY_RATE_2",
            "po_PO_LINE_ADDL_DUTY_AMT_2",
            "po_PO_HELD_FLAG",
            "po_PO_VENDOR_DOC_DATE",
            "po_cal_MERCH_YEAR",
            "po_cal_YEAR_WEEK",
            "po_cal_YEAR_QUARTER",
            "po_cal_YEAR_PERIOD",
            "a_ARTICLE_LENGTH",
            "a_ARTICLE_WIDTH",
            "a_ARTICLE_HEIGHT",
            "item_volume",
            "a_ARTICLE_WEIGHT",
            "item_weight",
            "a_ARTICLE_SIZE",
            "a_ARTICLE_40HC_QTY",
            "a_ARTICLE_40GP_QTY",
            "item_volume_sum",
            "item_weight_sum",
            (CAST("item_volume" AS DOUBLE) / NULLIF("item_volume_sum", 0)) * COALESCE("TOTAL_COST", 0) AS "allocation_by_vol",
            (CAST("item_weight" AS DOUBLE) / NULLIF("item_weight_sum", 0)) * COALESCE("TOTAL_COST", 0) AS "allocation_by_wgt",
            2366 AS "max_volume",
            44000 AS "max_weight"
          FROM "TLM_SHIPMENT_JOINED_PO_VOL_WGT_WINDOWS" 
        ) A
    )B;

<br>
--3.DOMESTIC_SHIPPING_FREIGHT_PO_ALLOCATION_ARTICLE
--DOMESTIC_SHIPPING_FREIGHT_TIME_FILTER_WINDOWS
</br>
CREATE OR REPLACE TEMP TABLE "DOMESTIC_SHIPPING_FREIGHT_TIME_FILTER_WINDOWS"
AS
SELECT   "INV_ID" AS "INV_ID",
    "INV_OBJECT_ID" AS "INV_OBJECT_ID",
    "TC_COMPANY_ID" AS "TC_COMPANY_ID",
    "TC_OBJECT_ID" AS "TC_OBJECT_ID",
    "INV_OBJECT_STATUS" AS "INV_OBJECT_STATUS",
    "O_NAME" AS "O_NAME",
    "O_ADDRESS" AS "O_ADDRESS",
    "O_CITY" AS "O_CITY",
    "O_COUNTY" AS "O_COUNTY",
    "O_STATE_PROV" AS "O_STATE_PROV",
    "O_POSTAL_CODE" AS "O_POSTAL_CODE",
    "O_COUNTRY_CODE" AS "O_COUNTRY_CODE",
    "D_NAME" AS "D_NAME",
    "D_ADDRESS" AS "D_ADDRESS",
    "D_CITY" AS "D_CITY",
    "D_COUNTY" AS "D_COUNTY",
    "D_STATE_PROV" AS "D_STATE_PROV",
    "D_POSTAL_CODE" AS "D_POSTAL_CODE",
    "D_COUNTRY_CODE" AS "D_COUNTRY_CODE",
    "MOT_DESC" AS "MOT_DESC",
    "EQUIPMENT_DESC" AS "EQUIPMENT_DESC",
    "SERVICE_LEVEL_DESC" AS "SERVICE_LEVEL_DESC",
    "PROTECTION_LEVEL_DESC" AS "PROTECTION_LEVEL_DESC",
    "FINANCIAL_WEIGHT" AS "FINANCIAL_WEIGHT",
    "ACTUAL_WEIGHT" AS "ACTUAL_WEIGHT",
    "LH_COST" AS "LH_COST",
    "DISTANCE" AS "DISTANCE",
    "DISTANCE_UOM" AS "DISTANCE_UOM",
    "BILL_OF_LADING_NUMBER" AS "BILL_OF_LADING_NUMBER",
    "PO_NUMBER" AS "PO_NUMBER",
    "SPEC_HANDLING_METHOD" AS "SPEC_HANDLING_METHOD",
    "COMMENTS" AS "COMMENTS",
    "HAS_IMPORT_ERROR" AS "HAS_IMPORT_ERROR",
    "HAS_WARNING" AS "HAS_WARNING",
    "IS_VALID" AS "IS_VALID",
    "CREATED_SOURCE_TYPE" AS "CREATED_SOURCE_TYPE",
    "CREATED_SOURCE" AS "CREATED_SOURCE",
    "CREATED_DTTM" AS "CREATED_DTTM",
    "LAST_UPDATED_SOURCE" AS "LAST_UPDATED_SOURCE",
    "LAST_UPDATED_DTTM" AS "LAST_UPDATED_DTTM",
    "STOP_COST" AS "STOP_COST",
    "AUXILARY_DATA" AS "AUXILARY_DATA",
    "PICKUP_DTTM" AS "PICKUP_DTTM",
    "DELIVERY_DTTM" AS "DELIVERY_DTTM",
    "CURRENCY_CODE" AS "CURRENCY_CODE",
    "LH_CURRENCY_CODE" AS "LH_CURRENCY_CODE",
    "STOP_CURRENCY_CODE" AS "STOP_CURRENCY_CODE",
    "SPOT_CHARGE_COST" AS "SPOT_CHARGE_COST",
    "SPOT_CHARGE_CURRENCY_CODE" AS "SPOT_CHARGE_CURRENCY_CODE",
    "ASSIGNED_CARRIER_CODE" AS "ASSIGNED_CARRIER_CODE",
    "NUM_PICKUPS" AS "NUM_PICKUPS",
    "NUM_DELIVERIES" AS "NUM_DELIVERIES",
    "RATE" AS "RATE",
    "RATE_CALC_METHOD" AS "RATE_CALC_METHOD",
    "RATE_UOM" AS "RATE_UOM",
    "TPE_OBJECT_ID" AS "TPE_OBJECT_ID",
    "O_FACILITY_ID" AS "O_FACILITY_ID",
    "D_FACILITY_ID" AS "D_FACILITY_ID",
    "TP_COMPANY_ID" AS "TP_COMPANY_ID",
    "PACKAGE_TYPE_ID" AS "PACKAGE_TYPE_ID",
    "COMPUTED_RATE" AS "COMPUTED_RATE",
    "COMPUTED_RATE_UOM" AS "COMPUTED_RATE_UOM",
    "COMPUTED_RATE_CALC_METHOD" AS "COMPUTED_RATE_CALC_METHOD",
    "COMPUTED_TOTAL_COST" AS "COMPUTED_TOTAL_COST",
    "COMPUTED_TOTAL_COST_CURR_CODE" AS "COMPUTED_TOTAL_COST_CURR_CODE",
    "O_FACILITY_NAME" AS "O_FACILITY_NAME",
    "D_FACILITY_NAME" AS "D_FACILITY_NAME",
    "COMPUTED_DISTANCE" AS "COMPUTED_DISTANCE",
    "COMPUTED_DISTANCE_UOM" AS "COMPUTED_DISTANCE_UOM",
    "COMPUTED_STOP_COST" AS "COMPUTED_STOP_COST",
    "COMPUTED_STOP_COST_CURR_CODE" AS "COMPUTED_STOP_COST_CURR_CODE",
    "APPROVED_DISTANCE" AS "APPROVED_DISTANCE",
    "APPROVED_LH_COST" AS "APPROVED_LH_COST",
    "APPROVED_RATE" AS "APPROVED_RATE",
    "APPROVED_FINANCIAL_WEIGHT" AS "APPROVED_FINANCIAL_WEIGHT",
    "APPROVED_ACTUAL_WEIGHT" AS "APPROVED_ACTUAL_WEIGHT",
    "RATE_ADJUSTMENT" AS "RATE_ADJUSTMENT",
    "MIN_CHARGE" AS "MIN_CHARGE",
    "COMPUTED_TARIFF" AS "COMPUTED_TARIFF",
    "COMPUTED_MIN_RATE" AS "COMPUTED_MIN_RATE",
    "UNDEFINED_ADJUSTMENT" AS "UNDEFINED_ADJUSTMENT",
    "DISCOUNT_AMOUNT" AS "DISCOUNT_AMOUNT",
    "UNDEFINED_ADJ_CURR_CODE" AS "UNDEFINED_ADJ_CURR_CODE",
    "DISCOUNT_AMT_CURR_CODE" AS "DISCOUNT_AMT_CURR_CODE",
    "RATE_CURR_CODE" AS "RATE_CURR_CODE",
    "CARRIER_ID" AS "CARRIER_ID",
    "ASSIGNED_CARRIER_ID" AS "ASSIGNED_CARRIER_ID",
    "EQUIPMENT_ID" AS "EQUIPMENT_ID",
    "MOT_ID" AS "MOT_ID",
    "PROTECTION_LEVEL_ID" AS "PROTECTION_LEVEL_ID",
    "SERVICE_LEVEL_ID" AS "SERVICE_LEVEL_ID",
    "UNDF_ADJ_CURR_CODE" AS "UNDF_ADJ_CURR_CODE",
    "COMPUTED_FINANCIAL_WEIGHT" AS "COMPUTED_FINANCIAL_WEIGHT",
    "ADJUSTMENT_AMOUNT" AS "ADJUSTMENT_AMOUNT",
    "APPROVED_ADJUSTMENT_AMOUNT" AS "APPROVED_ADJUSTMENT_AMOUNT",
    "APPROVED_STOP_COST" AS "APPROVED_STOP_COST",
    "APPROVED_RATE_ADJUSTMENT" AS "APPROVED_RATE_ADJUSTMENT",
    "APPROVED_RATE_CALC_METHOD" AS "APPROVED_RATE_CALC_METHOD",
    "APPROVED_RATE_UOM" AS "APPROVED_RATE_UOM",
    "APPROVED_DISTANCE_UOM" AS "APPROVED_DISTANCE_UOM",
    "COMPUTED_LH_COST" AS "COMPUTED_LH_COST",
    "COMPUTED_LH_COST_CURR_CODE" AS "COMPUTED_LH_COST_CURR_CODE",
    "WEIGHT_UOM_ID" AS "WEIGHT_UOM_ID",
    "APPROVED_WEIGHT_UOM_ID" AS "APPROVED_WEIGHT_UOM_ID",
    "INV_MIN_RATE" AS "INV_MIN_RATE",
    "SYS_MIN_RATE" AS "SYS_MIN_RATE",
    "UNAPPLIED_LH_COST" AS "UNAPPLIED_LH_COST",
    "UNAPPLIED_LH_CURRENCY_CODE" AS "UNAPPLIED_LH_CURRENCY_CODE",
    "UNAPPLIED_STOP_COST" AS "UNAPPLIED_STOP_COST",
    "UNAPPLIED_STOP_CURRENCY_CODE" AS "UNAPPLIED_STOP_CURRENCY_CODE",
    "ORG_SHIP_VIA_FACILITY_ID" AS "ORG_SHIP_VIA_FACILITY_ID",
    "ORG_SHIP_VIA_FACILITY_ALIAS_ID" AS "ORG_SHIP_VIA_FACILITY_ALIAS_ID",
    "DES_SHIP_VIA_FACILITY_ID" AS "DES_SHIP_VIA_FACILITY_ID",
    "DES_SHIP_VIA_FACILITY_ALIAS_ID" AS "DES_SHIP_VIA_FACILITY_ALIAS_ID",
    "INCOTERM_ID" AS "INCOTERM_ID",
    "SEC_CARRIER_ID" AS "SEC_CARRIER_ID",
    "COMMODITY_CLASS" AS "COMMODITY_CLASS",
    "ACTUAL_PAYMENT_AMOUNT" AS "ACTUAL_PAYMENT_AMOUNT",
    "ACTUAL_CURRENCY_CODE" AS "ACTUAL_CURRENCY_CODE",
    "NET_AMOUNT_CURRENCY_CODE" AS "NET_AMOUNT_CURRENCY_CODE",
    "NET_AMOUNT_DUE" AS "NET_AMOUNT_DUE",
    "NORMALIZED_NET_AMOUNT_DUE" AS "NORMALIZED_NET_AMOUNT_DUE",
    "REF_INV_OBJECT_PAID_AMOUNT" AS "REF_INV_OBJECT_PAID_AMOUNT",
    "REF_INV_OBJECT_PAID_AMOUNT_CC" AS "REF_INV_OBJECT_PAID_AMOUNT_CC",
    "REF_INV_OBJECT_AMOUNT" AS "REF_INV_OBJECT_AMOUNT",
    "REF_INV_OBJECT_AMOUNT_CC" AS "REF_INV_OBJECT_AMOUNT_CC",
    "REF_INVOICED_OBJECT_ID" AS "REF_INVOICED_OBJECT_ID",
    "INCOTERM_CODE" AS "INCOTERM_CODE",
    "ACTUAL_VOLUME" AS "ACTUAL_VOLUME",
    "VOLUME_UOM_ID" AS "VOLUME_UOM_ID",
    "COMPUTED_VOLUME" AS "COMPUTED_VOLUME",
    "COMPUTED_VOLUME_UOM_ID" AS "COMPUTED_VOLUME_UOM_ID",
    "APPROVED_VOLUME" AS "APPROVED_VOLUME",
    "APPROVED_VOLUME_UOM_ID" AS "APPROVED_VOLUME_UOM_ID",
    "VOLUME_UOM" AS "VOLUME_UOM",
    "WEIGHT_UOM" AS "WEIGHT_UOM",
    "INV_OBJ_GRS_AMT_DUE_CURR_CODE" AS "INV_OBJ_GRS_AMT_DUE_CURR_CODE",
    "INV_OBJ_TAX_AM_DUE_CURR_CODE" AS "INV_OBJ_TAX_AM_DUE_CURR_CODE",
    "INV_OBJ_TAX_AMT_DUE" AS "INV_OBJ_TAX_AMT_DUE",
    "INV_OBJ_GRS_AMT_DUE" AS "INV_OBJ_GRS_AMT_DUE",
    "TRACKING_NUMBER" AS "TRACKING_NUMBER",
    "LENGTH" AS "LENGTH",
    "WIDTH" AS "WIDTH",
    "HEIGHT" AS "HEIGHT",
    "ADJ_RATE" AS "ADJ_RATE",
    "COMPUTED_ADJ_RATE" AS "COMPUTED_ADJ_RATE",
    "APPROVED_ADJ_RATE" AS "APPROVED_ADJ_RATE",
    "ADJ_LH_COST" AS "ADJ_LH_COST",
    "COMPUTED_ADJ_LH_COST" AS "COMPUTED_ADJ_LH_COST",
    "APPROVED_ADJ_LH_COST" AS "APPROVED_ADJ_LH_COST",
    "ENTRY_TYPE" AS "ENTRY_TYPE",
    "PICKUP_NUMBER" AS "PICKUP_NUMBER",
    "MONETARY_VALUE" AS "MONETARY_VALUE",
    "MONETARY_VALUE_CURRENCY_CODE" AS "MONETARY_VALUE_CURRENCY_CODE",
    "MANIFEST_TYPE" AS "MANIFEST_TYPE",
    "NON_MACHINABLE" AS "NON_MACHINABLE",
    "LENGTH_UOM_ID" AS "LENGTH_UOM_ID",
    "RATING_LEVEL" AS "RATING_LEVEL",
    "WIDTH_UOM_ID" AS "WIDTH_UOM_ID",
    "HEIGHT_UOM_ID" AS "HEIGHT_UOM_ID",
    "MARK_FOR_DELETION" AS "MARK_FOR_DELETION",
    "BILLING_METHOD" AS "BILLING_METHOD",
    "LAST_UPDATED_SOURCE_TYPE" AS "LAST_UPDATED_SOURCE_TYPE",
    "UNAPPLIED_SPOT_COST" AS "UNAPPLIED_SPOT_COST",
    "UNAPPLIED_SPOT_CURRENCY_CODE" AS "UNAPPLIED_SPOT_CURRENCY_CODE",
    "APPROVED_SPOT_COST" AS "APPROVED_SPOT_COST",
    "INVOICE_DTL_ID" AS "INVOICE_DTL_ID",
    "VESSEL_NUMBER" AS "VESSEL_NUMBER",
    "VOYAGE_FLIGHT_NUMBER" AS "VOYAGE_FLIGHT_NUMBER",
    "BOOKING_TYPE" AS "BOOKING_TYPE",
    "PRO_NUMBER" AS "PRO_NUMBER",
    "TRAILER_NUMBER" AS "TRAILER_NUMBER",
    "COMMODITY_CODE_ID" AS "COMMODITY_CODE_ID",
    "UNAPPLIED_TOTAL_BALANCE" AS "UNAPPLIED_TOTAL_BALANCE",
    "APPROVED_TOTAL_BALANCE" AS "APPROVED_TOTAL_BALANCE",
    "CDC_TIMESTAMP" AS "CDC_TIMESTAMP",
    "OPERATION_TYPE" AS "OPERATION_TYPE",
    "ARCHIVED_DTTM" AS "ARCHIVED_DTTM",
    "INVOICE_DT" AS "INVOICE_DT",
    "invoice_date_parsed" AS "invoice_date_parsed",
    "NUM_REJECTIONS" AS "NUM_REJECTIONS",
    "TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID",
    "DELIVERY_START_DTTM" AS "DELIVERY_START_DTTM",
    "delivery_date_parsed" AS "delivery_date_parsed",
    "DELIVERY_END_DTTM" AS "DELIVERY_END_DTTM",
    "ORIGIN" AS "ORIGIN",
    "FINAL_DESTINATION" AS "FINAL_DESTINATION",
    "actual_delivery_date_parsed" AS "actual_delivery_date_parsed",
    "VENDOR_ID" AS "VENDOR_ID",
    "VENDOR_NAME" AS "VENDOR_NAME",
    "flag_wood_pellet_combined" AS "flag_wood_pellet_combined",
    "cal_MERCH_YEAR" AS "cal_MERCH_YEAR",
    "cal_YEAR_WEEK" AS "cal_YEAR_WEEK",
    "cal_YEAR_QUARTER" AS "cal_YEAR_QUARTER",
    "cal_YEAR_PERIOD" AS "cal_YEAR_PERIOD",
    "del_MERCH_YEAR" AS "del_MERCH_YEAR",
    "del_YEAR_WEEK" AS "del_YEAR_WEEK",
    "del_YEAR_QUARTER" AS "del_YEAR_QUARTER",
    "del_YEAR_PERIOD" AS "del_YEAR_PERIOD",
    "act_del_MERCH_YEAR" AS "act_del_MERCH_YEAR",
    "act_del_YEAR_WEEK" AS "act_del_YEAR_WEEK",
    "act_del_YEAR_QUARTER" AS "act_del_YEAR_QUARTER",
    "act_del_YEAR_PERIOD" AS "act_del_YEAR_PERIOD",
    "TOTAL_COST_sum" AS "TOTAL_COST",
    "rownumber" AS "rownumber"
    FROM (
    SELECT  DISTINCT 
    ds."INV_ID" AS "INV_ID",
    ds."INV_OBJECT_ID" AS "INV_OBJECT_ID",
    ds."TC_COMPANY_ID" AS "TC_COMPANY_ID",
    ds."TC_OBJECT_ID" AS "TC_OBJECT_ID",
    ds."INV_OBJECT_STATUS" AS "INV_OBJECT_STATUS",
    ds."O_NAME" AS "O_NAME",
    ds."O_ADDRESS" AS "O_ADDRESS",
    ds."O_CITY" AS "O_CITY",
    ds."O_COUNTY" AS "O_COUNTY",
    ds."O_STATE_PROV" AS "O_STATE_PROV",
    ds."O_POSTAL_CODE" AS "O_POSTAL_CODE",
    ds."O_COUNTRY_CODE" AS "O_COUNTRY_CODE",
    ds."D_NAME" AS "D_NAME",
    ds."D_ADDRESS" AS "D_ADDRESS",
    ds."D_CITY" AS "D_CITY",
    ds."D_COUNTY" AS "D_COUNTY",
    ds."D_STATE_PROV" AS "D_STATE_PROV",
    ds."D_POSTAL_CODE" AS "D_POSTAL_CODE",
    ds."D_COUNTRY_CODE" AS "D_COUNTRY_CODE",
    ds."MOT_DESC" AS "MOT_DESC",
    ds."EQUIPMENT_DESC" AS "EQUIPMENT_DESC",
    ds."SERVICE_LEVEL_DESC" AS "SERVICE_LEVEL_DESC",
    ds."PROTECTION_LEVEL_DESC" AS "PROTECTION_LEVEL_DESC",
    ds."FINANCIAL_WEIGHT" AS "FINANCIAL_WEIGHT",
    ds."ACTUAL_WEIGHT" AS "ACTUAL_WEIGHT",
    ds."TOTAL_COST" AS "TOTAL_COST",
    ds."LH_COST" AS "LH_COST",
    ds."DISTANCE" AS "DISTANCE",
    ds."DISTANCE_UOM" AS "DISTANCE_UOM",
    ds."BILL_OF_LADING_NUMBER" AS "BILL_OF_LADING_NUMBER",
    ds."PO_NUMBER" AS "PO_NUMBER",
    ds."SPEC_HANDLING_METHOD" AS "SPEC_HANDLING_METHOD",
    ds."COMMENTS" AS "COMMENTS",
    ds."HAS_IMPORT_ERROR" AS "HAS_IMPORT_ERROR",
    ds."HAS_WARNING" AS "HAS_WARNING",
    ds."IS_VALID" AS "IS_VALID",
    ds."CREATED_SOURCE_TYPE" AS "CREATED_SOURCE_TYPE",
    ds."CREATED_SOURCE" AS "CREATED_SOURCE",
    ds."CREATED_DTTM" AS "CREATED_DTTM",
    ds."LAST_UPDATED_SOURCE" AS "LAST_UPDATED_SOURCE",
    ds."LAST_UPDATED_DTTM" AS "LAST_UPDATED_DTTM",
    ds."STOP_COST" AS "STOP_COST",
    ds."AUXILARY_DATA" AS "AUXILARY_DATA",
    ds."PICKUP_DTTM" AS "PICKUP_DTTM",
    ds."DELIVERY_DTTM" AS "DELIVERY_DTTM",
    ds."CURRENCY_CODE" AS "CURRENCY_CODE",
    ds."LH_CURRENCY_CODE" AS "LH_CURRENCY_CODE",
    ds."STOP_CURRENCY_CODE" AS "STOP_CURRENCY_CODE",
    ds."SPOT_CHARGE_COST" AS "SPOT_CHARGE_COST",
    ds."SPOT_CHARGE_CURRENCY_CODE" AS "SPOT_CHARGE_CURRENCY_CODE",
    ds."ASSIGNED_CARRIER_CODE" AS "ASSIGNED_CARRIER_CODE",
    ds."NUM_PICKUPS" AS "NUM_PICKUPS",
    ds."NUM_DELIVERIES" AS "NUM_DELIVERIES",
    ds."RATE" AS "RATE",
    ds."RATE_CALC_METHOD" AS "RATE_CALC_METHOD",
    ds."RATE_UOM" AS "RATE_UOM",
    ds."TPE_OBJECT_ID" AS "TPE_OBJECT_ID",
    ds."O_FACILITY_ID" AS "O_FACILITY_ID",
    ds."D_FACILITY_ID" AS "D_FACILITY_ID",
    ds."TP_COMPANY_ID" AS "TP_COMPANY_ID",
    ds."PACKAGE_TYPE_ID" AS "PACKAGE_TYPE_ID",
    ds."COMPUTED_RATE" AS "COMPUTED_RATE",
    ds."COMPUTED_RATE_UOM" AS "COMPUTED_RATE_UOM",
    ds."COMPUTED_RATE_CALC_METHOD" AS "COMPUTED_RATE_CALC_METHOD",
    ds."COMPUTED_TOTAL_COST" AS "COMPUTED_TOTAL_COST",
    ds."COMPUTED_TOTAL_COST_CURR_CODE" AS "COMPUTED_TOTAL_COST_CURR_CODE",
    ds."O_FACILITY_NAME" AS "O_FACILITY_NAME",
    ds."D_FACILITY_NAME" AS "D_FACILITY_NAME",
    ds."COMPUTED_DISTANCE" AS "COMPUTED_DISTANCE",
    ds."COMPUTED_DISTANCE_UOM" AS "COMPUTED_DISTANCE_UOM",
    ds."COMPUTED_STOP_COST" AS "COMPUTED_STOP_COST",
    ds."COMPUTED_STOP_COST_CURR_CODE" AS "COMPUTED_STOP_COST_CURR_CODE",
    ds."APPROVED_DISTANCE" AS "APPROVED_DISTANCE",
    ds."APPROVED_LH_COST" AS "APPROVED_LH_COST",
    ds."APPROVED_RATE" AS "APPROVED_RATE",
    ds."APPROVED_FINANCIAL_WEIGHT" AS "APPROVED_FINANCIAL_WEIGHT",
    ds."APPROVED_ACTUAL_WEIGHT" AS "APPROVED_ACTUAL_WEIGHT",
    ds."RATE_ADJUSTMENT" AS "RATE_ADJUSTMENT",
    ds."MIN_CHARGE" AS "MIN_CHARGE",
    ds."COMPUTED_TARIFF" AS "COMPUTED_TARIFF",
    ds."COMPUTED_MIN_RATE" AS "COMPUTED_MIN_RATE",
    ds."UNDEFINED_ADJUSTMENT" AS "UNDEFINED_ADJUSTMENT",
    ds."DISCOUNT_AMOUNT" AS "DISCOUNT_AMOUNT",
    ds."UNDEFINED_ADJ_CURR_CODE" AS "UNDEFINED_ADJ_CURR_CODE",
    ds."DISCOUNT_AMT_CURR_CODE" AS "DISCOUNT_AMT_CURR_CODE",
    ds."RATE_CURR_CODE" AS "RATE_CURR_CODE",
    ds."CARRIER_ID" AS "CARRIER_ID",
    ds."ASSIGNED_CARRIER_ID" AS "ASSIGNED_CARRIER_ID",
    ds."EQUIPMENT_ID" AS "EQUIPMENT_ID",
    ds."MOT_ID" AS "MOT_ID",
    ds."PROTECTION_LEVEL_ID" AS "PROTECTION_LEVEL_ID",
    ds."SERVICE_LEVEL_ID" AS "SERVICE_LEVEL_ID",
    ds."UNDF_ADJ_CURR_CODE" AS "UNDF_ADJ_CURR_CODE",
    ds."COMPUTED_FINANCIAL_WEIGHT" AS "COMPUTED_FINANCIAL_WEIGHT",
    ds."ADJUSTMENT_AMOUNT" AS "ADJUSTMENT_AMOUNT",
    ds."APPROVED_ADJUSTMENT_AMOUNT" AS "APPROVED_ADJUSTMENT_AMOUNT",
    ds."APPROVED_STOP_COST" AS "APPROVED_STOP_COST",
    ds."APPROVED_RATE_ADJUSTMENT" AS "APPROVED_RATE_ADJUSTMENT",
    ds."APPROVED_RATE_CALC_METHOD" AS "APPROVED_RATE_CALC_METHOD",
    ds."APPROVED_RATE_UOM" AS "APPROVED_RATE_UOM",
    ds."APPROVED_DISTANCE_UOM" AS "APPROVED_DISTANCE_UOM",
    ds."COMPUTED_LH_COST" AS "COMPUTED_LH_COST",
    ds."COMPUTED_LH_COST_CURR_CODE" AS "COMPUTED_LH_COST_CURR_CODE",
    ds."WEIGHT_UOM_ID" AS "WEIGHT_UOM_ID",
    ds."APPROVED_WEIGHT_UOM_ID" AS "APPROVED_WEIGHT_UOM_ID",
    ds."INV_MIN_RATE" AS "INV_MIN_RATE",
    ds."SYS_MIN_RATE" AS "SYS_MIN_RATE",
    ds."UNAPPLIED_LH_COST" AS "UNAPPLIED_LH_COST",
    ds."UNAPPLIED_LH_CURRENCY_CODE" AS "UNAPPLIED_LH_CURRENCY_CODE",
    ds."UNAPPLIED_STOP_COST" AS "UNAPPLIED_STOP_COST",
    ds."UNAPPLIED_STOP_CURRENCY_CODE" AS "UNAPPLIED_STOP_CURRENCY_CODE",
    ds."ORG_SHIP_VIA_FACILITY_ID" AS "ORG_SHIP_VIA_FACILITY_ID",
    ds."ORG_SHIP_VIA_FACILITY_ALIAS_ID" AS "ORG_SHIP_VIA_FACILITY_ALIAS_ID",
    ds."DES_SHIP_VIA_FACILITY_ID" AS "DES_SHIP_VIA_FACILITY_ID",
    ds."DES_SHIP_VIA_FACILITY_ALIAS_ID" AS "DES_SHIP_VIA_FACILITY_ALIAS_ID",
    ds."INCOTERM_ID" AS "INCOTERM_ID",
    ds."SEC_CARRIER_ID" AS "SEC_CARRIER_ID",
    ds."COMMODITY_CLASS" AS "COMMODITY_CLASS",
    ds."ACTUAL_PAYMENT_AMOUNT" AS "ACTUAL_PAYMENT_AMOUNT",
    ds."ACTUAL_CURRENCY_CODE" AS "ACTUAL_CURRENCY_CODE",
    ds."NET_AMOUNT_CURRENCY_CODE" AS "NET_AMOUNT_CURRENCY_CODE",
    ds."NET_AMOUNT_DUE" AS "NET_AMOUNT_DUE",
    ds."NORMALIZED_NET_AMOUNT_DUE" AS "NORMALIZED_NET_AMOUNT_DUE",
    ds."REF_INV_OBJECT_PAID_AMOUNT" AS "REF_INV_OBJECT_PAID_AMOUNT",
    ds."REF_INV_OBJECT_PAID_AMOUNT_CC" AS "REF_INV_OBJECT_PAID_AMOUNT_CC",
    ds."REF_INV_OBJECT_AMOUNT" AS "REF_INV_OBJECT_AMOUNT",
    ds."REF_INV_OBJECT_AMOUNT_CC" AS "REF_INV_OBJECT_AMOUNT_CC",
    ds."REF_INVOICED_OBJECT_ID" AS "REF_INVOICED_OBJECT_ID",
    ds."INCOTERM_CODE" AS "INCOTERM_CODE",
    ds."ACTUAL_VOLUME" AS "ACTUAL_VOLUME",
    ds."VOLUME_UOM_ID" AS "VOLUME_UOM_ID",
    ds."COMPUTED_VOLUME" AS "COMPUTED_VOLUME",
    ds."COMPUTED_VOLUME_UOM_ID" AS "COMPUTED_VOLUME_UOM_ID",
    ds."APPROVED_VOLUME" AS "APPROVED_VOLUME",
    ds."APPROVED_VOLUME_UOM_ID" AS "APPROVED_VOLUME_UOM_ID",
    ds."VOLUME_UOM" AS "VOLUME_UOM",
    ds."WEIGHT_UOM" AS "WEIGHT_UOM",
    ds."INV_OBJ_GRS_AMT_DUE_CURR_CODE" AS "INV_OBJ_GRS_AMT_DUE_CURR_CODE",
    ds."INV_OBJ_TAX_AM_DUE_CURR_CODE" AS "INV_OBJ_TAX_AM_DUE_CURR_CODE",
    ds."INV_OBJ_TAX_AMT_DUE" AS "INV_OBJ_TAX_AMT_DUE",
    ds."INV_OBJ_GRS_AMT_DUE" AS "INV_OBJ_GRS_AMT_DUE",
    ds."TRACKING_NUMBER" AS "TRACKING_NUMBER",
    ds."LENGTH" AS "LENGTH",
    ds."WIDTH" AS "WIDTH",
    ds."HEIGHT" AS "HEIGHT",
    ds."ADJ_RATE" AS "ADJ_RATE",
    ds."COMPUTED_ADJ_RATE" AS "COMPUTED_ADJ_RATE",
    ds."APPROVED_ADJ_RATE" AS "APPROVED_ADJ_RATE",
    ds."ADJ_LH_COST" AS "ADJ_LH_COST",
    ds."COMPUTED_ADJ_LH_COST" AS "COMPUTED_ADJ_LH_COST",
    ds."APPROVED_ADJ_LH_COST" AS "APPROVED_ADJ_LH_COST",
    ds."ENTRY_TYPE" AS "ENTRY_TYPE",
    ds."PICKUP_NUMBER" AS "PICKUP_NUMBER",
    ds."MONETARY_VALUE" AS "MONETARY_VALUE",
    ds."MONETARY_VALUE_CURRENCY_CODE" AS "MONETARY_VALUE_CURRENCY_CODE",
    ds."MANIFEST_TYPE" AS "MANIFEST_TYPE",
    ds."NON_MACHINABLE" AS "NON_MACHINABLE",
    ds."LENGTH_UOM_ID" AS "LENGTH_UOM_ID",
    ds."RATING_LEVEL" AS "RATING_LEVEL",
    ds."WIDTH_UOM_ID" AS "WIDTH_UOM_ID",
    ds."HEIGHT_UOM_ID" AS "HEIGHT_UOM_ID",
    ds."MARK_FOR_DELETION" AS "MARK_FOR_DELETION",
    ds."BILLING_METHOD" AS "BILLING_METHOD",
    ds."LAST_UPDATED_SOURCE_TYPE" AS "LAST_UPDATED_SOURCE_TYPE",
    ds."UNAPPLIED_SPOT_COST" AS "UNAPPLIED_SPOT_COST",
    ds."UNAPPLIED_SPOT_CURRENCY_CODE" AS "UNAPPLIED_SPOT_CURRENCY_CODE",
    ds."APPROVED_SPOT_COST" AS "APPROVED_SPOT_COST",
    ds."INVOICE_DTL_ID" AS "INVOICE_DTL_ID",
    ds."VESSEL_NUMBER" AS "VESSEL_NUMBER",
    ds."VOYAGE_FLIGHT_NUMBER" AS "VOYAGE_FLIGHT_NUMBER",
    ds."BOOKING_TYPE" AS "BOOKING_TYPE",
    ds."PRO_NUMBER" AS "PRO_NUMBER",
    ds."TRAILER_NUMBER" AS "TRAILER_NUMBER",
    ds."COMMODITY_CODE_ID" AS "COMMODITY_CODE_ID",
    ds."UNAPPLIED_TOTAL_BALANCE" AS "UNAPPLIED_TOTAL_BALANCE",
    ds."APPROVED_TOTAL_BALANCE" AS "APPROVED_TOTAL_BALANCE",
    ds."CDC_TIMESTAMP" AS "CDC_TIMESTAMP",
    ds."OPERATION_TYPE" AS "OPERATION_TYPE",
    ds."ARCHIVED_DTTM" AS "ARCHIVED_DTTM",
    ds."INVOICE_DT" AS "INVOICE_DT",
    ds."INVOICE_DATE_PARSED" AS "invoice_date_parsed",
    ds."NUM_REJECTIONS" AS "NUM_REJECTIONS",
    ds."TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID",
    ds."DELIVERY_START_DTTM" AS "DELIVERY_START_DTTM",
    ds."DELIVERY_DATE_PARSED" AS "delivery_date_parsed",
    ds."DELIVERY_END_DTTM" AS "DELIVERY_END_DTTM",
    ds."ORIGIN" AS "ORIGIN",
    ds."FINAL_DESTINATION" AS "FINAL_DESTINATION",
    ds."actual_delivery_date_parsed" AS "actual_delivery_date_parsed",
    ds."VENDOR_ID" AS "VENDOR_ID",
    ds."VENDOR_NAME" AS "VENDOR_NAME",
    ds."flag_wood_pellet_combined" AS "flag_wood_pellet_combined",
   t1."MERCH_YEAR" AS "cal_MERCH_YEAR",
   t1."YEAR_WEEK" AS "cal_YEAR_WEEK",
   t1."YEAR_QUARTER" AS "cal_YEAR_QUARTER",
   t1."YEAR_PERIOD" AS "cal_YEAR_PERIOD",
   t2."MERCH_YEAR" AS "del_MERCH_YEAR",
   t2."YEAR_WEEK" AS "del_YEAR_WEEK",
   t2."YEAR_QUARTER" AS "del_YEAR_QUARTER",
   t2."YEAR_PERIOD" AS "del_YEAR_PERIOD",
   t2."MERCH_YEAR" AS "act_del_MERCH_YEAR",
  t3."YEAR_WEEK" AS "act_del_YEAR_WEEK",
  t3."YEAR_QUARTER" AS "act_del_YEAR_QUARTER",
  t3."YEAR_PERIOD" AS "act_del_YEAR_PERIOD",
   SUM(DISTINCT ds."TOTAL_COST") OVER (PARTITION BY "TC_OBJECT_ID") AS "TOTAL_COST_sum",
    ROW_NUMBER() OVER (PARTITION BY "TC_OBJECT_ID" ORDER BY "INV_ID" ASC NULLS FIRST) AS "rownumber"
  FROM "DOMESTIC_SHIPPING_FREIGHT_PREPARED_1" ds
  LEFT JOIN "TIME_DIMENSION_PREPARED" t1
    ON ds."INVOICE_DATE_PARSED" = t1."DATE"
  LEFT JOIN "TIME_DIMENSION_PREPARED" t2
    ON ds."DELIVERY_DATE_PARSED" = t2."DATE"
  LEFT JOIN "TIME_DIMENSION_PREPARED" t3
    ON CAST(LEFT(ds."actual_delivery_date_parsed",10) AS DATE) = CAST(LEFT (t3."DATE",10)  AS DATE)
 WHERE ds."NUM_REJECTIONS" = 0 AND ( ("INV_OBJECT_STATUS" = 40) OR ("INV_OBJECT_STATUS" = 20) OR ("INV_OBJECT_STATUS" = 30))
 AND  ("act_del_MERCH_YEAR" >= 2020) 
 )WHERE "rownumber" =1;

<br>
 --DOMESTIC_SHIPPING_FREIGHT_W_FACILITIES
</br>
CREATE OR REPLACE TEMP TABLE DOMESTIC_SHIPPING_FREIGHT_W_FACILITIES
AS
SELECT 
    "INV_ID" AS "INV_ID",
    "INV_OBJECT_ID" AS "INV_OBJECT_ID",
    "TC_COMPANY_ID" AS "TC_COMPANY_ID",
    "TC_OBJECT_ID" AS "TC_OBJECT_ID",
    "INV_OBJECT_STATUS" AS "INV_OBJECT_STATUS",
    "O_NAME" AS "O_NAME",
    "O_ADDRESS" AS "O_ADDRESS",
    "O_CITY" AS "O_CITY",
    "O_COUNTY" AS "O_COUNTY",
    "O_STATE_PROV" AS "O_STATE_PROV",
    "O_POSTAL_CODE" AS "O_POSTAL_CODE",
    "O_COUNTRY_CODE" AS "O_COUNTRY_CODE",
    "D_NAME" AS "D_NAME",
    "D_ADDRESS" AS "D_ADDRESS",
    "D_CITY" AS "D_CITY",
    "D_COUNTY" AS "D_COUNTY",
    "D_STATE_PROV" AS "D_STATE_PROV",
    "D_POSTAL_CODE" AS "D_POSTAL_CODE",
    "D_COUNTRY_CODE" AS "D_COUNTRY_CODE",
    "MOT_DESC" AS "MOT_DESC",
    "EQUIPMENT_DESC" AS "EQUIPMENT_DESC",
    "SERVICE_LEVEL_DESC" AS "SERVICE_LEVEL_DESC",
    "PROTECTION_LEVEL_DESC" AS "PROTECTION_LEVEL_DESC",
    "FINANCIAL_WEIGHT" AS "FINANCIAL_WEIGHT",
    "ACTUAL_WEIGHT" AS "ACTUAL_WEIGHT",
    "LH_COST" AS "LH_COST",
    "DISTANCE" AS "DISTANCE",
    "DISTANCE_UOM" AS "DISTANCE_UOM",
    "BILL_OF_LADING_NUMBER" AS "BILL_OF_LADING_NUMBER",
    "PO_NUMBER" AS "PO_NUMBER",
    "SPEC_HANDLING_METHOD" AS "SPEC_HANDLING_METHOD",
    "COMMENTS" AS "COMMENTS",
    "HAS_IMPORT_ERROR" AS "HAS_IMPORT_ERROR",
    "HAS_WARNING" AS "HAS_WARNING",
    "IS_VALID" AS "IS_VALID",
    "CREATED_SOURCE_TYPE" AS "CREATED_SOURCE_TYPE",
    "CREATED_SOURCE" AS "CREATED_SOURCE",
    "CREATED_DTTM" AS "CREATED_DTTM",
    "LAST_UPDATED_SOURCE" AS "LAST_UPDATED_SOURCE",
    "LAST_UPDATED_DTTM" AS "LAST_UPDATED_DTTM",
    "STOP_COST" AS "STOP_COST",
    "AUXILARY_DATA" AS "AUXILARY_DATA",
    "PICKUP_DTTM" AS "PICKUP_DTTM",
    "DELIVERY_DTTM" AS "DELIVERY_DTTM",
    "CURRENCY_CODE" AS "CURRENCY_CODE",
    "LH_CURRENCY_CODE" AS "LH_CURRENCY_CODE",
    "STOP_CURRENCY_CODE" AS "STOP_CURRENCY_CODE",
    "SPOT_CHARGE_COST" AS "SPOT_CHARGE_COST",
    "SPOT_CHARGE_CURRENCY_CODE" AS "SPOT_CHARGE_CURRENCY_CODE",
    "ASSIGNED_CARRIER_CODE" AS "ASSIGNED_CARRIER_CODE",
    "NUM_PICKUPS" AS "NUM_PICKUPS",
    "NUM_DELIVERIES" AS "NUM_DELIVERIES",
    "RATE" AS "RATE",
    "RATE_CALC_METHOD" AS "RATE_CALC_METHOD",
    "RATE_UOM" AS "RATE_UOM",
    "TPE_OBJECT_ID" AS "TPE_OBJECT_ID",
    "O_FACILITY_ID" AS "O_FACILITY_ID",
    "D_FACILITY_ID" AS "D_FACILITY_ID",
    "TP_COMPANY_ID" AS "TP_COMPANY_ID",
    "PACKAGE_TYPE_ID" AS "PACKAGE_TYPE_ID",
    "COMPUTED_RATE" AS "COMPUTED_RATE",
    "COMPUTED_RATE_UOM" AS "COMPUTED_RATE_UOM",
    "COMPUTED_RATE_CALC_METHOD" AS "COMPUTED_RATE_CALC_METHOD",
    "COMPUTED_TOTAL_COST" AS "COMPUTED_TOTAL_COST",
    "COMPUTED_TOTAL_COST_CURR_CODE" AS "COMPUTED_TOTAL_COST_CURR_CODE",
    "O_FACILITY_NAME" AS "O_FACILITY_NAME",
    "D_FACILITY_NAME" AS "D_FACILITY_NAME",
    "COMPUTED_DISTANCE" AS "COMPUTED_DISTANCE",
    "COMPUTED_DISTANCE_UOM" AS "COMPUTED_DISTANCE_UOM",
    "COMPUTED_STOP_COST" AS "COMPUTED_STOP_COST",
    "COMPUTED_STOP_COST_CURR_CODE" AS "COMPUTED_STOP_COST_CURR_CODE",
    "APPROVED_DISTANCE" AS "APPROVED_DISTANCE",
    "APPROVED_LH_COST" AS "APPROVED_LH_COST",
    "APPROVED_RATE" AS "APPROVED_RATE",
    "APPROVED_FINANCIAL_WEIGHT" AS "APPROVED_FINANCIAL_WEIGHT",
    "APPROVED_ACTUAL_WEIGHT" AS "APPROVED_ACTUAL_WEIGHT",
    "RATE_ADJUSTMENT" AS "RATE_ADJUSTMENT",
    "MIN_CHARGE" AS "MIN_CHARGE",
    "COMPUTED_TARIFF" AS "COMPUTED_TARIFF",
    "COMPUTED_MIN_RATE" AS "COMPUTED_MIN_RATE",
    "UNDEFINED_ADJUSTMENT" AS "UNDEFINED_ADJUSTMENT",
    "DISCOUNT_AMOUNT" AS "DISCOUNT_AMOUNT",
    "UNDEFINED_ADJ_CURR_CODE" AS "UNDEFINED_ADJ_CURR_CODE",
    "DISCOUNT_AMT_CURR_CODE" AS "DISCOUNT_AMT_CURR_CODE",
    "RATE_CURR_CODE" AS "RATE_CURR_CODE",
    "CARRIER_ID" AS "CARRIER_ID",
    "ASSIGNED_CARRIER_ID" AS "ASSIGNED_CARRIER_ID",
    "EQUIPMENT_ID" AS "EQUIPMENT_ID",
    "MOT_ID" AS "MOT_ID",
    "PROTECTION_LEVEL_ID" AS "PROTECTION_LEVEL_ID",
    "SERVICE_LEVEL_ID" AS "SERVICE_LEVEL_ID",
    "UNDF_ADJ_CURR_CODE" AS "UNDF_ADJ_CURR_CODE",
    "COMPUTED_FINANCIAL_WEIGHT" AS "COMPUTED_FINANCIAL_WEIGHT",
    "ADJUSTMENT_AMOUNT" AS "ADJUSTMENT_AMOUNT",
    "APPROVED_ADJUSTMENT_AMOUNT" AS "APPROVED_ADJUSTMENT_AMOUNT",
    "APPROVED_STOP_COST" AS "APPROVED_STOP_COST",
    "APPROVED_RATE_ADJUSTMENT" AS "APPROVED_RATE_ADJUSTMENT",
    "APPROVED_RATE_CALC_METHOD" AS "APPROVED_RATE_CALC_METHOD",
    "APPROVED_RATE_UOM" AS "APPROVED_RATE_UOM",
    "APPROVED_DISTANCE_UOM" AS "APPROVED_DISTANCE_UOM",
    "COMPUTED_LH_COST" AS "COMPUTED_LH_COST",
    "COMPUTED_LH_COST_CURR_CODE" AS "COMPUTED_LH_COST_CURR_CODE",
    "WEIGHT_UOM_ID" AS "WEIGHT_UOM_ID",
    "APPROVED_WEIGHT_UOM_ID" AS "APPROVED_WEIGHT_UOM_ID",
    "INV_MIN_RATE" AS "INV_MIN_RATE",
    "SYS_MIN_RATE" AS "SYS_MIN_RATE",
    "UNAPPLIED_LH_COST" AS "UNAPPLIED_LH_COST",
    "UNAPPLIED_LH_CURRENCY_CODE" AS "UNAPPLIED_LH_CURRENCY_CODE",
    "UNAPPLIED_STOP_COST" AS "UNAPPLIED_STOP_COST",
    "UNAPPLIED_STOP_CURRENCY_CODE" AS "UNAPPLIED_STOP_CURRENCY_CODE",
    "ORG_SHIP_VIA_FACILITY_ID" AS "ORG_SHIP_VIA_FACILITY_ID",
    "ORG_SHIP_VIA_FACILITY_ALIAS_ID" AS "ORG_SHIP_VIA_FACILITY_ALIAS_ID",
    "DES_SHIP_VIA_FACILITY_ID" AS "DES_SHIP_VIA_FACILITY_ID",
    "DES_SHIP_VIA_FACILITY_ALIAS_ID" AS "DES_SHIP_VIA_FACILITY_ALIAS_ID",
    "INCOTERM_ID" AS "INCOTERM_ID",
    "SEC_CARRIER_ID" AS "SEC_CARRIER_ID",
    "COMMODITY_CLASS" AS "COMMODITY_CLASS",
    "ACTUAL_PAYMENT_AMOUNT" AS "ACTUAL_PAYMENT_AMOUNT",
    "ACTUAL_CURRENCY_CODE" AS "ACTUAL_CURRENCY_CODE",
    "NET_AMOUNT_CURRENCY_CODE" AS "NET_AMOUNT_CURRENCY_CODE",
    "NET_AMOUNT_DUE" AS "NET_AMOUNT_DUE",
    "NORMALIZED_NET_AMOUNT_DUE" AS "NORMALIZED_NET_AMOUNT_DUE",
    "REF_INV_OBJECT_PAID_AMOUNT" AS "REF_INV_OBJECT_PAID_AMOUNT",
    "REF_INV_OBJECT_PAID_AMOUNT_CC" AS "REF_INV_OBJECT_PAID_AMOUNT_CC",
    "REF_INV_OBJECT_AMOUNT" AS "REF_INV_OBJECT_AMOUNT",
    "REF_INV_OBJECT_AMOUNT_CC" AS "REF_INV_OBJECT_AMOUNT_CC",
    "REF_INVOICED_OBJECT_ID" AS "REF_INVOICED_OBJECT_ID",
    "INCOTERM_CODE" AS "INCOTERM_CODE",
    "ACTUAL_VOLUME" AS "ACTUAL_VOLUME",
    "VOLUME_UOM_ID" AS "VOLUME_UOM_ID",
    "COMPUTED_VOLUME" AS "COMPUTED_VOLUME",
    "COMPUTED_VOLUME_UOM_ID" AS "COMPUTED_VOLUME_UOM_ID",
    "APPROVED_VOLUME" AS "APPROVED_VOLUME",
    "APPROVED_VOLUME_UOM_ID" AS "APPROVED_VOLUME_UOM_ID",
    "VOLUME_UOM" AS "VOLUME_UOM",
    "WEIGHT_UOM" AS "WEIGHT_UOM",
    "INV_OBJ_GRS_AMT_DUE_CURR_CODE" AS "INV_OBJ_GRS_AMT_DUE_CURR_CODE",
    "INV_OBJ_TAX_AM_DUE_CURR_CODE" AS "INV_OBJ_TAX_AM_DUE_CURR_CODE",
    "INV_OBJ_TAX_AMT_DUE" AS "INV_OBJ_TAX_AMT_DUE",
    "INV_OBJ_GRS_AMT_DUE" AS "INV_OBJ_GRS_AMT_DUE",
    "TRACKING_NUMBER" AS "TRACKING_NUMBER",
    "LENGTH" AS "LENGTH",
    "WIDTH" AS "WIDTH",
    "HEIGHT" AS "HEIGHT",
    "ADJ_RATE" AS "ADJ_RATE",
    "COMPUTED_ADJ_RATE" AS "COMPUTED_ADJ_RATE",
    "APPROVED_ADJ_RATE" AS "APPROVED_ADJ_RATE",
    "ADJ_LH_COST" AS "ADJ_LH_COST",
    "COMPUTED_ADJ_LH_COST" AS "COMPUTED_ADJ_LH_COST",
    "APPROVED_ADJ_LH_COST" AS "APPROVED_ADJ_LH_COST",
    "ENTRY_TYPE" AS "ENTRY_TYPE",
    "PICKUP_NUMBER" AS "PICKUP_NUMBER",
    "MONETARY_VALUE" AS "MONETARY_VALUE",
    "MONETARY_VALUE_CURRENCY_CODE" AS "MONETARY_VALUE_CURRENCY_CODE",
    "MANIFEST_TYPE" AS "MANIFEST_TYPE",
    "NON_MACHINABLE" AS "NON_MACHINABLE",
    "LENGTH_UOM_ID" AS "LENGTH_UOM_ID",
    "RATING_LEVEL" AS "RATING_LEVEL",
    "WIDTH_UOM_ID" AS "WIDTH_UOM_ID",
    "HEIGHT_UOM_ID" AS "HEIGHT_UOM_ID",
    "MARK_FOR_DELETION" AS "MARK_FOR_DELETION",
    "BILLING_METHOD" AS "BILLING_METHOD",
    "LAST_UPDATED_SOURCE_TYPE" AS "LAST_UPDATED_SOURCE_TYPE",
    "UNAPPLIED_SPOT_COST" AS "UNAPPLIED_SPOT_COST",
    "UNAPPLIED_SPOT_CURRENCY_CODE" AS "UNAPPLIED_SPOT_CURRENCY_CODE",
    "APPROVED_SPOT_COST" AS "APPROVED_SPOT_COST",
    "INVOICE_DTL_ID" AS "INVOICE_DTL_ID",
    "VESSEL_NUMBER" AS "VESSEL_NUMBER",
    "VOYAGE_FLIGHT_NUMBER" AS "VOYAGE_FLIGHT_NUMBER",
    "BOOKING_TYPE" AS "BOOKING_TYPE",
    "PRO_NUMBER" AS "PRO_NUMBER",
    "TRAILER_NUMBER" AS "TRAILER_NUMBER",
    "COMMODITY_CODE_ID" AS "COMMODITY_CODE_ID",
    "UNAPPLIED_TOTAL_BALANCE" AS "UNAPPLIED_TOTAL_BALANCE",
    "APPROVED_TOTAL_BALANCE" AS "APPROVED_TOTAL_BALANCE",
    "CDC_TIMESTAMP" AS "CDC_TIMESTAMP",
    "OPERATION_TYPE" AS "OPERATION_TYPE",
    "ARCHIVED_DTTM" AS "ARCHIVED_DTTM",
    "INVOICE_DT" AS "INVOICE_DT",
    "invoice_date_parsed" AS "invoice_date_parsed",
    "NUM_REJECTIONS" AS "NUM_REJECTIONS",
    "TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID",
    "DELIVERY_START_DTTM" AS "DELIVERY_START_DTTM",
    "delivery_date_parsed" AS "delivery_date_parsed",
    "DELIVERY_END_DTTM" AS "DELIVERY_END_DTTM",
    "ORIGIN" AS "ORIGIN",
    "FINAL_DESTINATION" AS "FINAL_DESTINATION",
    "actual_delivery_date_parsed" AS "actual_delivery_date_parsed",
    "VENDOR_ID" AS "VENDOR_ID",
    "VENDOR_NAME" AS "VENDOR_NAME",
    "flag_wood_pellet_combined" AS "flag_wood_pellet_combined",
    "cal_MERCH_YEAR" AS "cal_MERCH_YEAR",
    "cal_YEAR_WEEK" AS "cal_YEAR_WEEK",
    "cal_YEAR_QUARTER" AS "cal_YEAR_QUARTER",
    "cal_YEAR_PERIOD" AS "cal_YEAR_PERIOD",
    "del_MERCH_YEAR" AS "del_MERCH_YEAR",
    "del_YEAR_WEEK" AS "del_YEAR_WEEK",
    "del_YEAR_QUARTER" AS "del_YEAR_QUARTER",
    "del_YEAR_PERIOD" AS "del_YEAR_PERIOD",
    "act_del_MERCH_YEAR" AS "act_del_MERCH_YEAR",
    "act_del_YEAR_WEEK" AS "act_del_YEAR_WEEK",
    "act_del_YEAR_QUARTER" AS "act_del_YEAR_QUARTER",
    "act_del_YEAR_PERIOD" AS "act_del_YEAR_PERIOD",
    "TOTAL_COST" AS "TOTAL_COST",
    "org_Facility_Code" AS "org_Facility_Code",
    "org_Facility_Name" AS "org_Facility_Name",
    "org_Facility_Type" AS "org_Facility_Type",
    "dest_Facility_Code" AS "dest_Facility_Code",
    "dest_Facility_Name" AS "dest_Facility_Name",
    "dest_Facility_Type" AS "dest_Facility_Type",
    CASE WHEN UPPER("org_Facility_Type") = 'VENDOR' THEN 'Inbound' ELSE 'Outbound' END AS "inbound_flag"
  FROM (
    SELECT 
        "domestic_shipping_freight_time_filter_windows"."INV_ID" AS "INV_ID",
        "domestic_shipping_freight_time_filter_windows"."INV_OBJECT_ID" AS "INV_OBJECT_ID",
        "domestic_shipping_freight_time_filter_windows"."TC_COMPANY_ID" AS "TC_COMPANY_ID",
        "domestic_shipping_freight_time_filter_windows"."TC_OBJECT_ID" AS "TC_OBJECT_ID",
        "domestic_shipping_freight_time_filter_windows"."INV_OBJECT_STATUS" AS "INV_OBJECT_STATUS",
        "domestic_shipping_freight_time_filter_windows"."O_NAME" AS "O_NAME",
        "domestic_shipping_freight_time_filter_windows"."O_ADDRESS" AS "O_ADDRESS",
        "domestic_shipping_freight_time_filter_windows"."O_CITY" AS "O_CITY",
        "domestic_shipping_freight_time_filter_windows"."O_COUNTY" AS "O_COUNTY",
        "domestic_shipping_freight_time_filter_windows"."O_STATE_PROV" AS "O_STATE_PROV",
        "domestic_shipping_freight_time_filter_windows"."O_POSTAL_CODE" AS "O_POSTAL_CODE",
        "domestic_shipping_freight_time_filter_windows"."O_COUNTRY_CODE" AS "O_COUNTRY_CODE",
        "domestic_shipping_freight_time_filter_windows"."D_NAME" AS "D_NAME",
        "domestic_shipping_freight_time_filter_windows"."D_ADDRESS" AS "D_ADDRESS",
        "domestic_shipping_freight_time_filter_windows"."D_CITY" AS "D_CITY",
        "domestic_shipping_freight_time_filter_windows"."D_COUNTY" AS "D_COUNTY",
        "domestic_shipping_freight_time_filter_windows"."D_STATE_PROV" AS "D_STATE_PROV",
        "domestic_shipping_freight_time_filter_windows"."D_POSTAL_CODE" AS "D_POSTAL_CODE",
        "domestic_shipping_freight_time_filter_windows"."D_COUNTRY_CODE" AS "D_COUNTRY_CODE",
        "domestic_shipping_freight_time_filter_windows"."MOT_DESC" AS "MOT_DESC",
        "domestic_shipping_freight_time_filter_windows"."EQUIPMENT_DESC" AS "EQUIPMENT_DESC",
        "domestic_shipping_freight_time_filter_windows"."SERVICE_LEVEL_DESC" AS "SERVICE_LEVEL_DESC",
        "domestic_shipping_freight_time_filter_windows"."PROTECTION_LEVEL_DESC" AS "PROTECTION_LEVEL_DESC",
        "domestic_shipping_freight_time_filter_windows"."FINANCIAL_WEIGHT" AS "FINANCIAL_WEIGHT",
        "domestic_shipping_freight_time_filter_windows"."ACTUAL_WEIGHT" AS "ACTUAL_WEIGHT",
        "domestic_shipping_freight_time_filter_windows"."LH_COST" AS "LH_COST",
        "domestic_shipping_freight_time_filter_windows"."DISTANCE" AS "DISTANCE",
        "domestic_shipping_freight_time_filter_windows"."DISTANCE_UOM" AS "DISTANCE_UOM",
        "domestic_shipping_freight_time_filter_windows"."BILL_OF_LADING_NUMBER" AS "BILL_OF_LADING_NUMBER",
        "domestic_shipping_freight_time_filter_windows"."PO_NUMBER" AS "PO_NUMBER",
        "domestic_shipping_freight_time_filter_windows"."SPEC_HANDLING_METHOD" AS "SPEC_HANDLING_METHOD",
        "domestic_shipping_freight_time_filter_windows"."COMMENTS" AS "COMMENTS",
        "domestic_shipping_freight_time_filter_windows"."HAS_IMPORT_ERROR" AS "HAS_IMPORT_ERROR",
        "domestic_shipping_freight_time_filter_windows"."HAS_WARNING" AS "HAS_WARNING",
        "domestic_shipping_freight_time_filter_windows"."IS_VALID" AS "IS_VALID",
        "domestic_shipping_freight_time_filter_windows"."CREATED_SOURCE_TYPE" AS "CREATED_SOURCE_TYPE",
        "domestic_shipping_freight_time_filter_windows"."CREATED_SOURCE" AS "CREATED_SOURCE",
        "domestic_shipping_freight_time_filter_windows"."CREATED_DTTM" AS "CREATED_DTTM",
        "domestic_shipping_freight_time_filter_windows"."LAST_UPDATED_SOURCE" AS "LAST_UPDATED_SOURCE",
        "domestic_shipping_freight_time_filter_windows"."LAST_UPDATED_DTTM" AS "LAST_UPDATED_DTTM",
        "domestic_shipping_freight_time_filter_windows"."STOP_COST" AS "STOP_COST",
        "domestic_shipping_freight_time_filter_windows"."AUXILARY_DATA" AS "AUXILARY_DATA",
        "domestic_shipping_freight_time_filter_windows"."PICKUP_DTTM" AS "PICKUP_DTTM",
        "domestic_shipping_freight_time_filter_windows"."DELIVERY_DTTM" AS "DELIVERY_DTTM",
        "domestic_shipping_freight_time_filter_windows"."CURRENCY_CODE" AS "CURRENCY_CODE",
        "domestic_shipping_freight_time_filter_windows"."LH_CURRENCY_CODE" AS "LH_CURRENCY_CODE",
        "domestic_shipping_freight_time_filter_windows"."STOP_CURRENCY_CODE" AS "STOP_CURRENCY_CODE",
        "domestic_shipping_freight_time_filter_windows"."SPOT_CHARGE_COST" AS "SPOT_CHARGE_COST",
        "domestic_shipping_freight_time_filter_windows"."SPOT_CHARGE_CURRENCY_CODE" AS "SPOT_CHARGE_CURRENCY_CODE",
        "domestic_shipping_freight_time_filter_windows"."ASSIGNED_CARRIER_CODE" AS "ASSIGNED_CARRIER_CODE",
        "domestic_shipping_freight_time_filter_windows"."NUM_PICKUPS" AS "NUM_PICKUPS",
        "domestic_shipping_freight_time_filter_windows"."NUM_DELIVERIES" AS "NUM_DELIVERIES",
        "domestic_shipping_freight_time_filter_windows"."RATE" AS "RATE",
        "domestic_shipping_freight_time_filter_windows"."RATE_CALC_METHOD" AS "RATE_CALC_METHOD",
        "domestic_shipping_freight_time_filter_windows"."RATE_UOM" AS "RATE_UOM",
        "domestic_shipping_freight_time_filter_windows"."TPE_OBJECT_ID" AS "TPE_OBJECT_ID",
        "domestic_shipping_freight_time_filter_windows"."O_FACILITY_ID" AS "O_FACILITY_ID",
        "domestic_shipping_freight_time_filter_windows"."D_FACILITY_ID" AS "D_FACILITY_ID",
        "domestic_shipping_freight_time_filter_windows"."TP_COMPANY_ID" AS "TP_COMPANY_ID",
        "domestic_shipping_freight_time_filter_windows"."PACKAGE_TYPE_ID" AS "PACKAGE_TYPE_ID",
        "domestic_shipping_freight_time_filter_windows"."COMPUTED_RATE" AS "COMPUTED_RATE",
        "domestic_shipping_freight_time_filter_windows"."COMPUTED_RATE_UOM" AS "COMPUTED_RATE_UOM",
        "domestic_shipping_freight_time_filter_windows"."COMPUTED_RATE_CALC_METHOD" AS "COMPUTED_RATE_CALC_METHOD",
        "domestic_shipping_freight_time_filter_windows"."COMPUTED_TOTAL_COST" AS "COMPUTED_TOTAL_COST",
        "domestic_shipping_freight_time_filter_windows"."COMPUTED_TOTAL_COST_CURR_CODE" AS "COMPUTED_TOTAL_COST_CURR_CODE",
        "domestic_shipping_freight_time_filter_windows"."O_FACILITY_NAME" AS "O_FACILITY_NAME",
        "domestic_shipping_freight_time_filter_windows"."D_FACILITY_NAME" AS "D_FACILITY_NAME",
        "domestic_shipping_freight_time_filter_windows"."COMPUTED_DISTANCE" AS "COMPUTED_DISTANCE",
        "domestic_shipping_freight_time_filter_windows"."COMPUTED_DISTANCE_UOM" AS "COMPUTED_DISTANCE_UOM",
        "domestic_shipping_freight_time_filter_windows"."COMPUTED_STOP_COST" AS "COMPUTED_STOP_COST",
        "domestic_shipping_freight_time_filter_windows"."COMPUTED_STOP_COST_CURR_CODE" AS "COMPUTED_STOP_COST_CURR_CODE",
        "domestic_shipping_freight_time_filter_windows"."APPROVED_DISTANCE" AS "APPROVED_DISTANCE",
        "domestic_shipping_freight_time_filter_windows"."APPROVED_LH_COST" AS "APPROVED_LH_COST",
        "domestic_shipping_freight_time_filter_windows"."APPROVED_RATE" AS "APPROVED_RATE",
        "domestic_shipping_freight_time_filter_windows"."APPROVED_FINANCIAL_WEIGHT" AS "APPROVED_FINANCIAL_WEIGHT",
        "domestic_shipping_freight_time_filter_windows"."APPROVED_ACTUAL_WEIGHT" AS "APPROVED_ACTUAL_WEIGHT",
        "domestic_shipping_freight_time_filter_windows"."RATE_ADJUSTMENT" AS "RATE_ADJUSTMENT",
        "domestic_shipping_freight_time_filter_windows"."MIN_CHARGE" AS "MIN_CHARGE",
        "domestic_shipping_freight_time_filter_windows"."COMPUTED_TARIFF" AS "COMPUTED_TARIFF",
        "domestic_shipping_freight_time_filter_windows"."COMPUTED_MIN_RATE" AS "COMPUTED_MIN_RATE",
        "domestic_shipping_freight_time_filter_windows"."UNDEFINED_ADJUSTMENT" AS "UNDEFINED_ADJUSTMENT",
        "domestic_shipping_freight_time_filter_windows"."DISCOUNT_AMOUNT" AS "DISCOUNT_AMOUNT",
        "domestic_shipping_freight_time_filter_windows"."UNDEFINED_ADJ_CURR_CODE" AS "UNDEFINED_ADJ_CURR_CODE",
        "domestic_shipping_freight_time_filter_windows"."DISCOUNT_AMT_CURR_CODE" AS "DISCOUNT_AMT_CURR_CODE",
        "domestic_shipping_freight_time_filter_windows"."RATE_CURR_CODE" AS "RATE_CURR_CODE",
        "domestic_shipping_freight_time_filter_windows"."CARRIER_ID" AS "CARRIER_ID",
        "domestic_shipping_freight_time_filter_windows"."ASSIGNED_CARRIER_ID" AS "ASSIGNED_CARRIER_ID",
        "domestic_shipping_freight_time_filter_windows"."EQUIPMENT_ID" AS "EQUIPMENT_ID",
        "domestic_shipping_freight_time_filter_windows"."MOT_ID" AS "MOT_ID",
        "domestic_shipping_freight_time_filter_windows"."PROTECTION_LEVEL_ID" AS "PROTECTION_LEVEL_ID",
        "domestic_shipping_freight_time_filter_windows"."SERVICE_LEVEL_ID" AS "SERVICE_LEVEL_ID",
        "domestic_shipping_freight_time_filter_windows"."UNDF_ADJ_CURR_CODE" AS "UNDF_ADJ_CURR_CODE",
        "domestic_shipping_freight_time_filter_windows"."COMPUTED_FINANCIAL_WEIGHT" AS "COMPUTED_FINANCIAL_WEIGHT",
        "domestic_shipping_freight_time_filter_windows"."ADJUSTMENT_AMOUNT" AS "ADJUSTMENT_AMOUNT",
        "domestic_shipping_freight_time_filter_windows"."APPROVED_ADJUSTMENT_AMOUNT" AS "APPROVED_ADJUSTMENT_AMOUNT",
        "domestic_shipping_freight_time_filter_windows"."APPROVED_STOP_COST" AS "APPROVED_STOP_COST",
        "domestic_shipping_freight_time_filter_windows"."APPROVED_RATE_ADJUSTMENT" AS "APPROVED_RATE_ADJUSTMENT",
        "domestic_shipping_freight_time_filter_windows"."APPROVED_RATE_CALC_METHOD" AS "APPROVED_RATE_CALC_METHOD",
        "domestic_shipping_freight_time_filter_windows"."APPROVED_RATE_UOM" AS "APPROVED_RATE_UOM",
        "domestic_shipping_freight_time_filter_windows"."APPROVED_DISTANCE_UOM" AS "APPROVED_DISTANCE_UOM",
        "domestic_shipping_freight_time_filter_windows"."COMPUTED_LH_COST" AS "COMPUTED_LH_COST",
        "domestic_shipping_freight_time_filter_windows"."COMPUTED_LH_COST_CURR_CODE" AS "COMPUTED_LH_COST_CURR_CODE",
        "domestic_shipping_freight_time_filter_windows"."WEIGHT_UOM_ID" AS "WEIGHT_UOM_ID",
        "domestic_shipping_freight_time_filter_windows"."APPROVED_WEIGHT_UOM_ID" AS "APPROVED_WEIGHT_UOM_ID",
        "domestic_shipping_freight_time_filter_windows"."INV_MIN_RATE" AS "INV_MIN_RATE",
        "domestic_shipping_freight_time_filter_windows"."SYS_MIN_RATE" AS "SYS_MIN_RATE",
        "domestic_shipping_freight_time_filter_windows"."UNAPPLIED_LH_COST" AS "UNAPPLIED_LH_COST",
        "domestic_shipping_freight_time_filter_windows"."UNAPPLIED_LH_CURRENCY_CODE" AS "UNAPPLIED_LH_CURRENCY_CODE",
        "domestic_shipping_freight_time_filter_windows"."UNAPPLIED_STOP_COST" AS "UNAPPLIED_STOP_COST",
        "domestic_shipping_freight_time_filter_windows"."UNAPPLIED_STOP_CURRENCY_CODE" AS "UNAPPLIED_STOP_CURRENCY_CODE",
        "domestic_shipping_freight_time_filter_windows"."ORG_SHIP_VIA_FACILITY_ID" AS "ORG_SHIP_VIA_FACILITY_ID",
        "domestic_shipping_freight_time_filter_windows"."ORG_SHIP_VIA_FACILITY_ALIAS_ID" AS "ORG_SHIP_VIA_FACILITY_ALIAS_ID",
        "domestic_shipping_freight_time_filter_windows"."DES_SHIP_VIA_FACILITY_ID" AS "DES_SHIP_VIA_FACILITY_ID",
        "domestic_shipping_freight_time_filter_windows"."DES_SHIP_VIA_FACILITY_ALIAS_ID" AS "DES_SHIP_VIA_FACILITY_ALIAS_ID",
        "domestic_shipping_freight_time_filter_windows"."INCOTERM_ID" AS "INCOTERM_ID",
        "domestic_shipping_freight_time_filter_windows"."SEC_CARRIER_ID" AS "SEC_CARRIER_ID",
        "domestic_shipping_freight_time_filter_windows"."COMMODITY_CLASS" AS "COMMODITY_CLASS",
        "domestic_shipping_freight_time_filter_windows"."ACTUAL_PAYMENT_AMOUNT" AS "ACTUAL_PAYMENT_AMOUNT",
        "domestic_shipping_freight_time_filter_windows"."ACTUAL_CURRENCY_CODE" AS "ACTUAL_CURRENCY_CODE",
        "domestic_shipping_freight_time_filter_windows"."NET_AMOUNT_CURRENCY_CODE" AS "NET_AMOUNT_CURRENCY_CODE",
        "domestic_shipping_freight_time_filter_windows"."NET_AMOUNT_DUE" AS "NET_AMOUNT_DUE",
        "domestic_shipping_freight_time_filter_windows"."NORMALIZED_NET_AMOUNT_DUE" AS "NORMALIZED_NET_AMOUNT_DUE",
        "domestic_shipping_freight_time_filter_windows"."REF_INV_OBJECT_PAID_AMOUNT" AS "REF_INV_OBJECT_PAID_AMOUNT",
        "domestic_shipping_freight_time_filter_windows"."REF_INV_OBJECT_PAID_AMOUNT_CC" AS "REF_INV_OBJECT_PAID_AMOUNT_CC",
        "domestic_shipping_freight_time_filter_windows"."REF_INV_OBJECT_AMOUNT" AS "REF_INV_OBJECT_AMOUNT",
        "domestic_shipping_freight_time_filter_windows"."REF_INV_OBJECT_AMOUNT_CC" AS "REF_INV_OBJECT_AMOUNT_CC",
        "domestic_shipping_freight_time_filter_windows"."REF_INVOICED_OBJECT_ID" AS "REF_INVOICED_OBJECT_ID",
        "domestic_shipping_freight_time_filter_windows"."INCOTERM_CODE" AS "INCOTERM_CODE",
        "domestic_shipping_freight_time_filter_windows"."ACTUAL_VOLUME" AS "ACTUAL_VOLUME",
        "domestic_shipping_freight_time_filter_windows"."VOLUME_UOM_ID" AS "VOLUME_UOM_ID",
        "domestic_shipping_freight_time_filter_windows"."COMPUTED_VOLUME" AS "COMPUTED_VOLUME",
        "domestic_shipping_freight_time_filter_windows"."COMPUTED_VOLUME_UOM_ID" AS "COMPUTED_VOLUME_UOM_ID",
        "domestic_shipping_freight_time_filter_windows"."APPROVED_VOLUME" AS "APPROVED_VOLUME",
        "domestic_shipping_freight_time_filter_windows"."APPROVED_VOLUME_UOM_ID" AS "APPROVED_VOLUME_UOM_ID",
        "domestic_shipping_freight_time_filter_windows"."VOLUME_UOM" AS "VOLUME_UOM",
        "domestic_shipping_freight_time_filter_windows"."WEIGHT_UOM" AS "WEIGHT_UOM",
        "domestic_shipping_freight_time_filter_windows"."INV_OBJ_GRS_AMT_DUE_CURR_CODE" AS "INV_OBJ_GRS_AMT_DUE_CURR_CODE",
        "domestic_shipping_freight_time_filter_windows"."INV_OBJ_TAX_AM_DUE_CURR_CODE" AS "INV_OBJ_TAX_AM_DUE_CURR_CODE",
        "domestic_shipping_freight_time_filter_windows"."INV_OBJ_TAX_AMT_DUE" AS "INV_OBJ_TAX_AMT_DUE",
        "domestic_shipping_freight_time_filter_windows"."INV_OBJ_GRS_AMT_DUE" AS "INV_OBJ_GRS_AMT_DUE",
        "domestic_shipping_freight_time_filter_windows"."TRACKING_NUMBER" AS "TRACKING_NUMBER",
        "domestic_shipping_freight_time_filter_windows"."LENGTH" AS "LENGTH",
        "domestic_shipping_freight_time_filter_windows"."WIDTH" AS "WIDTH",
        "domestic_shipping_freight_time_filter_windows"."HEIGHT" AS "HEIGHT",
        "domestic_shipping_freight_time_filter_windows"."ADJ_RATE" AS "ADJ_RATE",
        "domestic_shipping_freight_time_filter_windows"."COMPUTED_ADJ_RATE" AS "COMPUTED_ADJ_RATE",
        "domestic_shipping_freight_time_filter_windows"."APPROVED_ADJ_RATE" AS "APPROVED_ADJ_RATE",
        "domestic_shipping_freight_time_filter_windows"."ADJ_LH_COST" AS "ADJ_LH_COST",
        "domestic_shipping_freight_time_filter_windows"."COMPUTED_ADJ_LH_COST" AS "COMPUTED_ADJ_LH_COST",
        "domestic_shipping_freight_time_filter_windows"."APPROVED_ADJ_LH_COST" AS "APPROVED_ADJ_LH_COST",
        "domestic_shipping_freight_time_filter_windows"."ENTRY_TYPE" AS "ENTRY_TYPE",
        "domestic_shipping_freight_time_filter_windows"."PICKUP_NUMBER" AS "PICKUP_NUMBER",
        "domestic_shipping_freight_time_filter_windows"."MONETARY_VALUE" AS "MONETARY_VALUE",
        "domestic_shipping_freight_time_filter_windows"."MONETARY_VALUE_CURRENCY_CODE" AS "MONETARY_VALUE_CURRENCY_CODE",
        "domestic_shipping_freight_time_filter_windows"."MANIFEST_TYPE" AS "MANIFEST_TYPE",
        "domestic_shipping_freight_time_filter_windows"."NON_MACHINABLE" AS "NON_MACHINABLE",
        "domestic_shipping_freight_time_filter_windows"."LENGTH_UOM_ID" AS "LENGTH_UOM_ID",
        "domestic_shipping_freight_time_filter_windows"."RATING_LEVEL" AS "RATING_LEVEL",
        "domestic_shipping_freight_time_filter_windows"."WIDTH_UOM_ID" AS "WIDTH_UOM_ID",
        "domestic_shipping_freight_time_filter_windows"."HEIGHT_UOM_ID" AS "HEIGHT_UOM_ID",
        "domestic_shipping_freight_time_filter_windows"."MARK_FOR_DELETION" AS "MARK_FOR_DELETION",
        "domestic_shipping_freight_time_filter_windows"."BILLING_METHOD" AS "BILLING_METHOD",
        "domestic_shipping_freight_time_filter_windows"."LAST_UPDATED_SOURCE_TYPE" AS "LAST_UPDATED_SOURCE_TYPE",
        "domestic_shipping_freight_time_filter_windows"."UNAPPLIED_SPOT_COST" AS "UNAPPLIED_SPOT_COST",
        "domestic_shipping_freight_time_filter_windows"."UNAPPLIED_SPOT_CURRENCY_CODE" AS "UNAPPLIED_SPOT_CURRENCY_CODE",
        "domestic_shipping_freight_time_filter_windows"."APPROVED_SPOT_COST" AS "APPROVED_SPOT_COST",
        "domestic_shipping_freight_time_filter_windows"."INVOICE_DTL_ID" AS "INVOICE_DTL_ID",
        "domestic_shipping_freight_time_filter_windows"."VESSEL_NUMBER" AS "VESSEL_NUMBER",
        "domestic_shipping_freight_time_filter_windows"."VOYAGE_FLIGHT_NUMBER" AS "VOYAGE_FLIGHT_NUMBER",
        "domestic_shipping_freight_time_filter_windows"."BOOKING_TYPE" AS "BOOKING_TYPE",
        "domestic_shipping_freight_time_filter_windows"."PRO_NUMBER" AS "PRO_NUMBER",
        "domestic_shipping_freight_time_filter_windows"."TRAILER_NUMBER" AS "TRAILER_NUMBER",
        "domestic_shipping_freight_time_filter_windows"."COMMODITY_CODE_ID" AS "COMMODITY_CODE_ID",
        "domestic_shipping_freight_time_filter_windows"."UNAPPLIED_TOTAL_BALANCE" AS "UNAPPLIED_TOTAL_BALANCE",
        "domestic_shipping_freight_time_filter_windows"."APPROVED_TOTAL_BALANCE" AS "APPROVED_TOTAL_BALANCE",
        "domestic_shipping_freight_time_filter_windows"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP",
        "domestic_shipping_freight_time_filter_windows"."OPERATION_TYPE" AS "OPERATION_TYPE",
        "domestic_shipping_freight_time_filter_windows"."ARCHIVED_DTTM" AS "ARCHIVED_DTTM",
        "domestic_shipping_freight_time_filter_windows"."INVOICE_DT" AS "INVOICE_DT",
        "domestic_shipping_freight_time_filter_windows"."invoice_date_parsed" AS "invoice_date_parsed",
        "domestic_shipping_freight_time_filter_windows"."NUM_REJECTIONS" AS "NUM_REJECTIONS",
        "domestic_shipping_freight_time_filter_windows"."TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID",
        "domestic_shipping_freight_time_filter_windows"."DELIVERY_START_DTTM" AS "DELIVERY_START_DTTM",
        "domestic_shipping_freight_time_filter_windows"."delivery_date_parsed" AS "delivery_date_parsed",
        "domestic_shipping_freight_time_filter_windows"."DELIVERY_END_DTTM" AS "DELIVERY_END_DTTM",
        "domestic_shipping_freight_time_filter_windows"."ORIGIN" AS "ORIGIN",
        "domestic_shipping_freight_time_filter_windows"."FINAL_DESTINATION" AS "FINAL_DESTINATION",
        "domestic_shipping_freight_time_filter_windows"."actual_delivery_date_parsed" AS "actual_delivery_date_parsed",
        "domestic_shipping_freight_time_filter_windows"."VENDOR_ID" AS "VENDOR_ID",
        "domestic_shipping_freight_time_filter_windows"."VENDOR_NAME" AS "VENDOR_NAME",
        "domestic_shipping_freight_time_filter_windows"."flag_wood_pellet_combined" AS "flag_wood_pellet_combined",
        "domestic_shipping_freight_time_filter_windows"."cal_MERCH_YEAR" AS "cal_MERCH_YEAR",
        "domestic_shipping_freight_time_filter_windows"."cal_YEAR_WEEK" AS "cal_YEAR_WEEK",
        "domestic_shipping_freight_time_filter_windows"."cal_YEAR_QUARTER" AS "cal_YEAR_QUARTER",
        "domestic_shipping_freight_time_filter_windows"."cal_YEAR_PERIOD" AS "cal_YEAR_PERIOD",
        "domestic_shipping_freight_time_filter_windows"."del_MERCH_YEAR" AS "del_MERCH_YEAR",
        "domestic_shipping_freight_time_filter_windows"."del_YEAR_WEEK" AS "del_YEAR_WEEK",
        "domestic_shipping_freight_time_filter_windows"."del_YEAR_QUARTER" AS "del_YEAR_QUARTER",
        "domestic_shipping_freight_time_filter_windows"."del_YEAR_PERIOD" AS "del_YEAR_PERIOD",
        "domestic_shipping_freight_time_filter_windows"."act_del_MERCH_YEAR" AS "act_del_MERCH_YEAR",
        "domestic_shipping_freight_time_filter_windows"."act_del_YEAR_WEEK" AS "act_del_YEAR_WEEK",
        "domestic_shipping_freight_time_filter_windows"."act_del_YEAR_QUARTER" AS "act_del_YEAR_QUARTER",
        "domestic_shipping_freight_time_filter_windows"."act_del_YEAR_PERIOD" AS "act_del_YEAR_PERIOD",
        "domestic_shipping_freight_time_filter_windows"."TOTAL_COST" AS "TOTAL_COST",
        "TSC_facilities_final"."FACILITY_CODE" AS "org_Facility_Code",
        "TSC_facilities_final"."FACILITY_NAME" AS "org_Facility_Name",
        "TSC_facilities_final"."FACILITY_TYPE" AS "org_Facility_Type",
        "TSC_facilities_final_2"."FACILITY_CODE" AS "dest_Facility_Code",
        "TSC_facilities_final_2"."FACILITY_NAME" AS "dest_Facility_Name",
        "TSC_facilities_final_2"."FACILITY_TYPE" AS "dest_Facility_Type"
      FROM DOMESTIC_SHIPPING_FREIGHT_TIME_FILTER_WINDOWS "domestic_shipping_freight_time_filter_windows"
      LEFT JOIN TSC_FACILITIES_FINAL "TSC_facilities_final"
        ON "domestic_shipping_freight_time_filter_windows"."ORIGIN" = CAST("TSC_facilities_final"."FACILITY_CODE"AS NUMERIC)
      LEFT JOIN TSC_FACILITIES_FINAL "TSC_facilities_final_2"
        ON "domestic_shipping_freight_time_filter_windows"."FINAL_DESTINATION" = CAST("TSC_facilities_final_2"."FACILITY_CODE" AS NUMERIC)
    ) "domestic_shipping_freight_w_facilities";
	
	
	
<br>
--DOMESTIC_SHIPPING_FREIGHT_W_FACILITIES_JOINED
</br>

CREATE OR REPLACE TEMPORARY TABLE "DOMESTIC_SHIPPING_FREIGHT_W_FACILITIES_JOINED"
AS
SELECT A.* ,B.order_id_po AS "order_id_po"
FROM 
(
SELECT 
    "INV_ID" AS "INV_ID",
    "INV_OBJECT_ID" AS "INV_OBJECT_ID",
    "TC_COMPANY_ID" AS "TC_COMPANY_ID",
    "TC_OBJECT_ID" AS "TC_OBJECT_ID",
    "INV_OBJECT_STATUS" AS "INV_OBJECT_STATUS",
    "O_NAME" AS "O_NAME",
    "O_ADDRESS" AS "O_ADDRESS",
    "O_CITY" AS "O_CITY",
    "O_COUNTY" AS "O_COUNTY",
    "O_STATE_PROV" AS "O_STATE_PROV",
    "O_POSTAL_CODE" AS "O_POSTAL_CODE",
    "O_COUNTRY_CODE" AS "O_COUNTRY_CODE",
    "D_NAME" AS "D_NAME",
    "D_ADDRESS" AS "D_ADDRESS",
    "D_CITY" AS "D_CITY",
    "D_COUNTY" AS "D_COUNTY",
    "D_STATE_PROV" AS "D_STATE_PROV",
    "D_POSTAL_CODE" AS "D_POSTAL_CODE",
    "D_COUNTRY_CODE" AS "D_COUNTRY_CODE",
    "MOT_DESC" AS "MOT_DESC",
    "EQUIPMENT_DESC" AS "EQUIPMENT_DESC",
    "SERVICE_LEVEL_DESC" AS "SERVICE_LEVEL_DESC",
    "PROTECTION_LEVEL_DESC" AS "PROTECTION_LEVEL_DESC",
    "FINANCIAL_WEIGHT" AS "FINANCIAL_WEIGHT",
    "ACTUAL_WEIGHT" AS "ACTUAL_WEIGHT",
    "LH_COST" AS "LH_COST",
    "DISTANCE" AS "DISTANCE",
    "DISTANCE_UOM" AS "DISTANCE_UOM",
    "BILL_OF_LADING_NUMBER" AS "BILL_OF_LADING_NUMBER",
    "PO_NUMBER" AS "PO_NUMBER",
    "SPEC_HANDLING_METHOD" AS "SPEC_HANDLING_METHOD",
    "COMMENTS" AS "COMMENTS",
    "HAS_IMPORT_ERROR" AS "HAS_IMPORT_ERROR",
    "HAS_WARNING" AS "HAS_WARNING",
    "IS_VALID" AS "IS_VALID",
    "CREATED_SOURCE_TYPE" AS "CREATED_SOURCE_TYPE",
    "CREATED_SOURCE" AS "CREATED_SOURCE",
    "CREATED_DTTM" AS "CREATED_DTTM",
    "LAST_UPDATED_SOURCE" AS "LAST_UPDATED_SOURCE",
    "LAST_UPDATED_DTTM" AS "LAST_UPDATED_DTTM",
    "STOP_COST" AS "STOP_COST",
    "AUXILARY_DATA" AS "AUXILARY_DATA",
    "PICKUP_DTTM" AS "PICKUP_DTTM",
    "DELIVERY_DTTM" AS "DELIVERY_DTTM",
    "CURRENCY_CODE" AS "CURRENCY_CODE",
    "LH_CURRENCY_CODE" AS "LH_CURRENCY_CODE",
    "STOP_CURRENCY_CODE" AS "STOP_CURRENCY_CODE",
    "SPOT_CHARGE_COST" AS "SPOT_CHARGE_COST",
    "SPOT_CHARGE_CURRENCY_CODE" AS "SPOT_CHARGE_CURRENCY_CODE",
    "ASSIGNED_CARRIER_CODE" AS "ASSIGNED_CARRIER_CODE",
    "NUM_PICKUPS" AS "NUM_PICKUPS",
    "NUM_DELIVERIES" AS "NUM_DELIVERIES",
    "RATE" AS "RATE",
    "RATE_CALC_METHOD" AS "RATE_CALC_METHOD",
    "RATE_UOM" AS "RATE_UOM",
    "TPE_OBJECT_ID" AS "TPE_OBJECT_ID",
    "O_FACILITY_ID" AS "O_FACILITY_ID",
    "D_FACILITY_ID" AS "D_FACILITY_ID",
    "TP_COMPANY_ID" AS "TP_COMPANY_ID",
    "PACKAGE_TYPE_ID" AS "PACKAGE_TYPE_ID",
    "COMPUTED_RATE" AS "COMPUTED_RATE",
    "COMPUTED_RATE_UOM" AS "COMPUTED_RATE_UOM",
    "COMPUTED_RATE_CALC_METHOD" AS "COMPUTED_RATE_CALC_METHOD",
    "COMPUTED_TOTAL_COST" AS "COMPUTED_TOTAL_COST",
    "COMPUTED_TOTAL_COST_CURR_CODE" AS "COMPUTED_TOTAL_COST_CURR_CODE",
    "O_FACILITY_NAME" AS "O_FACILITY_NAME",
    "D_FACILITY_NAME" AS "D_FACILITY_NAME",
    "COMPUTED_DISTANCE" AS "COMPUTED_DISTANCE",
    "COMPUTED_DISTANCE_UOM" AS "COMPUTED_DISTANCE_UOM",
    "COMPUTED_STOP_COST" AS "COMPUTED_STOP_COST",
    "COMPUTED_STOP_COST_CURR_CODE" AS "COMPUTED_STOP_COST_CURR_CODE",
    "APPROVED_DISTANCE" AS "APPROVED_DISTANCE",
    "APPROVED_LH_COST" AS "APPROVED_LH_COST",
    "APPROVED_RATE" AS "APPROVED_RATE",
    "APPROVED_FINANCIAL_WEIGHT" AS "APPROVED_FINANCIAL_WEIGHT",
    "APPROVED_ACTUAL_WEIGHT" AS "APPROVED_ACTUAL_WEIGHT",
    "RATE_ADJUSTMENT" AS "RATE_ADJUSTMENT",
    "MIN_CHARGE" AS "MIN_CHARGE",
    "COMPUTED_TARIFF" AS "COMPUTED_TARIFF",
    "COMPUTED_MIN_RATE" AS "COMPUTED_MIN_RATE",
    "UNDEFINED_ADJUSTMENT" AS "UNDEFINED_ADJUSTMENT",
    "DISCOUNT_AMOUNT" AS "DISCOUNT_AMOUNT",
    "UNDEFINED_ADJ_CURR_CODE" AS "UNDEFINED_ADJ_CURR_CODE",
    "DISCOUNT_AMT_CURR_CODE" AS "DISCOUNT_AMT_CURR_CODE",
    "RATE_CURR_CODE" AS "RATE_CURR_CODE",
    "CARRIER_ID" AS "CARRIER_ID",
    "ASSIGNED_CARRIER_ID" AS "ASSIGNED_CARRIER_ID",
    "EQUIPMENT_ID" AS "EQUIPMENT_ID",
    "MOT_ID" AS "MOT_ID",
    "PROTECTION_LEVEL_ID" AS "PROTECTION_LEVEL_ID",
    "SERVICE_LEVEL_ID" AS "SERVICE_LEVEL_ID",
    "UNDF_ADJ_CURR_CODE" AS "UNDF_ADJ_CURR_CODE",
    "COMPUTED_FINANCIAL_WEIGHT" AS "COMPUTED_FINANCIAL_WEIGHT",
    "ADJUSTMENT_AMOUNT" AS "ADJUSTMENT_AMOUNT",
    "APPROVED_ADJUSTMENT_AMOUNT" AS "APPROVED_ADJUSTMENT_AMOUNT",
    "APPROVED_STOP_COST" AS "APPROVED_STOP_COST",
    "APPROVED_RATE_ADJUSTMENT" AS "APPROVED_RATE_ADJUSTMENT",
    "APPROVED_RATE_CALC_METHOD" AS "APPROVED_RATE_CALC_METHOD",
    "APPROVED_RATE_UOM" AS "APPROVED_RATE_UOM",
    "APPROVED_DISTANCE_UOM" AS "APPROVED_DISTANCE_UOM",
    "COMPUTED_LH_COST" AS "COMPUTED_LH_COST",
    "COMPUTED_LH_COST_CURR_CODE" AS "COMPUTED_LH_COST_CURR_CODE",
    "WEIGHT_UOM_ID" AS "WEIGHT_UOM_ID",
    "APPROVED_WEIGHT_UOM_ID" AS "APPROVED_WEIGHT_UOM_ID",
    "INV_MIN_RATE" AS "INV_MIN_RATE",
    "SYS_MIN_RATE" AS "SYS_MIN_RATE",
    "UNAPPLIED_LH_COST" AS "UNAPPLIED_LH_COST",
    "UNAPPLIED_LH_CURRENCY_CODE" AS "UNAPPLIED_LH_CURRENCY_CODE",
    "UNAPPLIED_STOP_COST" AS "UNAPPLIED_STOP_COST",
    "UNAPPLIED_STOP_CURRENCY_CODE" AS "UNAPPLIED_STOP_CURRENCY_CODE",
    "ORG_SHIP_VIA_FACILITY_ID" AS "ORG_SHIP_VIA_FACILITY_ID",
    "ORG_SHIP_VIA_FACILITY_ALIAS_ID" AS "ORG_SHIP_VIA_FACILITY_ALIAS_ID",
    "DES_SHIP_VIA_FACILITY_ID" AS "DES_SHIP_VIA_FACILITY_ID",
    "DES_SHIP_VIA_FACILITY_ALIAS_ID" AS "DES_SHIP_VIA_FACILITY_ALIAS_ID",
    "INCOTERM_ID" AS "INCOTERM_ID",
    "SEC_CARRIER_ID" AS "SEC_CARRIER_ID",
    "COMMODITY_CLASS" AS "COMMODITY_CLASS",
    "ACTUAL_PAYMENT_AMOUNT" AS "ACTUAL_PAYMENT_AMOUNT",
    "ACTUAL_CURRENCY_CODE" AS "ACTUAL_CURRENCY_CODE",
    "NET_AMOUNT_CURRENCY_CODE" AS "NET_AMOUNT_CURRENCY_CODE",
    "NET_AMOUNT_DUE" AS "NET_AMOUNT_DUE",
    "NORMALIZED_NET_AMOUNT_DUE" AS "NORMALIZED_NET_AMOUNT_DUE",
    "REF_INV_OBJECT_PAID_AMOUNT" AS "REF_INV_OBJECT_PAID_AMOUNT",
    "REF_INV_OBJECT_PAID_AMOUNT_CC" AS "REF_INV_OBJECT_PAID_AMOUNT_CC",
    "REF_INV_OBJECT_AMOUNT" AS "REF_INV_OBJECT_AMOUNT",
    "REF_INV_OBJECT_AMOUNT_CC" AS "REF_INV_OBJECT_AMOUNT_CC",
    "REF_INVOICED_OBJECT_ID" AS "REF_INVOICED_OBJECT_ID",
    "INCOTERM_CODE" AS "INCOTERM_CODE",
    "ACTUAL_VOLUME" AS "ACTUAL_VOLUME",
    "VOLUME_UOM_ID" AS "VOLUME_UOM_ID",
    "COMPUTED_VOLUME" AS "COMPUTED_VOLUME",
    "COMPUTED_VOLUME_UOM_ID" AS "COMPUTED_VOLUME_UOM_ID",
    "APPROVED_VOLUME" AS "APPROVED_VOLUME",
    "APPROVED_VOLUME_UOM_ID" AS "APPROVED_VOLUME_UOM_ID",
    "VOLUME_UOM" AS "VOLUME_UOM",
    "WEIGHT_UOM" AS "WEIGHT_UOM",
    "INV_OBJ_GRS_AMT_DUE_CURR_CODE" AS "INV_OBJ_GRS_AMT_DUE_CURR_CODE",
    "INV_OBJ_TAX_AM_DUE_CURR_CODE" AS "INV_OBJ_TAX_AM_DUE_CURR_CODE",
    "INV_OBJ_TAX_AMT_DUE" AS "INV_OBJ_TAX_AMT_DUE",
    "INV_OBJ_GRS_AMT_DUE" AS "INV_OBJ_GRS_AMT_DUE",
    "TRACKING_NUMBER" AS "TRACKING_NUMBER",
    "LENGTH" AS "LENGTH",
    "WIDTH" AS "WIDTH",
    "HEIGHT" AS "HEIGHT",
    "ADJ_RATE" AS "ADJ_RATE",
    "COMPUTED_ADJ_RATE" AS "COMPUTED_ADJ_RATE",
    "APPROVED_ADJ_RATE" AS "APPROVED_ADJ_RATE",
    "ADJ_LH_COST" AS "ADJ_LH_COST",
    "COMPUTED_ADJ_LH_COST" AS "COMPUTED_ADJ_LH_COST",
    "APPROVED_ADJ_LH_COST" AS "APPROVED_ADJ_LH_COST",
    "ENTRY_TYPE" AS "ENTRY_TYPE",
    "PICKUP_NUMBER" AS "PICKUP_NUMBER",
    "MONETARY_VALUE" AS "MONETARY_VALUE",
    "MONETARY_VALUE_CURRENCY_CODE" AS "MONETARY_VALUE_CURRENCY_CODE",
    "MANIFEST_TYPE" AS "MANIFEST_TYPE",
    "NON_MACHINABLE" AS "NON_MACHINABLE",
    "LENGTH_UOM_ID" AS "LENGTH_UOM_ID",
    "RATING_LEVEL" AS "RATING_LEVEL",
    "WIDTH_UOM_ID" AS "WIDTH_UOM_ID",
    "HEIGHT_UOM_ID" AS "HEIGHT_UOM_ID",
    "MARK_FOR_DELETION" AS "MARK_FOR_DELETION",
    "BILLING_METHOD" AS "BILLING_METHOD",
    "LAST_UPDATED_SOURCE_TYPE" AS "LAST_UPDATED_SOURCE_TYPE",
    "UNAPPLIED_SPOT_COST" AS "UNAPPLIED_SPOT_COST",
    "UNAPPLIED_SPOT_CURRENCY_CODE" AS "UNAPPLIED_SPOT_CURRENCY_CODE",
    "APPROVED_SPOT_COST" AS "APPROVED_SPOT_COST",
    "INVOICE_DTL_ID" AS "INVOICE_DTL_ID",
    "VESSEL_NUMBER" AS "VESSEL_NUMBER",
    "VOYAGE_FLIGHT_NUMBER" AS "VOYAGE_FLIGHT_NUMBER",
    "BOOKING_TYPE" AS "BOOKING_TYPE",
    "PRO_NUMBER" AS "PRO_NUMBER",
    "TRAILER_NUMBER" AS "TRAILER_NUMBER",
    "COMMODITY_CODE_ID" AS "COMMODITY_CODE_ID",
    "UNAPPLIED_TOTAL_BALANCE" AS "UNAPPLIED_TOTAL_BALANCE",
    "APPROVED_TOTAL_BALANCE" AS "APPROVED_TOTAL_BALANCE",
    "CDC_TIMESTAMP" AS "CDC_TIMESTAMP",
    "OPERATION_TYPE" AS "OPERATION_TYPE",
    "ARCHIVED_DTTM" AS "ARCHIVED_DTTM",
    "INVOICE_DT" AS "INVOICE_DT",
    "invoice_date_parsed" AS "invoice_date_parsed",
    "NUM_REJECTIONS" AS "NUM_REJECTIONS",
    "TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID",
    "DELIVERY_START_DTTM" AS "DELIVERY_START_DTTM",
    "delivery_date_parsed" AS "delivery_date_parsed",
    "DELIVERY_END_DTTM" AS "DELIVERY_END_DTTM",
    "ORIGIN" AS "ORIGIN",
    "FINAL_DESTINATION" AS "FINAL_DESTINATION",
    "actual_delivery_date_parsed" AS "actual_delivery_date_parsed",
    "VENDOR_ID" AS "VENDOR_ID",
    "VENDOR_NAME" AS "VENDOR_NAME",
    "flag_wood_pellet_combined" AS "flag_wood_pellet_combined",
    "cal_MERCH_YEAR" AS "cal_MERCH_YEAR",
    "cal_YEAR_WEEK" AS "cal_YEAR_WEEK",
    "cal_YEAR_QUARTER" AS "cal_YEAR_QUARTER",
    "cal_YEAR_PERIOD" AS "cal_YEAR_PERIOD",
    "del_MERCH_YEAR" AS "del_MERCH_YEAR",
    "del_YEAR_WEEK" AS "del_YEAR_WEEK",
    "del_YEAR_QUARTER" AS "del_YEAR_QUARTER",
    "del_YEAR_PERIOD" AS "del_YEAR_PERIOD",
    "act_del_MERCH_YEAR" AS "act_del_MERCH_YEAR",
    "act_del_YEAR_WEEK" AS "act_del_YEAR_WEEK",
    "act_del_YEAR_QUARTER" AS "act_del_YEAR_QUARTER",
    "act_del_YEAR_PERIOD" AS "act_del_YEAR_PERIOD",
    "TOTAL_COST" AS "TOTAL_COST",
    "org_Facility_Code" AS "org_Facility_Code",
    "org_Facility_Name" AS "org_Facility_Name",
    "org_Facility_Type" AS "org_Facility_Type",
    "dest_Facility_Code" AS "dest_Facility_Code",
    "dest_Facility_Name" AS "dest_Facility_Name",
    "dest_Facility_Type" AS "dest_Facility_Type",
    "inbound_flag" AS "inbound_flag"
  FROM (
    SELECT 
        "domestic_shipping_freight_w_facilities"."INV_ID" AS "INV_ID",
        "domestic_shipping_freight_w_facilities"."INV_OBJECT_ID" AS "INV_OBJECT_ID",
        "domestic_shipping_freight_w_facilities"."TC_COMPANY_ID" AS "TC_COMPANY_ID",
        "domestic_shipping_freight_w_facilities"."TC_OBJECT_ID" AS "TC_OBJECT_ID",
        "domestic_shipping_freight_w_facilities"."INV_OBJECT_STATUS" AS "INV_OBJECT_STATUS",
        "domestic_shipping_freight_w_facilities"."O_NAME" AS "O_NAME",
        "domestic_shipping_freight_w_facilities"."O_ADDRESS" AS "O_ADDRESS",
        "domestic_shipping_freight_w_facilities"."O_CITY" AS "O_CITY",
        "domestic_shipping_freight_w_facilities"."O_COUNTY" AS "O_COUNTY",
        "domestic_shipping_freight_w_facilities"."O_STATE_PROV" AS "O_STATE_PROV",
        "domestic_shipping_freight_w_facilities"."O_POSTAL_CODE" AS "O_POSTAL_CODE",
        "domestic_shipping_freight_w_facilities"."O_COUNTRY_CODE" AS "O_COUNTRY_CODE",
        "domestic_shipping_freight_w_facilities"."D_NAME" AS "D_NAME",
        "domestic_shipping_freight_w_facilities"."D_ADDRESS" AS "D_ADDRESS",
        "domestic_shipping_freight_w_facilities"."D_CITY" AS "D_CITY",
        "domestic_shipping_freight_w_facilities"."D_COUNTY" AS "D_COUNTY",
        "domestic_shipping_freight_w_facilities"."D_STATE_PROV" AS "D_STATE_PROV",
        "domestic_shipping_freight_w_facilities"."D_POSTAL_CODE" AS "D_POSTAL_CODE",
        "domestic_shipping_freight_w_facilities"."D_COUNTRY_CODE" AS "D_COUNTRY_CODE",
        "domestic_shipping_freight_w_facilities"."MOT_DESC" AS "MOT_DESC",
        "domestic_shipping_freight_w_facilities"."EQUIPMENT_DESC" AS "EQUIPMENT_DESC",
        "domestic_shipping_freight_w_facilities"."SERVICE_LEVEL_DESC" AS "SERVICE_LEVEL_DESC",
        "domestic_shipping_freight_w_facilities"."PROTECTION_LEVEL_DESC" AS "PROTECTION_LEVEL_DESC",
        "domestic_shipping_freight_w_facilities"."FINANCIAL_WEIGHT" AS "FINANCIAL_WEIGHT",
        "domestic_shipping_freight_w_facilities"."ACTUAL_WEIGHT" AS "ACTUAL_WEIGHT",
        "domestic_shipping_freight_w_facilities"."LH_COST" AS "LH_COST",
        "domestic_shipping_freight_w_facilities"."DISTANCE" AS "DISTANCE",
        "domestic_shipping_freight_w_facilities"."DISTANCE_UOM" AS "DISTANCE_UOM",
        "domestic_shipping_freight_w_facilities"."BILL_OF_LADING_NUMBER" AS "BILL_OF_LADING_NUMBER",
        "domestic_shipping_freight_w_facilities"."PO_NUMBER" AS "PO_NUMBER",
        "domestic_shipping_freight_w_facilities"."SPEC_HANDLING_METHOD" AS "SPEC_HANDLING_METHOD",
        "domestic_shipping_freight_w_facilities"."COMMENTS" AS "COMMENTS",
        "domestic_shipping_freight_w_facilities"."HAS_IMPORT_ERROR" AS "HAS_IMPORT_ERROR",
        "domestic_shipping_freight_w_facilities"."HAS_WARNING" AS "HAS_WARNING",
        "domestic_shipping_freight_w_facilities"."IS_VALID" AS "IS_VALID",
        "domestic_shipping_freight_w_facilities"."CREATED_SOURCE_TYPE" AS "CREATED_SOURCE_TYPE",
        "domestic_shipping_freight_w_facilities"."CREATED_SOURCE" AS "CREATED_SOURCE",
        "domestic_shipping_freight_w_facilities"."CREATED_DTTM" AS "CREATED_DTTM",
        "domestic_shipping_freight_w_facilities"."LAST_UPDATED_SOURCE" AS "LAST_UPDATED_SOURCE",
        "domestic_shipping_freight_w_facilities"."LAST_UPDATED_DTTM" AS "LAST_UPDATED_DTTM",
        "domestic_shipping_freight_w_facilities"."STOP_COST" AS "STOP_COST",
        "domestic_shipping_freight_w_facilities"."AUXILARY_DATA" AS "AUXILARY_DATA",
        "domestic_shipping_freight_w_facilities"."PICKUP_DTTM" AS "PICKUP_DTTM",
        "domestic_shipping_freight_w_facilities"."DELIVERY_DTTM" AS "DELIVERY_DTTM",
        "domestic_shipping_freight_w_facilities"."CURRENCY_CODE" AS "CURRENCY_CODE",
        "domestic_shipping_freight_w_facilities"."LH_CURRENCY_CODE" AS "LH_CURRENCY_CODE",
        "domestic_shipping_freight_w_facilities"."STOP_CURRENCY_CODE" AS "STOP_CURRENCY_CODE",
        "domestic_shipping_freight_w_facilities"."SPOT_CHARGE_COST" AS "SPOT_CHARGE_COST",
        "domestic_shipping_freight_w_facilities"."SPOT_CHARGE_CURRENCY_CODE" AS "SPOT_CHARGE_CURRENCY_CODE",
        "domestic_shipping_freight_w_facilities"."ASSIGNED_CARRIER_CODE" AS "ASSIGNED_CARRIER_CODE",
        "domestic_shipping_freight_w_facilities"."NUM_PICKUPS" AS "NUM_PICKUPS",
        "domestic_shipping_freight_w_facilities"."NUM_DELIVERIES" AS "NUM_DELIVERIES",
        "domestic_shipping_freight_w_facilities"."RATE" AS "RATE",
        "domestic_shipping_freight_w_facilities"."RATE_CALC_METHOD" AS "RATE_CALC_METHOD",
        "domestic_shipping_freight_w_facilities"."RATE_UOM" AS "RATE_UOM",
        "domestic_shipping_freight_w_facilities"."TPE_OBJECT_ID" AS "TPE_OBJECT_ID",
        "domestic_shipping_freight_w_facilities"."O_FACILITY_ID" AS "O_FACILITY_ID",
        "domestic_shipping_freight_w_facilities"."D_FACILITY_ID" AS "D_FACILITY_ID",
        "domestic_shipping_freight_w_facilities"."TP_COMPANY_ID" AS "TP_COMPANY_ID",
        "domestic_shipping_freight_w_facilities"."PACKAGE_TYPE_ID" AS "PACKAGE_TYPE_ID",
        "domestic_shipping_freight_w_facilities"."COMPUTED_RATE" AS "COMPUTED_RATE",
        "domestic_shipping_freight_w_facilities"."COMPUTED_RATE_UOM" AS "COMPUTED_RATE_UOM",
        "domestic_shipping_freight_w_facilities"."COMPUTED_RATE_CALC_METHOD" AS "COMPUTED_RATE_CALC_METHOD",
        "domestic_shipping_freight_w_facilities"."COMPUTED_TOTAL_COST" AS "COMPUTED_TOTAL_COST",
        "domestic_shipping_freight_w_facilities"."COMPUTED_TOTAL_COST_CURR_CODE" AS "COMPUTED_TOTAL_COST_CURR_CODE",
        "domestic_shipping_freight_w_facilities"."O_FACILITY_NAME" AS "O_FACILITY_NAME",
        "domestic_shipping_freight_w_facilities"."D_FACILITY_NAME" AS "D_FACILITY_NAME",
        "domestic_shipping_freight_w_facilities"."COMPUTED_DISTANCE" AS "COMPUTED_DISTANCE",
        "domestic_shipping_freight_w_facilities"."COMPUTED_DISTANCE_UOM" AS "COMPUTED_DISTANCE_UOM",
        "domestic_shipping_freight_w_facilities"."COMPUTED_STOP_COST" AS "COMPUTED_STOP_COST",
        "domestic_shipping_freight_w_facilities"."COMPUTED_STOP_COST_CURR_CODE" AS "COMPUTED_STOP_COST_CURR_CODE",
        "domestic_shipping_freight_w_facilities"."APPROVED_DISTANCE" AS "APPROVED_DISTANCE",
        "domestic_shipping_freight_w_facilities"."APPROVED_LH_COST" AS "APPROVED_LH_COST",
        "domestic_shipping_freight_w_facilities"."APPROVED_RATE" AS "APPROVED_RATE",
        "domestic_shipping_freight_w_facilities"."APPROVED_FINANCIAL_WEIGHT" AS "APPROVED_FINANCIAL_WEIGHT",
        "domestic_shipping_freight_w_facilities"."APPROVED_ACTUAL_WEIGHT" AS "APPROVED_ACTUAL_WEIGHT",
        "domestic_shipping_freight_w_facilities"."RATE_ADJUSTMENT" AS "RATE_ADJUSTMENT",
        "domestic_shipping_freight_w_facilities"."MIN_CHARGE" AS "MIN_CHARGE",
        "domestic_shipping_freight_w_facilities"."COMPUTED_TARIFF" AS "COMPUTED_TARIFF",
        "domestic_shipping_freight_w_facilities"."COMPUTED_MIN_RATE" AS "COMPUTED_MIN_RATE",
        "domestic_shipping_freight_w_facilities"."UNDEFINED_ADJUSTMENT" AS "UNDEFINED_ADJUSTMENT",
        "domestic_shipping_freight_w_facilities"."DISCOUNT_AMOUNT" AS "DISCOUNT_AMOUNT",
        "domestic_shipping_freight_w_facilities"."UNDEFINED_ADJ_CURR_CODE" AS "UNDEFINED_ADJ_CURR_CODE",
        "domestic_shipping_freight_w_facilities"."DISCOUNT_AMT_CURR_CODE" AS "DISCOUNT_AMT_CURR_CODE",
        "domestic_shipping_freight_w_facilities"."RATE_CURR_CODE" AS "RATE_CURR_CODE",
        "domestic_shipping_freight_w_facilities"."CARRIER_ID" AS "CARRIER_ID",
        "domestic_shipping_freight_w_facilities"."ASSIGNED_CARRIER_ID" AS "ASSIGNED_CARRIER_ID",
        "domestic_shipping_freight_w_facilities"."EQUIPMENT_ID" AS "EQUIPMENT_ID",
        "domestic_shipping_freight_w_facilities"."MOT_ID" AS "MOT_ID",
        "domestic_shipping_freight_w_facilities"."PROTECTION_LEVEL_ID" AS "PROTECTION_LEVEL_ID",
        "domestic_shipping_freight_w_facilities"."SERVICE_LEVEL_ID" AS "SERVICE_LEVEL_ID",
        "domestic_shipping_freight_w_facilities"."UNDF_ADJ_CURR_CODE" AS "UNDF_ADJ_CURR_CODE",
        "domestic_shipping_freight_w_facilities"."COMPUTED_FINANCIAL_WEIGHT" AS "COMPUTED_FINANCIAL_WEIGHT",
        "domestic_shipping_freight_w_facilities"."ADJUSTMENT_AMOUNT" AS "ADJUSTMENT_AMOUNT",
        "domestic_shipping_freight_w_facilities"."APPROVED_ADJUSTMENT_AMOUNT" AS "APPROVED_ADJUSTMENT_AMOUNT",
        "domestic_shipping_freight_w_facilities"."APPROVED_STOP_COST" AS "APPROVED_STOP_COST",
        "domestic_shipping_freight_w_facilities"."APPROVED_RATE_ADJUSTMENT" AS "APPROVED_RATE_ADJUSTMENT",
        "domestic_shipping_freight_w_facilities"."APPROVED_RATE_CALC_METHOD" AS "APPROVED_RATE_CALC_METHOD",
        "domestic_shipping_freight_w_facilities"."APPROVED_RATE_UOM" AS "APPROVED_RATE_UOM",
        "domestic_shipping_freight_w_facilities"."APPROVED_DISTANCE_UOM" AS "APPROVED_DISTANCE_UOM",
        "domestic_shipping_freight_w_facilities"."COMPUTED_LH_COST" AS "COMPUTED_LH_COST",
        "domestic_shipping_freight_w_facilities"."COMPUTED_LH_COST_CURR_CODE" AS "COMPUTED_LH_COST_CURR_CODE",
        "domestic_shipping_freight_w_facilities"."WEIGHT_UOM_ID" AS "WEIGHT_UOM_ID",
        "domestic_shipping_freight_w_facilities"."APPROVED_WEIGHT_UOM_ID" AS "APPROVED_WEIGHT_UOM_ID",
        "domestic_shipping_freight_w_facilities"."INV_MIN_RATE" AS "INV_MIN_RATE",
        "domestic_shipping_freight_w_facilities"."SYS_MIN_RATE" AS "SYS_MIN_RATE",
        "domestic_shipping_freight_w_facilities"."UNAPPLIED_LH_COST" AS "UNAPPLIED_LH_COST",
        "domestic_shipping_freight_w_facilities"."UNAPPLIED_LH_CURRENCY_CODE" AS "UNAPPLIED_LH_CURRENCY_CODE",
        "domestic_shipping_freight_w_facilities"."UNAPPLIED_STOP_COST" AS "UNAPPLIED_STOP_COST",
        "domestic_shipping_freight_w_facilities"."UNAPPLIED_STOP_CURRENCY_CODE" AS "UNAPPLIED_STOP_CURRENCY_CODE",
        "domestic_shipping_freight_w_facilities"."ORG_SHIP_VIA_FACILITY_ID" AS "ORG_SHIP_VIA_FACILITY_ID",
        "domestic_shipping_freight_w_facilities"."ORG_SHIP_VIA_FACILITY_ALIAS_ID" AS "ORG_SHIP_VIA_FACILITY_ALIAS_ID",
        "domestic_shipping_freight_w_facilities"."DES_SHIP_VIA_FACILITY_ID" AS "DES_SHIP_VIA_FACILITY_ID",
        "domestic_shipping_freight_w_facilities"."DES_SHIP_VIA_FACILITY_ALIAS_ID" AS "DES_SHIP_VIA_FACILITY_ALIAS_ID",
        "domestic_shipping_freight_w_facilities"."INCOTERM_ID" AS "INCOTERM_ID",
        "domestic_shipping_freight_w_facilities"."SEC_CARRIER_ID" AS "SEC_CARRIER_ID",
        "domestic_shipping_freight_w_facilities"."COMMODITY_CLASS" AS "COMMODITY_CLASS",
        "domestic_shipping_freight_w_facilities"."ACTUAL_PAYMENT_AMOUNT" AS "ACTUAL_PAYMENT_AMOUNT",
        "domestic_shipping_freight_w_facilities"."ACTUAL_CURRENCY_CODE" AS "ACTUAL_CURRENCY_CODE",
        "domestic_shipping_freight_w_facilities"."NET_AMOUNT_CURRENCY_CODE" AS "NET_AMOUNT_CURRENCY_CODE",
        "domestic_shipping_freight_w_facilities"."NET_AMOUNT_DUE" AS "NET_AMOUNT_DUE",
        "domestic_shipping_freight_w_facilities"."NORMALIZED_NET_AMOUNT_DUE" AS "NORMALIZED_NET_AMOUNT_DUE",
        "domestic_shipping_freight_w_facilities"."REF_INV_OBJECT_PAID_AMOUNT" AS "REF_INV_OBJECT_PAID_AMOUNT",
        "domestic_shipping_freight_w_facilities"."REF_INV_OBJECT_PAID_AMOUNT_CC" AS "REF_INV_OBJECT_PAID_AMOUNT_CC",
        "domestic_shipping_freight_w_facilities"."REF_INV_OBJECT_AMOUNT" AS "REF_INV_OBJECT_AMOUNT",
        "domestic_shipping_freight_w_facilities"."REF_INV_OBJECT_AMOUNT_CC" AS "REF_INV_OBJECT_AMOUNT_CC",
        "domestic_shipping_freight_w_facilities"."REF_INVOICED_OBJECT_ID" AS "REF_INVOICED_OBJECT_ID",
        "domestic_shipping_freight_w_facilities"."INCOTERM_CODE" AS "INCOTERM_CODE",
        "domestic_shipping_freight_w_facilities"."ACTUAL_VOLUME" AS "ACTUAL_VOLUME",
        "domestic_shipping_freight_w_facilities"."VOLUME_UOM_ID" AS "VOLUME_UOM_ID",
        "domestic_shipping_freight_w_facilities"."COMPUTED_VOLUME" AS "COMPUTED_VOLUME",
        "domestic_shipping_freight_w_facilities"."COMPUTED_VOLUME_UOM_ID" AS "COMPUTED_VOLUME_UOM_ID",
        "domestic_shipping_freight_w_facilities"."APPROVED_VOLUME" AS "APPROVED_VOLUME",
        "domestic_shipping_freight_w_facilities"."APPROVED_VOLUME_UOM_ID" AS "APPROVED_VOLUME_UOM_ID",
        "domestic_shipping_freight_w_facilities"."VOLUME_UOM" AS "VOLUME_UOM",
        "domestic_shipping_freight_w_facilities"."WEIGHT_UOM" AS "WEIGHT_UOM",
        "domestic_shipping_freight_w_facilities"."INV_OBJ_GRS_AMT_DUE_CURR_CODE" AS "INV_OBJ_GRS_AMT_DUE_CURR_CODE",
        "domestic_shipping_freight_w_facilities"."INV_OBJ_TAX_AM_DUE_CURR_CODE" AS "INV_OBJ_TAX_AM_DUE_CURR_CODE",
        "domestic_shipping_freight_w_facilities"."INV_OBJ_TAX_AMT_DUE" AS "INV_OBJ_TAX_AMT_DUE",
        "domestic_shipping_freight_w_facilities"."INV_OBJ_GRS_AMT_DUE" AS "INV_OBJ_GRS_AMT_DUE",
        "domestic_shipping_freight_w_facilities"."TRACKING_NUMBER" AS "TRACKING_NUMBER",
        "domestic_shipping_freight_w_facilities"."LENGTH" AS "LENGTH",
        "domestic_shipping_freight_w_facilities"."WIDTH" AS "WIDTH",
        "domestic_shipping_freight_w_facilities"."HEIGHT" AS "HEIGHT",
        "domestic_shipping_freight_w_facilities"."ADJ_RATE" AS "ADJ_RATE",
        "domestic_shipping_freight_w_facilities"."COMPUTED_ADJ_RATE" AS "COMPUTED_ADJ_RATE",
        "domestic_shipping_freight_w_facilities"."APPROVED_ADJ_RATE" AS "APPROVED_ADJ_RATE",
        "domestic_shipping_freight_w_facilities"."ADJ_LH_COST" AS "ADJ_LH_COST",
        "domestic_shipping_freight_w_facilities"."COMPUTED_ADJ_LH_COST" AS "COMPUTED_ADJ_LH_COST",
        "domestic_shipping_freight_w_facilities"."APPROVED_ADJ_LH_COST" AS "APPROVED_ADJ_LH_COST",
        "domestic_shipping_freight_w_facilities"."ENTRY_TYPE" AS "ENTRY_TYPE",
        "domestic_shipping_freight_w_facilities"."PICKUP_NUMBER" AS "PICKUP_NUMBER",
        "domestic_shipping_freight_w_facilities"."MONETARY_VALUE" AS "MONETARY_VALUE",
        "domestic_shipping_freight_w_facilities"."MONETARY_VALUE_CURRENCY_CODE" AS "MONETARY_VALUE_CURRENCY_CODE",
        "domestic_shipping_freight_w_facilities"."MANIFEST_TYPE" AS "MANIFEST_TYPE",
        "domestic_shipping_freight_w_facilities"."NON_MACHINABLE" AS "NON_MACHINABLE",
        "domestic_shipping_freight_w_facilities"."LENGTH_UOM_ID" AS "LENGTH_UOM_ID",
        "domestic_shipping_freight_w_facilities"."RATING_LEVEL" AS "RATING_LEVEL",
        "domestic_shipping_freight_w_facilities"."WIDTH_UOM_ID" AS "WIDTH_UOM_ID",
        "domestic_shipping_freight_w_facilities"."HEIGHT_UOM_ID" AS "HEIGHT_UOM_ID",
        "domestic_shipping_freight_w_facilities"."MARK_FOR_DELETION" AS "MARK_FOR_DELETION",
        "domestic_shipping_freight_w_facilities"."BILLING_METHOD" AS "BILLING_METHOD",
        "domestic_shipping_freight_w_facilities"."LAST_UPDATED_SOURCE_TYPE" AS "LAST_UPDATED_SOURCE_TYPE",
        "domestic_shipping_freight_w_facilities"."UNAPPLIED_SPOT_COST" AS "UNAPPLIED_SPOT_COST",
        "domestic_shipping_freight_w_facilities"."UNAPPLIED_SPOT_CURRENCY_CODE" AS "UNAPPLIED_SPOT_CURRENCY_CODE",
        "domestic_shipping_freight_w_facilities"."APPROVED_SPOT_COST" AS "APPROVED_SPOT_COST",
        "domestic_shipping_freight_w_facilities"."INVOICE_DTL_ID" AS "INVOICE_DTL_ID",
        "domestic_shipping_freight_w_facilities"."VESSEL_NUMBER" AS "VESSEL_NUMBER",
        "domestic_shipping_freight_w_facilities"."VOYAGE_FLIGHT_NUMBER" AS "VOYAGE_FLIGHT_NUMBER",
        "domestic_shipping_freight_w_facilities"."BOOKING_TYPE" AS "BOOKING_TYPE",
        "domestic_shipping_freight_w_facilities"."PRO_NUMBER" AS "PRO_NUMBER",
        "domestic_shipping_freight_w_facilities"."TRAILER_NUMBER" AS "TRAILER_NUMBER",
        "domestic_shipping_freight_w_facilities"."COMMODITY_CODE_ID" AS "COMMODITY_CODE_ID",
        "domestic_shipping_freight_w_facilities"."UNAPPLIED_TOTAL_BALANCE" AS "UNAPPLIED_TOTAL_BALANCE",
        "domestic_shipping_freight_w_facilities"."APPROVED_TOTAL_BALANCE" AS "APPROVED_TOTAL_BALANCE",
        "domestic_shipping_freight_w_facilities"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP",
        "domestic_shipping_freight_w_facilities"."OPERATION_TYPE" AS "OPERATION_TYPE",
        "domestic_shipping_freight_w_facilities"."ARCHIVED_DTTM" AS "ARCHIVED_DTTM",
        "domestic_shipping_freight_w_facilities"."INVOICE_DT" AS "INVOICE_DT",
        "domestic_shipping_freight_w_facilities"."invoice_date_parsed" AS "invoice_date_parsed",
        "domestic_shipping_freight_w_facilities"."NUM_REJECTIONS" AS "NUM_REJECTIONS",
        "domestic_shipping_freight_w_facilities"."TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID",
        "domestic_shipping_freight_w_facilities"."DELIVERY_START_DTTM" AS "DELIVERY_START_DTTM",
        "domestic_shipping_freight_w_facilities"."delivery_date_parsed" AS "delivery_date_parsed",
        "domestic_shipping_freight_w_facilities"."DELIVERY_END_DTTM" AS "DELIVERY_END_DTTM",
        "domestic_shipping_freight_w_facilities"."ORIGIN" AS "ORIGIN",
        "domestic_shipping_freight_w_facilities"."FINAL_DESTINATION" AS "FINAL_DESTINATION",
        "domestic_shipping_freight_w_facilities"."actual_delivery_date_parsed" AS "actual_delivery_date_parsed",
        "domestic_shipping_freight_w_facilities"."VENDOR_ID" AS "VENDOR_ID",
        "domestic_shipping_freight_w_facilities"."VENDOR_NAME" AS "VENDOR_NAME",
        "domestic_shipping_freight_w_facilities"."flag_wood_pellet_combined" AS "flag_wood_pellet_combined",
        "domestic_shipping_freight_w_facilities"."cal_MERCH_YEAR" AS "cal_MERCH_YEAR",
        "domestic_shipping_freight_w_facilities"."cal_YEAR_WEEK" AS "cal_YEAR_WEEK",
        "domestic_shipping_freight_w_facilities"."cal_YEAR_QUARTER" AS "cal_YEAR_QUARTER",
        "domestic_shipping_freight_w_facilities"."cal_YEAR_PERIOD" AS "cal_YEAR_PERIOD",
        "domestic_shipping_freight_w_facilities"."del_MERCH_YEAR" AS "del_MERCH_YEAR",
        "domestic_shipping_freight_w_facilities"."del_YEAR_WEEK" AS "del_YEAR_WEEK",
        "domestic_shipping_freight_w_facilities"."del_YEAR_QUARTER" AS "del_YEAR_QUARTER",
        "domestic_shipping_freight_w_facilities"."del_YEAR_PERIOD" AS "del_YEAR_PERIOD",
        "domestic_shipping_freight_w_facilities"."act_del_MERCH_YEAR" AS "act_del_MERCH_YEAR",
        "domestic_shipping_freight_w_facilities"."act_del_YEAR_WEEK" AS "act_del_YEAR_WEEK",
        "domestic_shipping_freight_w_facilities"."act_del_YEAR_QUARTER" AS "act_del_YEAR_QUARTER",
        "domestic_shipping_freight_w_facilities"."act_del_YEAR_PERIOD" AS "act_del_YEAR_PERIOD",
        "domestic_shipping_freight_w_facilities"."TOTAL_COST" AS "TOTAL_COST",
        "domestic_shipping_freight_w_facilities"."org_Facility_Code" AS "org_Facility_Code",
        "domestic_shipping_freight_w_facilities"."org_Facility_Name" AS "org_Facility_Name",
        "domestic_shipping_freight_w_facilities"."org_Facility_Type" AS "org_Facility_Type",
        "domestic_shipping_freight_w_facilities"."dest_Facility_Code" AS "dest_Facility_Code",
        "domestic_shipping_freight_w_facilities"."dest_Facility_Name" AS "dest_Facility_Name",
        "domestic_shipping_freight_w_facilities"."dest_Facility_Type" AS "dest_Facility_Type",
        "domestic_shipping_freight_w_facilities"."inbound_flag" AS "inbound_flag",
        "TENANT149_DATA_wood_pellet_vendors_w_number_by_VENDOR_ID_prepared"."wood_pellet" AS "wood_pellet",
        "wood_pellet_vendors_prepared_w_name"."wood_pellet_2" AS "wood_pellet_2",
        "wood_pellet_vendors_w_ids_prepared_by_vendor_id"."wood_pellet_3" AS "wood_pellet_3"
      FROM "DOMESTIC_SHIPPING_FREIGHT_W_FACILITIES" "domestic_shipping_freight_w_facilities"
      LEFT JOIN (
        SELECT 
            "VENDOR_ID" AS "VENDOR_ID",
            1 AS "wood_pellet"
          FROM (
            SELECT *
              FROM wood_pellet_vendors_w_number_by_vendor_id "TENANT149_DATA_wood_pellet_vendors_w_number_by_VENDOR_ID_prepared"
            ) "withoutcomputedcols_query"
        ) "TENANT149_DATA_wood_pellet_vendors_w_number_by_VENDOR_ID_prepared"
        ON "domestic_shipping_freight_w_facilities"."org_Facility_Code" = "TENANT149_DATA_wood_pellet_vendors_w_number_by_VENDOR_ID_prepared"."VENDOR_ID"
      LEFT JOIN (
        SELECT 
            "VENDOR_NAME" AS "VENDOR_NAME",
            1 AS "wood_pellet_2"
          FROM (
            SELECT *
              FROM "WOOD_PELLET_VENDORS_PREPARED_W_NAME" "wood_pellet_vendors_prepared_w_name"
            ) "withoutcomputedcols_query"
        ) "wood_pellet_vendors_prepared_w_name"
        ON "domestic_shipping_freight_w_facilities"."org_Facility_Name" = "wood_pellet_vendors_prepared_w_name"."VENDOR_NAME"
      LEFT JOIN (
        SELECT 
            "VENDOR_ID" AS "vendor_id",
            1 AS "wood_pellet_3"
          FROM (
            SELECT *
              FROM "WOOD_PELLET_VENDORS_W_IDS_PREPARED_BY_VENDOR_ID" "wood_pellet_vendors_w_ids_prepared_by_vendor_id"
            ) "withoutcomputedcols_query"
        ) "wood_pellet_vendors_w_ids_prepared_by_vendor_id"
        ON "domestic_shipping_freight_w_facilities"."ORIGIN" = "wood_pellet_vendors_w_ids_prepared_by_vendor_id"."vendor_id"
    ) "withoutcomputedcols_query"
      WHERE COALESCE("wood_pellet_3", "wood_pellet_2", "wood_pellet", 0) = 0
      AND ( ("inbound_flag" = 'Inbound') AND "org_Facility_Code" IS NOT NULL AND "dest_Facility_Code" IS NOT NULL)
)A 
LEFT JOIN "SC_TLM_ORDERS_PREPARED_BY_ORDER_ID_FILTER" B
    ON A."TC_SHIPMENT_ID" = B."TC_SHIPMENT_ID";

<br>
--DOMESTIC_SHIPPING_FREIGHT_PO_W_ARTICLE_JOINED
</br>

CREATE OR REPLACE TEMPORARY TABLE "DOMESTIC_SHIPPING_FREIGHT_PO_W_ARTICLE_JOINED"
AS
SELECT  DISTINCT 
    "domestic_shipping_freight_w_po_prep"."INV_ID" AS "INV_ID",
    "domestic_shipping_freight_w_po_prep"."INV_OBJECT_ID" AS "INV_OBJECT_ID",
    "domestic_shipping_freight_w_po_prep"."TC_COMPANY_ID" AS "TC_COMPANY_ID",
    "domestic_shipping_freight_w_po_prep"."TC_OBJECT_ID" AS "TC_OBJECT_ID",
    "domestic_shipping_freight_w_po_prep"."INV_OBJECT_STATUS" AS "INV_OBJECT_STATUS",
    "domestic_shipping_freight_w_po_prep"."O_NAME" AS "O_NAME",
    "domestic_shipping_freight_w_po_prep"."O_ADDRESS" AS "O_ADDRESS",
    "domestic_shipping_freight_w_po_prep"."O_CITY" AS "O_CITY",
    "domestic_shipping_freight_w_po_prep"."O_COUNTY" AS "O_COUNTY",
    "domestic_shipping_freight_w_po_prep"."O_STATE_PROV" AS "O_STATE_PROV",
    "domestic_shipping_freight_w_po_prep"."O_POSTAL_CODE" AS "O_POSTAL_CODE",
    "domestic_shipping_freight_w_po_prep"."O_COUNTRY_CODE" AS "O_COUNTRY_CODE",
    "domestic_shipping_freight_w_po_prep"."D_NAME" AS "D_NAME",
    "domestic_shipping_freight_w_po_prep"."D_ADDRESS" AS "D_ADDRESS",
    "domestic_shipping_freight_w_po_prep"."D_CITY" AS "D_CITY",
    "domestic_shipping_freight_w_po_prep"."D_COUNTY" AS "D_COUNTY",
    "domestic_shipping_freight_w_po_prep"."D_STATE_PROV" AS "D_STATE_PROV",
    "domestic_shipping_freight_w_po_prep"."D_POSTAL_CODE" AS "D_POSTAL_CODE",
    "domestic_shipping_freight_w_po_prep"."D_COUNTRY_CODE" AS "D_COUNTRY_CODE",
    "domestic_shipping_freight_w_po_prep"."MOT_DESC" AS "MOT_DESC",
    "domestic_shipping_freight_w_po_prep"."EQUIPMENT_DESC" AS "EQUIPMENT_DESC",
    "domestic_shipping_freight_w_po_prep"."SERVICE_LEVEL_DESC" AS "SERVICE_LEVEL_DESC",
    "domestic_shipping_freight_w_po_prep"."PROTECTION_LEVEL_DESC" AS "PROTECTION_LEVEL_DESC",
    "domestic_shipping_freight_w_po_prep"."FINANCIAL_WEIGHT" AS "FINANCIAL_WEIGHT",
    "domestic_shipping_freight_w_po_prep"."ACTUAL_WEIGHT" AS "ACTUAL_WEIGHT",
    "domestic_shipping_freight_w_po_prep"."TOTAL_COST" AS "TOTAL_COST",
    "domestic_shipping_freight_w_po_prep"."LH_COST" AS "LH_COST",
    "domestic_shipping_freight_w_po_prep"."DISTANCE" AS "DISTANCE",
    "domestic_shipping_freight_w_po_prep"."DISTANCE_UOM" AS "DISTANCE_UOM",
    "domestic_shipping_freight_w_po_prep"."BILL_OF_LADING_NUMBER" AS "BILL_OF_LADING_NUMBER",
    "domestic_shipping_freight_w_po_prep"."PO_NUMBER" AS "PO_NUMBER",
    "domestic_shipping_freight_w_po_prep"."SPEC_HANDLING_METHOD" AS "SPEC_HANDLING_METHOD",
    "domestic_shipping_freight_w_po_prep"."COMMENTS" AS "COMMENTS",
    "domestic_shipping_freight_w_po_prep"."HAS_IMPORT_ERROR" AS "HAS_IMPORT_ERROR",
    "domestic_shipping_freight_w_po_prep"."HAS_WARNING" AS "HAS_WARNING",
    "domestic_shipping_freight_w_po_prep"."IS_VALID" AS "IS_VALID",
    "domestic_shipping_freight_w_po_prep"."CREATED_SOURCE_TYPE" AS "CREATED_SOURCE_TYPE",
    "domestic_shipping_freight_w_po_prep"."CREATED_SOURCE" AS "CREATED_SOURCE",
    "domestic_shipping_freight_w_po_prep"."CREATED_DTTM" AS "CREATED_DTTM",
    "domestic_shipping_freight_w_po_prep"."LAST_UPDATED_SOURCE" AS "LAST_UPDATED_SOURCE",
    "domestic_shipping_freight_w_po_prep"."LAST_UPDATED_DTTM" AS "LAST_UPDATED_DTTM",
    "domestic_shipping_freight_w_po_prep"."STOP_COST" AS "STOP_COST",
    "domestic_shipping_freight_w_po_prep"."AUXILARY_DATA" AS "AUXILARY_DATA",
    "domestic_shipping_freight_w_po_prep"."PICKUP_DTTM" AS "PICKUP_DTTM",
    "domestic_shipping_freight_w_po_prep"."DELIVERY_DTTM" AS "DELIVERY_DTTM",
    "domestic_shipping_freight_w_po_prep"."CURRENCY_CODE" AS "CURRENCY_CODE",
    "domestic_shipping_freight_w_po_prep"."LH_CURRENCY_CODE" AS "LH_CURRENCY_CODE",
    "domestic_shipping_freight_w_po_prep"."STOP_CURRENCY_CODE" AS "STOP_CURRENCY_CODE",
    "domestic_shipping_freight_w_po_prep"."SPOT_CHARGE_COST" AS "SPOT_CHARGE_COST",
    "domestic_shipping_freight_w_po_prep"."SPOT_CHARGE_CURRENCY_CODE" AS "SPOT_CHARGE_CURRENCY_CODE",
    "domestic_shipping_freight_w_po_prep"."ASSIGNED_CARRIER_CODE" AS "ASSIGNED_CARRIER_CODE",
    "domestic_shipping_freight_w_po_prep"."NUM_PICKUPS" AS "NUM_PICKUPS",
    "domestic_shipping_freight_w_po_prep"."NUM_DELIVERIES" AS "NUM_DELIVERIES",
    "domestic_shipping_freight_w_po_prep"."RATE" AS "RATE",
    "domestic_shipping_freight_w_po_prep"."RATE_CALC_METHOD" AS "RATE_CALC_METHOD",
    "domestic_shipping_freight_w_po_prep"."RATE_UOM" AS "RATE_UOM",
    "domestic_shipping_freight_w_po_prep"."TPE_OBJECT_ID" AS "TPE_OBJECT_ID",
    "domestic_shipping_freight_w_po_prep"."O_FACILITY_ID" AS "O_FACILITY_ID",
    "domestic_shipping_freight_w_po_prep"."D_FACILITY_ID" AS "D_FACILITY_ID",
    "domestic_shipping_freight_w_po_prep"."TP_COMPANY_ID" AS "TP_COMPANY_ID",
    "domestic_shipping_freight_w_po_prep"."PACKAGE_TYPE_ID" AS "PACKAGE_TYPE_ID",
    "domestic_shipping_freight_w_po_prep"."COMPUTED_RATE" AS "COMPUTED_RATE",
    "domestic_shipping_freight_w_po_prep"."COMPUTED_RATE_UOM" AS "COMPUTED_RATE_UOM",
    "domestic_shipping_freight_w_po_prep"."COMPUTED_RATE_CALC_METHOD" AS "COMPUTED_RATE_CALC_METHOD",
    "domestic_shipping_freight_w_po_prep"."COMPUTED_TOTAL_COST" AS "COMPUTED_TOTAL_COST",
    "domestic_shipping_freight_w_po_prep"."COMPUTED_TOTAL_COST_CURR_CODE" AS "COMPUTED_TOTAL_COST_CURR_CODE",
    "domestic_shipping_freight_w_po_prep"."O_FACILITY_NAME" AS "O_FACILITY_NAME",
    "domestic_shipping_freight_w_po_prep"."D_FACILITY_NAME" AS "D_FACILITY_NAME",
    "domestic_shipping_freight_w_po_prep"."COMPUTED_DISTANCE" AS "COMPUTED_DISTANCE",
    "domestic_shipping_freight_w_po_prep"."COMPUTED_DISTANCE_UOM" AS "COMPUTED_DISTANCE_UOM",
    "domestic_shipping_freight_w_po_prep"."COMPUTED_STOP_COST" AS "COMPUTED_STOP_COST",
    "domestic_shipping_freight_w_po_prep"."COMPUTED_STOP_COST_CURR_CODE" AS "COMPUTED_STOP_COST_CURR_CODE",
    "domestic_shipping_freight_w_po_prep"."APPROVED_DISTANCE" AS "APPROVED_DISTANCE",
    "domestic_shipping_freight_w_po_prep"."APPROVED_LH_COST" AS "APPROVED_LH_COST",
    "domestic_shipping_freight_w_po_prep"."APPROVED_RATE" AS "APPROVED_RATE",
    "domestic_shipping_freight_w_po_prep"."APPROVED_FINANCIAL_WEIGHT" AS "APPROVED_FINANCIAL_WEIGHT",
    "domestic_shipping_freight_w_po_prep"."APPROVED_ACTUAL_WEIGHT" AS "APPROVED_ACTUAL_WEIGHT",
    "domestic_shipping_freight_w_po_prep"."RATE_ADJUSTMENT" AS "RATE_ADJUSTMENT",
    "domestic_shipping_freight_w_po_prep"."MIN_CHARGE" AS "MIN_CHARGE",
    "domestic_shipping_freight_w_po_prep"."COMPUTED_TARIFF" AS "COMPUTED_TARIFF",
    "domestic_shipping_freight_w_po_prep"."COMPUTED_MIN_RATE" AS "COMPUTED_MIN_RATE",
    "domestic_shipping_freight_w_po_prep"."UNDEFINED_ADJUSTMENT" AS "UNDEFINED_ADJUSTMENT",
    "domestic_shipping_freight_w_po_prep"."DISCOUNT_AMOUNT" AS "DISCOUNT_AMOUNT",
    "domestic_shipping_freight_w_po_prep"."UNDEFINED_ADJ_CURR_CODE" AS "UNDEFINED_ADJ_CURR_CODE",
    "domestic_shipping_freight_w_po_prep"."DISCOUNT_AMT_CURR_CODE" AS "DISCOUNT_AMT_CURR_CODE",
    "domestic_shipping_freight_w_po_prep"."RATE_CURR_CODE" AS "RATE_CURR_CODE",
    "domestic_shipping_freight_w_po_prep"."CARRIER_ID" AS "CARRIER_ID",
    "domestic_shipping_freight_w_po_prep"."ASSIGNED_CARRIER_ID" AS "ASSIGNED_CARRIER_ID",
    "domestic_shipping_freight_w_po_prep"."EQUIPMENT_ID" AS "EQUIPMENT_ID",
    "domestic_shipping_freight_w_po_prep"."MOT_ID" AS "MOT_ID",
    "domestic_shipping_freight_w_po_prep"."PROTECTION_LEVEL_ID" AS "PROTECTION_LEVEL_ID",
    "domestic_shipping_freight_w_po_prep"."SERVICE_LEVEL_ID" AS "SERVICE_LEVEL_ID",
    "domestic_shipping_freight_w_po_prep"."UNDF_ADJ_CURR_CODE" AS "UNDF_ADJ_CURR_CODE",
    "domestic_shipping_freight_w_po_prep"."COMPUTED_FINANCIAL_WEIGHT" AS "COMPUTED_FINANCIAL_WEIGHT",
    "domestic_shipping_freight_w_po_prep"."ADJUSTMENT_AMOUNT" AS "ADJUSTMENT_AMOUNT",
    "domestic_shipping_freight_w_po_prep"."APPROVED_ADJUSTMENT_AMOUNT" AS "APPROVED_ADJUSTMENT_AMOUNT",
    "domestic_shipping_freight_w_po_prep"."APPROVED_STOP_COST" AS "APPROVED_STOP_COST",
    "domestic_shipping_freight_w_po_prep"."APPROVED_RATE_ADJUSTMENT" AS "APPROVED_RATE_ADJUSTMENT",
    "domestic_shipping_freight_w_po_prep"."APPROVED_RATE_CALC_METHOD" AS "APPROVED_RATE_CALC_METHOD",
    "domestic_shipping_freight_w_po_prep"."APPROVED_RATE_UOM" AS "APPROVED_RATE_UOM",
    "domestic_shipping_freight_w_po_prep"."APPROVED_DISTANCE_UOM" AS "APPROVED_DISTANCE_UOM",
    "domestic_shipping_freight_w_po_prep"."COMPUTED_LH_COST" AS "COMPUTED_LH_COST",
    "domestic_shipping_freight_w_po_prep"."COMPUTED_LH_COST_CURR_CODE" AS "COMPUTED_LH_COST_CURR_CODE",
    "domestic_shipping_freight_w_po_prep"."WEIGHT_UOM_ID" AS "WEIGHT_UOM_ID",
    "domestic_shipping_freight_w_po_prep"."APPROVED_WEIGHT_UOM_ID" AS "APPROVED_WEIGHT_UOM_ID",
    "domestic_shipping_freight_w_po_prep"."INV_MIN_RATE" AS "INV_MIN_RATE",
    "domestic_shipping_freight_w_po_prep"."SYS_MIN_RATE" AS "SYS_MIN_RATE",
    "domestic_shipping_freight_w_po_prep"."UNAPPLIED_LH_COST" AS "UNAPPLIED_LH_COST",
    "domestic_shipping_freight_w_po_prep"."UNAPPLIED_LH_CURRENCY_CODE" AS "UNAPPLIED_LH_CURRENCY_CODE",
    "domestic_shipping_freight_w_po_prep"."UNAPPLIED_STOP_COST" AS "UNAPPLIED_STOP_COST",
    "domestic_shipping_freight_w_po_prep"."UNAPPLIED_STOP_CURRENCY_CODE" AS "UNAPPLIED_STOP_CURRENCY_CODE",
    "domestic_shipping_freight_w_po_prep"."ORG_SHIP_VIA_FACILITY_ID" AS "ORG_SHIP_VIA_FACILITY_ID",
    "domestic_shipping_freight_w_po_prep"."ORG_SHIP_VIA_FACILITY_ALIAS_ID" AS "ORG_SHIP_VIA_FACILITY_ALIAS_ID",
    "domestic_shipping_freight_w_po_prep"."DES_SHIP_VIA_FACILITY_ID" AS "DES_SHIP_VIA_FACILITY_ID",
    "domestic_shipping_freight_w_po_prep"."DES_SHIP_VIA_FACILITY_ALIAS_ID" AS "DES_SHIP_VIA_FACILITY_ALIAS_ID",
    "domestic_shipping_freight_w_po_prep"."INCOTERM_ID" AS "INCOTERM_ID",
    "domestic_shipping_freight_w_po_prep"."SEC_CARRIER_ID" AS "SEC_CARRIER_ID",
    "domestic_shipping_freight_w_po_prep"."COMMODITY_CLASS" AS "COMMODITY_CLASS",
    "domestic_shipping_freight_w_po_prep"."ACTUAL_PAYMENT_AMOUNT" AS "ACTUAL_PAYMENT_AMOUNT",
    "domestic_shipping_freight_w_po_prep"."ACTUAL_CURRENCY_CODE" AS "ACTUAL_CURRENCY_CODE",
    "domestic_shipping_freight_w_po_prep"."NET_AMOUNT_CURRENCY_CODE" AS "NET_AMOUNT_CURRENCY_CODE",
    "domestic_shipping_freight_w_po_prep"."NET_AMOUNT_DUE" AS "NET_AMOUNT_DUE",
    "domestic_shipping_freight_w_po_prep"."NORMALIZED_NET_AMOUNT_DUE" AS "NORMALIZED_NET_AMOUNT_DUE",
    "domestic_shipping_freight_w_po_prep"."REF_INV_OBJECT_PAID_AMOUNT" AS "REF_INV_OBJECT_PAID_AMOUNT",
    "domestic_shipping_freight_w_po_prep"."REF_INV_OBJECT_PAID_AMOUNT_CC" AS "REF_INV_OBJECT_PAID_AMOUNT_CC",
    "domestic_shipping_freight_w_po_prep"."REF_INV_OBJECT_AMOUNT" AS "REF_INV_OBJECT_AMOUNT",
    "domestic_shipping_freight_w_po_prep"."REF_INV_OBJECT_AMOUNT_CC" AS "REF_INV_OBJECT_AMOUNT_CC",
    "domestic_shipping_freight_w_po_prep"."REF_INVOICED_OBJECT_ID" AS "REF_INVOICED_OBJECT_ID",
    "domestic_shipping_freight_w_po_prep"."INCOTERM_CODE" AS "INCOTERM_CODE",
    "domestic_shipping_freight_w_po_prep"."ACTUAL_VOLUME" AS "ACTUAL_VOLUME",
    "domestic_shipping_freight_w_po_prep"."VOLUME_UOM_ID" AS "VOLUME_UOM_ID",
    "domestic_shipping_freight_w_po_prep"."COMPUTED_VOLUME" AS "COMPUTED_VOLUME",
    "domestic_shipping_freight_w_po_prep"."COMPUTED_VOLUME_UOM_ID" AS "COMPUTED_VOLUME_UOM_ID",
    "domestic_shipping_freight_w_po_prep"."APPROVED_VOLUME" AS "APPROVED_VOLUME",
    "domestic_shipping_freight_w_po_prep"."APPROVED_VOLUME_UOM_ID" AS "APPROVED_VOLUME_UOM_ID",
    "domestic_shipping_freight_w_po_prep"."VOLUME_UOM" AS "VOLUME_UOM",
    "domestic_shipping_freight_w_po_prep"."WEIGHT_UOM" AS "WEIGHT_UOM",
    "domestic_shipping_freight_w_po_prep"."INV_OBJ_GRS_AMT_DUE_CURR_CODE" AS "INV_OBJ_GRS_AMT_DUE_CURR_CODE",
    "domestic_shipping_freight_w_po_prep"."INV_OBJ_TAX_AM_DUE_CURR_CODE" AS "INV_OBJ_TAX_AM_DUE_CURR_CODE",
    "domestic_shipping_freight_w_po_prep"."INV_OBJ_TAX_AMT_DUE" AS "INV_OBJ_TAX_AMT_DUE",
    "domestic_shipping_freight_w_po_prep"."INV_OBJ_GRS_AMT_DUE" AS "INV_OBJ_GRS_AMT_DUE",
    "domestic_shipping_freight_w_po_prep"."TRACKING_NUMBER" AS "TRACKING_NUMBER",
    "domestic_shipping_freight_w_po_prep"."LENGTH" AS "LENGTH",
    "domestic_shipping_freight_w_po_prep"."WIDTH" AS "WIDTH",
    "domestic_shipping_freight_w_po_prep"."HEIGHT" AS "HEIGHT",
    "domestic_shipping_freight_w_po_prep"."ADJ_RATE" AS "ADJ_RATE",
    "domestic_shipping_freight_w_po_prep"."COMPUTED_ADJ_RATE" AS "COMPUTED_ADJ_RATE",
    "domestic_shipping_freight_w_po_prep"."APPROVED_ADJ_RATE" AS "APPROVED_ADJ_RATE",
    "domestic_shipping_freight_w_po_prep"."ADJ_LH_COST" AS "ADJ_LH_COST",
    "domestic_shipping_freight_w_po_prep"."COMPUTED_ADJ_LH_COST" AS "COMPUTED_ADJ_LH_COST",
    "domestic_shipping_freight_w_po_prep"."APPROVED_ADJ_LH_COST" AS "APPROVED_ADJ_LH_COST",
    "domestic_shipping_freight_w_po_prep"."ENTRY_TYPE" AS "ENTRY_TYPE",
    "domestic_shipping_freight_w_po_prep"."PICKUP_NUMBER" AS "PICKUP_NUMBER",
    "domestic_shipping_freight_w_po_prep"."MONETARY_VALUE" AS "MONETARY_VALUE",
    "domestic_shipping_freight_w_po_prep"."MONETARY_VALUE_CURRENCY_CODE" AS "MONETARY_VALUE_CURRENCY_CODE",
    "domestic_shipping_freight_w_po_prep"."MANIFEST_TYPE" AS "MANIFEST_TYPE",
    "domestic_shipping_freight_w_po_prep"."NON_MACHINABLE" AS "NON_MACHINABLE",
    "domestic_shipping_freight_w_po_prep"."LENGTH_UOM_ID" AS "LENGTH_UOM_ID",
    "domestic_shipping_freight_w_po_prep"."RATING_LEVEL" AS "RATING_LEVEL",
    "domestic_shipping_freight_w_po_prep"."WIDTH_UOM_ID" AS "WIDTH_UOM_ID",
    "domestic_shipping_freight_w_po_prep"."HEIGHT_UOM_ID" AS "HEIGHT_UOM_ID",
    "domestic_shipping_freight_w_po_prep"."MARK_FOR_DELETION" AS "MARK_FOR_DELETION",
    "domestic_shipping_freight_w_po_prep"."BILLING_METHOD" AS "BILLING_METHOD",
    "domestic_shipping_freight_w_po_prep"."LAST_UPDATED_SOURCE_TYPE" AS "LAST_UPDATED_SOURCE_TYPE",
    "domestic_shipping_freight_w_po_prep"."UNAPPLIED_SPOT_COST" AS "UNAPPLIED_SPOT_COST",
    "domestic_shipping_freight_w_po_prep"."UNAPPLIED_SPOT_CURRENCY_CODE" AS "UNAPPLIED_SPOT_CURRENCY_CODE",
    "domestic_shipping_freight_w_po_prep"."APPROVED_SPOT_COST" AS "APPROVED_SPOT_COST",
    "domestic_shipping_freight_w_po_prep"."INVOICE_DTL_ID" AS "INVOICE_DTL_ID",
    "domestic_shipping_freight_w_po_prep"."VESSEL_NUMBER" AS "VESSEL_NUMBER",
    "domestic_shipping_freight_w_po_prep"."VOYAGE_FLIGHT_NUMBER" AS "VOYAGE_FLIGHT_NUMBER",
    "domestic_shipping_freight_w_po_prep"."BOOKING_TYPE" AS "BOOKING_TYPE",
    "domestic_shipping_freight_w_po_prep"."PRO_NUMBER" AS "PRO_NUMBER",
    "domestic_shipping_freight_w_po_prep"."TRAILER_NUMBER" AS "TRAILER_NUMBER",
    "domestic_shipping_freight_w_po_prep"."COMMODITY_CODE_ID" AS "COMMODITY_CODE_ID",
    "domestic_shipping_freight_w_po_prep"."UNAPPLIED_TOTAL_BALANCE" AS "UNAPPLIED_TOTAL_BALANCE",
    "domestic_shipping_freight_w_po_prep"."APPROVED_TOTAL_BALANCE" AS "APPROVED_TOTAL_BALANCE",
    "domestic_shipping_freight_w_po_prep"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP",
    "domestic_shipping_freight_w_po_prep"."OPERATION_TYPE" AS "OPERATION_TYPE",
    "domestic_shipping_freight_w_po_prep"."ARCHIVED_DTTM" AS "ARCHIVED_DTTM",
    "domestic_shipping_freight_w_po_prep"."INVOICE_DT" AS "INVOICE_DT",
    "domestic_shipping_freight_w_po_prep"."invoice_date_parsed" AS "invoice_date_parsed",
    "domestic_shipping_freight_w_po_prep"."NUM_REJECTIONS" AS "NUM_REJECTIONS",
    "domestic_shipping_freight_w_po_prep"."TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID",
    "domestic_shipping_freight_w_po_prep"."DELIVERY_START_DTTM" AS "DELIVERY_START_DTTM",
    "domestic_shipping_freight_w_po_prep"."delivery_date_parsed" AS "delivery_date_parsed",
    "domestic_shipping_freight_w_po_prep"."DELIVERY_END_DTTM" AS "DELIVERY_END_DTTM",
    "domestic_shipping_freight_w_po_prep"."ORIGIN" AS "ORIGIN",
    "domestic_shipping_freight_w_po_prep"."FINAL_DESTINATION" AS "FINAL_DESTINATION",
    "domestic_shipping_freight_w_po_prep"."actual_delivery_date_parsed" AS "actual_delivery_date_parsed",
    "domestic_shipping_freight_w_po_prep"."VENDOR_ID" AS "VENDOR_ID",
    "domestic_shipping_freight_w_po_prep"."VENDOR_NAME" AS "VENDOR_NAME",
    "domestic_shipping_freight_w_po_prep"."flag_wood_pellet_combined" AS "flag_wood_pellet_combined",
    "domestic_shipping_freight_w_po_prep"."cal_MERCH_YEAR" AS "cal_MERCH_YEAR",
    "domestic_shipping_freight_w_po_prep"."cal_YEAR_WEEK" AS "cal_YEAR_WEEK",
    "domestic_shipping_freight_w_po_prep"."cal_YEAR_QUARTER" AS "cal_YEAR_QUARTER",
    "domestic_shipping_freight_w_po_prep"."cal_YEAR_PERIOD" AS "cal_YEAR_PERIOD",
    "domestic_shipping_freight_w_po_prep"."del_MERCH_YEAR" AS "del_MERCH_YEAR",
    "domestic_shipping_freight_w_po_prep"."del_YEAR_WEEK" AS "del_YEAR_WEEK",
    "domestic_shipping_freight_w_po_prep"."del_YEAR_QUARTER" AS "del_YEAR_QUARTER",
    "domestic_shipping_freight_w_po_prep"."del_YEAR_PERIOD" AS "del_YEAR_PERIOD",
    "domestic_shipping_freight_w_po_prep"."act_del_MERCH_YEAR" AS "act_del_MERCH_YEAR",
    "domestic_shipping_freight_w_po_prep"."act_del_YEAR_WEEK" AS "act_del_YEAR_WEEK",
    "domestic_shipping_freight_w_po_prep"."act_del_YEAR_QUARTER" AS "act_del_YEAR_QUARTER",
    "domestic_shipping_freight_w_po_prep"."act_del_YEAR_PERIOD" AS "act_del_YEAR_PERIOD",
    "domestic_shipping_freight_w_po_prep"."org_Facility_Code" AS "org_Facility_Code",
    "domestic_shipping_freight_w_po_prep"."org_Facility_Name" AS "org_Facility_Name",
    "domestic_shipping_freight_w_po_prep"."org_Facility_Type" AS "org_Facility_Type",
    "domestic_shipping_freight_w_po_prep"."dest_Facility_Code" AS "dest_Facility_Code",
    "domestic_shipping_freight_w_po_prep"."dest_Facility_Name" AS "dest_Facility_Name",
    "domestic_shipping_freight_w_po_prep"."dest_Facility_Type" AS "dest_Facility_Type",
    "domestic_shipping_freight_w_po_prep"."inbound_flag" AS "inbound_flag",
    "domestic_shipping_freight_w_po_prep"."order_id_po" AS "order_id_po",
    "purchase_order_line_w_cal"."STORE_NO" AS "po_STORE_NO",
    "purchase_order_line_w_cal"."CO_CODE" AS "po_CO_CODE",
    "purchase_order_line_w_cal"."ARTICLE_NO" AS "po_ARTICLE_NO",
    "purchase_order_line_w_cal"."PO_NO" AS "po_PO_NO",
    "purchase_order_line_w_cal"."PO_LINE_NO" AS "po_PO_LINE_NO",
    "purchase_order_line_w_cal"."PO_DATE" AS "po_PO_DATE",
    "purchase_order_line_w_cal"."po_date_parsed" AS "po_po_date_parsed",
    "purchase_order_line_w_cal"."DELIV_DATE" AS "po_DELIV_DATE",
    "purchase_order_line_w_cal"."deliv_date_parsed" AS "po_deliv_date_parsed",
    "purchase_order_line_w_cal"."PO_TYPE_CODE" AS "po_PO_TYPE_CODE",
    "purchase_order_line_w_cal"."VENDOR_ID" AS "po_VENDOR_ID",
    "purchase_order_line_w_cal"."VSR_CODE" AS "po_VSR_CODE",
    "purchase_order_line_w_cal"."PO_LINE_CANCELLED_FLAG" AS "po_PO_LINE_CANCELLED_FLAG",
    "purchase_order_line_w_cal"."PO_LINE_ORDER_QTY" AS "po_PO_LINE_ORDER_QTY",
    "purchase_order_line_w_cal"."PO_LINE_ISSUE_QTY" AS "po_PO_LINE_ISSUE_QTY",
    "purchase_order_line_w_cal"."PO_LINE_RCVD_QTY" AS "po_PO_LINE_RCVD_QTY",
    "purchase_order_line_w_cal"."PO_LINE_UNIT_PRICE" AS "po_PO_LINE_UNIT_PRICE",
    "purchase_order_line_w_cal"."DC_NO" AS "po_DC_NO",
    "purchase_order_line_w_cal"."PO_TRACKING_NO" AS "po_PO_TRACKING_NO",
    "purchase_order_line_w_cal"."PO_LINE_TRACKING_NO" AS "po_PO_LINE_TRACKING_NO",
    "purchase_order_line_w_cal"."CURRENT_REPL_TYPE_CODE" AS "po_CURRENT_REPL_TYPE_CODE",
    "purchase_order_line_w_cal"."FREIGHT_TYPE_CODE" AS "po_FREIGHT_TYPE_CODE",
    "purchase_order_line_w_cal"."SHIP_START_DATE" AS "po_SHIP_START_DATE",
    "purchase_order_line_w_cal"."SHIP_END_DATE" AS "po_SHIP_END_DATE",
    "purchase_order_line_w_cal"."DELIV_START_DATE" AS "po_DELIV_START_DATE",
    "purchase_order_line_w_cal"."DELIV_END_DATE" AS "po_DELIV_END_DATE",
    "purchase_order_line_w_cal"."PO_LINE_UNIT_FREIGHT_AMT" AS "po_PO_LINE_UNIT_FREIGHT_AMT",
    "purchase_order_line_w_cal"."PO_LINE_MANUFACTURER" AS "po_PO_LINE_MANUFACTURER",
    "purchase_order_line_w_cal"."PO_LINE_ORIGIN_COUNTRY_CODE" AS "po_PO_LINE_ORIGIN_COUNTRY_CODE",
    "purchase_order_line_w_cal"."PO_LINE_PORT_OF_ORIGIN" AS "po_PO_LINE_PORT_OF_ORIGIN",
    "purchase_order_line_w_cal"."PO_LINE_MIN_RCVD_DATE" AS "po_PO_LINE_MIN_RCVD_DATE",
    "purchase_order_line_w_cal"."PO_LINE_MAX_RCVD_DATE" AS "po_PO_LINE_MAX_RCVD_DATE",
    "purchase_order_line_w_cal"."PO_LINE_DELIVERED_FLAG" AS "po_PO_LINE_DELIVERED_FLAG",
    "purchase_order_line_w_cal"."PO_LINE_CONFIRMED_ON_BOARD_DATE" AS "po_PO_LINE_CONFIRMED_ON_BOARD_DATE",
    "purchase_order_line_w_cal"."PO_LINE_BOOKED_FOR_SHIPMENT_DATE" AS "po_PO_LINE_BOOKED_FOR_SHIPMENT_DATE",
    "purchase_order_line_w_cal"."PO_LINE_TRANSIT_RESN_CODE" AS "po_PO_LINE_TRANSIT_RESN_CODE",
    "purchase_order_line_w_cal"."PO_LINE_MOVE_TYPE_CODE" AS "po_PO_LINE_MOVE_TYPE_CODE",
    "purchase_order_line_w_cal"."PO_LINE_AGENT_COMMISSION_RATE" AS "po_PO_LINE_AGENT_COMMISSION_RATE",
    "purchase_order_line_w_cal"."PO_LINE_AGENT_COMMISSION_AMT" AS "po_PO_LINE_AGENT_COMMISSION_AMT",
    "purchase_order_line_w_cal"."PO_LINE_ADDL_ARTICLE_NO" AS "po_PO_LINE_ADDL_ARTICLE_NO",
    "purchase_order_line_w_cal"."PO_LINE_ADDL_ARTICLE_QTY" AS "po_PO_LINE_ADDL_ARTICLE_QTY",
    "purchase_order_line_w_cal"."PO_LINE_FACTORY_VENDOR_ID" AS "po_PO_LINE_FACTORY_VENDOR_ID",
    "purchase_order_line_w_cal"."PO_LINE_STUFFING_LOC_VENDOR_ID" AS "po_PO_LINE_STUFFING_LOC_VENDOR_ID",
    "purchase_order_line_w_cal"."PO_LINE_SOURCING_AGENT_VENDOR_ID" AS "po_PO_LINE_SOURCING_AGENT_VENDOR_ID",
    "purchase_order_line_w_cal"."PO_LINE_FREIGHT_FORWARDER_VENDOR_ID" AS "po_PO_LINE_FREIGHT_FORWARDER_VENDOR_ID",
    "purchase_order_line_w_cal"."PO_LINE_LETTER_OF_CREDIT_NO" AS "po_PO_LINE_LETTER_OF_CREDIT_NO",
    "purchase_order_line_w_cal"."PO_LINE_OPEN_ACCT_NO" AS "po_PO_LINE_OPEN_ACCT_NO",
    "purchase_order_line_w_cal"."PO_LINE_ARTICLE_LENGTH" AS "po_PO_LINE_ARTICLE_LENGTH",
    "purchase_order_line_w_cal"."PO_LINE_ARTICLE_WIDTH" AS "po_PO_LINE_ARTICLE_WIDTH",
    "purchase_order_line_w_cal"."PO_LINE_ARTICLE_HEIGHT" AS "po_PO_LINE_ARTICLE_HEIGHT",
    "purchase_order_line_w_cal"."PO_LINE_ARTICLE_DIMENSIONS_UOM" AS "po_PO_LINE_ARTICLE_DIMENSIONS_UOM",
    "purchase_order_line_w_cal"."PO_LINE_ARTICLE_WEIGHT" AS "po_PO_LINE_ARTICLE_WEIGHT",
    "purchase_order_line_w_cal"."PO_LINE_ARTICLE_WEIGHT_UOM" AS "po_PO_LINE_ARTICLE_WEIGHT_UOM",
    "purchase_order_line_w_cal"."PO_TOTAL_WEIGHT" AS "po_PO_TOTAL_WEIGHT",
    "purchase_order_line_w_cal"."PO_LINE_ARTICLE_VOLUME" AS "po_PO_LINE_ARTICLE_VOLUME",
    "purchase_order_line_w_cal"."PO_LINE_ARTICLE_VOLUME_UOM" AS "po_PO_LINE_ARTICLE_VOLUME_UOM",
    "purchase_order_line_w_cal"."PO_TOTAL_VOLUME" AS "po_PO_TOTAL_VOLUME",
    "purchase_order_line_w_cal"."HTS_CODE" AS "po_HTS_CODE",
    "purchase_order_line_w_cal"."PO_LINE_DUTY_RATE" AS "po_PO_LINE_DUTY_RATE",
    "purchase_order_line_w_cal"."PO_LINE_DUTY_AMT" AS "po_PO_LINE_DUTY_AMT",
    "purchase_order_line_w_cal"."PO_LINE_ADDL_HTS_CODE_1" AS "po_PO_LINE_ADDL_HTS_CODE_1",
    "purchase_order_line_w_cal"."PO_LINE_ADDL_DUTY_RATE_1" AS "po_PO_LINE_ADDL_DUTY_RATE_1",
    "purchase_order_line_w_cal"."PO_LINE_ADDL_DUTY_AMT_1" AS "po_PO_LINE_ADDL_DUTY_AMT_1",
    "purchase_order_line_w_cal"."PO_LINE_ADDL_HTS_CODE_2" AS "po_PO_LINE_ADDL_HTS_CODE_2",
    "purchase_order_line_w_cal"."PO_LINE_ADDL_DUTY_RATE_2" AS "po_PO_LINE_ADDL_DUTY_RATE_2",
    "purchase_order_line_w_cal"."PO_LINE_ADDL_DUTY_AMT_2" AS "po_PO_LINE_ADDL_DUTY_AMT_2",
    "purchase_order_line_w_cal"."PO_HELD_FLAG" AS "po_PO_HELD_FLAG",
    "purchase_order_line_w_cal"."PO_VENDOR_DOC_DATE" AS "po_PO_VENDOR_DOC_DATE",
      "article"."ARTICLE_LENGTH" AS "a_ARTICLE_LENGTH",
    "article"."ARTICLE_WIDTH" AS "a_ARTICLE_WIDTH",
    "article"."ARTICLE_HEIGHT" AS "a_ARTICLE_HEIGHT",
    "article"."ARTICLE_WEIGHT" AS "a_ARTICLE_WEIGHT",
    "article"."ARTICLE_SIZE" AS "a_ARTICLE_SIZE",
    "article"."ARTICLE_40HC_QTY" AS "a_ARTICLE_40HC_QTY",
    "article"."ARTICLE_40GP_QTY" AS "a_ARTICLE_40GP_QTY"
  FROM "DOMESTIC_SHIPPING_FREIGHT_W_FACILITIES_JOINED" "domestic_shipping_freight_w_po_prep"
  LEFT JOIN "PURCHASE_ORDER_LINE_W_CAL" "purchase_order_line_w_cal"
  ON "domestic_shipping_freight_w_po_prep"."order_id_po" = "purchase_order_line_w_cal"."PO_NO"
  LEFT JOIN ARTICLE_W_SHP_DIM_PREP "article"
  ON "purchase_order_line_w_cal"."ARTICLE_NO" = "article"."ARTICLE_NO";
  
<br>
--DOMESTIC_SHIPPING_FREIGHT_PO_ALLOCATION_ARTICLE
</br>
CREATE OR REPLACE TEMPORARY TABLE "DOMESTIC_SHIPPING_FREIGHT_PO_ALLOCATION_ARTICLE"
AS
WITH CTE AS 
(SELECT  INV_ID
  ,INV_OBJECT_ID
  ,TC_COMPANY_ID
  ,TC_OBJECT_ID
  ,INV_OBJECT_STATUS
  ,O_NAME
  ,O_ADDRESS
  ,O_CITY
  ,O_COUNTY
  ,O_STATE_PROV
  ,O_POSTAL_CODE
  ,O_COUNTRY_CODE
  ,D_NAME
  ,D_ADDRESS
  ,D_CITY
  ,D_COUNTY
  ,D_STATE_PROV
  ,D_POSTAL_CODE
  ,D_COUNTRY_CODE
  ,MOT_DESC
  ,EQUIPMENT_DESC
  ,SERVICE_LEVEL_DESC
  ,PROTECTION_LEVEL_DESC
  ,FINANCIAL_WEIGHT
  ,ACTUAL_WEIGHT
  ,TOTAL_COST
  ,LH_COST
  ,DISTANCE
  ,DISTANCE_UOM
  ,BILL_OF_LADING_NUMBER
  ,PO_NUMBER
  ,SPEC_HANDLING_METHOD
  ,COMMENTS
  ,HAS_IMPORT_ERROR
  ,HAS_WARNING
  ,IS_VALID
  ,CREATED_SOURCE_TYPE
  ,CREATED_SOURCE
  ,CREATED_DTTM
  ,LAST_UPDATED_SOURCE
  ,LAST_UPDATED_DTTM
  ,STOP_COST
  ,AUXILARY_DATA
  ,PICKUP_DTTM
  ,DELIVERY_DTTM
  ,CURRENCY_CODE
  ,LH_CURRENCY_CODE
  ,STOP_CURRENCY_CODE
  ,SPOT_CHARGE_COST
  ,SPOT_CHARGE_CURRENCY_CODE
  ,ASSIGNED_CARRIER_CODE
  ,NUM_PICKUPS
  ,NUM_DELIVERIES
  ,RATE
  ,RATE_CALC_METHOD
  ,RATE_UOM
  ,TPE_OBJECT_ID
  ,O_FACILITY_ID
  ,D_FACILITY_ID
  ,TP_COMPANY_ID
  ,PACKAGE_TYPE_ID
  ,COMPUTED_RATE
  ,COMPUTED_RATE_UOM
  ,COMPUTED_RATE_CALC_METHOD
  ,COMPUTED_TOTAL_COST
  ,COMPUTED_TOTAL_COST_CURR_CODE
  ,O_FACILITY_NAME
  ,D_FACILITY_NAME
  ,COMPUTED_DISTANCE
  ,COMPUTED_DISTANCE_UOM
  ,COMPUTED_STOP_COST
  ,COMPUTED_STOP_COST_CURR_CODE
  ,APPROVED_DISTANCE
  ,APPROVED_LH_COST
  ,APPROVED_RATE
  ,APPROVED_FINANCIAL_WEIGHT
  ,APPROVED_ACTUAL_WEIGHT
  ,RATE_ADJUSTMENT
  ,MIN_CHARGE
  ,COMPUTED_TARIFF
  ,COMPUTED_MIN_RATE
  ,UNDEFINED_ADJUSTMENT
  ,DISCOUNT_AMOUNT
  ,UNDEFINED_ADJ_CURR_CODE
  ,DISCOUNT_AMT_CURR_CODE
  ,RATE_CURR_CODE
  ,CARRIER_ID
  ,ASSIGNED_CARRIER_ID
  ,EQUIPMENT_ID
  ,MOT_ID
  ,PROTECTION_LEVEL_ID
  ,SERVICE_LEVEL_ID
  ,UNDF_ADJ_CURR_CODE
  ,COMPUTED_FINANCIAL_WEIGHT
  ,ADJUSTMENT_AMOUNT
  ,APPROVED_ADJUSTMENT_AMOUNT
  ,APPROVED_STOP_COST
  ,APPROVED_RATE_ADJUSTMENT
  ,APPROVED_RATE_CALC_METHOD
  ,APPROVED_RATE_UOM
  ,APPROVED_DISTANCE_UOM
  ,COMPUTED_LH_COST
  ,COMPUTED_LH_COST_CURR_CODE
  ,WEIGHT_UOM_ID
  ,APPROVED_WEIGHT_UOM_ID
  ,INV_MIN_RATE
  ,SYS_MIN_RATE
  ,UNAPPLIED_LH_COST
  ,UNAPPLIED_LH_CURRENCY_CODE
  ,UNAPPLIED_STOP_COST
  ,UNAPPLIED_STOP_CURRENCY_CODE
  ,ORG_SHIP_VIA_FACILITY_ID
  ,ORG_SHIP_VIA_FACILITY_ALIAS_ID
  ,DES_SHIP_VIA_FACILITY_ID
  ,DES_SHIP_VIA_FACILITY_ALIAS_ID
  ,INCOTERM_ID
  ,SEC_CARRIER_ID
  ,COMMODITY_CLASS
  ,ACTUAL_PAYMENT_AMOUNT
  ,ACTUAL_CURRENCY_CODE
  ,NET_AMOUNT_CURRENCY_CODE
  ,NET_AMOUNT_DUE
  ,NORMALIZED_NET_AMOUNT_DUE
  ,REF_INV_OBJECT_PAID_AMOUNT
  ,REF_INV_OBJECT_PAID_AMOUNT_CC
  ,REF_INV_OBJECT_AMOUNT
  ,REF_INV_OBJECT_AMOUNT_CC
  ,REF_INVOICED_OBJECT_ID
  ,INCOTERM_CODE
  ,ACTUAL_VOLUME
  ,VOLUME_UOM_ID
  ,COMPUTED_VOLUME
  ,COMPUTED_VOLUME_UOM_ID
  ,APPROVED_VOLUME
  ,APPROVED_VOLUME_UOM_ID
  ,VOLUME_UOM
  ,WEIGHT_UOM
  ,INV_OBJ_GRS_AMT_DUE_CURR_CODE
  ,INV_OBJ_TAX_AM_DUE_CURR_CODE
  ,INV_OBJ_TAX_AMT_DUE
  ,INV_OBJ_GRS_AMT_DUE
  ,TRACKING_NUMBER
  ,LENGTH
  ,WIDTH
  ,HEIGHT
  ,ADJ_RATE
  ,COMPUTED_ADJ_RATE
  ,APPROVED_ADJ_RATE
  ,ADJ_LH_COST
  ,COMPUTED_ADJ_LH_COST
  ,APPROVED_ADJ_LH_COST
  ,ENTRY_TYPE
  ,PICKUP_NUMBER
  ,MONETARY_VALUE
  ,MONETARY_VALUE_CURRENCY_CODE
  ,MANIFEST_TYPE
  ,NON_MACHINABLE
  ,LENGTH_UOM_ID
  ,RATING_LEVEL
  ,WIDTH_UOM_ID
  ,HEIGHT_UOM_ID
  ,MARK_FOR_DELETION
  ,BILLING_METHOD
  ,LAST_UPDATED_SOURCE_TYPE
  ,UNAPPLIED_SPOT_COST
  ,UNAPPLIED_SPOT_CURRENCY_CODE
  ,APPROVED_SPOT_COST
  ,INVOICE_DTL_ID
  ,VESSEL_NUMBER
  ,VOYAGE_FLIGHT_NUMBER
  ,BOOKING_TYPE
  ,PRO_NUMBER
  ,TRAILER_NUMBER
  ,COMMODITY_CODE_ID
  ,UNAPPLIED_TOTAL_BALANCE
  ,APPROVED_TOTAL_BALANCE
  ,CDC_TIMESTAMP
  ,OPERATION_TYPE
  ,ARCHIVED_DTTM
  ,INVOICE_DT
  ,"invoice_date_parsed"
  ,NUM_REJECTIONS
  ,TC_SHIPMENT_ID
  ,DELIVERY_START_DTTM
  ,"delivery_date_parsed"
  ,DELIVERY_END_DTTM
  ,ORIGIN
  ,FINAL_DESTINATION
  ,"actual_delivery_date_parsed"
  ,VENDOR_ID
  ,VENDOR_NAME
  ,"flag_wood_pellet_combined"
  ,"cal_MERCH_YEAR"
  ,"cal_YEAR_WEEK"
  ,"cal_YEAR_QUARTER"
  ",cal_YEAR_PERIOD
  ","del_MERCH_YEAR"
  ,"del_YEAR_WEEK"
  ,"del_YEAR_QUARTER"
  ,"del_YEAR_PERIOD"
  ,"act_del_MERCH_YEAR"
  ,"act_del_YEAR_WEEK"
  ,"act_del_YEAR_QUARTER"
  ,"act_del_YEAR_PERIOD"
  ,"org_Facility_Code"
  ,"org_Facility_Name"
  ,"org_Facility_Type"
  ,"dest_Facility_Code"
  ,"dest_Facility_Name"
  ,"dest_Facility_Type"
  ,"inbound_flag"
  ,"order_id_po"
  ,"po_STORE_NO"
  ,"po_CO_CODE"
  ,"po_ARTICLE_NO"
  ,"po_PO_NO"
  ,"po_PO_LINE_NO"
  ,"po_PO_DATE"
  ,"po_po_date_parsed"
  ,"po_DELIV_DATE"
  ,"po_deliv_date_parsed"
  ,"po_PO_TYPE_CODE"
  ,"po_VENDOR_ID"
  ,"po_VSR_CODE"
  ,"po_PO_LINE_CANCELLED_FLAG"
  ,"po_PO_LINE_ORDER_QTY"
  ,"po_PO_LINE_ISSUE_QTY"
  ,"po_PO_LINE_RCVD_QTY"
  ,"po_PO_LINE_UNIT_PRICE"
  ,"po_DC_NO"
  ,"po_PO_TRACKING_NO"
  ,"po_PO_LINE_TRACKING_NO"
  ,"po_CURRENT_REPL_TYPE_CODE"
  ,"po_FREIGHT_TYPE_CODE"
  ,"po_SHIP_START_DATE"
  ,"po_SHIP_END_DATE"
  ,"po_DELIV_START_DATE"
  ,"po_DELIV_END_DATE"
  ,"po_PO_LINE_UNIT_FREIGHT_AMT"
  ,"po_PO_LINE_MANUFACTURER"
  ,"po_PO_LINE_ORIGIN_COUNTRY_CODE"
  ,"po_PO_LINE_PORT_OF_ORIGIN"
  ,"po_PO_LINE_MIN_RCVD_DATE"
  ,"po_PO_LINE_DELIVERED_FLAG"
  ,"po_PO_LINE_CONFIRMED_ON_BOARD_DATE"
  ,"po_PO_LINE_BOOKED_FOR_SHIPMENT_DATE"
  ,"po_PO_LINE_TRANSIT_RESN_CODE"
  ,"po_PO_LINE_MOVE_TYPE_CODE"
  ,"po_PO_LINE_AGENT_COMMISSION_RATE"
  ,"po_PO_LINE_AGENT_COMMISSION_AMT"
  ,"po_PO_LINE_ADDL_ARTICLE_NO"
  ,"po_PO_LINE_ADDL_ARTICLE_QTY"
  ,"po_PO_LINE_FACTORY_VENDOR_ID"
  ,"po_PO_LINE_STUFFING_LOC_VENDOR_ID"
  ,"po_PO_LINE_SOURCING_AGENT_VENDOR_ID"
  ,"po_PO_LINE_FREIGHT_FORWARDER_VENDOR_ID"
  ,"po_PO_LINE_LETTER_OF_CREDIT_NO"
  , "po_PO_LINE_OPEN_ACCT_NO"
  ,"po_PO_LINE_ARTICLE_LENGTH"
  ,"po_PO_LINE_ARTICLE_WIDTH"
  ,"po_PO_LINE_ARTICLE_HEIGHT"
  ,"po_PO_LINE_ARTICLE_DIMENSIONS_UOM"
  ,"po_PO_LINE_ARTICLE_WEIGHT"
  ,"po_PO_LINE_ARTICLE_WEIGHT_UOM"
  ,"po_PO_TOTAL_WEIGHT"
  ,"po_PO_LINE_ARTICLE_VOLUME"
  ,"po_PO_LINE_ARTICLE_VOLUME_UOM"
  ,"po_PO_TOTAL_VOLUME"
  ,"po_HTS_CODE"
  ,"po_PO_LINE_DUTY_RATE"
  ,"po_PO_LINE_DUTY_AMT"
  ,"po_PO_LINE_ADDL_HTS_CODE_1"
  ,"po_PO_LINE_ADDL_DUTY_RATE_1"
  ,"po_PO_LINE_ADDL_DUTY_AMT_1"
  ,"po_PO_LINE_ADDL_HTS_CODE_2"
  ,"po_PO_LINE_ADDL_DUTY_RATE_2"
  ,"po_PO_LINE_ADDL_DUTY_AMT_2"
  ,"po_PO_HELD_FLAG"
  ,"po_PO_VENDOR_DOC_DATE"
  ,"a_ARTICLE_LENGTH"
  ,"a_ARTICLE_WIDTH"
  ,"a_ARTICLE_HEIGHT"
  ,"a_ARTICLE_WEIGHT"
  ,"a_ARTICLE_SIZE"
  ,"a_ARTICLE_40HC_QTY"
  ,"a_ARTICLE_40GP_QTY",
  round(coalesce("a_ARTICLE_LENGTH",0)*coalesce("a_ARTICLE_WIDTH",0)*coalesce("a_ARTICLE_HEIGHT",0)*coalesce("po_PO_LINE_ORDER_QTY",0)/1728) "item_volume",
  round(coalesce("a_ARTICLE_WEIGHT",0)*coalesce("po_PO_LINE_ORDER_QTY",0)) AS "item_weight"
FROM "DOMESTIC_SHIPPING_FREIGHT_PO_W_ARTICLE_JOINED"
)
 SELECT 
    *,
    CASE WHEN "weight_volume_flag" = 'V' THEN "allocation_by_vol" ELSE "allocation_by_wgt" END AS "allocation_final"
FROM 
(
SELECT 
*, CASE WHEN CAST("item_volume_sum" AS DOUBLE) / NULLIF("max_volume", 0) >= CAST("item_weight_sum" AS DOUBLE) / NULLIF("max_weight", 0) THEN 'V' ELSE 'W' END AS "weight_volume_flag"
FROM (
SELECT *,
             (CAST("item_volume" AS DOUBLE) / NULLIF("item_volume_sum", 0)) * COALESCE("TOTAL_COST", 0) AS "allocation_by_vol",
            (CAST("item_weight" AS DOUBLE) / NULLIF("item_weight_sum", 0)) * COALESCE("TOTAL_COST", 0) AS "allocation_by_wgt",
            2366 AS "max_volume",
            44000 AS "max_weight"
 FROM 
(
SELECT  *,
    SUM("item_volume") OVER (PARTITION BY "TC_OBJECT_ID") AS "item_volume_sum",
    SUM("item_weight") OVER (PARTITION BY "TC_OBJECT_ID") AS "item_weight_sum"
FROM CTE
)A)B)C;

<br>
--4.TLM_SHIPMENT_JOINED_DO_VOl_WGT_ALLOCATION
--TLM_SHIPMENT_JOINED_OUTBOUND
</br>
CREATE OR REPLACE TEMPORARY TABLE "TLM_SHIPMENT_JOINED_OUTBOUND"
AS
WITH TLM_SHIPMENT_JOINED_FILTER_SHIPPING_WINDOWS
AS
(
SELECT  *
  FROM (
    SELECT 
        "tlm_shipment_joined_w_cal_filtered"."SHIPMENT_ID" AS "SHIPMENT_ID",
        "tlm_shipment_joined_w_cal_filtered"."TC_COMPANY_ID" AS "TC_COMPANY_ID",
        "tlm_shipment_joined_w_cal_filtered"."RS_AREA_ID" AS "RS_AREA_ID",
        "tlm_shipment_joined_w_cal_filtered"."TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID",
        "tlm_shipment_joined_w_cal_filtered"."PP_SHIPMENT_ID" AS "PP_SHIPMENT_ID",
        "tlm_shipment_joined_w_cal_filtered"."SHIPMENT_STATUS" AS "SHIPMENT_STATUS",
        "tlm_shipment_joined_w_cal_filtered"."UPDATE_SENT" AS "UPDATE_SENT",
        "tlm_shipment_joined_w_cal_filtered"."BUSINESS_PROCESS" AS "BUSINESS_PROCESS",
        "tlm_shipment_joined_w_cal_filtered"."CREATION_TYPE" AS "CREATION_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."CONS_RUN_ID" AS "CONS_RUN_ID",
        "tlm_shipment_joined_w_cal_filtered"."IS_CANCELLED" AS "IS_CANCELLED",
        "tlm_shipment_joined_w_cal_filtered"."RS_TYPE" AS "RS_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."RS_CONFIG_ID" AS "RS_CONFIG_ID",
        "tlm_shipment_joined_w_cal_filtered"."RS_CONFIG_CYCLE_ID" AS "RS_CONFIG_CYCLE_ID",
        "tlm_shipment_joined_w_cal_filtered"."CONFIG_CYCLE_SEQ" AS "CONFIG_CYCLE_SEQ",
        "tlm_shipment_joined_w_cal_filtered"."CYCLE_DEADLINE_DTTM" AS "CYCLE_DEADLINE_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."CYCLE_EXECUTION_DTTM" AS "CYCLE_EXECUTION_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."LAST_RS_NOTIFICATION_DTTM" AS "LAST_RS_NOTIFICATION_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."CFMF_STATUS" AS "CFMF_STATUS",
        "tlm_shipment_joined_w_cal_filtered"."AVAILABLE_DTTM" AS "AVAILABLE_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."CMID" AS "CMID",
        "tlm_shipment_joined_w_cal_filtered"."CM_DISCOUNT" AS "CM_DISCOUNT",
        "tlm_shipment_joined_w_cal_filtered"."O_FACILITY_NUMBER" AS "O_FACILITY_NUMBER",
        "tlm_shipment_joined_w_cal_filtered"."O_FACILITY_ID" AS "O_FACILITY_ID",
        "tlm_shipment_joined_w_cal_filtered"."O_ADDRESS" AS "O_ADDRESS",
        "tlm_shipment_joined_w_cal_filtered"."O_CITY" AS "O_CITY",
        "tlm_shipment_joined_w_cal_filtered"."O_STATE_PROV" AS "O_STATE_PROV",
        "tlm_shipment_joined_w_cal_filtered"."O_POSTAL_CODE" AS "O_POSTAL_CODE",
        "tlm_shipment_joined_w_cal_filtered"."O_COUNTY" AS "O_COUNTY",
        "tlm_shipment_joined_w_cal_filtered"."O_COUNTRY_CODE" AS "O_COUNTRY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."D_FACILITY_NUMBER" AS "D_FACILITY_NUMBER",
        "tlm_shipment_joined_w_cal_filtered"."D_FACILITY_ID" AS "D_FACILITY_ID",
        "tlm_shipment_joined_w_cal_filtered"."D_ADDRESS" AS "D_ADDRESS",
        "tlm_shipment_joined_w_cal_filtered"."D_CITY" AS "D_CITY",
        "tlm_shipment_joined_w_cal_filtered"."D_STATE_PROV" AS "D_STATE_PROV",
        "tlm_shipment_joined_w_cal_filtered"."D_POSTAL_CODE" AS "D_POSTAL_CODE",
        "tlm_shipment_joined_w_cal_filtered"."D_COUNTY" AS "D_COUNTY",
        "tlm_shipment_joined_w_cal_filtered"."D_COUNTRY_CODE" AS "D_COUNTRY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."DISTANCE" AS "DISTANCE",
        "tlm_shipment_joined_w_cal_filtered"."DIRECT_DISTANCE" AS "DIRECT_DISTANCE",
        "tlm_shipment_joined_w_cal_filtered"."OUT_OF_ROUTE_DISTANCE" AS "OUT_OF_ROUTE_DISTANCE",
        "tlm_shipment_joined_w_cal_filtered"."DISTANCE_UOM" AS "DISTANCE_UOM",
        "tlm_shipment_joined_w_cal_filtered"."BUSINESS_PARTNER_ID" AS "BUSINESS_PARTNER_ID",
        "tlm_shipment_joined_w_cal_filtered"."COMMODITY_CLASS" AS "COMMODITY_CLASS",
        "tlm_shipment_joined_w_cal_filtered"."IS_HAZMAT" AS "IS_HAZMAT",
        "tlm_shipment_joined_w_cal_filtered"."IS_PERISHABLE" AS "IS_PERISHABLE",
        "tlm_shipment_joined_w_cal_filtered"."BILLING_METHOD" AS "BILLING_METHOD",
        "tlm_shipment_joined_w_cal_filtered"."DSG_CARRIER_CODE" AS "DSG_CARRIER_CODE",
        "tlm_shipment_joined_w_cal_filtered"."REC_CMID" AS "REC_CMID",
        "tlm_shipment_joined_w_cal_filtered"."REC_CM_SHIPMENT_ID" AS "REC_CM_SHIPMENT_ID",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_CARRIER_CODE" AS "ASSIGNED_CARRIER_CODE",
        "tlm_shipment_joined_w_cal_filtered"."SHIPMENT_REF_ID" AS "SHIPMENT_REF_ID",
        "tlm_shipment_joined_w_cal_filtered"."BILL_TO_CODE" AS "BILL_TO_CODE",
        "tlm_shipment_joined_w_cal_filtered"."BILL_TO_TITLE" AS "BILL_TO_TITLE",
        "tlm_shipment_joined_w_cal_filtered"."BILL_TO_NAME" AS "BILL_TO_NAME",
        "tlm_shipment_joined_w_cal_filtered"."BILL_TO_ADDRESS" AS "BILL_TO_ADDRESS",
        "tlm_shipment_joined_w_cal_filtered"."BILL_TO_CITY" AS "BILL_TO_CITY",
        "tlm_shipment_joined_w_cal_filtered"."BILL_TO_STATE_PROV" AS "BILL_TO_STATE_PROV",
        "tlm_shipment_joined_w_cal_filtered"."BILL_TO_POSTAL_CODE" AS "BILL_TO_POSTAL_CODE",
        "tlm_shipment_joined_w_cal_filtered"."BILL_TO_COUNTRY_CODE" AS "BILL_TO_COUNTRY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."BILL_TO_PHONE_NUMBER" AS "BILL_TO_PHONE_NUMBER",
        "tlm_shipment_joined_w_cal_filtered"."PURCHASE_ORDER" AS "PURCHASE_ORDER",
        "tlm_shipment_joined_w_cal_filtered"."PRO_NUMBER" AS "PRO_NUMBER",
        "tlm_shipment_joined_w_cal_filtered"."TRANS_RESP_CODE" AS "TRANS_RESP_CODE",
        "tlm_shipment_joined_w_cal_filtered"."BASELINE_COST" AS "BASELINE_COST",
        "tlm_shipment_joined_w_cal_filtered"."ESTIMATED_COST" AS "ESTIMATED_COST",
        "tlm_shipment_joined_w_cal_filtered"."LINEHAUL_COST" AS "LINEHAUL_COST",
        "tlm_shipment_joined_w_cal_filtered"."ACCESSORIAL_COST" AS "ACCESSORIAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."STOP_COST" AS "STOP_COST",
        "tlm_shipment_joined_w_cal_filtered"."ESTIMATED_SAVINGS" AS "ESTIMATED_SAVINGS",
        "tlm_shipment_joined_w_cal_filtered"."SPOT_CHARGE" AS "SPOT_CHARGE",
        "tlm_shipment_joined_w_cal_filtered"."CURRENCY_CODE" AS "CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."PICKUP_START_DTTM" AS "PICKUP_START_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."PICKUP_END_DTTM" AS "PICKUP_END_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."DELIVERY_START_DTTM" AS "DELIVERY_START_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."DELIVERY_END_DTTM" AS "DELIVERY_END_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."NUM_STOPS" AS "NUM_STOPS",
        "tlm_shipment_joined_w_cal_filtered"."NUM_DOCKS" AS "NUM_DOCKS",
        "tlm_shipment_joined_w_cal_filtered"."ON_TIME_INDICATOR" AS "ON_TIME_INDICATOR",
        "tlm_shipment_joined_w_cal_filtered"."HAS_NOTES" AS "HAS_NOTES",
        "tlm_shipment_joined_w_cal_filtered"."HAS_ALERTS" AS "HAS_ALERTS",
        "tlm_shipment_joined_w_cal_filtered"."HAS_IMPORT_ERROR" AS "HAS_IMPORT_ERROR",
        "tlm_shipment_joined_w_cal_filtered"."HAS_SOFT_CHECK_ERROR" AS "HAS_SOFT_CHECK_ERROR",
        "tlm_shipment_joined_w_cal_filtered"."HAS_TRACKING_MSG" AS "HAS_TRACKING_MSG",
        "tlm_shipment_joined_w_cal_filtered"."TRACKING_MSG_PROBLEM" AS "TRACKING_MSG_PROBLEM",
        "tlm_shipment_joined_w_cal_filtered"."REC_LINEHAUL_COST" AS "REC_LINEHAUL_COST",
        "tlm_shipment_joined_w_cal_filtered"."REC_ACCESSORIAL_COST" AS "REC_ACCESSORIAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."REC_TOTAL_COST" AS "REC_TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."CYCLE_RESP_DEADLINE_TZ" AS "CYCLE_RESP_DEADLINE_TZ",
        "tlm_shipment_joined_w_cal_filtered"."TENDER_RESP_DEADLINE_TZ" AS "TENDER_RESP_DEADLINE_TZ",
        "tlm_shipment_joined_w_cal_filtered"."PICKUP_TZ" AS "PICKUP_TZ",
        "tlm_shipment_joined_w_cal_filtered"."DELIVERY_TZ" AS "DELIVERY_TZ",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_LANE_ID" AS "ASSIGNED_LANE_ID",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_LANE_DETAIL_ID" AS "ASSIGNED_LANE_DETAIL_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_SPOT_CHARGE" AS "REC_SPOT_CHARGE",
        "tlm_shipment_joined_w_cal_filtered"."REC_LANE_ID" AS "REC_LANE_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_LANE_DETAIL_ID" AS "REC_LANE_DETAIL_ID",
        "tlm_shipment_joined_w_cal_filtered"."TENDER_DTTM" AS "TENDER_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."O_STOP_LOCATION_NAME" AS "O_STOP_LOCATION_NAME",
        "tlm_shipment_joined_w_cal_filtered"."D_STOP_LOCATION_NAME" AS "D_STOP_LOCATION_NAME",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_CM_SHIPMENT_ID" AS "ASSIGNED_CM_SHIPMENT_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_CM_DISCOUNT" AS "REC_CM_DISCOUNT",
        "tlm_shipment_joined_w_cal_filtered"."REC_STOP_COST" AS "REC_STOP_COST",
        "tlm_shipment_joined_w_cal_filtered"."LAST_SELECTOR_RUN_DTTM" AS "LAST_SELECTOR_RUN_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."LAST_CM_OPTION_GEN_DTTM" AS "LAST_CM_OPTION_GEN_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."IS_CM_OPTION_GEN_ACTIVE" AS "IS_CM_OPTION_GEN_ACTIVE",
        "tlm_shipment_joined_w_cal_filtered"."RS_CYCLE_REMAINING" AS "RS_CYCLE_REMAINING",
        "tlm_shipment_joined_w_cal_filtered"."IS_TIME_FEAS_ENABLED" AS "IS_TIME_FEAS_ENABLED",
        "tlm_shipment_joined_w_cal_filtered"."EXT_SYS_SHIPMENT_ID" AS "EXT_SYS_SHIPMENT_ID",
        "tlm_shipment_joined_w_cal_filtered"."EXTRACTION_DTTM" AS "EXTRACTION_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_BROKER_CARRIER_CODE" AS "ASSIGNED_BROKER_CARRIER_CODE",
        "tlm_shipment_joined_w_cal_filtered"."USE_BROKER_AS_CARRIER" AS "USE_BROKER_AS_CARRIER",
        "tlm_shipment_joined_w_cal_filtered"."BROKER_REF" AS "BROKER_REF",
        "tlm_shipment_joined_w_cal_filtered"."RATING_QUALIFIER" AS "RATING_QUALIFIER",
        "tlm_shipment_joined_w_cal_filtered"."STATUS_CHANGE_DTTM" AS "STATUS_CHANGE_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."BUDG_TOTAL_COST" AS "BUDG_TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."NORMALIZED_MARGIN" AS "NORMALIZED_MARGIN",
        "tlm_shipment_joined_w_cal_filtered"."NORMALIZED_TOTAL_COST" AS "NORMALIZED_TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."BUDG_NORMALIZED_TOTAL_COST" AS "BUDG_NORMALIZED_TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."REC_BUDG_LINEHAUL_COST" AS "REC_BUDG_LINEHAUL_COST",
        "tlm_shipment_joined_w_cal_filtered"."REC_BUDG_STOP_COST" AS "REC_BUDG_STOP_COST",
        "tlm_shipment_joined_w_cal_filtered"."REC_BUDG_CM_DISCOUNT" AS "REC_BUDG_CM_DISCOUNT",
        "tlm_shipment_joined_w_cal_filtered"."REC_BUDG_ACCESSORIAL_COST" AS "REC_BUDG_ACCESSORIAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."REC_BUDG_TOTAL_COST" AS "REC_BUDG_TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."REC_MARGIN" AS "REC_MARGIN",
        "tlm_shipment_joined_w_cal_filtered"."REC_NORMALIZED_MARGIN" AS "REC_NORMALIZED_MARGIN",
        "tlm_shipment_joined_w_cal_filtered"."REC_NORMALIZED_TOTAL_COST" AS "REC_NORMALIZED_TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."REC_BUDG_NORMALIZED_TOTAL_COST" AS "REC_BUDG_NORMALIZED_TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."BUDG_CURRENCY_CODE" AS "BUDG_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."SPOT_CHARGE_CURRENCY_CODE" AS "SPOT_CHARGE_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."REC_CURRENCY_CODE" AS "REC_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."REC_BUDG_CURRENCY_CODE" AS "REC_BUDG_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."REC_SPOT_CHARGE_CURRENCY_CODE" AS "REC_SPOT_CHARGE_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."RATING_LANE_ID" AS "RATING_LANE_ID",
        "tlm_shipment_joined_w_cal_filtered"."FRT_REV_RATING_LANE_ID" AS "FRT_REV_RATING_LANE_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_RATING_LANE_ID" AS "REC_RATING_LANE_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_BUDG_RATING_LANE_ID" AS "REC_BUDG_RATING_LANE_ID",
        "tlm_shipment_joined_w_cal_filtered"."RATING_LANE_DETAIL_ID" AS "RATING_LANE_DETAIL_ID",
        "tlm_shipment_joined_w_cal_filtered"."FRT_REV_RATING_LANE_DETAIL_ID" AS "FRT_REV_RATING_LANE_DETAIL_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_RATING_LANE_DETAIL_ID" AS "REC_RATING_LANE_DETAIL_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_BUDG_RATING_LANE_DETAIL_ID" AS "REC_BUDG_RATING_LANE_DETAIL_ID",
        "tlm_shipment_joined_w_cal_filtered"."BUDG_CM_DISCOUNT" AS "BUDG_CM_DISCOUNT",
        "tlm_shipment_joined_w_cal_filtered"."NORMALIZED_BASELINE_COST" AS "NORMALIZED_BASELINE_COST",
        "tlm_shipment_joined_w_cal_filtered"."BASELINE_COST_CURRENCY_CODE" AS "BASELINE_COST_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."REPORTED_COST" AS "REPORTED_COST",
        "tlm_shipment_joined_w_cal_filtered"."TRACTOR_NUMBER" AS "TRACTOR_NUMBER",
        "tlm_shipment_joined_w_cal_filtered"."IS_AUTO_DELIVERED" AS "IS_AUTO_DELIVERED",
        "tlm_shipment_joined_w_cal_filtered"."SHIPMENT_TYPE" AS "SHIPMENT_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."ORIG_BUDG_TOTAL_COST" AS "ORIG_BUDG_TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."ACCESSORIAL_COST_TO_CARRIER" AS "ACCESSORIAL_COST_TO_CARRIER",
        "tlm_shipment_joined_w_cal_filtered"."CARRIER_CHARGE" AS "CARRIER_CHARGE",
        "tlm_shipment_joined_w_cal_filtered"."ACTUAL_COST" AS "ACTUAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."EARNED_INCOME" AS "EARNED_INCOME",
        "tlm_shipment_joined_w_cal_filtered"."SENT_TO_PKMS" AS "SENT_TO_PKMS",
        "tlm_shipment_joined_w_cal_filtered"."IS_SHIPMENT_RECONCILED" AS "IS_SHIPMENT_RECONCILED",
        "tlm_shipment_joined_w_cal_filtered"."DELIVERY_REQ" AS "DELIVERY_REQ",
        "tlm_shipment_joined_w_cal_filtered"."DROPOFF_PICKUP" AS "DROPOFF_PICKUP",
        "tlm_shipment_joined_w_cal_filtered"."PACKAGING" AS "PACKAGING",
        "tlm_shipment_joined_w_cal_filtered"."SENT_TO_PKMS_DTTM" AS "SENT_TO_PKMS_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."WMS_STATUS_CODE" AS "WMS_STATUS_CODE",
        "tlm_shipment_joined_w_cal_filtered"."SPOT_CHARGE_AND_PAYEE_ACC" AS "SPOT_CHARGE_AND_PAYEE_ACC",
        "tlm_shipment_joined_w_cal_filtered"."SPOT_CHARGE_AND_PAYEE_ACC_CC" AS "SPOT_CHARGE_AND_PAYEE_ACC_CC",
        "tlm_shipment_joined_w_cal_filtered"."NORM_SPOT_CHARGE_AND_PAYEE_ACC" AS "NORM_SPOT_CHARGE_AND_PAYEE_ACC",
        "tlm_shipment_joined_w_cal_filtered"."FACILITY_SCHEDULE_ID" AS "FACILITY_SCHEDULE_ID",
        "tlm_shipment_joined_w_cal_filtered"."EARNED_INCOME_CURRENCY_CODE" AS "EARNED_INCOME_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."ACTUAL_COST_CURRENCY_CODE" AS "ACTUAL_COST_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."SHIPMENT_RECON_DTTM" AS "SHIPMENT_RECON_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."PLN_RATING_LANE_ID" AS "PLN_RATING_LANE_ID",
        "tlm_shipment_joined_w_cal_filtered"."PLN_RATING_LANE_DETAIL_ID" AS "PLN_RATING_LANE_DETAIL_ID",
        "tlm_shipment_joined_w_cal_filtered"."PLN_TOTAL_COST" AS "PLN_TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."PLN_LINEHAUL_COST" AS "PLN_LINEHAUL_COST",
        "tlm_shipment_joined_w_cal_filtered"."PLN_TOTAL_ACCESSORIAL_COST" AS "PLN_TOTAL_ACCESSORIAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."PLN_STOP_OFF_COST" AS "PLN_STOP_OFF_COST",
        "tlm_shipment_joined_w_cal_filtered"."PLN_NORMALIZED_TOTAL_COST" AS "PLN_NORMALIZED_TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."PLN_CURRENCY_CODE" AS "PLN_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."PLN_ACCESSORL_COST_TO_CARRIER" AS "PLN_ACCESSORL_COST_TO_CARRIER",
        "tlm_shipment_joined_w_cal_filtered"."PLN_CARRIER_CHARGE" AS "PLN_CARRIER_CHARGE",
        "tlm_shipment_joined_w_cal_filtered"."WAYPOINT_TOTAL_COST" AS "WAYPOINT_TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."WAYPOINT_HANDLING_COST" AS "WAYPOINT_HANDLING_COST",
        "tlm_shipment_joined_w_cal_filtered"."GRS_OPERATION" AS "GRS_OPERATION",
        "tlm_shipment_joined_w_cal_filtered"."IS_GRS_OPT_CYCLE_RUNNING" AS "IS_GRS_OPT_CYCLE_RUNNING",
        "tlm_shipment_joined_w_cal_filtered"."IS_MANUAL_ASSIGN" AS "IS_MANUAL_ASSIGN",
        "tlm_shipment_joined_w_cal_filtered"."LAST_RUN_GRS_DTTM" AS "LAST_RUN_GRS_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."GRS_MAX_SHIPMENT_STATUS" AS "GRS_MAX_SHIPMENT_STATUS",
        "tlm_shipment_joined_w_cal_filtered"."PRIORITY_TYPE" AS "PRIORITY_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."MV_CURRENCY_CODE" AS "MV_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."PROD_SCHED_REF_NUMBER" AS "PROD_SCHED_REF_NUMBER",
        "tlm_shipment_joined_w_cal_filtered"."COMMODITY_CODE_ID" AS "COMMODITY_CODE_ID",
        "tlm_shipment_joined_w_cal_filtered"."UN_NUMBER_ID" AS "UN_NUMBER_ID",
        "tlm_shipment_joined_w_cal_filtered"."CONTRACT_NUMBER" AS "CONTRACT_NUMBER",
        "tlm_shipment_joined_w_cal_filtered"."BOOKING_REF_SHIPPER" AS "BOOKING_REF_SHIPPER",
        "tlm_shipment_joined_w_cal_filtered"."BOOKING_REF_CARRIER" AS "BOOKING_REF_CARRIER",
        "tlm_shipment_joined_w_cal_filtered"."BK_RESOURCE_REF_EXTERNAL" AS "BK_RESOURCE_REF_EXTERNAL",
        "tlm_shipment_joined_w_cal_filtered"."BK_RESOURCE_NAME_EXTERNAL" AS "BK_RESOURCE_NAME_EXTERNAL",
        "tlm_shipment_joined_w_cal_filtered"."BK_O_FACILITY_ID" AS "BK_O_FACILITY_ID",
        "tlm_shipment_joined_w_cal_filtered"."BK_D_FACILITY_ID" AS "BK_D_FACILITY_ID",
        "tlm_shipment_joined_w_cal_filtered"."BK_MASTER_AIRWAY_BILL" AS "BK_MASTER_AIRWAY_BILL",
        "tlm_shipment_joined_w_cal_filtered"."BK_FORWARDER_AIRWAY_BILL" AS "BK_FORWARDER_AIRWAY_BILL",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_SCNDR_CARRIER_CODE" AS "ASSIGNED_SCNDR_CARRIER_CODE",
        "tlm_shipment_joined_w_cal_filtered"."CUSTOMER_CREDIT_LIMIT_ID" AS "CUSTOMER_CREDIT_LIMIT_ID",
        "tlm_shipment_joined_w_cal_filtered"."SHIPMENT_LEG_TYPE" AS "SHIPMENT_LEG_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."SHIPMENT_CLOSED_INDICATOR" AS "SHIPMENT_CLOSED_INDICATOR",
        "tlm_shipment_joined_w_cal_filtered"."OCEAN_ROUTING_STAGE" AS "OCEAN_ROUTING_STAGE",
        "tlm_shipment_joined_w_cal_filtered"."BK_DEPARTURE_DTTM" AS "BK_DEPARTURE_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."BK_DEPARTURE_TZ" AS "BK_DEPARTURE_TZ",
        "tlm_shipment_joined_w_cal_filtered"."BK_ARRIVAL_DTTM" AS "BK_ARRIVAL_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."BK_ARRIVAL_TZ" AS "BK_ARRIVAL_TZ",
        "tlm_shipment_joined_w_cal_filtered"."BK_PICKUP_DTTM" AS "BK_PICKUP_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."BK_PICKUP_TZ" AS "BK_PICKUP_TZ",
        "tlm_shipment_joined_w_cal_filtered"."BK_CUTOFF_DTTM" AS "BK_CUTOFF_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."BK_CUTOFF_TZ" AS "BK_CUTOFF_TZ",
        "tlm_shipment_joined_w_cal_filtered"."NUM_CHARGE_LAYOVERS" AS "NUM_CHARGE_LAYOVERS",
        "tlm_shipment_joined_w_cal_filtered"."RATE_TYPE" AS "RATE_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."RATE_UOM" AS "RATE_UOM",
        "tlm_shipment_joined_w_cal_filtered"."PICK_START_DTTM" AS "PICK_START_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."PAPERWORK_START_DTTM" AS "PAPERWORK_START_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."VEHICLE_CHECK_START_DTTM" AS "VEHICLE_CHECK_START_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."SHIPMENT_START_DTTM" AS "SHIPMENT_START_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."SHIPMENT_END_DTTM" AS "SHIPMENT_END_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."FEASIBLE_DRIVER_TYPE" AS "FEASIBLE_DRIVER_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."WAVE_ID" AS "WAVE_ID",
        "tlm_shipment_joined_w_cal_filtered"."ESTIMATED_DISPATCH_DTTM" AS "ESTIMATED_DISPATCH_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."TOTAL_TIME" AS "TOTAL_TIME",
        "tlm_shipment_joined_w_cal_filtered"."LOC_REFERENCE" AS "LOC_REFERENCE",
        "tlm_shipment_joined_w_cal_filtered"."BK_O_FACILITY_ALIAS_ID" AS "BK_O_FACILITY_ALIAS_ID",
        "tlm_shipment_joined_w_cal_filtered"."BK_D_FACILITY_ALIAS_ID" AS "BK_D_FACILITY_ALIAS_ID",
        "tlm_shipment_joined_w_cal_filtered"."EQUIP_UTIL_PER" AS "EQUIP_UTIL_PER",
        "tlm_shipment_joined_w_cal_filtered"."MOVE_TYPE" AS "MOVE_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."DRIVER_TYPE_ID" AS "DRIVER_TYPE_ID",
        "tlm_shipment_joined_w_cal_filtered"."EQUIPMENT_TYPE" AS "EQUIPMENT_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."RADIAL_DISTANCE" AS "RADIAL_DISTANCE",
        "tlm_shipment_joined_w_cal_filtered"."RADIAL_DISTANCE_UOM" AS "RADIAL_DISTANCE_UOM",
        "tlm_shipment_joined_w_cal_filtered"."DESIGNATED_TRACTOR_CODE" AS "DESIGNATED_TRACTOR_CODE",
        "tlm_shipment_joined_w_cal_filtered"."DESIGNATED_DRIVER_TYPE" AS "DESIGNATED_DRIVER_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."IS_WAVE_MAN_CHANGED" AS "IS_WAVE_MAN_CHANGED",
        "tlm_shipment_joined_w_cal_filtered"."RETAIN_CONSOLIDATOR_TIMES" AS "RETAIN_CONSOLIDATOR_TIMES",
        "tlm_shipment_joined_w_cal_filtered"."TARIFF" AS "TARIFF",
        "tlm_shipment_joined_w_cal_filtered"."MIN_RATE" AS "MIN_RATE",
        "tlm_shipment_joined_w_cal_filtered"."FIRST_UPDATE_SENT_TO_PKMS" AS "FIRST_UPDATE_SENT_TO_PKMS",
        "tlm_shipment_joined_w_cal_filtered"."EVENT_IND_TYPEID" AS "EVENT_IND_TYPEID",
        "tlm_shipment_joined_w_cal_filtered"."TANDEM_PATH_ID" AS "TANDEM_PATH_ID",
        "tlm_shipment_joined_w_cal_filtered"."O_TANDEM_FACILITY" AS "O_TANDEM_FACILITY",
        "tlm_shipment_joined_w_cal_filtered"."D_TANDEM_FACILITY" AS "D_TANDEM_FACILITY",
        "tlm_shipment_joined_w_cal_filtered"."O_TANDEM_FACILITY_ALIAS" AS "O_TANDEM_FACILITY_ALIAS",
        "tlm_shipment_joined_w_cal_filtered"."D_TANDEM_FACILITY_ALIAS" AS "D_TANDEM_FACILITY_ALIAS",
        "tlm_shipment_joined_w_cal_filtered"."DELAY_TYPE" AS "DELAY_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_CARRIER_ID" AS "ASSIGNED_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."DSG_CARRIER_ID" AS "DSG_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_CARRIER_ID" AS "REC_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."FEASIBLE_CARRIER_ID" AS "FEASIBLE_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."PAYEE_CARRIER_ID" AS "PAYEE_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."SCNDR_CARRIER_ID" AS "SCNDR_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."BROKER_CARRIER_ID" AS "BROKER_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_SCNDR_CARRIER_ID" AS "ASSIGNED_SCNDR_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."DSG_SCNDR_CARRIER_ID" AS "DSG_SCNDR_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_BROKER_CARRIER_ID" AS "ASSIGNED_BROKER_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."LH_PAYEE_CARRIER_ID" AS "LH_PAYEE_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_BROKER_CARRIER_ID" AS "REC_BROKER_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_EQUIPMENT_ID" AS "ASSIGNED_EQUIPMENT_ID",
        "tlm_shipment_joined_w_cal_filtered"."DSG_EQUIPMENT_ID" AS "DSG_EQUIPMENT_ID",
        "tlm_shipment_joined_w_cal_filtered"."FEASIBLE_EQUIPMENT_ID" AS "FEASIBLE_EQUIPMENT_ID",
        "tlm_shipment_joined_w_cal_filtered"."FEASIBLE_EQUIPMENT2_ID" AS "FEASIBLE_EQUIPMENT2_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_EQUIPMENT_ID" AS "REC_EQUIPMENT_ID",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_MOT_ID" AS "ASSIGNED_MOT_ID",
        "tlm_shipment_joined_w_cal_filtered"."DSG_MOT_ID" AS "DSG_MOT_ID",
        "tlm_shipment_joined_w_cal_filtered"."FEASIBLE_MOT_ID" AS "FEASIBLE_MOT_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_MOT_ID" AS "REC_MOT_ID",
        "tlm_shipment_joined_w_cal_filtered"."PRODUCT_CLASS_ID" AS "PRODUCT_CLASS_ID",
        "tlm_shipment_joined_w_cal_filtered"."PROTECTION_LEVEL_ID" AS "PROTECTION_LEVEL_ID",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_SERVICE_LEVEL_ID" AS "ASSIGNED_SERVICE_LEVEL_ID",
        "tlm_shipment_joined_w_cal_filtered"."DSG_SERVICE_LEVEL_ID" AS "DSG_SERVICE_LEVEL_ID",
        "tlm_shipment_joined_w_cal_filtered"."FEASIBLE_SERVICE_LEVEL_ID" AS "FEASIBLE_SERVICE_LEVEL_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_SERVICE_LEVEL_ID" AS "REC_SERVICE_LEVEL_ID",
        "tlm_shipment_joined_w_cal_filtered"."HAS_EM_NOTIFY_FLAG" AS "HAS_EM_NOTIFY_FLAG",
        "tlm_shipment_joined_w_cal_filtered"."REGION_ID" AS "REGION_ID",
        "tlm_shipment_joined_w_cal_filtered"."INBOUND_REGION_ID" AS "INBOUND_REGION_ID",
        "tlm_shipment_joined_w_cal_filtered"."OUTBOUND_REGION_ID" AS "OUTBOUND_REGION_ID",
        "tlm_shipment_joined_w_cal_filtered"."FINANCIAL_WT" AS "FINANCIAL_WT",
        "tlm_shipment_joined_w_cal_filtered"."IS_BOOKING_REQUIRED" AS "IS_BOOKING_REQUIRED",
        "tlm_shipment_joined_w_cal_filtered"."TOTAL_COST_EXCL_TAX" AS "TOTAL_COST_EXCL_TAX",
        "tlm_shipment_joined_w_cal_filtered"."TOTAL_TAX_AMOUNT" AS "TOTAL_TAX_AMOUNT",
        "tlm_shipment_joined_w_cal_filtered"."IS_ASSOCIATED_TO_OUTBOUND" AS "IS_ASSOCIATED_TO_OUTBOUND",
        "tlm_shipment_joined_w_cal_filtered"."RECEIVED_DTTM" AS "RECEIVED_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."BOOKING_ID" AS "BOOKING_ID",
        "tlm_shipment_joined_w_cal_filtered"."IS_MISROUTED" AS "IS_MISROUTED",
        "tlm_shipment_joined_w_cal_filtered"."FEASIBLE_CARRIER_CODE" AS "FEASIBLE_CARRIER_CODE",
        "tlm_shipment_joined_w_cal_filtered"."SHIPMENT_WIN_ADJ_FLAG" AS "SHIPMENT_WIN_ADJ_FLAG",
        "tlm_shipment_joined_w_cal_filtered"."DT_PARAM_SET_ID" AS "DT_PARAM_SET_ID",
        "tlm_shipment_joined_w_cal_filtered"."MERCHANDIZING_DEPARTMENT_ID" AS "MERCHANDIZING_DEPARTMENT_ID",
        "tlm_shipment_joined_w_cal_filtered"."STATIC_ROUTE_ID" AS "STATIC_ROUTE_ID",
        "tlm_shipment_joined_w_cal_filtered"."IS_FILO" AS "IS_FILO",
        "tlm_shipment_joined_w_cal_filtered"."IS_COOLER_AT_NOSE" AS "IS_COOLER_AT_NOSE",
        "tlm_shipment_joined_w_cal_filtered"."AUTH_NBR" AS "AUTH_NBR",
        "tlm_shipment_joined_w_cal_filtered"."CONS_LOCN_ID" AS "CONS_LOCN_ID",
        "tlm_shipment_joined_w_cal_filtered"."RTE_TYPE" AS "RTE_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."TRLR_TYPE" AS "TRLR_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."TRLR_SIZE" AS "TRLR_SIZE",
        "tlm_shipment_joined_w_cal_filtered"."CONS_ADDR_CODE" AS "CONS_ADDR_CODE",
        "tlm_shipment_joined_w_cal_filtered"."HUB_ID" AS "HUB_ID",
        "tlm_shipment_joined_w_cal_filtered"."TRLR_GEN_CODE" AS "TRLR_GEN_CODE",
        "tlm_shipment_joined_w_cal_filtered"."MAX_NBR_OF_CTNS" AS "MAX_NBR_OF_CTNS",
        "tlm_shipment_joined_w_cal_filtered"."APPT_DOOR_SCHED_TYPE" AS "APPT_DOOR_SCHED_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."CREATED_SOURCE_TYPE" AS "CREATED_SOURCE_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."CREATED_SOURCE" AS "CREATED_SOURCE",
        "tlm_shipment_joined_w_cal_filtered"."CREATED_DTTM" AS "CREATED_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."LAST_UPDATED_SOURCE_TYPE" AS "LAST_UPDATED_SOURCE_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."LAST_UPDATED_SOURCE" AS "LAST_UPDATED_SOURCE",
        "tlm_shipment_joined_w_cal_filtered"."LAST_UPDATED_DTTM" AS "LAST_UPDATED_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."DSG_SCNDR_CARRIER_CODE" AS "DSG_SCNDR_CARRIER_CODE",
        "tlm_shipment_joined_w_cal_filtered"."LH_PAYEE_CARRIER_CODE" AS "LH_PAYEE_CARRIER_CODE",
        "tlm_shipment_joined_w_cal_filtered"."REC_BROKER_CARRIER_CODE" AS "REC_BROKER_CARRIER_CODE",
        "tlm_shipment_joined_w_cal_filtered"."REC_CARRIER_CODE" AS "REC_CARRIER_CODE",
        "tlm_shipment_joined_w_cal_filtered"."LPN_ASSIGNMENT_STOPPED" AS "LPN_ASSIGNMENT_STOPPED",
        "tlm_shipment_joined_w_cal_filtered"."SEAL_NUMBER" AS "SEAL_NUMBER",
        "tlm_shipment_joined_w_cal_filtered"."HIBERNATE_VERSION" AS "HIBERNATE_VERSION",
        "tlm_shipment_joined_w_cal_filtered"."SHIP_GROUP_ID" AS "SHIP_GROUP_ID",
        "tlm_shipment_joined_w_cal_filtered"."RATE" AS "RATE",
        "tlm_shipment_joined_w_cal_filtered"."MONETARY_VALUE" AS "MONETARY_VALUE",
        "tlm_shipment_joined_w_cal_filtered"."DOOR" AS "DOOR",
        "tlm_shipment_joined_w_cal_filtered"."RTE_TYPE_1" AS "RTE_TYPE_1",
        "tlm_shipment_joined_w_cal_filtered"."RTE_TYPE_2" AS "RTE_TYPE_2",
        "tlm_shipment_joined_w_cal_filtered"."SCHEDULED_PICKUP_DTTM" AS "SCHEDULED_PICKUP_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."MANIFEST_ID" AS "MANIFEST_ID",
        "tlm_shipment_joined_w_cal_filtered"."DAYS_TO_DELIVER" AS "DAYS_TO_DELIVER",
        "tlm_shipment_joined_w_cal_filtered"."SED_GENERATED_FLAG" AS "SED_GENERATED_FLAG",
        "tlm_shipment_joined_w_cal_filtered"."SERV_AREA_CODE" AS "SERV_AREA_CODE",
        "tlm_shipment_joined_w_cal_filtered"."TENDER_RESP_DEADLINE_DTTM" AS "TENDER_RESP_DEADLINE_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."PRINT_CONS_BOL" AS "PRINT_CONS_BOL",
        "tlm_shipment_joined_w_cal_filtered"."LEFT_WT" AS "LEFT_WT",
        "tlm_shipment_joined_w_cal_filtered"."RIGHT_WT" AS "RIGHT_WT",
        "tlm_shipment_joined_w_cal_filtered"."LANE_NAME" AS "LANE_NAME",
        "tlm_shipment_joined_w_cal_filtered"."DECLARED_VALUE" AS "DECLARED_VALUE",
        "tlm_shipment_joined_w_cal_filtered"."DV_CURRENCY_CODE" AS "DV_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."COD_AMOUNT" AS "COD_AMOUNT",
        "tlm_shipment_joined_w_cal_filtered"."CUSTOMER_ID" AS "CUSTOMER_ID",
        "tlm_shipment_joined_w_cal_filtered"."CUST_FRGT_CHARGE" AS "CUST_FRGT_CHARGE",
        "tlm_shipment_joined_w_cal_filtered"."COD_CURRENCY_CODE" AS "COD_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."PLANNED_WEIGHT" AS "PLANNED_WEIGHT",
        "tlm_shipment_joined_w_cal_filtered"."WEIGHT_UOM_ID_BASE" AS "WEIGHT_UOM_ID_BASE",
        "tlm_shipment_joined_w_cal_filtered"."PLANNED_VOLUME" AS "PLANNED_VOLUME",
        "tlm_shipment_joined_w_cal_filtered"."VOLUME_UOM_ID_BASE" AS "VOLUME_UOM_ID_BASE",
        "tlm_shipment_joined_w_cal_filtered"."SIZE1_VALUE" AS "SIZE1_VALUE",
        "tlm_shipment_joined_w_cal_filtered"."SIZE1_UOM_ID" AS "SIZE1_UOM_ID",
        "tlm_shipment_joined_w_cal_filtered"."SIZE2_VALUE" AS "SIZE2_VALUE",
        "tlm_shipment_joined_w_cal_filtered"."SIZE2_UOM_ID" AS "SIZE2_UOM_ID",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_SHIP_VIA" AS "ASSIGNED_SHIP_VIA",
        "tlm_shipment_joined_w_cal_filtered"."INSURANCE_STATUS" AS "INSURANCE_STATUS",
        "tlm_shipment_joined_w_cal_filtered"."RTE_SWC_NBR" AS "RTE_SWC_NBR",
        "tlm_shipment_joined_w_cal_filtered"."RTE_TO" AS "RTE_TO",
        "tlm_shipment_joined_w_cal_filtered"."BILL_OF_LADING_NUMBER" AS "BILL_OF_LADING_NUMBER",
        "tlm_shipment_joined_w_cal_filtered"."TRAILER_NUMBER" AS "TRAILER_NUMBER",
        "tlm_shipment_joined_w_cal_filtered"."TRANS_PLAN_OWNER" AS "TRANS_PLAN_OWNER",
        "tlm_shipment_joined_w_cal_filtered"."TOTAL_REVENUE_CURRENCY_CODE" AS "TOTAL_REVENUE_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."TOTAL_REVENUE" AS "TOTAL_REVENUE",
        "tlm_shipment_joined_w_cal_filtered"."FRT_REV_SPOT_CHARGE_CURR_CODE" AS "FRT_REV_SPOT_CHARGE_CURR_CODE",
        "tlm_shipment_joined_w_cal_filtered"."NORMALIZED_TOTAL_REVENUE" AS "NORMALIZED_TOTAL_REVENUE",
        "tlm_shipment_joined_w_cal_filtered"."FRT_REV_SPOT_CHARGE" AS "FRT_REV_SPOT_CHARGE",
        "tlm_shipment_joined_w_cal_filtered"."DSG_VOYAGE_FLIGHT" AS "DSG_VOYAGE_FLIGHT",
        "tlm_shipment_joined_w_cal_filtered"."FEASIBLE_VOYAGE_FLIGHT" AS "FEASIBLE_VOYAGE_FLIGHT",
        "tlm_shipment_joined_w_cal_filtered"."CURRENCY_DTTM" AS "CURRENCY_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."FRT_REV_LINEHAUL_CHARGE" AS "FRT_REV_LINEHAUL_CHARGE",
        "tlm_shipment_joined_w_cal_filtered"."FRT_REV_STOP_CHARGE" AS "FRT_REV_STOP_CHARGE",
        "tlm_shipment_joined_w_cal_filtered"."FRT_REV_ACCESSORIAL_CHARGE" AS "FRT_REV_ACCESSORIAL_CHARGE",
        "tlm_shipment_joined_w_cal_filtered"."MARGIN" AS "MARGIN",
        "tlm_shipment_joined_w_cal_filtered"."TOTAL_COST" AS "TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."INCOTERM_ID" AS "INCOTERM_ID",
        "tlm_shipment_joined_w_cal_filtered"."ORDER_QTY" AS "ORDER_QTY",
        "tlm_shipment_joined_w_cal_filtered"."QTY_UOM_ID" AS "QTY_UOM_ID",
        "tlm_shipment_joined_w_cal_filtered"."REF_SHIPMENT_NBR" AS "REF_SHIPMENT_NBR",
        "tlm_shipment_joined_w_cal_filtered"."STAGING_LOCN_ID" AS "STAGING_LOCN_ID",
        "tlm_shipment_joined_w_cal_filtered"."LOADING_SEQ_ORD" AS "LOADING_SEQ_ORD",
        "tlm_shipment_joined_w_cal_filtered"."HAZMAT_CERT_CONTACT" AS "HAZMAT_CERT_CONTACT",
        "tlm_shipment_joined_w_cal_filtered"."HAZMAT_CERT_DECLARATION" AS "HAZMAT_CERT_DECLARATION",
        "tlm_shipment_joined_w_cal_filtered"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP",
        "tlm_shipment_joined_w_cal_filtered"."OPERATION_TYPE" AS "OPERATION_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."ARCHIVED_DTTM" AS "ARCHIVED_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."ORIGIN" AS "ORIGIN",
        "tlm_shipment_joined_w_cal_filtered"."FINAL_DESTINATION" AS "FINAL_DESTINATION",
        "tlm_shipment_joined_w_cal_filtered"."actual_delivery_date_parsed" AS "actual_delivery_date_parsed",
        "tlm_shipment_joined_w_cal_filtered"."wood_pellet" AS "wood_pellet",
        "tlm_shipment_joined_w_cal_filtered"."act_del_MERCH_YEAR" AS "act_del_MERCH_YEAR",
        "tlm_shipment_joined_w_cal_filtered"."act_del_YEAR_WEEK" AS "act_del_YEAR_WEEK",
        "tlm_shipment_joined_w_cal_filtered"."act_del_YEAR_QUARTER" AS "act_del_YEAR_QUARTER",
        "tlm_shipment_joined_w_cal_filtered"."act_del_YEAR_PERIOD" AS "act_del_YEAR_PERIOD",
        "domestic_shipping_freight_w_cal_filtered_test_TC_Object_ID"."invoice_shipping_id" AS "invoice_shipping_id",
           SUM("TOTAL_COST") OVER (PARTITION BY "TC_SHIPMENT_ID" ORDER BY "SHIPMENT_ID" ASC NULLS FIRST) AS "TOTAL_COST_sum",
            ROW_NUMBER() OVER (PARTITION BY "TC_SHIPMENT_ID" ORDER BY "SHIPMENT_ID" ASC NULLS FIRST) AS "rownumber"
      FROM "TLM_SHIPMENT_W_CAl_FILTERED" "tlm_shipment_joined_w_cal_filtered"
      LEFT JOIN (
        SELECT 
            "TC_OBJECT_ID" AS "TC_OBJECT_ID",
            1 AS "invoice_shipping_id"
          FROM (
            SELECT  *
              FROM "DOMESTIC_SHIPPING_FREIGHT_W_CAL_FILTERED_TEST_TC_OBJECT_ID" "domestic_shipping_freight_w_cal_filtered_test_TC_Object_ID"
            ) "withoutcomputedcols_query"
        ) "domestic_shipping_freight_w_cal_filtered_test_TC_Object_ID"
        ON "tlm_shipment_joined_w_cal_filtered"."TC_SHIPMENT_ID" = "domestic_shipping_freight_w_cal_filtered_test_TC_Object_ID"."TC_OBJECT_ID"
    ) "unfiltered_query"
  WHERE ("invoice_shipping_id" != 1 OR "invoice_shipping_id" IS NULL AND 1 IS NOT NULL OR "invoice_shipping_id" IS NOT NULL AND 1 IS NULL)
        AND "rownumber" = 1
        )

        SELECT * FROM 
        (
        SELECT 
    "SHIPMENT_ID" AS "SHIPMENT_ID",
    "TC_COMPANY_ID" AS "TC_COMPANY_ID",
    "RS_AREA_ID" AS "RS_AREA_ID",
    "TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID",
    "PP_SHIPMENT_ID" AS "PP_SHIPMENT_ID",
    "SHIPMENT_STATUS" AS "SHIPMENT_STATUS",
    "UPDATE_SENT" AS "UPDATE_SENT",
    "BUSINESS_PROCESS" AS "BUSINESS_PROCESS",
    "CREATION_TYPE" AS "CREATION_TYPE",
    "CONS_RUN_ID" AS "CONS_RUN_ID",
    "IS_CANCELLED" AS "IS_CANCELLED",
    "RS_TYPE" AS "RS_TYPE",
    "RS_CONFIG_ID" AS "RS_CONFIG_ID",
    "RS_CONFIG_CYCLE_ID" AS "RS_CONFIG_CYCLE_ID",
    "CONFIG_CYCLE_SEQ" AS "CONFIG_CYCLE_SEQ",
    "CYCLE_DEADLINE_DTTM" AS "CYCLE_DEADLINE_DTTM",
    "CYCLE_EXECUTION_DTTM" AS "CYCLE_EXECUTION_DTTM",
    "LAST_RS_NOTIFICATION_DTTM" AS "LAST_RS_NOTIFICATION_DTTM",
    "CFMF_STATUS" AS "CFMF_STATUS",
    "AVAILABLE_DTTM" AS "AVAILABLE_DTTM",
    "CMID" AS "CMID",
    "CM_DISCOUNT" AS "CM_DISCOUNT",
    "O_FACILITY_NUMBER" AS "O_FACILITY_NUMBER",
    "O_FACILITY_ID" AS "O_FACILITY_ID",
    "O_ADDRESS" AS "O_ADDRESS",
    "O_CITY" AS "O_CITY",
    "O_STATE_PROV" AS "O_STATE_PROV",
    "O_POSTAL_CODE" AS "O_POSTAL_CODE",
    "O_COUNTY" AS "O_COUNTY",
    "O_COUNTRY_CODE" AS "O_COUNTRY_CODE",
    "D_FACILITY_NUMBER" AS "D_FACILITY_NUMBER",
    "D_FACILITY_ID" AS "D_FACILITY_ID",
    "D_ADDRESS" AS "D_ADDRESS",
    "D_CITY" AS "D_CITY",
    "D_STATE_PROV" AS "D_STATE_PROV",
    "D_POSTAL_CODE" AS "D_POSTAL_CODE",
    "D_COUNTY" AS "D_COUNTY",
    "D_COUNTRY_CODE" AS "D_COUNTRY_CODE",
    "DISTANCE" AS "DISTANCE",
    "DIRECT_DISTANCE" AS "DIRECT_DISTANCE",
    "OUT_OF_ROUTE_DISTANCE" AS "OUT_OF_ROUTE_DISTANCE",
    "DISTANCE_UOM" AS "DISTANCE_UOM",
    "BUSINESS_PARTNER_ID" AS "BUSINESS_PARTNER_ID",
    "COMMODITY_CLASS" AS "COMMODITY_CLASS",
    "IS_HAZMAT" AS "IS_HAZMAT",
    "IS_PERISHABLE" AS "IS_PERISHABLE",
    "BILLING_METHOD" AS "BILLING_METHOD",
    "DSG_CARRIER_CODE" AS "DSG_CARRIER_CODE",
    "REC_CMID" AS "REC_CMID",
    "REC_CM_SHIPMENT_ID" AS "REC_CM_SHIPMENT_ID",
    "ASSIGNED_CARRIER_CODE" AS "ASSIGNED_CARRIER_CODE",
    "SHIPMENT_REF_ID" AS "SHIPMENT_REF_ID",
    "BILL_TO_CODE" AS "BILL_TO_CODE",
    "BILL_TO_TITLE" AS "BILL_TO_TITLE",
    "BILL_TO_NAME" AS "BILL_TO_NAME",
    "BILL_TO_ADDRESS" AS "BILL_TO_ADDRESS",
    "BILL_TO_CITY" AS "BILL_TO_CITY",
    "BILL_TO_STATE_PROV" AS "BILL_TO_STATE_PROV",
    "BILL_TO_POSTAL_CODE" AS "BILL_TO_POSTAL_CODE",
    "BILL_TO_COUNTRY_CODE" AS "BILL_TO_COUNTRY_CODE",
    "BILL_TO_PHONE_NUMBER" AS "BILL_TO_PHONE_NUMBER",
    "PURCHASE_ORDER" AS "PURCHASE_ORDER",
    "PRO_NUMBER" AS "PRO_NUMBER",
    "TRANS_RESP_CODE" AS "TRANS_RESP_CODE",
    "BASELINE_COST" AS "BASELINE_COST",
    "ESTIMATED_COST" AS "ESTIMATED_COST",
    "LINEHAUL_COST" AS "LINEHAUL_COST",
    "ACCESSORIAL_COST" AS "ACCESSORIAL_COST",
    "STOP_COST" AS "STOP_COST",
    "ESTIMATED_SAVINGS" AS "ESTIMATED_SAVINGS",
    "SPOT_CHARGE" AS "SPOT_CHARGE",
    "CURRENCY_CODE" AS "CURRENCY_CODE",
    "PICKUP_START_DTTM" AS "PICKUP_START_DTTM",
    "PICKUP_END_DTTM" AS "PICKUP_END_DTTM",
    "DELIVERY_START_DTTM" AS "DELIVERY_START_DTTM",
    "DELIVERY_END_DTTM" AS "DELIVERY_END_DTTM",
    "NUM_STOPS" AS "NUM_STOPS",
    "NUM_DOCKS" AS "NUM_DOCKS",
    "ON_TIME_INDICATOR" AS "ON_TIME_INDICATOR",
    "HAS_NOTES" AS "HAS_NOTES",
    "HAS_ALERTS" AS "HAS_ALERTS",
    "HAS_IMPORT_ERROR" AS "HAS_IMPORT_ERROR",
    "HAS_SOFT_CHECK_ERROR" AS "HAS_SOFT_CHECK_ERROR",
    "HAS_TRACKING_MSG" AS "HAS_TRACKING_MSG",
    "TRACKING_MSG_PROBLEM" AS "TRACKING_MSG_PROBLEM",
    "REC_LINEHAUL_COST" AS "REC_LINEHAUL_COST",
    "REC_ACCESSORIAL_COST" AS "REC_ACCESSORIAL_COST",
    "REC_TOTAL_COST" AS "REC_TOTAL_COST",
    "CYCLE_RESP_DEADLINE_TZ" AS "CYCLE_RESP_DEADLINE_TZ",
    "TENDER_RESP_DEADLINE_TZ" AS "TENDER_RESP_DEADLINE_TZ",
    "PICKUP_TZ" AS "PICKUP_TZ",
    "DELIVERY_TZ" AS "DELIVERY_TZ",
    "ASSIGNED_LANE_ID" AS "ASSIGNED_LANE_ID",
    "ASSIGNED_LANE_DETAIL_ID" AS "ASSIGNED_LANE_DETAIL_ID",
    "REC_SPOT_CHARGE" AS "REC_SPOT_CHARGE",
    "REC_LANE_ID" AS "REC_LANE_ID",
    "REC_LANE_DETAIL_ID" AS "REC_LANE_DETAIL_ID",
    "TENDER_DTTM" AS "TENDER_DTTM",
    "O_STOP_LOCATION_NAME" AS "O_STOP_LOCATION_NAME",
    "D_STOP_LOCATION_NAME" AS "D_STOP_LOCATION_NAME",
    "ASSIGNED_CM_SHIPMENT_ID" AS "ASSIGNED_CM_SHIPMENT_ID",
    "REC_CM_DISCOUNT" AS "REC_CM_DISCOUNT",
    "REC_STOP_COST" AS "REC_STOP_COST",
    "LAST_SELECTOR_RUN_DTTM" AS "LAST_SELECTOR_RUN_DTTM",
    "LAST_CM_OPTION_GEN_DTTM" AS "LAST_CM_OPTION_GEN_DTTM",
    "IS_CM_OPTION_GEN_ACTIVE" AS "IS_CM_OPTION_GEN_ACTIVE",
    "RS_CYCLE_REMAINING" AS "RS_CYCLE_REMAINING",
    "IS_TIME_FEAS_ENABLED" AS "IS_TIME_FEAS_ENABLED",
    "EXT_SYS_SHIPMENT_ID" AS "EXT_SYS_SHIPMENT_ID",
    "EXTRACTION_DTTM" AS "EXTRACTION_DTTM",
    "ASSIGNED_BROKER_CARRIER_CODE" AS "ASSIGNED_BROKER_CARRIER_CODE",
    "USE_BROKER_AS_CARRIER" AS "USE_BROKER_AS_CARRIER",
    "BROKER_REF" AS "BROKER_REF",
    "RATING_QUALIFIER" AS "RATING_QUALIFIER",
    "STATUS_CHANGE_DTTM" AS "STATUS_CHANGE_DTTM",
    "BUDG_TOTAL_COST" AS "BUDG_TOTAL_COST",
    "NORMALIZED_MARGIN" AS "NORMALIZED_MARGIN",
    "NORMALIZED_TOTAL_COST" AS "NORMALIZED_TOTAL_COST",
    "BUDG_NORMALIZED_TOTAL_COST" AS "BUDG_NORMALIZED_TOTAL_COST",
    "REC_BUDG_LINEHAUL_COST" AS "REC_BUDG_LINEHAUL_COST",
    "REC_BUDG_STOP_COST" AS "REC_BUDG_STOP_COST",
    "REC_BUDG_CM_DISCOUNT" AS "REC_BUDG_CM_DISCOUNT",
    "REC_BUDG_ACCESSORIAL_COST" AS "REC_BUDG_ACCESSORIAL_COST",
    "REC_BUDG_TOTAL_COST" AS "REC_BUDG_TOTAL_COST",
    "REC_MARGIN" AS "REC_MARGIN",
    "REC_NORMALIZED_MARGIN" AS "REC_NORMALIZED_MARGIN",
    "REC_NORMALIZED_TOTAL_COST" AS "REC_NORMALIZED_TOTAL_COST",
    "REC_BUDG_NORMALIZED_TOTAL_COST" AS "REC_BUDG_NORMALIZED_TOTAL_COST",
    "BUDG_CURRENCY_CODE" AS "BUDG_CURRENCY_CODE",
    "SPOT_CHARGE_CURRENCY_CODE" AS "SPOT_CHARGE_CURRENCY_CODE",
    "REC_CURRENCY_CODE" AS "REC_CURRENCY_CODE",
    "REC_BUDG_CURRENCY_CODE" AS "REC_BUDG_CURRENCY_CODE",
    "REC_SPOT_CHARGE_CURRENCY_CODE" AS "REC_SPOT_CHARGE_CURRENCY_CODE",
    "RATING_LANE_ID" AS "RATING_LANE_ID",
    "FRT_REV_RATING_LANE_ID" AS "FRT_REV_RATING_LANE_ID",
    "REC_RATING_LANE_ID" AS "REC_RATING_LANE_ID",
    "REC_BUDG_RATING_LANE_ID" AS "REC_BUDG_RATING_LANE_ID",
    "RATING_LANE_DETAIL_ID" AS "RATING_LANE_DETAIL_ID",
    "FRT_REV_RATING_LANE_DETAIL_ID" AS "FRT_REV_RATING_LANE_DETAIL_ID",
    "REC_RATING_LANE_DETAIL_ID" AS "REC_RATING_LANE_DETAIL_ID",
    "REC_BUDG_RATING_LANE_DETAIL_ID" AS "REC_BUDG_RATING_LANE_DETAIL_ID",
    "BUDG_CM_DISCOUNT" AS "BUDG_CM_DISCOUNT",
    "NORMALIZED_BASELINE_COST" AS "NORMALIZED_BASELINE_COST",
    "BASELINE_COST_CURRENCY_CODE" AS "BASELINE_COST_CURRENCY_CODE",
    "REPORTED_COST" AS "REPORTED_COST",
    "TRACTOR_NUMBER" AS "TRACTOR_NUMBER",
    "IS_AUTO_DELIVERED" AS "IS_AUTO_DELIVERED",
    "SHIPMENT_TYPE" AS "SHIPMENT_TYPE",
    "ORIG_BUDG_TOTAL_COST" AS "ORIG_BUDG_TOTAL_COST",
    "ACCESSORIAL_COST_TO_CARRIER" AS "ACCESSORIAL_COST_TO_CARRIER",
    "CARRIER_CHARGE" AS "CARRIER_CHARGE",
    "ACTUAL_COST" AS "ACTUAL_COST",
    "EARNED_INCOME" AS "EARNED_INCOME",
    "SENT_TO_PKMS" AS "SENT_TO_PKMS",
    "IS_SHIPMENT_RECONCILED" AS "IS_SHIPMENT_RECONCILED",
    "DELIVERY_REQ" AS "DELIVERY_REQ",
    "DROPOFF_PICKUP" AS "DROPOFF_PICKUP",
    "PACKAGING" AS "PACKAGING",
    "SENT_TO_PKMS_DTTM" AS "SENT_TO_PKMS_DTTM",
    "WMS_STATUS_CODE" AS "WMS_STATUS_CODE",
    "SPOT_CHARGE_AND_PAYEE_ACC" AS "SPOT_CHARGE_AND_PAYEE_ACC",
    "SPOT_CHARGE_AND_PAYEE_ACC_CC" AS "SPOT_CHARGE_AND_PAYEE_ACC_CC",
    "NORM_SPOT_CHARGE_AND_PAYEE_ACC" AS "NORM_SPOT_CHARGE_AND_PAYEE_ACC",
    "FACILITY_SCHEDULE_ID" AS "FACILITY_SCHEDULE_ID",
    "EARNED_INCOME_CURRENCY_CODE" AS "EARNED_INCOME_CURRENCY_CODE",
    "ACTUAL_COST_CURRENCY_CODE" AS "ACTUAL_COST_CURRENCY_CODE",
    "SHIPMENT_RECON_DTTM" AS "SHIPMENT_RECON_DTTM",
    "PLN_RATING_LANE_ID" AS "PLN_RATING_LANE_ID",
    "PLN_RATING_LANE_DETAIL_ID" AS "PLN_RATING_LANE_DETAIL_ID",
    "PLN_TOTAL_COST" AS "PLN_TOTAL_COST",
    "PLN_LINEHAUL_COST" AS "PLN_LINEHAUL_COST",
    "PLN_TOTAL_ACCESSORIAL_COST" AS "PLN_TOTAL_ACCESSORIAL_COST",
    "PLN_STOP_OFF_COST" AS "PLN_STOP_OFF_COST",
    "PLN_NORMALIZED_TOTAL_COST" AS "PLN_NORMALIZED_TOTAL_COST",
    "PLN_CURRENCY_CODE" AS "PLN_CURRENCY_CODE",
    "PLN_ACCESSORL_COST_TO_CARRIER" AS "PLN_ACCESSORL_COST_TO_CARRIER",
    "PLN_CARRIER_CHARGE" AS "PLN_CARRIER_CHARGE",
    "WAYPOINT_TOTAL_COST" AS "WAYPOINT_TOTAL_COST",
    "WAYPOINT_HANDLING_COST" AS "WAYPOINT_HANDLING_COST",
    "GRS_OPERATION" AS "GRS_OPERATION",
    "IS_GRS_OPT_CYCLE_RUNNING" AS "IS_GRS_OPT_CYCLE_RUNNING",
    "IS_MANUAL_ASSIGN" AS "IS_MANUAL_ASSIGN",
    "LAST_RUN_GRS_DTTM" AS "LAST_RUN_GRS_DTTM",
    "GRS_MAX_SHIPMENT_STATUS" AS "GRS_MAX_SHIPMENT_STATUS",
    "PRIORITY_TYPE" AS "PRIORITY_TYPE",
    "MV_CURRENCY_CODE" AS "MV_CURRENCY_CODE",
    "PROD_SCHED_REF_NUMBER" AS "PROD_SCHED_REF_NUMBER",
    "COMMODITY_CODE_ID" AS "COMMODITY_CODE_ID",
    "UN_NUMBER_ID" AS "UN_NUMBER_ID",
    "CONTRACT_NUMBER" AS "CONTRACT_NUMBER",
    "BOOKING_REF_SHIPPER" AS "BOOKING_REF_SHIPPER",
    "BOOKING_REF_CARRIER" AS "BOOKING_REF_CARRIER",
    "BK_RESOURCE_REF_EXTERNAL" AS "BK_RESOURCE_REF_EXTERNAL",
    "BK_RESOURCE_NAME_EXTERNAL" AS "BK_RESOURCE_NAME_EXTERNAL",
    "BK_O_FACILITY_ID" AS "BK_O_FACILITY_ID",
    "BK_D_FACILITY_ID" AS "BK_D_FACILITY_ID",
    "BK_MASTER_AIRWAY_BILL" AS "BK_MASTER_AIRWAY_BILL",
    "BK_FORWARDER_AIRWAY_BILL" AS "BK_FORWARDER_AIRWAY_BILL",
    "ASSIGNED_SCNDR_CARRIER_CODE" AS "ASSIGNED_SCNDR_CARRIER_CODE",
    "CUSTOMER_CREDIT_LIMIT_ID" AS "CUSTOMER_CREDIT_LIMIT_ID",
    "SHIPMENT_LEG_TYPE" AS "SHIPMENT_LEG_TYPE",
    "SHIPMENT_CLOSED_INDICATOR" AS "SHIPMENT_CLOSED_INDICATOR",
    "OCEAN_ROUTING_STAGE" AS "OCEAN_ROUTING_STAGE",
    "BK_DEPARTURE_DTTM" AS "BK_DEPARTURE_DTTM",
    "BK_DEPARTURE_TZ" AS "BK_DEPARTURE_TZ",
    "BK_ARRIVAL_DTTM" AS "BK_ARRIVAL_DTTM",
    "BK_ARRIVAL_TZ" AS "BK_ARRIVAL_TZ",
    "BK_PICKUP_DTTM" AS "BK_PICKUP_DTTM",
    "BK_PICKUP_TZ" AS "BK_PICKUP_TZ",
    "BK_CUTOFF_DTTM" AS "BK_CUTOFF_DTTM",
    "BK_CUTOFF_TZ" AS "BK_CUTOFF_TZ",
    "NUM_CHARGE_LAYOVERS" AS "NUM_CHARGE_LAYOVERS",
    "RATE_TYPE" AS "RATE_TYPE",
    "RATE_UOM" AS "RATE_UOM",
    "PICK_START_DTTM" AS "PICK_START_DTTM",
    "PAPERWORK_START_DTTM" AS "PAPERWORK_START_DTTM",
    "VEHICLE_CHECK_START_DTTM" AS "VEHICLE_CHECK_START_DTTM",
    "SHIPMENT_START_DTTM" AS "SHIPMENT_START_DTTM",
    "SHIPMENT_END_DTTM" AS "SHIPMENT_END_DTTM",
    "FEASIBLE_DRIVER_TYPE" AS "FEASIBLE_DRIVER_TYPE",
    "WAVE_ID" AS "WAVE_ID",
    "ESTIMATED_DISPATCH_DTTM" AS "ESTIMATED_DISPATCH_DTTM",
    "TOTAL_TIME" AS "TOTAL_TIME",
    "LOC_REFERENCE" AS "LOC_REFERENCE",
    "BK_O_FACILITY_ALIAS_ID" AS "BK_O_FACILITY_ALIAS_ID",
    "BK_D_FACILITY_ALIAS_ID" AS "BK_D_FACILITY_ALIAS_ID",
    "EQUIP_UTIL_PER" AS "EQUIP_UTIL_PER",
    "MOVE_TYPE" AS "MOVE_TYPE",
    "DRIVER_TYPE_ID" AS "DRIVER_TYPE_ID",
    "EQUIPMENT_TYPE" AS "EQUIPMENT_TYPE",
    "RADIAL_DISTANCE" AS "RADIAL_DISTANCE",
    "RADIAL_DISTANCE_UOM" AS "RADIAL_DISTANCE_UOM",
    "DESIGNATED_TRACTOR_CODE" AS "DESIGNATED_TRACTOR_CODE",
    "DESIGNATED_DRIVER_TYPE" AS "DESIGNATED_DRIVER_TYPE",
    "IS_WAVE_MAN_CHANGED" AS "IS_WAVE_MAN_CHANGED",
    "RETAIN_CONSOLIDATOR_TIMES" AS "RETAIN_CONSOLIDATOR_TIMES",
    "TARIFF" AS "TARIFF",
    "MIN_RATE" AS "MIN_RATE",
    "FIRST_UPDATE_SENT_TO_PKMS" AS "FIRST_UPDATE_SENT_TO_PKMS",
    "EVENT_IND_TYPEID" AS "EVENT_IND_TYPEID",
    "TANDEM_PATH_ID" AS "TANDEM_PATH_ID",
    "O_TANDEM_FACILITY" AS "O_TANDEM_FACILITY",
    "D_TANDEM_FACILITY" AS "D_TANDEM_FACILITY",
    "O_TANDEM_FACILITY_ALIAS" AS "O_TANDEM_FACILITY_ALIAS",
    "D_TANDEM_FACILITY_ALIAS" AS "D_TANDEM_FACILITY_ALIAS",
    "DELAY_TYPE" AS "DELAY_TYPE",
    "ASSIGNED_CARRIER_ID" AS "ASSIGNED_CARRIER_ID",
    "DSG_CARRIER_ID" AS "DSG_CARRIER_ID",
    "REC_CARRIER_ID" AS "REC_CARRIER_ID",
    "FEASIBLE_CARRIER_ID" AS "FEASIBLE_CARRIER_ID",
    "PAYEE_CARRIER_ID" AS "PAYEE_CARRIER_ID",
    "SCNDR_CARRIER_ID" AS "SCNDR_CARRIER_ID",
    "BROKER_CARRIER_ID" AS "BROKER_CARRIER_ID",
    "ASSIGNED_SCNDR_CARRIER_ID" AS "ASSIGNED_SCNDR_CARRIER_ID",
    "DSG_SCNDR_CARRIER_ID" AS "DSG_SCNDR_CARRIER_ID",
    "ASSIGNED_BROKER_CARRIER_ID" AS "ASSIGNED_BROKER_CARRIER_ID",
    "LH_PAYEE_CARRIER_ID" AS "LH_PAYEE_CARRIER_ID",
    "REC_BROKER_CARRIER_ID" AS "REC_BROKER_CARRIER_ID",
    "ASSIGNED_EQUIPMENT_ID" AS "ASSIGNED_EQUIPMENT_ID",
    "DSG_EQUIPMENT_ID" AS "DSG_EQUIPMENT_ID",
    "FEASIBLE_EQUIPMENT_ID" AS "FEASIBLE_EQUIPMENT_ID",
    "FEASIBLE_EQUIPMENT2_ID" AS "FEASIBLE_EQUIPMENT2_ID",
    "REC_EQUIPMENT_ID" AS "REC_EQUIPMENT_ID",
    "ASSIGNED_MOT_ID" AS "ASSIGNED_MOT_ID",
    "DSG_MOT_ID" AS "DSG_MOT_ID",
    "FEASIBLE_MOT_ID" AS "FEASIBLE_MOT_ID",
    "REC_MOT_ID" AS "REC_MOT_ID",
    "PRODUCT_CLASS_ID" AS "PRODUCT_CLASS_ID",
    "PROTECTION_LEVEL_ID" AS "PROTECTION_LEVEL_ID",
    "ASSIGNED_SERVICE_LEVEL_ID" AS "ASSIGNED_SERVICE_LEVEL_ID",
    "DSG_SERVICE_LEVEL_ID" AS "DSG_SERVICE_LEVEL_ID",
    "FEASIBLE_SERVICE_LEVEL_ID" AS "FEASIBLE_SERVICE_LEVEL_ID",
    "REC_SERVICE_LEVEL_ID" AS "REC_SERVICE_LEVEL_ID",
    "HAS_EM_NOTIFY_FLAG" AS "HAS_EM_NOTIFY_FLAG",
    "REGION_ID" AS "REGION_ID",
    "INBOUND_REGION_ID" AS "INBOUND_REGION_ID",
    "OUTBOUND_REGION_ID" AS "OUTBOUND_REGION_ID",
    "FINANCIAL_WT" AS "FINANCIAL_WT",
    "IS_BOOKING_REQUIRED" AS "IS_BOOKING_REQUIRED",
    "TOTAL_COST_EXCL_TAX" AS "TOTAL_COST_EXCL_TAX",
    "TOTAL_TAX_AMOUNT" AS "TOTAL_TAX_AMOUNT",
    "IS_ASSOCIATED_TO_OUTBOUND" AS "IS_ASSOCIATED_TO_OUTBOUND",
    "RECEIVED_DTTM" AS "RECEIVED_DTTM",
    "BOOKING_ID" AS "BOOKING_ID",
    "IS_MISROUTED" AS "IS_MISROUTED",
    "FEASIBLE_CARRIER_CODE" AS "FEASIBLE_CARRIER_CODE",
    "SHIPMENT_WIN_ADJ_FLAG" AS "SHIPMENT_WIN_ADJ_FLAG",
    "DT_PARAM_SET_ID" AS "DT_PARAM_SET_ID",
    "MERCHANDIZING_DEPARTMENT_ID" AS "MERCHANDIZING_DEPARTMENT_ID",
    "STATIC_ROUTE_ID" AS "STATIC_ROUTE_ID",
    "IS_FILO" AS "IS_FILO",
    "IS_COOLER_AT_NOSE" AS "IS_COOLER_AT_NOSE",
    "AUTH_NBR" AS "AUTH_NBR",
    "CONS_LOCN_ID" AS "CONS_LOCN_ID",
    "RTE_TYPE" AS "RTE_TYPE",
    "TRLR_TYPE" AS "TRLR_TYPE",
    "TRLR_SIZE" AS "TRLR_SIZE",
    "CONS_ADDR_CODE" AS "CONS_ADDR_CODE",
    "HUB_ID" AS "HUB_ID",
    "TRLR_GEN_CODE" AS "TRLR_GEN_CODE",
    "MAX_NBR_OF_CTNS" AS "MAX_NBR_OF_CTNS",
    "APPT_DOOR_SCHED_TYPE" AS "APPT_DOOR_SCHED_TYPE",
    "CREATED_SOURCE_TYPE" AS "CREATED_SOURCE_TYPE",
    "CREATED_SOURCE" AS "CREATED_SOURCE",
    "CREATED_DTTM" AS "CREATED_DTTM",
    "LAST_UPDATED_SOURCE_TYPE" AS "LAST_UPDATED_SOURCE_TYPE",
    "LAST_UPDATED_SOURCE" AS "LAST_UPDATED_SOURCE",
    "LAST_UPDATED_DTTM" AS "LAST_UPDATED_DTTM",
    "DSG_SCNDR_CARRIER_CODE" AS "DSG_SCNDR_CARRIER_CODE",
    "LH_PAYEE_CARRIER_CODE" AS "LH_PAYEE_CARRIER_CODE",
    "REC_BROKER_CARRIER_CODE" AS "REC_BROKER_CARRIER_CODE",
    "REC_CARRIER_CODE" AS "REC_CARRIER_CODE",
    "LPN_ASSIGNMENT_STOPPED" AS "LPN_ASSIGNMENT_STOPPED",
    "SEAL_NUMBER" AS "SEAL_NUMBER",
    "HIBERNATE_VERSION" AS "HIBERNATE_VERSION",
    "SHIP_GROUP_ID" AS "SHIP_GROUP_ID",
    "RATE" AS "RATE",
    "MONETARY_VALUE" AS "MONETARY_VALUE",
    "DOOR" AS "DOOR",
    "RTE_TYPE_1" AS "RTE_TYPE_1",
    "RTE_TYPE_2" AS "RTE_TYPE_2",
    "SCHEDULED_PICKUP_DTTM" AS "SCHEDULED_PICKUP_DTTM",
    "MANIFEST_ID" AS "MANIFEST_ID",
    "DAYS_TO_DELIVER" AS "DAYS_TO_DELIVER",
    "SED_GENERATED_FLAG" AS "SED_GENERATED_FLAG",
    "SERV_AREA_CODE" AS "SERV_AREA_CODE",
    "TENDER_RESP_DEADLINE_DTTM" AS "TENDER_RESP_DEADLINE_DTTM",
    "PRINT_CONS_BOL" AS "PRINT_CONS_BOL",
    "LEFT_WT" AS "LEFT_WT",
    "RIGHT_WT" AS "RIGHT_WT",
    "LANE_NAME" AS "LANE_NAME",
    "DECLARED_VALUE" AS "DECLARED_VALUE",
    "DV_CURRENCY_CODE" AS "DV_CURRENCY_CODE",
    "COD_AMOUNT" AS "COD_AMOUNT",
    "CUSTOMER_ID" AS "CUSTOMER_ID",
    "CUST_FRGT_CHARGE" AS "CUST_FRGT_CHARGE",
    "COD_CURRENCY_CODE" AS "COD_CURRENCY_CODE",
    "PLANNED_WEIGHT" AS "PLANNED_WEIGHT",
    "WEIGHT_UOM_ID_BASE" AS "WEIGHT_UOM_ID_BASE",
    "PLANNED_VOLUME" AS "PLANNED_VOLUME",
    "VOLUME_UOM_ID_BASE" AS "VOLUME_UOM_ID_BASE",
    "SIZE1_VALUE" AS "SIZE1_VALUE",
    "SIZE1_UOM_ID" AS "SIZE1_UOM_ID",
    "SIZE2_VALUE" AS "SIZE2_VALUE",
    "SIZE2_UOM_ID" AS "SIZE2_UOM_ID",
    "ASSIGNED_SHIP_VIA" AS "ASSIGNED_SHIP_VIA",
    "INSURANCE_STATUS" AS "INSURANCE_STATUS",
    "RTE_SWC_NBR" AS "RTE_SWC_NBR",
    "RTE_TO" AS "RTE_TO",
    "BILL_OF_LADING_NUMBER" AS "BILL_OF_LADING_NUMBER",
    "TRAILER_NUMBER" AS "TRAILER_NUMBER",
    "TRANS_PLAN_OWNER" AS "TRANS_PLAN_OWNER",
    "TOTAL_REVENUE_CURRENCY_CODE" AS "TOTAL_REVENUE_CURRENCY_CODE",
    "TOTAL_REVENUE" AS "TOTAL_REVENUE",
    "FRT_REV_SPOT_CHARGE_CURR_CODE" AS "FRT_REV_SPOT_CHARGE_CURR_CODE",
    "NORMALIZED_TOTAL_REVENUE" AS "NORMALIZED_TOTAL_REVENUE",
    "FRT_REV_SPOT_CHARGE" AS "FRT_REV_SPOT_CHARGE",
    "DSG_VOYAGE_FLIGHT" AS "DSG_VOYAGE_FLIGHT",
    "FEASIBLE_VOYAGE_FLIGHT" AS "FEASIBLE_VOYAGE_FLIGHT",
    "CURRENCY_DTTM" AS "CURRENCY_DTTM",
    "FRT_REV_LINEHAUL_CHARGE" AS "FRT_REV_LINEHAUL_CHARGE",
    "FRT_REV_STOP_CHARGE" AS "FRT_REV_STOP_CHARGE",
    "FRT_REV_ACCESSORIAL_CHARGE" AS "FRT_REV_ACCESSORIAL_CHARGE",
    "MARGIN" AS "MARGIN",
    "INCOTERM_ID" AS "INCOTERM_ID",
    "ORDER_QTY" AS "ORDER_QTY",
    "QTY_UOM_ID" AS "QTY_UOM_ID",
    "REF_SHIPMENT_NBR" AS "REF_SHIPMENT_NBR",
    "STAGING_LOCN_ID" AS "STAGING_LOCN_ID",
    "LOADING_SEQ_ORD" AS "LOADING_SEQ_ORD",
    "HAZMAT_CERT_CONTACT" AS "HAZMAT_CERT_CONTACT",
    "HAZMAT_CERT_DECLARATION" AS "HAZMAT_CERT_DECLARATION",
    "CDC_TIMESTAMP" AS "CDC_TIMESTAMP",
    "OPERATION_TYPE" AS "OPERATION_TYPE",
    "ARCHIVED_DTTM" AS "ARCHIVED_DTTM",
    "ORIGIN" AS "ORIGIN",
    "FINAL_DESTINATION" AS "FINAL_DESTINATION",
    "actual_delivery_date_parsed" AS "actual_delivery_date_parsed",
    "wood_pellet" AS "wood_pellet",
    "act_del_MERCH_YEAR" AS "act_del_MERCH_YEAR",
    "act_del_YEAR_WEEK" AS "act_del_YEAR_WEEK",
    "act_del_YEAR_QUARTER" AS "act_del_YEAR_QUARTER",
    "act_del_YEAR_PERIOD" AS "act_del_YEAR_PERIOD",
    "invoice_shipping_id" AS "invoice_shipping_id",
    "TOTAL_COST" AS "TOTAL_COST",
    "org_Facility_Code" AS "org_Facility_Code",
    "org_Facility_Name" AS "org_Facility_Name",
    "org_Facility_Type" AS "org_Facility_Type",
    "dest_Facility_Code" AS "dest_Facility_Code",
    "dest_Facility_Name" AS "dest_Facility_Name",
    "dest_Facility_Type" AS "dest_Facility_Type",
    CASE WHEN UPPER("org_Facility_Type") = 'VENDOR' THEN 'Inbound' ELSE 'Outbound' END AS "inbound_flag"
  FROM (
    SELECT 
        tsw."SHIPMENT_ID" AS "SHIPMENT_ID",
        tsw."TC_COMPANY_ID" AS "TC_COMPANY_ID",
        tsw."RS_AREA_ID" AS "RS_AREA_ID",
        tsw."TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID",
        tsw."PP_SHIPMENT_ID" AS "PP_SHIPMENT_ID",
        tsw."SHIPMENT_STATUS" AS "SHIPMENT_STATUS",
        tsw."UPDATE_SENT" AS "UPDATE_SENT",
        tsw."BUSINESS_PROCESS" AS "BUSINESS_PROCESS",
        tsw."CREATION_TYPE" AS "CREATION_TYPE",
        tsw."CONS_RUN_ID" AS "CONS_RUN_ID",
        tsw."IS_CANCELLED" AS "IS_CANCELLED",
        tsw."RS_TYPE" AS "RS_TYPE",
        tsw."RS_CONFIG_ID" AS "RS_CONFIG_ID",
        tsw."RS_CONFIG_CYCLE_ID" AS "RS_CONFIG_CYCLE_ID",
        tsw."CONFIG_CYCLE_SEQ" AS "CONFIG_CYCLE_SEQ",
        tsw."CYCLE_DEADLINE_DTTM" AS "CYCLE_DEADLINE_DTTM",
        tsw."CYCLE_EXECUTION_DTTM" AS "CYCLE_EXECUTION_DTTM",
        tsw."LAST_RS_NOTIFICATION_DTTM" AS "LAST_RS_NOTIFICATION_DTTM",
        tsw."CFMF_STATUS" AS "CFMF_STATUS",
        tsw."AVAILABLE_DTTM" AS "AVAILABLE_DTTM",
        tsw."CMID" AS "CMID",
        tsw."CM_DISCOUNT" AS "CM_DISCOUNT",
        tsw."O_FACILITY_NUMBER" AS "O_FACILITY_NUMBER",
        tsw."O_FACILITY_ID" AS "O_FACILITY_ID",
        tsw."O_ADDRESS" AS "O_ADDRESS",
        tsw."O_CITY" AS "O_CITY",
        tsw."O_STATE_PROV" AS "O_STATE_PROV",
        tsw."O_POSTAL_CODE" AS "O_POSTAL_CODE",
        tsw."O_COUNTY" AS "O_COUNTY",
        tsw."O_COUNTRY_CODE" AS "O_COUNTRY_CODE",
        tsw."D_FACILITY_NUMBER" AS "D_FACILITY_NUMBER",
        tsw."D_FACILITY_ID" AS "D_FACILITY_ID",
        tsw."D_ADDRESS" AS "D_ADDRESS",
        tsw."D_CITY" AS "D_CITY",
        tsw."D_STATE_PROV" AS "D_STATE_PROV",
        tsw."D_POSTAL_CODE" AS "D_POSTAL_CODE",
        tsw."D_COUNTY" AS "D_COUNTY",
        tsw."D_COUNTRY_CODE" AS "D_COUNTRY_CODE",
        tsw."DISTANCE" AS "DISTANCE",
        tsw."DIRECT_DISTANCE" AS "DIRECT_DISTANCE",
        tsw."OUT_OF_ROUTE_DISTANCE" AS "OUT_OF_ROUTE_DISTANCE",
        tsw."DISTANCE_UOM" AS "DISTANCE_UOM",
        tsw."BUSINESS_PARTNER_ID" AS "BUSINESS_PARTNER_ID",
        tsw."COMMODITY_CLASS" AS "COMMODITY_CLASS",
        tsw."IS_HAZMAT" AS "IS_HAZMAT",
        tsw."IS_PERISHABLE" AS "IS_PERISHABLE",
        tsw."BILLING_METHOD" AS "BILLING_METHOD",
        tsw."DSG_CARRIER_CODE" AS "DSG_CARRIER_CODE",
        tsw."REC_CMID" AS "REC_CMID",
        tsw."REC_CM_SHIPMENT_ID" AS "REC_CM_SHIPMENT_ID",
        tsw."ASSIGNED_CARRIER_CODE" AS "ASSIGNED_CARRIER_CODE",
        tsw."SHIPMENT_REF_ID" AS "SHIPMENT_REF_ID",
        tsw."BILL_TO_CODE" AS "BILL_TO_CODE",
        tsw."BILL_TO_TITLE" AS "BILL_TO_TITLE",
        tsw."BILL_TO_NAME" AS "BILL_TO_NAME",
        tsw."BILL_TO_ADDRESS" AS "BILL_TO_ADDRESS",
        tsw."BILL_TO_CITY" AS "BILL_TO_CITY",
        tsw."BILL_TO_STATE_PROV" AS "BILL_TO_STATE_PROV",
        tsw."BILL_TO_POSTAL_CODE" AS "BILL_TO_POSTAL_CODE",
        tsw."BILL_TO_COUNTRY_CODE" AS "BILL_TO_COUNTRY_CODE",
        tsw."BILL_TO_PHONE_NUMBER" AS "BILL_TO_PHONE_NUMBER",
        tsw."PURCHASE_ORDER" AS "PURCHASE_ORDER",
        tsw."PRO_NUMBER" AS "PRO_NUMBER",
        tsw."TRANS_RESP_CODE" AS "TRANS_RESP_CODE",
        tsw."BASELINE_COST" AS "BASELINE_COST",
        tsw."ESTIMATED_COST" AS "ESTIMATED_COST",
        tsw."LINEHAUL_COST" AS "LINEHAUL_COST",
        tsw."ACCESSORIAL_COST" AS "ACCESSORIAL_COST",
        tsw."STOP_COST" AS "STOP_COST",
        tsw."ESTIMATED_SAVINGS" AS "ESTIMATED_SAVINGS",
        tsw."SPOT_CHARGE" AS "SPOT_CHARGE",
        tsw."CURRENCY_CODE" AS "CURRENCY_CODE",
        tsw."PICKUP_START_DTTM" AS "PICKUP_START_DTTM",
        tsw."PICKUP_END_DTTM" AS "PICKUP_END_DTTM",
        tsw."DELIVERY_START_DTTM" AS "DELIVERY_START_DTTM",
        tsw."DELIVERY_END_DTTM" AS "DELIVERY_END_DTTM",
        tsw."NUM_STOPS" AS "NUM_STOPS",
        tsw."NUM_DOCKS" AS "NUM_DOCKS",
        tsw."ON_TIME_INDICATOR" AS "ON_TIME_INDICATOR",
        tsw."HAS_NOTES" AS "HAS_NOTES",
        tsw."HAS_ALERTS" AS "HAS_ALERTS",
        tsw."HAS_IMPORT_ERROR" AS "HAS_IMPORT_ERROR",
        tsw."HAS_SOFT_CHECK_ERROR" AS "HAS_SOFT_CHECK_ERROR",
        tsw."HAS_TRACKING_MSG" AS "HAS_TRACKING_MSG",
        tsw."TRACKING_MSG_PROBLEM" AS "TRACKING_MSG_PROBLEM",
        tsw."REC_LINEHAUL_COST" AS "REC_LINEHAUL_COST",
        tsw."REC_ACCESSORIAL_COST" AS "REC_ACCESSORIAL_COST",
        tsw."REC_TOTAL_COST" AS "REC_TOTAL_COST",
        tsw."CYCLE_RESP_DEADLINE_TZ" AS "CYCLE_RESP_DEADLINE_TZ",
        tsw."TENDER_RESP_DEADLINE_TZ" AS "TENDER_RESP_DEADLINE_TZ",
        tsw."PICKUP_TZ" AS "PICKUP_TZ",
        tsw."DELIVERY_TZ" AS "DELIVERY_TZ",
        tsw."ASSIGNED_LANE_ID" AS "ASSIGNED_LANE_ID",
        tsw."ASSIGNED_LANE_DETAIL_ID" AS "ASSIGNED_LANE_DETAIL_ID",
        tsw."REC_SPOT_CHARGE" AS "REC_SPOT_CHARGE",
        tsw."REC_LANE_ID" AS "REC_LANE_ID",
        tsw."REC_LANE_DETAIL_ID" AS "REC_LANE_DETAIL_ID",
        tsw."TENDER_DTTM" AS "TENDER_DTTM",
        tsw."O_STOP_LOCATION_NAME" AS "O_STOP_LOCATION_NAME",
        tsw."D_STOP_LOCATION_NAME" AS "D_STOP_LOCATION_NAME",
        tsw."ASSIGNED_CM_SHIPMENT_ID" AS "ASSIGNED_CM_SHIPMENT_ID",
        tsw."REC_CM_DISCOUNT" AS "REC_CM_DISCOUNT",
        tsw."REC_STOP_COST" AS "REC_STOP_COST",
        tsw."LAST_SELECTOR_RUN_DTTM" AS "LAST_SELECTOR_RUN_DTTM",
        tsw."LAST_CM_OPTION_GEN_DTTM" AS "LAST_CM_OPTION_GEN_DTTM",
        tsw."IS_CM_OPTION_GEN_ACTIVE" AS "IS_CM_OPTION_GEN_ACTIVE",
        tsw."RS_CYCLE_REMAINING" AS "RS_CYCLE_REMAINING",
        tsw."IS_TIME_FEAS_ENABLED" AS "IS_TIME_FEAS_ENABLED",
        tsw."EXT_SYS_SHIPMENT_ID" AS "EXT_SYS_SHIPMENT_ID",
        tsw."EXTRACTION_DTTM" AS "EXTRACTION_DTTM",
        tsw."ASSIGNED_BROKER_CARRIER_CODE" AS "ASSIGNED_BROKER_CARRIER_CODE",
        tsw."USE_BROKER_AS_CARRIER" AS "USE_BROKER_AS_CARRIER",
        tsw."BROKER_REF" AS "BROKER_REF",
        tsw."RATING_QUALIFIER" AS "RATING_QUALIFIER",
        tsw."STATUS_CHANGE_DTTM" AS "STATUS_CHANGE_DTTM",
        tsw."BUDG_TOTAL_COST" AS "BUDG_TOTAL_COST",
        tsw."NORMALIZED_MARGIN" AS "NORMALIZED_MARGIN",
        tsw."NORMALIZED_TOTAL_COST" AS "NORMALIZED_TOTAL_COST",
        tsw."BUDG_NORMALIZED_TOTAL_COST" AS "BUDG_NORMALIZED_TOTAL_COST",
        tsw."REC_BUDG_LINEHAUL_COST" AS "REC_BUDG_LINEHAUL_COST",
        tsw."REC_BUDG_STOP_COST" AS "REC_BUDG_STOP_COST",
        tsw."REC_BUDG_CM_DISCOUNT" AS "REC_BUDG_CM_DISCOUNT",
        tsw."REC_BUDG_ACCESSORIAL_COST" AS "REC_BUDG_ACCESSORIAL_COST",
        tsw."REC_BUDG_TOTAL_COST" AS "REC_BUDG_TOTAL_COST",
        tsw."REC_MARGIN" AS "REC_MARGIN",
        tsw."REC_NORMALIZED_MARGIN" AS "REC_NORMALIZED_MARGIN",
        tsw."REC_NORMALIZED_TOTAL_COST" AS "REC_NORMALIZED_TOTAL_COST",
        tsw."REC_BUDG_NORMALIZED_TOTAL_COST" AS "REC_BUDG_NORMALIZED_TOTAL_COST",
        tsw."BUDG_CURRENCY_CODE" AS "BUDG_CURRENCY_CODE",
        tsw."SPOT_CHARGE_CURRENCY_CODE" AS "SPOT_CHARGE_CURRENCY_CODE",
        tsw."REC_CURRENCY_CODE" AS "REC_CURRENCY_CODE",
        tsw."REC_BUDG_CURRENCY_CODE" AS "REC_BUDG_CURRENCY_CODE",
        tsw."REC_SPOT_CHARGE_CURRENCY_CODE" AS "REC_SPOT_CHARGE_CURRENCY_CODE",
        tsw."RATING_LANE_ID" AS "RATING_LANE_ID",
        tsw."FRT_REV_RATING_LANE_ID" AS "FRT_REV_RATING_LANE_ID",
        tsw."REC_RATING_LANE_ID" AS "REC_RATING_LANE_ID",
        tsw."REC_BUDG_RATING_LANE_ID" AS "REC_BUDG_RATING_LANE_ID",
        tsw."RATING_LANE_DETAIL_ID" AS "RATING_LANE_DETAIL_ID",
        tsw."FRT_REV_RATING_LANE_DETAIL_ID" AS "FRT_REV_RATING_LANE_DETAIL_ID",
        tsw."REC_RATING_LANE_DETAIL_ID" AS "REC_RATING_LANE_DETAIL_ID",
        tsw."REC_BUDG_RATING_LANE_DETAIL_ID" AS "REC_BUDG_RATING_LANE_DETAIL_ID",
        tsw."BUDG_CM_DISCOUNT" AS "BUDG_CM_DISCOUNT",
        tsw."NORMALIZED_BASELINE_COST" AS "NORMALIZED_BASELINE_COST",
        tsw."BASELINE_COST_CURRENCY_CODE" AS "BASELINE_COST_CURRENCY_CODE",
        tsw."REPORTED_COST" AS "REPORTED_COST",
        tsw."TRACTOR_NUMBER" AS "TRACTOR_NUMBER",
        tsw."IS_AUTO_DELIVERED" AS "IS_AUTO_DELIVERED",
        tsw."SHIPMENT_TYPE" AS "SHIPMENT_TYPE",
        tsw."ORIG_BUDG_TOTAL_COST" AS "ORIG_BUDG_TOTAL_COST",
        tsw."ACCESSORIAL_COST_TO_CARRIER" AS "ACCESSORIAL_COST_TO_CARRIER",
        tsw."CARRIER_CHARGE" AS "CARRIER_CHARGE",
        tsw."ACTUAL_COST" AS "ACTUAL_COST",
        tsw."EARNED_INCOME" AS "EARNED_INCOME",
        tsw."SENT_TO_PKMS" AS "SENT_TO_PKMS",
        tsw."IS_SHIPMENT_RECONCILED" AS "IS_SHIPMENT_RECONCILED",
        tsw."DELIVERY_REQ" AS "DELIVERY_REQ",
        tsw."DROPOFF_PICKUP" AS "DROPOFF_PICKUP",
        tsw."PACKAGING" AS "PACKAGING",
        tsw."SENT_TO_PKMS_DTTM" AS "SENT_TO_PKMS_DTTM",
        tsw."WMS_STATUS_CODE" AS "WMS_STATUS_CODE",
        tsw."SPOT_CHARGE_AND_PAYEE_ACC" AS "SPOT_CHARGE_AND_PAYEE_ACC",
        tsw."SPOT_CHARGE_AND_PAYEE_ACC_CC" AS "SPOT_CHARGE_AND_PAYEE_ACC_CC",
        tsw."NORM_SPOT_CHARGE_AND_PAYEE_ACC" AS "NORM_SPOT_CHARGE_AND_PAYEE_ACC",
        tsw."FACILITY_SCHEDULE_ID" AS "FACILITY_SCHEDULE_ID",
        tsw."EARNED_INCOME_CURRENCY_CODE" AS "EARNED_INCOME_CURRENCY_CODE",
        tsw."ACTUAL_COST_CURRENCY_CODE" AS "ACTUAL_COST_CURRENCY_CODE",
        tsw."SHIPMENT_RECON_DTTM" AS "SHIPMENT_RECON_DTTM",
        tsw."PLN_RATING_LANE_ID" AS "PLN_RATING_LANE_ID",
        tsw."PLN_RATING_LANE_DETAIL_ID" AS "PLN_RATING_LANE_DETAIL_ID",
        tsw."PLN_TOTAL_COST" AS "PLN_TOTAL_COST",
        tsw."PLN_LINEHAUL_COST" AS "PLN_LINEHAUL_COST",
        tsw."PLN_TOTAL_ACCESSORIAL_COST" AS "PLN_TOTAL_ACCESSORIAL_COST",
        tsw."PLN_STOP_OFF_COST" AS "PLN_STOP_OFF_COST",
        tsw."PLN_NORMALIZED_TOTAL_COST" AS "PLN_NORMALIZED_TOTAL_COST",
        tsw."PLN_CURRENCY_CODE" AS "PLN_CURRENCY_CODE",
        tsw."PLN_ACCESSORL_COST_TO_CARRIER" AS "PLN_ACCESSORL_COST_TO_CARRIER",
        tsw."PLN_CARRIER_CHARGE" AS "PLN_CARRIER_CHARGE",
        tsw."WAYPOINT_TOTAL_COST" AS "WAYPOINT_TOTAL_COST",
        tsw."WAYPOINT_HANDLING_COST" AS "WAYPOINT_HANDLING_COST",
        tsw."GRS_OPERATION" AS "GRS_OPERATION",
        tsw."IS_GRS_OPT_CYCLE_RUNNING" AS "IS_GRS_OPT_CYCLE_RUNNING",
        tsw."IS_MANUAL_ASSIGN" AS "IS_MANUAL_ASSIGN",
        tsw."LAST_RUN_GRS_DTTM" AS "LAST_RUN_GRS_DTTM",
        tsw."GRS_MAX_SHIPMENT_STATUS" AS "GRS_MAX_SHIPMENT_STATUS",
        tsw."PRIORITY_TYPE" AS "PRIORITY_TYPE",
        tsw."MV_CURRENCY_CODE" AS "MV_CURRENCY_CODE",
        tsw."PROD_SCHED_REF_NUMBER" AS "PROD_SCHED_REF_NUMBER",
        tsw."COMMODITY_CODE_ID" AS "COMMODITY_CODE_ID",
        tsw."UN_NUMBER_ID" AS "UN_NUMBER_ID",
        tsw."CONTRACT_NUMBER" AS "CONTRACT_NUMBER",
        tsw."BOOKING_REF_SHIPPER" AS "BOOKING_REF_SHIPPER",
        tsw."BOOKING_REF_CARRIER" AS "BOOKING_REF_CARRIER",
        tsw."BK_RESOURCE_REF_EXTERNAL" AS "BK_RESOURCE_REF_EXTERNAL",
        tsw."BK_RESOURCE_NAME_EXTERNAL" AS "BK_RESOURCE_NAME_EXTERNAL",
        tsw."BK_O_FACILITY_ID" AS "BK_O_FACILITY_ID",
        tsw."BK_D_FACILITY_ID" AS "BK_D_FACILITY_ID",
        tsw."BK_MASTER_AIRWAY_BILL" AS "BK_MASTER_AIRWAY_BILL",
        tsw."BK_FORWARDER_AIRWAY_BILL" AS "BK_FORWARDER_AIRWAY_BILL",
        tsw."ASSIGNED_SCNDR_CARRIER_CODE" AS "ASSIGNED_SCNDR_CARRIER_CODE",
        tsw."CUSTOMER_CREDIT_LIMIT_ID" AS "CUSTOMER_CREDIT_LIMIT_ID",
        tsw."SHIPMENT_LEG_TYPE" AS "SHIPMENT_LEG_TYPE",
        tsw."SHIPMENT_CLOSED_INDICATOR" AS "SHIPMENT_CLOSED_INDICATOR",
        tsw."OCEAN_ROUTING_STAGE" AS "OCEAN_ROUTING_STAGE",
        tsw."BK_DEPARTURE_DTTM" AS "BK_DEPARTURE_DTTM",
        tsw."BK_DEPARTURE_TZ" AS "BK_DEPARTURE_TZ",
        tsw."BK_ARRIVAL_DTTM" AS "BK_ARRIVAL_DTTM",
        tsw."BK_ARRIVAL_TZ" AS "BK_ARRIVAL_TZ",
        tsw."BK_PICKUP_DTTM" AS "BK_PICKUP_DTTM",
        tsw."BK_PICKUP_TZ" AS "BK_PICKUP_TZ",
        tsw."BK_CUTOFF_DTTM" AS "BK_CUTOFF_DTTM",
        tsw."BK_CUTOFF_TZ" AS "BK_CUTOFF_TZ",
        tsw."NUM_CHARGE_LAYOVERS" AS "NUM_CHARGE_LAYOVERS",
        tsw."RATE_TYPE" AS "RATE_TYPE",
        tsw."RATE_UOM" AS "RATE_UOM",
        tsw."PICK_START_DTTM" AS "PICK_START_DTTM",
        tsw."PAPERWORK_START_DTTM" AS "PAPERWORK_START_DTTM",
        tsw."VEHICLE_CHECK_START_DTTM" AS "VEHICLE_CHECK_START_DTTM",
        tsw."SHIPMENT_START_DTTM" AS "SHIPMENT_START_DTTM",
        tsw."SHIPMENT_END_DTTM" AS "SHIPMENT_END_DTTM",
        tsw."FEASIBLE_DRIVER_TYPE" AS "FEASIBLE_DRIVER_TYPE",
        tsw."WAVE_ID" AS "WAVE_ID",
        tsw."ESTIMATED_DISPATCH_DTTM" AS "ESTIMATED_DISPATCH_DTTM",
        tsw."TOTAL_TIME" AS "TOTAL_TIME",
        tsw."LOC_REFERENCE" AS "LOC_REFERENCE",
        tsw."BK_O_FACILITY_ALIAS_ID" AS "BK_O_FACILITY_ALIAS_ID",
        tsw."BK_D_FACILITY_ALIAS_ID" AS "BK_D_FACILITY_ALIAS_ID",
        tsw."EQUIP_UTIL_PER" AS "EQUIP_UTIL_PER",
        tsw."MOVE_TYPE" AS "MOVE_TYPE",
        tsw."DRIVER_TYPE_ID" AS "DRIVER_TYPE_ID",
        tsw."EQUIPMENT_TYPE" AS "EQUIPMENT_TYPE",
        tsw."RADIAL_DISTANCE" AS "RADIAL_DISTANCE",
        tsw."RADIAL_DISTANCE_UOM" AS "RADIAL_DISTANCE_UOM",
        tsw."DESIGNATED_TRACTOR_CODE" AS "DESIGNATED_TRACTOR_CODE",
        tsw."DESIGNATED_DRIVER_TYPE" AS "DESIGNATED_DRIVER_TYPE",
        tsw."IS_WAVE_MAN_CHANGED" AS "IS_WAVE_MAN_CHANGED",
        tsw."RETAIN_CONSOLIDATOR_TIMES" AS "RETAIN_CONSOLIDATOR_TIMES",
        tsw."TARIFF" AS "TARIFF",
        tsw."MIN_RATE" AS "MIN_RATE",
        tsw."FIRST_UPDATE_SENT_TO_PKMS" AS "FIRST_UPDATE_SENT_TO_PKMS",
        tsw."EVENT_IND_TYPEID" AS "EVENT_IND_TYPEID",
        tsw."TANDEM_PATH_ID" AS "TANDEM_PATH_ID",
        tsw."O_TANDEM_FACILITY" AS "O_TANDEM_FACILITY",
        tsw."D_TANDEM_FACILITY" AS "D_TANDEM_FACILITY",
        tsw."O_TANDEM_FACILITY_ALIAS" AS "O_TANDEM_FACILITY_ALIAS",
        tsw."D_TANDEM_FACILITY_ALIAS" AS "D_TANDEM_FACILITY_ALIAS",
        tsw."DELAY_TYPE" AS "DELAY_TYPE",
        tsw."ASSIGNED_CARRIER_ID" AS "ASSIGNED_CARRIER_ID",
        tsw."DSG_CARRIER_ID" AS "DSG_CARRIER_ID",
        tsw."REC_CARRIER_ID" AS "REC_CARRIER_ID",
        tsw."FEASIBLE_CARRIER_ID" AS "FEASIBLE_CARRIER_ID",
        tsw."PAYEE_CARRIER_ID" AS "PAYEE_CARRIER_ID",
        tsw."SCNDR_CARRIER_ID" AS "SCNDR_CARRIER_ID",
        tsw."BROKER_CARRIER_ID" AS "BROKER_CARRIER_ID",
        tsw."ASSIGNED_SCNDR_CARRIER_ID" AS "ASSIGNED_SCNDR_CARRIER_ID",
        tsw."DSG_SCNDR_CARRIER_ID" AS "DSG_SCNDR_CARRIER_ID",
        tsw."ASSIGNED_BROKER_CARRIER_ID" AS "ASSIGNED_BROKER_CARRIER_ID",
        tsw."LH_PAYEE_CARRIER_ID" AS "LH_PAYEE_CARRIER_ID",
        tsw."REC_BROKER_CARRIER_ID" AS "REC_BROKER_CARRIER_ID",
        tsw."ASSIGNED_EQUIPMENT_ID" AS "ASSIGNED_EQUIPMENT_ID",
        tsw."DSG_EQUIPMENT_ID" AS "DSG_EQUIPMENT_ID",
        tsw."FEASIBLE_EQUIPMENT_ID" AS "FEASIBLE_EQUIPMENT_ID",
        tsw."FEASIBLE_EQUIPMENT2_ID" AS "FEASIBLE_EQUIPMENT2_ID",
        tsw."REC_EQUIPMENT_ID" AS "REC_EQUIPMENT_ID",
        tsw."ASSIGNED_MOT_ID" AS "ASSIGNED_MOT_ID",
        tsw."DSG_MOT_ID" AS "DSG_MOT_ID",
        tsw."FEASIBLE_MOT_ID" AS "FEASIBLE_MOT_ID",
        tsw."REC_MOT_ID" AS "REC_MOT_ID",
        tsw."PRODUCT_CLASS_ID" AS "PRODUCT_CLASS_ID",
        tsw."PROTECTION_LEVEL_ID" AS "PROTECTION_LEVEL_ID",
        tsw."ASSIGNED_SERVICE_LEVEL_ID" AS "ASSIGNED_SERVICE_LEVEL_ID",
        tsw."DSG_SERVICE_LEVEL_ID" AS "DSG_SERVICE_LEVEL_ID",
        tsw."FEASIBLE_SERVICE_LEVEL_ID" AS "FEASIBLE_SERVICE_LEVEL_ID",
        tsw."REC_SERVICE_LEVEL_ID" AS "REC_SERVICE_LEVEL_ID",
        tsw."HAS_EM_NOTIFY_FLAG" AS "HAS_EM_NOTIFY_FLAG",
        tsw."REGION_ID" AS "REGION_ID",
        tsw."INBOUND_REGION_ID" AS "INBOUND_REGION_ID",
        tsw."OUTBOUND_REGION_ID" AS "OUTBOUND_REGION_ID",
        tsw."FINANCIAL_WT" AS "FINANCIAL_WT",
        tsw."IS_BOOKING_REQUIRED" AS "IS_BOOKING_REQUIRED",
        tsw."TOTAL_COST_EXCL_TAX" AS "TOTAL_COST_EXCL_TAX",
        tsw."TOTAL_TAX_AMOUNT" AS "TOTAL_TAX_AMOUNT",
        tsw."IS_ASSOCIATED_TO_OUTBOUND" AS "IS_ASSOCIATED_TO_OUTBOUND",
        tsw."RECEIVED_DTTM" AS "RECEIVED_DTTM",
        tsw."BOOKING_ID" AS "BOOKING_ID",
        tsw."IS_MISROUTED" AS "IS_MISROUTED",
        tsw."FEASIBLE_CARRIER_CODE" AS "FEASIBLE_CARRIER_CODE",
        tsw."SHIPMENT_WIN_ADJ_FLAG" AS "SHIPMENT_WIN_ADJ_FLAG",
        tsw."DT_PARAM_SET_ID" AS "DT_PARAM_SET_ID",
        tsw."MERCHANDIZING_DEPARTMENT_ID" AS "MERCHANDIZING_DEPARTMENT_ID",
        tsw."STATIC_ROUTE_ID" AS "STATIC_ROUTE_ID",
        tsw."IS_FILO" AS "IS_FILO",
        tsw."IS_COOLER_AT_NOSE" AS "IS_COOLER_AT_NOSE",
        tsw."AUTH_NBR" AS "AUTH_NBR",
        tsw."CONS_LOCN_ID" AS "CONS_LOCN_ID",
        tsw."RTE_TYPE" AS "RTE_TYPE",
        tsw."TRLR_TYPE" AS "TRLR_TYPE",
        tsw."TRLR_SIZE" AS "TRLR_SIZE",
        tsw."CONS_ADDR_CODE" AS "CONS_ADDR_CODE",
        tsw."HUB_ID" AS "HUB_ID",
        tsw."TRLR_GEN_CODE" AS "TRLR_GEN_CODE",
        tsw."MAX_NBR_OF_CTNS" AS "MAX_NBR_OF_CTNS",
        tsw."APPT_DOOR_SCHED_TYPE" AS "APPT_DOOR_SCHED_TYPE",
        tsw."CREATED_SOURCE_TYPE" AS "CREATED_SOURCE_TYPE",
        tsw."CREATED_SOURCE" AS "CREATED_SOURCE",
        tsw."CREATED_DTTM" AS "CREATED_DTTM",
        tsw."LAST_UPDATED_SOURCE_TYPE" AS "LAST_UPDATED_SOURCE_TYPE",
        tsw."LAST_UPDATED_SOURCE" AS "LAST_UPDATED_SOURCE",
        tsw."LAST_UPDATED_DTTM" AS "LAST_UPDATED_DTTM",
        tsw."DSG_SCNDR_CARRIER_CODE" AS "DSG_SCNDR_CARRIER_CODE",
        tsw."LH_PAYEE_CARRIER_CODE" AS "LH_PAYEE_CARRIER_CODE",
        tsw."REC_BROKER_CARRIER_CODE" AS "REC_BROKER_CARRIER_CODE",
        tsw."REC_CARRIER_CODE" AS "REC_CARRIER_CODE",
        tsw."LPN_ASSIGNMENT_STOPPED" AS "LPN_ASSIGNMENT_STOPPED",
        tsw."SEAL_NUMBER" AS "SEAL_NUMBER",
        tsw."HIBERNATE_VERSION" AS "HIBERNATE_VERSION",
        tsw."SHIP_GROUP_ID" AS "SHIP_GROUP_ID",
        tsw."RATE" AS "RATE",
        tsw."MONETARY_VALUE" AS "MONETARY_VALUE",
        tsw."DOOR" AS "DOOR",
        tsw."RTE_TYPE_1" AS "RTE_TYPE_1",
        tsw."RTE_TYPE_2" AS "RTE_TYPE_2",
        tsw."SCHEDULED_PICKUP_DTTM" AS "SCHEDULED_PICKUP_DTTM",
        tsw."MANIFEST_ID" AS "MANIFEST_ID",
        tsw."DAYS_TO_DELIVER" AS "DAYS_TO_DELIVER",
        tsw."SED_GENERATED_FLAG" AS "SED_GENERATED_FLAG",
        tsw."SERV_AREA_CODE" AS "SERV_AREA_CODE",
        tsw."TENDER_RESP_DEADLINE_DTTM" AS "TENDER_RESP_DEADLINE_DTTM",
        tsw."PRINT_CONS_BOL" AS "PRINT_CONS_BOL",
        tsw."LEFT_WT" AS "LEFT_WT",
        tsw."RIGHT_WT" AS "RIGHT_WT",
        tsw."LANE_NAME" AS "LANE_NAME",
        tsw."DECLARED_VALUE" AS "DECLARED_VALUE",
        tsw."DV_CURRENCY_CODE" AS "DV_CURRENCY_CODE",
        tsw."COD_AMOUNT" AS "COD_AMOUNT",
        tsw."CUSTOMER_ID" AS "CUSTOMER_ID",
        tsw."CUST_FRGT_CHARGE" AS "CUST_FRGT_CHARGE",
        tsw."COD_CURRENCY_CODE" AS "COD_CURRENCY_CODE",
        tsw."PLANNED_WEIGHT" AS "PLANNED_WEIGHT",
        tsw."WEIGHT_UOM_ID_BASE" AS "WEIGHT_UOM_ID_BASE",
        tsw."PLANNED_VOLUME" AS "PLANNED_VOLUME",
        tsw."VOLUME_UOM_ID_BASE" AS "VOLUME_UOM_ID_BASE",
        tsw."SIZE1_VALUE" AS "SIZE1_VALUE",
        tsw."SIZE1_UOM_ID" AS "SIZE1_UOM_ID",
        tsw."SIZE2_VALUE" AS "SIZE2_VALUE",
        tsw."SIZE2_UOM_ID" AS "SIZE2_UOM_ID",
        tsw."ASSIGNED_SHIP_VIA" AS "ASSIGNED_SHIP_VIA",
        tsw."INSURANCE_STATUS" AS "INSURANCE_STATUS",
        tsw."RTE_SWC_NBR" AS "RTE_SWC_NBR",
        tsw."RTE_TO" AS "RTE_TO",
        tsw."BILL_OF_LADING_NUMBER" AS "BILL_OF_LADING_NUMBER",
        tsw."TRAILER_NUMBER" AS "TRAILER_NUMBER",
        tsw."TRANS_PLAN_OWNER" AS "TRANS_PLAN_OWNER",
        tsw."TOTAL_REVENUE_CURRENCY_CODE" AS "TOTAL_REVENUE_CURRENCY_CODE",
        tsw."TOTAL_REVENUE" AS "TOTAL_REVENUE",
        tsw."FRT_REV_SPOT_CHARGE_CURR_CODE" AS "FRT_REV_SPOT_CHARGE_CURR_CODE",
        tsw."NORMALIZED_TOTAL_REVENUE" AS "NORMALIZED_TOTAL_REVENUE",
        tsw."FRT_REV_SPOT_CHARGE" AS "FRT_REV_SPOT_CHARGE",
        tsw."DSG_VOYAGE_FLIGHT" AS "DSG_VOYAGE_FLIGHT",
        tsw."FEASIBLE_VOYAGE_FLIGHT" AS "FEASIBLE_VOYAGE_FLIGHT",
        tsw."CURRENCY_DTTM" AS "CURRENCY_DTTM",
        tsw."FRT_REV_LINEHAUL_CHARGE" AS "FRT_REV_LINEHAUL_CHARGE",
        tsw."FRT_REV_STOP_CHARGE" AS "FRT_REV_STOP_CHARGE",
        tsw."FRT_REV_ACCESSORIAL_CHARGE" AS "FRT_REV_ACCESSORIAL_CHARGE",
        tsw."MARGIN" AS "MARGIN",
        tsw."INCOTERM_ID" AS "INCOTERM_ID",
        tsw."ORDER_QTY" AS "ORDER_QTY",
        tsw."QTY_UOM_ID" AS "QTY_UOM_ID",
        tsw."REF_SHIPMENT_NBR" AS "REF_SHIPMENT_NBR",
        tsw."STAGING_LOCN_ID" AS "STAGING_LOCN_ID",
        tsw."LOADING_SEQ_ORD" AS "LOADING_SEQ_ORD",
        tsw."HAZMAT_CERT_CONTACT" AS "HAZMAT_CERT_CONTACT",
        tsw."HAZMAT_CERT_DECLARATION" AS "HAZMAT_CERT_DECLARATION",
        tsw."CDC_TIMESTAMP" AS "CDC_TIMESTAMP",
        tsw."OPERATION_TYPE" AS "OPERATION_TYPE",
        tsw."ARCHIVED_DTTM" AS "ARCHIVED_DTTM",
        tsw."ORIGIN" AS "ORIGIN",
        tsw."FINAL_DESTINATION" AS "FINAL_DESTINATION",
        tsw."actual_delivery_date_parsed" AS "actual_delivery_date_parsed",
        tsw."wood_pellet" AS "wood_pellet",
        tsw."act_del_MERCH_YEAR" AS "act_del_MERCH_YEAR",
        tsw."act_del_YEAR_WEEK" AS "act_del_YEAR_WEEK",
        tsw."act_del_YEAR_QUARTER" AS "act_del_YEAR_QUARTER",
        tsw."act_del_YEAR_PERIOD" AS "act_del_YEAR_PERIOD",
        tsw."invoice_shipping_id" AS "invoice_shipping_id",
        tsw."TOTAL_COST_sum" AS "TOTAL_COST",
        tscfinal."FACILITY_CODE" AS "org_Facility_Code",
        tscfinal."FACILITY_NAME" AS "org_Facility_Name",
        tscfinal."FACILITY_TYPE" AS "org_Facility_Type",
        tscfinal2."FACILITY_CODE" AS "dest_Facility_Code",
        tscfinal2."FACILITY_NAME" AS "dest_Facility_Name",
        tscfinal2."FACILITY_TYPE" AS "dest_Facility_Type"
      FROM "TLM_SHIPMENT_JOINED_FILTER_SHIPPING_WINDOWS" tsw
      LEFT JOIN "TSC_FACILITIES_FINAL" tscfinal
        ON tsw."ORIGIN" = CAST(tscfinal."FACILITY_CODE" AS NUMERIC)
      LEFT JOIN "TSC_FACILITIES_FINAL" tscfinal2
        ON tsw."FINAL_DESTINATION" = CAST(tscfinal2."FACILITY_CODE" AS NUMERIC)
    ) "withoutcomputedcols_query")A
    WHERE ( (CASE WHEN UPPER("org_Facility_Type") =  'VENDOR' THEN 'Inbound' ELSE 'Outbound' END) = 'Outbound') AND "org_Facility_Code" IS NOT NULL AND "dest_Facility_Code" IS NOT NULL;
<br>
--SC_TLM_ORDERS_PREPARED_BY_ORDER_ID 
</br>
CREATE OR REPLACE TEMPORARY TABLE "SC_TLM_ORDERS_PREPARED_BY_ORDER_ID"
AS
SELECT 
  "ORDER_ID" AS "ORDER_ID",
  "TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID"
FROM  EDW.VW_SC_TLM_ORDERS
GROUP BY "ORDER_ID", "TC_SHIPMENT_ID";
	 
<br>
--TLM_SHIPMENT_JOINED_DO_W_ARTICLE_PREPARED
</br>
CREATE OR REPLACE TEMPORARY TABLE "TLM_SHIPMENT_JOINED_DO_W_ARTICLE_PREPARED"
AS
WITH CTE AS 
(
SELECT 
    "tlm_shipment_joined_outbound"."SHIPMENT_ID" AS "SHIPMENT_ID",
    "tlm_shipment_joined_outbound"."TC_COMPANY_ID" AS "TC_COMPANY_ID",
    "tlm_shipment_joined_outbound"."RS_AREA_ID" AS "RS_AREA_ID",
    "tlm_shipment_joined_outbound"."TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID",
    "tlm_shipment_joined_outbound"."PP_SHIPMENT_ID" AS "PP_SHIPMENT_ID",
    "tlm_shipment_joined_outbound"."SHIPMENT_STATUS" AS "SHIPMENT_STATUS",
    "tlm_shipment_joined_outbound"."UPDATE_SENT" AS "UPDATE_SENT",
    "tlm_shipment_joined_outbound"."BUSINESS_PROCESS" AS "BUSINESS_PROCESS",
    "tlm_shipment_joined_outbound"."CREATION_TYPE" AS "CREATION_TYPE",
    "tlm_shipment_joined_outbound"."CONS_RUN_ID" AS "CONS_RUN_ID",
    "tlm_shipment_joined_outbound"."IS_CANCELLED" AS "IS_CANCELLED",
    "tlm_shipment_joined_outbound"."RS_TYPE" AS "RS_TYPE",
    "tlm_shipment_joined_outbound"."RS_CONFIG_ID" AS "RS_CONFIG_ID",
    "tlm_shipment_joined_outbound"."RS_CONFIG_CYCLE_ID" AS "RS_CONFIG_CYCLE_ID",
    "tlm_shipment_joined_outbound"."CONFIG_CYCLE_SEQ" AS "CONFIG_CYCLE_SEQ",
    "tlm_shipment_joined_outbound"."CYCLE_DEADLINE_DTTM" AS "CYCLE_DEADLINE_DTTM",
    "tlm_shipment_joined_outbound"."CYCLE_EXECUTION_DTTM" AS "CYCLE_EXECUTION_DTTM",
    "tlm_shipment_joined_outbound"."LAST_RS_NOTIFICATION_DTTM" AS "LAST_RS_NOTIFICATION_DTTM",
    "tlm_shipment_joined_outbound"."CFMF_STATUS" AS "CFMF_STATUS",
    "tlm_shipment_joined_outbound"."AVAILABLE_DTTM" AS "AVAILABLE_DTTM",
    "tlm_shipment_joined_outbound"."CMID" AS "CMID",
    "tlm_shipment_joined_outbound"."CM_DISCOUNT" AS "CM_DISCOUNT",
    "tlm_shipment_joined_outbound"."O_FACILITY_NUMBER" AS "O_FACILITY_NUMBER",
    "tlm_shipment_joined_outbound"."O_FACILITY_ID" AS "O_FACILITY_ID",
    "tlm_shipment_joined_outbound"."O_ADDRESS" AS "O_ADDRESS",
    "tlm_shipment_joined_outbound"."O_CITY" AS "O_CITY",
    "tlm_shipment_joined_outbound"."O_STATE_PROV" AS "O_STATE_PROV",
    "tlm_shipment_joined_outbound"."O_POSTAL_CODE" AS "O_POSTAL_CODE",
    "tlm_shipment_joined_outbound"."O_COUNTY" AS "O_COUNTY",
    "tlm_shipment_joined_outbound"."O_COUNTRY_CODE" AS "O_COUNTRY_CODE",
    "tlm_shipment_joined_outbound"."D_FACILITY_NUMBER" AS "D_FACILITY_NUMBER",
    "tlm_shipment_joined_outbound"."D_FACILITY_ID" AS "D_FACILITY_ID",
    "tlm_shipment_joined_outbound"."D_ADDRESS" AS "D_ADDRESS",
    "tlm_shipment_joined_outbound"."D_CITY" AS "D_CITY",
    "tlm_shipment_joined_outbound"."D_STATE_PROV" AS "D_STATE_PROV",
    "tlm_shipment_joined_outbound"."D_POSTAL_CODE" AS "D_POSTAL_CODE",
    "tlm_shipment_joined_outbound"."D_COUNTY" AS "D_COUNTY",
    "tlm_shipment_joined_outbound"."D_COUNTRY_CODE" AS "D_COUNTRY_CODE",
    "tlm_shipment_joined_outbound"."DISTANCE" AS "DISTANCE",
    "tlm_shipment_joined_outbound"."DIRECT_DISTANCE" AS "DIRECT_DISTANCE",
    "tlm_shipment_joined_outbound"."OUT_OF_ROUTE_DISTANCE" AS "OUT_OF_ROUTE_DISTANCE",
    "tlm_shipment_joined_outbound"."DISTANCE_UOM" AS "DISTANCE_UOM",
    "tlm_shipment_joined_outbound"."BUSINESS_PARTNER_ID" AS "BUSINESS_PARTNER_ID",
    "tlm_shipment_joined_outbound"."COMMODITY_CLASS" AS "COMMODITY_CLASS",
    "tlm_shipment_joined_outbound"."IS_HAZMAT" AS "IS_HAZMAT",
    "tlm_shipment_joined_outbound"."IS_PERISHABLE" AS "IS_PERISHABLE",
    "tlm_shipment_joined_outbound"."BILLING_METHOD" AS "BILLING_METHOD",
    "tlm_shipment_joined_outbound"."DSG_CARRIER_CODE" AS "DSG_CARRIER_CODE",
    "tlm_shipment_joined_outbound"."REC_CMID" AS "REC_CMID",
    "tlm_shipment_joined_outbound"."REC_CM_SHIPMENT_ID" AS "REC_CM_SHIPMENT_ID",
    "tlm_shipment_joined_outbound"."ASSIGNED_CARRIER_CODE" AS "ASSIGNED_CARRIER_CODE",
    "tlm_shipment_joined_outbound"."SHIPMENT_REF_ID" AS "SHIPMENT_REF_ID",
    "tlm_shipment_joined_outbound"."BILL_TO_CODE" AS "BILL_TO_CODE",
    "tlm_shipment_joined_outbound"."BILL_TO_TITLE" AS "BILL_TO_TITLE",
    "tlm_shipment_joined_outbound"."BILL_TO_NAME" AS "BILL_TO_NAME",
    "tlm_shipment_joined_outbound"."BILL_TO_ADDRESS" AS "BILL_TO_ADDRESS",
    "tlm_shipment_joined_outbound"."BILL_TO_CITY" AS "BILL_TO_CITY",
    "tlm_shipment_joined_outbound"."BILL_TO_STATE_PROV" AS "BILL_TO_STATE_PROV",
    "tlm_shipment_joined_outbound"."BILL_TO_POSTAL_CODE" AS "BILL_TO_POSTAL_CODE",
    "tlm_shipment_joined_outbound"."BILL_TO_COUNTRY_CODE" AS "BILL_TO_COUNTRY_CODE",
    "tlm_shipment_joined_outbound"."BILL_TO_PHONE_NUMBER" AS "BILL_TO_PHONE_NUMBER",
    "tlm_shipment_joined_outbound"."PURCHASE_ORDER" AS "PURCHASE_ORDER",
    "tlm_shipment_joined_outbound"."PRO_NUMBER" AS "PRO_NUMBER",
    "tlm_shipment_joined_outbound"."TRANS_RESP_CODE" AS "TRANS_RESP_CODE",
    "tlm_shipment_joined_outbound"."BASELINE_COST" AS "BASELINE_COST",
    "tlm_shipment_joined_outbound"."ESTIMATED_COST" AS "ESTIMATED_COST",
    "tlm_shipment_joined_outbound"."LINEHAUL_COST" AS "LINEHAUL_COST",
    "tlm_shipment_joined_outbound"."ACCESSORIAL_COST" AS "ACCESSORIAL_COST",
    "tlm_shipment_joined_outbound"."STOP_COST" AS "STOP_COST",
    "tlm_shipment_joined_outbound"."ESTIMATED_SAVINGS" AS "ESTIMATED_SAVINGS",
    "tlm_shipment_joined_outbound"."SPOT_CHARGE" AS "SPOT_CHARGE",
    "tlm_shipment_joined_outbound"."CURRENCY_CODE" AS "CURRENCY_CODE",
    "tlm_shipment_joined_outbound"."PICKUP_START_DTTM" AS "PICKUP_START_DTTM",
    "tlm_shipment_joined_outbound"."PICKUP_END_DTTM" AS "PICKUP_END_DTTM",
    "tlm_shipment_joined_outbound"."DELIVERY_START_DTTM" AS "DELIVERY_START_DTTM",
    "tlm_shipment_joined_outbound"."DELIVERY_END_DTTM" AS "DELIVERY_END_DTTM",
    "tlm_shipment_joined_outbound"."NUM_STOPS" AS "NUM_STOPS",
    "tlm_shipment_joined_outbound"."NUM_DOCKS" AS "NUM_DOCKS",
    "tlm_shipment_joined_outbound"."ON_TIME_INDICATOR" AS "ON_TIME_INDICATOR",
    "tlm_shipment_joined_outbound"."HAS_NOTES" AS "HAS_NOTES",
    "tlm_shipment_joined_outbound"."HAS_ALERTS" AS "HAS_ALERTS",
    "tlm_shipment_joined_outbound"."HAS_IMPORT_ERROR" AS "HAS_IMPORT_ERROR",
    "tlm_shipment_joined_outbound"."HAS_SOFT_CHECK_ERROR" AS "HAS_SOFT_CHECK_ERROR",
    "tlm_shipment_joined_outbound"."HAS_TRACKING_MSG" AS "HAS_TRACKING_MSG",
    "tlm_shipment_joined_outbound"."TRACKING_MSG_PROBLEM" AS "TRACKING_MSG_PROBLEM",
    "tlm_shipment_joined_outbound"."REC_LINEHAUL_COST" AS "REC_LINEHAUL_COST",
    "tlm_shipment_joined_outbound"."REC_ACCESSORIAL_COST" AS "REC_ACCESSORIAL_COST",
    "tlm_shipment_joined_outbound"."REC_TOTAL_COST" AS "REC_TOTAL_COST",
    "tlm_shipment_joined_outbound"."CYCLE_RESP_DEADLINE_TZ" AS "CYCLE_RESP_DEADLINE_TZ",
    "tlm_shipment_joined_outbound"."TENDER_RESP_DEADLINE_TZ" AS "TENDER_RESP_DEADLINE_TZ",
    "tlm_shipment_joined_outbound"."PICKUP_TZ" AS "PICKUP_TZ",
    "tlm_shipment_joined_outbound"."DELIVERY_TZ" AS "DELIVERY_TZ",
    "tlm_shipment_joined_outbound"."ASSIGNED_LANE_ID" AS "ASSIGNED_LANE_ID",
    "tlm_shipment_joined_outbound"."ASSIGNED_LANE_DETAIL_ID" AS "ASSIGNED_LANE_DETAIL_ID",
    "tlm_shipment_joined_outbound"."REC_SPOT_CHARGE" AS "REC_SPOT_CHARGE",
    "tlm_shipment_joined_outbound"."REC_LANE_ID" AS "REC_LANE_ID",
    "tlm_shipment_joined_outbound"."REC_LANE_DETAIL_ID" AS "REC_LANE_DETAIL_ID",
    "tlm_shipment_joined_outbound"."TENDER_DTTM" AS "TENDER_DTTM",
    "tlm_shipment_joined_outbound"."O_STOP_LOCATION_NAME" AS "O_STOP_LOCATION_NAME",
    "tlm_shipment_joined_outbound"."D_STOP_LOCATION_NAME" AS "D_STOP_LOCATION_NAME",
    "tlm_shipment_joined_outbound"."ASSIGNED_CM_SHIPMENT_ID" AS "ASSIGNED_CM_SHIPMENT_ID",
    "tlm_shipment_joined_outbound"."REC_CM_DISCOUNT" AS "REC_CM_DISCOUNT",
    "tlm_shipment_joined_outbound"."REC_STOP_COST" AS "REC_STOP_COST",
    "tlm_shipment_joined_outbound"."LAST_SELECTOR_RUN_DTTM" AS "LAST_SELECTOR_RUN_DTTM",
    "tlm_shipment_joined_outbound"."LAST_CM_OPTION_GEN_DTTM" AS "LAST_CM_OPTION_GEN_DTTM",
    "tlm_shipment_joined_outbound"."IS_CM_OPTION_GEN_ACTIVE" AS "IS_CM_OPTION_GEN_ACTIVE",
    "tlm_shipment_joined_outbound"."RS_CYCLE_REMAINING" AS "RS_CYCLE_REMAINING",
    "tlm_shipment_joined_outbound"."IS_TIME_FEAS_ENABLED" AS "IS_TIME_FEAS_ENABLED",
    "tlm_shipment_joined_outbound"."EXT_SYS_SHIPMENT_ID" AS "EXT_SYS_SHIPMENT_ID",
    "tlm_shipment_joined_outbound"."EXTRACTION_DTTM" AS "EXTRACTION_DTTM",
    "tlm_shipment_joined_outbound"."ASSIGNED_BROKER_CARRIER_CODE" AS "ASSIGNED_BROKER_CARRIER_CODE",
    "tlm_shipment_joined_outbound"."USE_BROKER_AS_CARRIER" AS "USE_BROKER_AS_CARRIER",
    "tlm_shipment_joined_outbound"."BROKER_REF" AS "BROKER_REF",
    "tlm_shipment_joined_outbound"."RATING_QUALIFIER" AS "RATING_QUALIFIER",
    "tlm_shipment_joined_outbound"."STATUS_CHANGE_DTTM" AS "STATUS_CHANGE_DTTM",
    "tlm_shipment_joined_outbound"."BUDG_TOTAL_COST" AS "BUDG_TOTAL_COST",
    "tlm_shipment_joined_outbound"."NORMALIZED_MARGIN" AS "NORMALIZED_MARGIN",
    "tlm_shipment_joined_outbound"."NORMALIZED_TOTAL_COST" AS "NORMALIZED_TOTAL_COST",
    "tlm_shipment_joined_outbound"."BUDG_NORMALIZED_TOTAL_COST" AS "BUDG_NORMALIZED_TOTAL_COST",
    "tlm_shipment_joined_outbound"."REC_BUDG_LINEHAUL_COST" AS "REC_BUDG_LINEHAUL_COST",
    "tlm_shipment_joined_outbound"."REC_BUDG_STOP_COST" AS "REC_BUDG_STOP_COST",
    "tlm_shipment_joined_outbound"."REC_BUDG_CM_DISCOUNT" AS "REC_BUDG_CM_DISCOUNT",
    "tlm_shipment_joined_outbound"."REC_BUDG_ACCESSORIAL_COST" AS "REC_BUDG_ACCESSORIAL_COST",
    "tlm_shipment_joined_outbound"."REC_BUDG_TOTAL_COST" AS "REC_BUDG_TOTAL_COST",
    "tlm_shipment_joined_outbound"."REC_MARGIN" AS "REC_MARGIN",
    "tlm_shipment_joined_outbound"."REC_NORMALIZED_MARGIN" AS "REC_NORMALIZED_MARGIN",
    "tlm_shipment_joined_outbound"."REC_NORMALIZED_TOTAL_COST" AS "REC_NORMALIZED_TOTAL_COST",
    "tlm_shipment_joined_outbound"."REC_BUDG_NORMALIZED_TOTAL_COST" AS "REC_BUDG_NORMALIZED_TOTAL_COST",
    "tlm_shipment_joined_outbound"."BUDG_CURRENCY_CODE" AS "BUDG_CURRENCY_CODE",
    "tlm_shipment_joined_outbound"."SPOT_CHARGE_CURRENCY_CODE" AS "SPOT_CHARGE_CURRENCY_CODE",
    "tlm_shipment_joined_outbound"."REC_CURRENCY_CODE" AS "REC_CURRENCY_CODE",
    "tlm_shipment_joined_outbound"."REC_BUDG_CURRENCY_CODE" AS "REC_BUDG_CURRENCY_CODE",
    "tlm_shipment_joined_outbound"."REC_SPOT_CHARGE_CURRENCY_CODE" AS "REC_SPOT_CHARGE_CURRENCY_CODE",
    "tlm_shipment_joined_outbound"."RATING_LANE_ID" AS "RATING_LANE_ID",
    "tlm_shipment_joined_outbound"."FRT_REV_RATING_LANE_ID" AS "FRT_REV_RATING_LANE_ID",
    "tlm_shipment_joined_outbound"."REC_RATING_LANE_ID" AS "REC_RATING_LANE_ID",
    "tlm_shipment_joined_outbound"."REC_BUDG_RATING_LANE_ID" AS "REC_BUDG_RATING_LANE_ID",
    "tlm_shipment_joined_outbound"."RATING_LANE_DETAIL_ID" AS "RATING_LANE_DETAIL_ID",
    "tlm_shipment_joined_outbound"."FRT_REV_RATING_LANE_DETAIL_ID" AS "FRT_REV_RATING_LANE_DETAIL_ID",
    "tlm_shipment_joined_outbound"."REC_RATING_LANE_DETAIL_ID" AS "REC_RATING_LANE_DETAIL_ID",
    "tlm_shipment_joined_outbound"."REC_BUDG_RATING_LANE_DETAIL_ID" AS "REC_BUDG_RATING_LANE_DETAIL_ID",
    "tlm_shipment_joined_outbound"."BUDG_CM_DISCOUNT" AS "BUDG_CM_DISCOUNT",
    "tlm_shipment_joined_outbound"."NORMALIZED_BASELINE_COST" AS "NORMALIZED_BASELINE_COST",
    "tlm_shipment_joined_outbound"."BASELINE_COST_CURRENCY_CODE" AS "BASELINE_COST_CURRENCY_CODE",
    "tlm_shipment_joined_outbound"."REPORTED_COST" AS "REPORTED_COST",
    "tlm_shipment_joined_outbound"."TRACTOR_NUMBER" AS "TRACTOR_NUMBER",
    "tlm_shipment_joined_outbound"."IS_AUTO_DELIVERED" AS "IS_AUTO_DELIVERED",
    "tlm_shipment_joined_outbound"."SHIPMENT_TYPE" AS "SHIPMENT_TYPE",
    "tlm_shipment_joined_outbound"."ORIG_BUDG_TOTAL_COST" AS "ORIG_BUDG_TOTAL_COST",
    "tlm_shipment_joined_outbound"."ACCESSORIAL_COST_TO_CARRIER" AS "ACCESSORIAL_COST_TO_CARRIER",
    "tlm_shipment_joined_outbound"."CARRIER_CHARGE" AS "CARRIER_CHARGE",
    "tlm_shipment_joined_outbound"."ACTUAL_COST" AS "ACTUAL_COST",
    "tlm_shipment_joined_outbound"."EARNED_INCOME" AS "EARNED_INCOME",
    "tlm_shipment_joined_outbound"."SENT_TO_PKMS" AS "SENT_TO_PKMS",
    "tlm_shipment_joined_outbound"."IS_SHIPMENT_RECONCILED" AS "IS_SHIPMENT_RECONCILED",
    "tlm_shipment_joined_outbound"."DELIVERY_REQ" AS "DELIVERY_REQ",
    "tlm_shipment_joined_outbound"."DROPOFF_PICKUP" AS "DROPOFF_PICKUP",
    "tlm_shipment_joined_outbound"."PACKAGING" AS "PACKAGING",
    "tlm_shipment_joined_outbound"."SENT_TO_PKMS_DTTM" AS "SENT_TO_PKMS_DTTM",
    "tlm_shipment_joined_outbound"."WMS_STATUS_CODE" AS "WMS_STATUS_CODE",
    "tlm_shipment_joined_outbound"."SPOT_CHARGE_AND_PAYEE_ACC" AS "SPOT_CHARGE_AND_PAYEE_ACC",
    "tlm_shipment_joined_outbound"."SPOT_CHARGE_AND_PAYEE_ACC_CC" AS "SPOT_CHARGE_AND_PAYEE_ACC_CC",
    "tlm_shipment_joined_outbound"."NORM_SPOT_CHARGE_AND_PAYEE_ACC" AS "NORM_SPOT_CHARGE_AND_PAYEE_ACC",
    "tlm_shipment_joined_outbound"."FACILITY_SCHEDULE_ID" AS "FACILITY_SCHEDULE_ID",
    "tlm_shipment_joined_outbound"."EARNED_INCOME_CURRENCY_CODE" AS "EARNED_INCOME_CURRENCY_CODE",
    "tlm_shipment_joined_outbound"."ACTUAL_COST_CURRENCY_CODE" AS "ACTUAL_COST_CURRENCY_CODE",
    "tlm_shipment_joined_outbound"."SHIPMENT_RECON_DTTM" AS "SHIPMENT_RECON_DTTM",
    "tlm_shipment_joined_outbound"."PLN_RATING_LANE_ID" AS "PLN_RATING_LANE_ID",
    "tlm_shipment_joined_outbound"."PLN_RATING_LANE_DETAIL_ID" AS "PLN_RATING_LANE_DETAIL_ID",
    "tlm_shipment_joined_outbound"."PLN_TOTAL_COST" AS "PLN_TOTAL_COST",
    "tlm_shipment_joined_outbound"."PLN_LINEHAUL_COST" AS "PLN_LINEHAUL_COST",
    "tlm_shipment_joined_outbound"."PLN_TOTAL_ACCESSORIAL_COST" AS "PLN_TOTAL_ACCESSORIAL_COST",
    "tlm_shipment_joined_outbound"."PLN_STOP_OFF_COST" AS "PLN_STOP_OFF_COST",
    "tlm_shipment_joined_outbound"."PLN_NORMALIZED_TOTAL_COST" AS "PLN_NORMALIZED_TOTAL_COST",
    "tlm_shipment_joined_outbound"."PLN_CURRENCY_CODE" AS "PLN_CURRENCY_CODE",
    "tlm_shipment_joined_outbound"."PLN_ACCESSORL_COST_TO_CARRIER" AS "PLN_ACCESSORL_COST_TO_CARRIER",
    "tlm_shipment_joined_outbound"."PLN_CARRIER_CHARGE" AS "PLN_CARRIER_CHARGE",
    "tlm_shipment_joined_outbound"."WAYPOINT_TOTAL_COST" AS "WAYPOINT_TOTAL_COST",
    "tlm_shipment_joined_outbound"."WAYPOINT_HANDLING_COST" AS "WAYPOINT_HANDLING_COST",
    "tlm_shipment_joined_outbound"."GRS_OPERATION" AS "GRS_OPERATION",
    "tlm_shipment_joined_outbound"."IS_GRS_OPT_CYCLE_RUNNING" AS "IS_GRS_OPT_CYCLE_RUNNING",
    "tlm_shipment_joined_outbound"."IS_MANUAL_ASSIGN" AS "IS_MANUAL_ASSIGN",
    "tlm_shipment_joined_outbound"."LAST_RUN_GRS_DTTM" AS "LAST_RUN_GRS_DTTM",
    "tlm_shipment_joined_outbound"."GRS_MAX_SHIPMENT_STATUS" AS "GRS_MAX_SHIPMENT_STATUS",
    "tlm_shipment_joined_outbound"."PRIORITY_TYPE" AS "PRIORITY_TYPE",
    "tlm_shipment_joined_outbound"."MV_CURRENCY_CODE" AS "MV_CURRENCY_CODE",
    "tlm_shipment_joined_outbound"."PROD_SCHED_REF_NUMBER" AS "PROD_SCHED_REF_NUMBER",
    "tlm_shipment_joined_outbound"."COMMODITY_CODE_ID" AS "COMMODITY_CODE_ID",
    "tlm_shipment_joined_outbound"."UN_NUMBER_ID" AS "UN_NUMBER_ID",
    "tlm_shipment_joined_outbound"."CONTRACT_NUMBER" AS "CONTRACT_NUMBER",
    "tlm_shipment_joined_outbound"."BOOKING_REF_SHIPPER" AS "BOOKING_REF_SHIPPER",
    "tlm_shipment_joined_outbound"."BOOKING_REF_CARRIER" AS "BOOKING_REF_CARRIER",
    "tlm_shipment_joined_outbound"."BK_RESOURCE_REF_EXTERNAL" AS "BK_RESOURCE_REF_EXTERNAL",
    "tlm_shipment_joined_outbound"."BK_RESOURCE_NAME_EXTERNAL" AS "BK_RESOURCE_NAME_EXTERNAL",
    "tlm_shipment_joined_outbound"."BK_O_FACILITY_ID" AS "BK_O_FACILITY_ID",
    "tlm_shipment_joined_outbound"."BK_D_FACILITY_ID" AS "BK_D_FACILITY_ID",
    "tlm_shipment_joined_outbound"."BK_MASTER_AIRWAY_BILL" AS "BK_MASTER_AIRWAY_BILL",
    "tlm_shipment_joined_outbound"."BK_FORWARDER_AIRWAY_BILL" AS "BK_FORWARDER_AIRWAY_BILL",
    "tlm_shipment_joined_outbound"."ASSIGNED_SCNDR_CARRIER_CODE" AS "ASSIGNED_SCNDR_CARRIER_CODE",
    "tlm_shipment_joined_outbound"."CUSTOMER_CREDIT_LIMIT_ID" AS "CUSTOMER_CREDIT_LIMIT_ID",
    "tlm_shipment_joined_outbound"."SHIPMENT_LEG_TYPE" AS "SHIPMENT_LEG_TYPE",
    "tlm_shipment_joined_outbound"."SHIPMENT_CLOSED_INDICATOR" AS "SHIPMENT_CLOSED_INDICATOR",
    "tlm_shipment_joined_outbound"."OCEAN_ROUTING_STAGE" AS "OCEAN_ROUTING_STAGE",
    "tlm_shipment_joined_outbound"."BK_DEPARTURE_DTTM" AS "BK_DEPARTURE_DTTM",
    "tlm_shipment_joined_outbound"."BK_DEPARTURE_TZ" AS "BK_DEPARTURE_TZ",
    "tlm_shipment_joined_outbound"."BK_ARRIVAL_DTTM" AS "BK_ARRIVAL_DTTM",
    "tlm_shipment_joined_outbound"."BK_ARRIVAL_TZ" AS "BK_ARRIVAL_TZ",
    "tlm_shipment_joined_outbound"."BK_PICKUP_DTTM" AS "BK_PICKUP_DTTM",
    "tlm_shipment_joined_outbound"."BK_PICKUP_TZ" AS "BK_PICKUP_TZ",
    "tlm_shipment_joined_outbound"."BK_CUTOFF_DTTM" AS "BK_CUTOFF_DTTM",
    "tlm_shipment_joined_outbound"."BK_CUTOFF_TZ" AS "BK_CUTOFF_TZ",
    "tlm_shipment_joined_outbound"."NUM_CHARGE_LAYOVERS" AS "NUM_CHARGE_LAYOVERS",
    "tlm_shipment_joined_outbound"."RATE_TYPE" AS "RATE_TYPE",
    "tlm_shipment_joined_outbound"."RATE_UOM" AS "RATE_UOM",
    "tlm_shipment_joined_outbound"."PICK_START_DTTM" AS "PICK_START_DTTM",
    "tlm_shipment_joined_outbound"."PAPERWORK_START_DTTM" AS "PAPERWORK_START_DTTM",
    "tlm_shipment_joined_outbound"."VEHICLE_CHECK_START_DTTM" AS "VEHICLE_CHECK_START_DTTM",
    "tlm_shipment_joined_outbound"."SHIPMENT_START_DTTM" AS "SHIPMENT_START_DTTM",
    "tlm_shipment_joined_outbound"."SHIPMENT_END_DTTM" AS "SHIPMENT_END_DTTM",
    "tlm_shipment_joined_outbound"."FEASIBLE_DRIVER_TYPE" AS "FEASIBLE_DRIVER_TYPE",
    "tlm_shipment_joined_outbound"."WAVE_ID" AS "WAVE_ID",
    "tlm_shipment_joined_outbound"."ESTIMATED_DISPATCH_DTTM" AS "ESTIMATED_DISPATCH_DTTM",
    "tlm_shipment_joined_outbound"."TOTAL_TIME" AS "TOTAL_TIME",
    "tlm_shipment_joined_outbound"."LOC_REFERENCE" AS "LOC_REFERENCE",
    "tlm_shipment_joined_outbound"."BK_O_FACILITY_ALIAS_ID" AS "BK_O_FACILITY_ALIAS_ID",
    "tlm_shipment_joined_outbound"."BK_D_FACILITY_ALIAS_ID" AS "BK_D_FACILITY_ALIAS_ID",
    "tlm_shipment_joined_outbound"."EQUIP_UTIL_PER" AS "EQUIP_UTIL_PER",
    "tlm_shipment_joined_outbound"."MOVE_TYPE" AS "MOVE_TYPE",
    "tlm_shipment_joined_outbound"."DRIVER_TYPE_ID" AS "DRIVER_TYPE_ID",
    "tlm_shipment_joined_outbound"."EQUIPMENT_TYPE" AS "EQUIPMENT_TYPE",
    "tlm_shipment_joined_outbound"."RADIAL_DISTANCE" AS "RADIAL_DISTANCE",
    "tlm_shipment_joined_outbound"."RADIAL_DISTANCE_UOM" AS "RADIAL_DISTANCE_UOM",
    "tlm_shipment_joined_outbound"."DESIGNATED_TRACTOR_CODE" AS "DESIGNATED_TRACTOR_CODE",
    "tlm_shipment_joined_outbound"."DESIGNATED_DRIVER_TYPE" AS "DESIGNATED_DRIVER_TYPE",
    "tlm_shipment_joined_outbound"."IS_WAVE_MAN_CHANGED" AS "IS_WAVE_MAN_CHANGED",
    "tlm_shipment_joined_outbound"."RETAIN_CONSOLIDATOR_TIMES" AS "RETAIN_CONSOLIDATOR_TIMES",
    "tlm_shipment_joined_outbound"."TARIFF" AS "TARIFF",
    "tlm_shipment_joined_outbound"."MIN_RATE" AS "MIN_RATE",
    "tlm_shipment_joined_outbound"."FIRST_UPDATE_SENT_TO_PKMS" AS "FIRST_UPDATE_SENT_TO_PKMS",
    "tlm_shipment_joined_outbound"."EVENT_IND_TYPEID" AS "EVENT_IND_TYPEID",
    "tlm_shipment_joined_outbound"."TANDEM_PATH_ID" AS "TANDEM_PATH_ID",
    "tlm_shipment_joined_outbound"."O_TANDEM_FACILITY" AS "O_TANDEM_FACILITY",
    "tlm_shipment_joined_outbound"."D_TANDEM_FACILITY" AS "D_TANDEM_FACILITY",
    "tlm_shipment_joined_outbound"."O_TANDEM_FACILITY_ALIAS" AS "O_TANDEM_FACILITY_ALIAS",
    "tlm_shipment_joined_outbound"."D_TANDEM_FACILITY_ALIAS" AS "D_TANDEM_FACILITY_ALIAS",
    "tlm_shipment_joined_outbound"."DELAY_TYPE" AS "DELAY_TYPE",
    "tlm_shipment_joined_outbound"."ASSIGNED_CARRIER_ID" AS "ASSIGNED_CARRIER_ID",
    "tlm_shipment_joined_outbound"."DSG_CARRIER_ID" AS "DSG_CARRIER_ID",
    "tlm_shipment_joined_outbound"."REC_CARRIER_ID" AS "REC_CARRIER_ID",
    "tlm_shipment_joined_outbound"."FEASIBLE_CARRIER_ID" AS "FEASIBLE_CARRIER_ID",
    "tlm_shipment_joined_outbound"."PAYEE_CARRIER_ID" AS "PAYEE_CARRIER_ID",
    "tlm_shipment_joined_outbound"."SCNDR_CARRIER_ID" AS "SCNDR_CARRIER_ID",
    "tlm_shipment_joined_outbound"."BROKER_CARRIER_ID" AS "BROKER_CARRIER_ID",
    "tlm_shipment_joined_outbound"."ASSIGNED_SCNDR_CARRIER_ID" AS "ASSIGNED_SCNDR_CARRIER_ID",
    "tlm_shipment_joined_outbound"."DSG_SCNDR_CARRIER_ID" AS "DSG_SCNDR_CARRIER_ID",
    "tlm_shipment_joined_outbound"."ASSIGNED_BROKER_CARRIER_ID" AS "ASSIGNED_BROKER_CARRIER_ID",
    "tlm_shipment_joined_outbound"."LH_PAYEE_CARRIER_ID" AS "LH_PAYEE_CARRIER_ID",
    "tlm_shipment_joined_outbound"."REC_BROKER_CARRIER_ID" AS "REC_BROKER_CARRIER_ID",
    "tlm_shipment_joined_outbound"."ASSIGNED_EQUIPMENT_ID" AS "ASSIGNED_EQUIPMENT_ID",
    "tlm_shipment_joined_outbound"."DSG_EQUIPMENT_ID" AS "DSG_EQUIPMENT_ID",
    "tlm_shipment_joined_outbound"."FEASIBLE_EQUIPMENT_ID" AS "FEASIBLE_EQUIPMENT_ID",
    "tlm_shipment_joined_outbound"."FEASIBLE_EQUIPMENT2_ID" AS "FEASIBLE_EQUIPMENT2_ID",
    "tlm_shipment_joined_outbound"."REC_EQUIPMENT_ID" AS "REC_EQUIPMENT_ID",
    "tlm_shipment_joined_outbound"."ASSIGNED_MOT_ID" AS "ASSIGNED_MOT_ID",
    "tlm_shipment_joined_outbound"."DSG_MOT_ID" AS "DSG_MOT_ID",
    "tlm_shipment_joined_outbound"."FEASIBLE_MOT_ID" AS "FEASIBLE_MOT_ID",
    "tlm_shipment_joined_outbound"."REC_MOT_ID" AS "REC_MOT_ID",
    "tlm_shipment_joined_outbound"."PRODUCT_CLASS_ID" AS "PRODUCT_CLASS_ID",
    "tlm_shipment_joined_outbound"."PROTECTION_LEVEL_ID" AS "PROTECTION_LEVEL_ID",
    "tlm_shipment_joined_outbound"."ASSIGNED_SERVICE_LEVEL_ID" AS "ASSIGNED_SERVICE_LEVEL_ID",
    "tlm_shipment_joined_outbound"."DSG_SERVICE_LEVEL_ID" AS "DSG_SERVICE_LEVEL_ID",
    "tlm_shipment_joined_outbound"."FEASIBLE_SERVICE_LEVEL_ID" AS "FEASIBLE_SERVICE_LEVEL_ID",
    "tlm_shipment_joined_outbound"."REC_SERVICE_LEVEL_ID" AS "REC_SERVICE_LEVEL_ID",
    "tlm_shipment_joined_outbound"."HAS_EM_NOTIFY_FLAG" AS "HAS_EM_NOTIFY_FLAG",
    "tlm_shipment_joined_outbound"."REGION_ID" AS "REGION_ID",
    "tlm_shipment_joined_outbound"."INBOUND_REGION_ID" AS "INBOUND_REGION_ID",
    "tlm_shipment_joined_outbound"."OUTBOUND_REGION_ID" AS "OUTBOUND_REGION_ID",
    "tlm_shipment_joined_outbound"."FINANCIAL_WT" AS "FINANCIAL_WT",
    "tlm_shipment_joined_outbound"."IS_BOOKING_REQUIRED" AS "IS_BOOKING_REQUIRED",
    "tlm_shipment_joined_outbound"."TOTAL_COST_EXCL_TAX" AS "TOTAL_COST_EXCL_TAX",
    "tlm_shipment_joined_outbound"."TOTAL_TAX_AMOUNT" AS "TOTAL_TAX_AMOUNT",
    "tlm_shipment_joined_outbound"."IS_ASSOCIATED_TO_OUTBOUND" AS "IS_ASSOCIATED_TO_OUTBOUND",
    "tlm_shipment_joined_outbound"."RECEIVED_DTTM" AS "RECEIVED_DTTM",
    "tlm_shipment_joined_outbound"."BOOKING_ID" AS "BOOKING_ID",
    "tlm_shipment_joined_outbound"."IS_MISROUTED" AS "IS_MISROUTED",
    "tlm_shipment_joined_outbound"."FEASIBLE_CARRIER_CODE" AS "FEASIBLE_CARRIER_CODE",
    "tlm_shipment_joined_outbound"."SHIPMENT_WIN_ADJ_FLAG" AS "SHIPMENT_WIN_ADJ_FLAG",
    "tlm_shipment_joined_outbound"."DT_PARAM_SET_ID" AS "DT_PARAM_SET_ID",
    "tlm_shipment_joined_outbound"."MERCHANDIZING_DEPARTMENT_ID" AS "MERCHANDIZING_DEPARTMENT_ID",
    "tlm_shipment_joined_outbound"."STATIC_ROUTE_ID" AS "STATIC_ROUTE_ID",
    "tlm_shipment_joined_outbound"."IS_FILO" AS "IS_FILO",
    "tlm_shipment_joined_outbound"."IS_COOLER_AT_NOSE" AS "IS_COOLER_AT_NOSE",
    "tlm_shipment_joined_outbound"."AUTH_NBR" AS "AUTH_NBR",
    "tlm_shipment_joined_outbound"."CONS_LOCN_ID" AS "CONS_LOCN_ID",
    "tlm_shipment_joined_outbound"."RTE_TYPE" AS "RTE_TYPE",
    "tlm_shipment_joined_outbound"."TRLR_TYPE" AS "TRLR_TYPE",
    "tlm_shipment_joined_outbound"."TRLR_SIZE" AS "TRLR_SIZE",
    "tlm_shipment_joined_outbound"."CONS_ADDR_CODE" AS "CONS_ADDR_CODE",
    "tlm_shipment_joined_outbound"."HUB_ID" AS "HUB_ID",
    "tlm_shipment_joined_outbound"."TRLR_GEN_CODE" AS "TRLR_GEN_CODE",
    "tlm_shipment_joined_outbound"."MAX_NBR_OF_CTNS" AS "MAX_NBR_OF_CTNS",
    "tlm_shipment_joined_outbound"."APPT_DOOR_SCHED_TYPE" AS "APPT_DOOR_SCHED_TYPE",
    "tlm_shipment_joined_outbound"."CREATED_SOURCE_TYPE" AS "CREATED_SOURCE_TYPE",
    "tlm_shipment_joined_outbound"."CREATED_SOURCE" AS "CREATED_SOURCE",
    "tlm_shipment_joined_outbound"."CREATED_DTTM" AS "CREATED_DTTM",
    "tlm_shipment_joined_outbound"."LAST_UPDATED_SOURCE_TYPE" AS "LAST_UPDATED_SOURCE_TYPE",
    "tlm_shipment_joined_outbound"."LAST_UPDATED_SOURCE" AS "LAST_UPDATED_SOURCE",
    "tlm_shipment_joined_outbound"."LAST_UPDATED_DTTM" AS "LAST_UPDATED_DTTM",
    "tlm_shipment_joined_outbound"."DSG_SCNDR_CARRIER_CODE" AS "DSG_SCNDR_CARRIER_CODE",
    "tlm_shipment_joined_outbound"."LH_PAYEE_CARRIER_CODE" AS "LH_PAYEE_CARRIER_CODE",
    "tlm_shipment_joined_outbound"."REC_BROKER_CARRIER_CODE" AS "REC_BROKER_CARRIER_CODE",
    "tlm_shipment_joined_outbound"."REC_CARRIER_CODE" AS "REC_CARRIER_CODE",
    "tlm_shipment_joined_outbound"."LPN_ASSIGNMENT_STOPPED" AS "LPN_ASSIGNMENT_STOPPED",
    "tlm_shipment_joined_outbound"."SEAL_NUMBER" AS "SEAL_NUMBER",
    "tlm_shipment_joined_outbound"."HIBERNATE_VERSION" AS "HIBERNATE_VERSION",
    "tlm_shipment_joined_outbound"."SHIP_GROUP_ID" AS "SHIP_GROUP_ID",
    "tlm_shipment_joined_outbound"."RATE" AS "RATE",
    "tlm_shipment_joined_outbound"."MONETARY_VALUE" AS "MONETARY_VALUE",
    "tlm_shipment_joined_outbound"."DOOR" AS "DOOR",
    "tlm_shipment_joined_outbound"."RTE_TYPE_1" AS "RTE_TYPE_1",
    "tlm_shipment_joined_outbound"."RTE_TYPE_2" AS "RTE_TYPE_2",
    "tlm_shipment_joined_outbound"."SCHEDULED_PICKUP_DTTM" AS "SCHEDULED_PICKUP_DTTM",
    "tlm_shipment_joined_outbound"."MANIFEST_ID" AS "MANIFEST_ID",
    "tlm_shipment_joined_outbound"."DAYS_TO_DELIVER" AS "DAYS_TO_DELIVER",
    "tlm_shipment_joined_outbound"."SED_GENERATED_FLAG" AS "SED_GENERATED_FLAG",
    "tlm_shipment_joined_outbound"."SERV_AREA_CODE" AS "SERV_AREA_CODE",
    "tlm_shipment_joined_outbound"."TENDER_RESP_DEADLINE_DTTM" AS "TENDER_RESP_DEADLINE_DTTM",
    "tlm_shipment_joined_outbound"."PRINT_CONS_BOL" AS "PRINT_CONS_BOL",
    "tlm_shipment_joined_outbound"."LEFT_WT" AS "LEFT_WT",
    "tlm_shipment_joined_outbound"."RIGHT_WT" AS "RIGHT_WT",
    "tlm_shipment_joined_outbound"."LANE_NAME" AS "LANE_NAME",
    "tlm_shipment_joined_outbound"."DECLARED_VALUE" AS "DECLARED_VALUE",
    "tlm_shipment_joined_outbound"."DV_CURRENCY_CODE" AS "DV_CURRENCY_CODE",
    "tlm_shipment_joined_outbound"."COD_AMOUNT" AS "COD_AMOUNT",
    "tlm_shipment_joined_outbound"."CUSTOMER_ID" AS "CUSTOMER_ID",
    "tlm_shipment_joined_outbound"."CUST_FRGT_CHARGE" AS "CUST_FRGT_CHARGE",
    "tlm_shipment_joined_outbound"."COD_CURRENCY_CODE" AS "COD_CURRENCY_CODE",
    "tlm_shipment_joined_outbound"."PLANNED_WEIGHT" AS "PLANNED_WEIGHT",
    "tlm_shipment_joined_outbound"."WEIGHT_UOM_ID_BASE" AS "WEIGHT_UOM_ID_BASE",
    "tlm_shipment_joined_outbound"."PLANNED_VOLUME" AS "PLANNED_VOLUME",
    "tlm_shipment_joined_outbound"."VOLUME_UOM_ID_BASE" AS "VOLUME_UOM_ID_BASE",
    "tlm_shipment_joined_outbound"."SIZE1_VALUE" AS "SIZE1_VALUE",
    "tlm_shipment_joined_outbound"."SIZE1_UOM_ID" AS "SIZE1_UOM_ID",
    "tlm_shipment_joined_outbound"."SIZE2_VALUE" AS "SIZE2_VALUE",
    "tlm_shipment_joined_outbound"."SIZE2_UOM_ID" AS "SIZE2_UOM_ID",
    "tlm_shipment_joined_outbound"."ASSIGNED_SHIP_VIA" AS "ASSIGNED_SHIP_VIA",
    "tlm_shipment_joined_outbound"."INSURANCE_STATUS" AS "INSURANCE_STATUS",
    "tlm_shipment_joined_outbound"."RTE_SWC_NBR" AS "RTE_SWC_NBR",
    "tlm_shipment_joined_outbound"."RTE_TO" AS "RTE_TO",
    "tlm_shipment_joined_outbound"."BILL_OF_LADING_NUMBER" AS "BILL_OF_LADING_NUMBER",
    "tlm_shipment_joined_outbound"."TRAILER_NUMBER" AS "TRAILER_NUMBER",
    "tlm_shipment_joined_outbound"."TRANS_PLAN_OWNER" AS "TRANS_PLAN_OWNER",
    "tlm_shipment_joined_outbound"."TOTAL_REVENUE_CURRENCY_CODE" AS "TOTAL_REVENUE_CURRENCY_CODE",
    "tlm_shipment_joined_outbound"."TOTAL_REVENUE" AS "TOTAL_REVENUE",
    "tlm_shipment_joined_outbound"."FRT_REV_SPOT_CHARGE_CURR_CODE" AS "FRT_REV_SPOT_CHARGE_CURR_CODE",
    "tlm_shipment_joined_outbound"."NORMALIZED_TOTAL_REVENUE" AS "NORMALIZED_TOTAL_REVENUE",
    "tlm_shipment_joined_outbound"."FRT_REV_SPOT_CHARGE" AS "FRT_REV_SPOT_CHARGE",
    "tlm_shipment_joined_outbound"."DSG_VOYAGE_FLIGHT" AS "DSG_VOYAGE_FLIGHT",
    "tlm_shipment_joined_outbound"."FEASIBLE_VOYAGE_FLIGHT" AS "FEASIBLE_VOYAGE_FLIGHT",
    "tlm_shipment_joined_outbound"."CURRENCY_DTTM" AS "CURRENCY_DTTM",
    "tlm_shipment_joined_outbound"."FRT_REV_LINEHAUL_CHARGE" AS "FRT_REV_LINEHAUL_CHARGE",
    "tlm_shipment_joined_outbound"."FRT_REV_STOP_CHARGE" AS "FRT_REV_STOP_CHARGE",
    "tlm_shipment_joined_outbound"."FRT_REV_ACCESSORIAL_CHARGE" AS "FRT_REV_ACCESSORIAL_CHARGE",
    "tlm_shipment_joined_outbound"."MARGIN" AS "MARGIN",
    "tlm_shipment_joined_outbound"."INCOTERM_ID" AS "INCOTERM_ID",
    "tlm_shipment_joined_outbound"."ORDER_QTY" AS "ORDER_QTY",
    "tlm_shipment_joined_outbound"."QTY_UOM_ID" AS "QTY_UOM_ID",
    "tlm_shipment_joined_outbound"."REF_SHIPMENT_NBR" AS "REF_SHIPMENT_NBR",
    "tlm_shipment_joined_outbound"."STAGING_LOCN_ID" AS "STAGING_LOCN_ID",
    "tlm_shipment_joined_outbound"."LOADING_SEQ_ORD" AS "LOADING_SEQ_ORD",
    "tlm_shipment_joined_outbound"."HAZMAT_CERT_CONTACT" AS "HAZMAT_CERT_CONTACT",
    "tlm_shipment_joined_outbound"."HAZMAT_CERT_DECLARATION" AS "HAZMAT_CERT_DECLARATION",
    "tlm_shipment_joined_outbound"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP",
    "tlm_shipment_joined_outbound"."OPERATION_TYPE" AS "OPERATION_TYPE",
    "tlm_shipment_joined_outbound"."ARCHIVED_DTTM" AS "ARCHIVED_DTTM",
    "tlm_shipment_joined_outbound"."ORIGIN" AS "ORIGIN",
    "tlm_shipment_joined_outbound"."FINAL_DESTINATION" AS "FINAL_DESTINATION",
    "tlm_shipment_joined_outbound"."actual_delivery_date_parsed" AS "actual_delivery_date_parsed",
    "tlm_shipment_joined_outbound"."wood_pellet" AS "wood_pellet",
    "tlm_shipment_joined_outbound"."act_del_MERCH_YEAR" AS "act_del_MERCH_YEAR",
    "tlm_shipment_joined_outbound"."act_del_YEAR_WEEK" AS "act_del_YEAR_WEEK",
    "tlm_shipment_joined_outbound"."act_del_YEAR_QUARTER" AS "act_del_YEAR_QUARTER",
    "tlm_shipment_joined_outbound"."act_del_YEAR_PERIOD" AS "act_del_YEAR_PERIOD",
    "tlm_shipment_joined_outbound"."invoice_shipping_id" AS "invoice_shipping_id",
    "tlm_shipment_joined_outbound"."TOTAL_COST" AS "TOTAL_COST",
    "tlm_shipment_joined_outbound"."org_Facility_Code" AS "org_Facility_Code",
    "tlm_shipment_joined_outbound"."org_Facility_Name" AS "org_Facility_Name",
    "tlm_shipment_joined_outbound"."org_Facility_Type" AS "org_Facility_Type",
    "tlm_shipment_joined_outbound"."dest_Facility_Code" AS "dest_Facility_Code",
    "tlm_shipment_joined_outbound"."dest_Facility_Name" AS "dest_Facility_Name",
    "tlm_shipment_joined_outbound"."dest_Facility_Type" AS "dest_Facility_Type",
    "tlm_shipment_joined_outbound"."inbound_flag" AS "inbound_flag",
    "sc_tlm_orders_prepared_by_ORDER_ID"."ORDER_ID" AS "do_ORDER_ID"
  FROM "TLM_SHIPMENT_JOINED_OUTBOUND" "tlm_shipment_joined_outbound"
  LEFT JOIN "SC_TLM_ORDERS_PREPARED_BY_ORDER_ID" "sc_tlm_orders_prepared_by_ORDER_ID"
    ON "tlm_shipment_joined_outbound"."TC_SHIPMENT_ID" = "sc_tlm_orders_prepared_by_ORDER_ID"."TC_SHIPMENT_ID"
    )
    SELECT 
    "tlm_shipment_joined_do_prepared"."SHIPMENT_ID" AS "SHIPMENT_ID",
    "tlm_shipment_joined_do_prepared"."TC_COMPANY_ID" AS "TC_COMPANY_ID",
    "tlm_shipment_joined_do_prepared"."RS_AREA_ID" AS "RS_AREA_ID",
    "tlm_shipment_joined_do_prepared"."TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID",
    "tlm_shipment_joined_do_prepared"."PP_SHIPMENT_ID" AS "PP_SHIPMENT_ID",
    "tlm_shipment_joined_do_prepared"."SHIPMENT_STATUS" AS "SHIPMENT_STATUS",
    "tlm_shipment_joined_do_prepared"."UPDATE_SENT" AS "UPDATE_SENT",
    "tlm_shipment_joined_do_prepared"."BUSINESS_PROCESS" AS "BUSINESS_PROCESS",
    "tlm_shipment_joined_do_prepared"."CREATION_TYPE" AS "CREATION_TYPE",
    "tlm_shipment_joined_do_prepared"."CONS_RUN_ID" AS "CONS_RUN_ID",
    "tlm_shipment_joined_do_prepared"."IS_CANCELLED" AS "IS_CANCELLED",
    "tlm_shipment_joined_do_prepared"."RS_TYPE" AS "RS_TYPE",
    "tlm_shipment_joined_do_prepared"."RS_CONFIG_ID" AS "RS_CONFIG_ID",
    "tlm_shipment_joined_do_prepared"."RS_CONFIG_CYCLE_ID" AS "RS_CONFIG_CYCLE_ID",
    "tlm_shipment_joined_do_prepared"."CONFIG_CYCLE_SEQ" AS "CONFIG_CYCLE_SEQ",
    "tlm_shipment_joined_do_prepared"."CYCLE_DEADLINE_DTTM" AS "CYCLE_DEADLINE_DTTM",
    "tlm_shipment_joined_do_prepared"."CYCLE_EXECUTION_DTTM" AS "CYCLE_EXECUTION_DTTM",
    "tlm_shipment_joined_do_prepared"."LAST_RS_NOTIFICATION_DTTM" AS "LAST_RS_NOTIFICATION_DTTM",
    "tlm_shipment_joined_do_prepared"."CFMF_STATUS" AS "CFMF_STATUS",
    "tlm_shipment_joined_do_prepared"."AVAILABLE_DTTM" AS "AVAILABLE_DTTM",
    "tlm_shipment_joined_do_prepared"."CMID" AS "CMID",
    "tlm_shipment_joined_do_prepared"."CM_DISCOUNT" AS "CM_DISCOUNT",
    "tlm_shipment_joined_do_prepared"."O_FACILITY_NUMBER" AS "O_FACILITY_NUMBER",
    "tlm_shipment_joined_do_prepared"."O_FACILITY_ID" AS "O_FACILITY_ID",
    "tlm_shipment_joined_do_prepared"."O_ADDRESS" AS "O_ADDRESS",
    "tlm_shipment_joined_do_prepared"."O_CITY" AS "O_CITY",
    "tlm_shipment_joined_do_prepared"."O_STATE_PROV" AS "O_STATE_PROV",
    "tlm_shipment_joined_do_prepared"."O_POSTAL_CODE" AS "O_POSTAL_CODE",
    "tlm_shipment_joined_do_prepared"."O_COUNTY" AS "O_COUNTY",
    "tlm_shipment_joined_do_prepared"."O_COUNTRY_CODE" AS "O_COUNTRY_CODE",
    "tlm_shipment_joined_do_prepared"."D_FACILITY_NUMBER" AS "D_FACILITY_NUMBER",
    "tlm_shipment_joined_do_prepared"."D_FACILITY_ID" AS "D_FACILITY_ID",
    "tlm_shipment_joined_do_prepared"."D_ADDRESS" AS "D_ADDRESS",
    "tlm_shipment_joined_do_prepared"."D_CITY" AS "D_CITY",
    "tlm_shipment_joined_do_prepared"."D_STATE_PROV" AS "D_STATE_PROV",
    "tlm_shipment_joined_do_prepared"."D_POSTAL_CODE" AS "D_POSTAL_CODE",
    "tlm_shipment_joined_do_prepared"."D_COUNTY" AS "D_COUNTY",
    "tlm_shipment_joined_do_prepared"."D_COUNTRY_CODE" AS "D_COUNTRY_CODE",
    "tlm_shipment_joined_do_prepared"."DISTANCE" AS "DISTANCE",
    "tlm_shipment_joined_do_prepared"."DIRECT_DISTANCE" AS "DIRECT_DISTANCE",
    "tlm_shipment_joined_do_prepared"."OUT_OF_ROUTE_DISTANCE" AS "OUT_OF_ROUTE_DISTANCE",
    "tlm_shipment_joined_do_prepared"."DISTANCE_UOM" AS "DISTANCE_UOM",
    "tlm_shipment_joined_do_prepared"."BUSINESS_PARTNER_ID" AS "BUSINESS_PARTNER_ID",
    "tlm_shipment_joined_do_prepared"."COMMODITY_CLASS" AS "COMMODITY_CLASS",
    "tlm_shipment_joined_do_prepared"."IS_HAZMAT" AS "IS_HAZMAT",
    "tlm_shipment_joined_do_prepared"."IS_PERISHABLE" AS "IS_PERISHABLE",
    "tlm_shipment_joined_do_prepared"."BILLING_METHOD" AS "BILLING_METHOD",
    "tlm_shipment_joined_do_prepared"."DSG_CARRIER_CODE" AS "DSG_CARRIER_CODE",
    "tlm_shipment_joined_do_prepared"."REC_CMID" AS "REC_CMID",
    "tlm_shipment_joined_do_prepared"."REC_CM_SHIPMENT_ID" AS "REC_CM_SHIPMENT_ID",
    "tlm_shipment_joined_do_prepared"."ASSIGNED_CARRIER_CODE" AS "ASSIGNED_CARRIER_CODE",
    "tlm_shipment_joined_do_prepared"."SHIPMENT_REF_ID" AS "SHIPMENT_REF_ID",
    "tlm_shipment_joined_do_prepared"."BILL_TO_CODE" AS "BILL_TO_CODE",
    "tlm_shipment_joined_do_prepared"."BILL_TO_TITLE" AS "BILL_TO_TITLE",
    "tlm_shipment_joined_do_prepared"."BILL_TO_NAME" AS "BILL_TO_NAME",
    "tlm_shipment_joined_do_prepared"."BILL_TO_ADDRESS" AS "BILL_TO_ADDRESS",
    "tlm_shipment_joined_do_prepared"."BILL_TO_CITY" AS "BILL_TO_CITY",
    "tlm_shipment_joined_do_prepared"."BILL_TO_STATE_PROV" AS "BILL_TO_STATE_PROV",
    "tlm_shipment_joined_do_prepared"."BILL_TO_POSTAL_CODE" AS "BILL_TO_POSTAL_CODE",
    "tlm_shipment_joined_do_prepared"."BILL_TO_COUNTRY_CODE" AS "BILL_TO_COUNTRY_CODE",
    "tlm_shipment_joined_do_prepared"."BILL_TO_PHONE_NUMBER" AS "BILL_TO_PHONE_NUMBER",
    "tlm_shipment_joined_do_prepared"."PURCHASE_ORDER" AS "PURCHASE_ORDER",
    "tlm_shipment_joined_do_prepared"."PRO_NUMBER" AS "PRO_NUMBER",
    "tlm_shipment_joined_do_prepared"."TRANS_RESP_CODE" AS "TRANS_RESP_CODE",
    "tlm_shipment_joined_do_prepared"."BASELINE_COST" AS "BASELINE_COST",
    "tlm_shipment_joined_do_prepared"."ESTIMATED_COST" AS "ESTIMATED_COST",
    "tlm_shipment_joined_do_prepared"."LINEHAUL_COST" AS "LINEHAUL_COST",
    "tlm_shipment_joined_do_prepared"."ACCESSORIAL_COST" AS "ACCESSORIAL_COST",
    "tlm_shipment_joined_do_prepared"."STOP_COST" AS "STOP_COST",
    "tlm_shipment_joined_do_prepared"."ESTIMATED_SAVINGS" AS "ESTIMATED_SAVINGS",
    "tlm_shipment_joined_do_prepared"."SPOT_CHARGE" AS "SPOT_CHARGE",
    "tlm_shipment_joined_do_prepared"."CURRENCY_CODE" AS "CURRENCY_CODE",
    "tlm_shipment_joined_do_prepared"."PICKUP_START_DTTM" AS "PICKUP_START_DTTM",
    "tlm_shipment_joined_do_prepared"."PICKUP_END_DTTM" AS "PICKUP_END_DTTM",
    "tlm_shipment_joined_do_prepared"."DELIVERY_START_DTTM" AS "DELIVERY_START_DTTM",
    "tlm_shipment_joined_do_prepared"."DELIVERY_END_DTTM" AS "DELIVERY_END_DTTM",
    "tlm_shipment_joined_do_prepared"."NUM_STOPS" AS "NUM_STOPS",
    "tlm_shipment_joined_do_prepared"."NUM_DOCKS" AS "NUM_DOCKS",
    "tlm_shipment_joined_do_prepared"."ON_TIME_INDICATOR" AS "ON_TIME_INDICATOR",
    "tlm_shipment_joined_do_prepared"."HAS_NOTES" AS "HAS_NOTES",
    "tlm_shipment_joined_do_prepared"."HAS_ALERTS" AS "HAS_ALERTS",
    "tlm_shipment_joined_do_prepared"."HAS_IMPORT_ERROR" AS "HAS_IMPORT_ERROR",
    "tlm_shipment_joined_do_prepared"."HAS_SOFT_CHECK_ERROR" AS "HAS_SOFT_CHECK_ERROR",
    "tlm_shipment_joined_do_prepared"."HAS_TRACKING_MSG" AS "HAS_TRACKING_MSG",
    "tlm_shipment_joined_do_prepared"."TRACKING_MSG_PROBLEM" AS "TRACKING_MSG_PROBLEM",
    "tlm_shipment_joined_do_prepared"."REC_LINEHAUL_COST" AS "REC_LINEHAUL_COST",
    "tlm_shipment_joined_do_prepared"."REC_ACCESSORIAL_COST" AS "REC_ACCESSORIAL_COST",
    "tlm_shipment_joined_do_prepared"."REC_TOTAL_COST" AS "REC_TOTAL_COST",
    "tlm_shipment_joined_do_prepared"."CYCLE_RESP_DEADLINE_TZ" AS "CYCLE_RESP_DEADLINE_TZ",
    "tlm_shipment_joined_do_prepared"."TENDER_RESP_DEADLINE_TZ" AS "TENDER_RESP_DEADLINE_TZ",
    "tlm_shipment_joined_do_prepared"."PICKUP_TZ" AS "PICKUP_TZ",
    "tlm_shipment_joined_do_prepared"."DELIVERY_TZ" AS "DELIVERY_TZ",
    "tlm_shipment_joined_do_prepared"."ASSIGNED_LANE_ID" AS "ASSIGNED_LANE_ID",
    "tlm_shipment_joined_do_prepared"."ASSIGNED_LANE_DETAIL_ID" AS "ASSIGNED_LANE_DETAIL_ID",
    "tlm_shipment_joined_do_prepared"."REC_SPOT_CHARGE" AS "REC_SPOT_CHARGE",
    "tlm_shipment_joined_do_prepared"."REC_LANE_ID" AS "REC_LANE_ID",
    "tlm_shipment_joined_do_prepared"."REC_LANE_DETAIL_ID" AS "REC_LANE_DETAIL_ID",
    "tlm_shipment_joined_do_prepared"."TENDER_DTTM" AS "TENDER_DTTM",
    "tlm_shipment_joined_do_prepared"."O_STOP_LOCATION_NAME" AS "O_STOP_LOCATION_NAME",
    "tlm_shipment_joined_do_prepared"."D_STOP_LOCATION_NAME" AS "D_STOP_LOCATION_NAME",
    "tlm_shipment_joined_do_prepared"."ASSIGNED_CM_SHIPMENT_ID" AS "ASSIGNED_CM_SHIPMENT_ID",
    "tlm_shipment_joined_do_prepared"."REC_CM_DISCOUNT" AS "REC_CM_DISCOUNT",
    "tlm_shipment_joined_do_prepared"."REC_STOP_COST" AS "REC_STOP_COST",
    "tlm_shipment_joined_do_prepared"."LAST_SELECTOR_RUN_DTTM" AS "LAST_SELECTOR_RUN_DTTM",
    "tlm_shipment_joined_do_prepared"."LAST_CM_OPTION_GEN_DTTM" AS "LAST_CM_OPTION_GEN_DTTM",
    "tlm_shipment_joined_do_prepared"."IS_CM_OPTION_GEN_ACTIVE" AS "IS_CM_OPTION_GEN_ACTIVE",
    "tlm_shipment_joined_do_prepared"."RS_CYCLE_REMAINING" AS "RS_CYCLE_REMAINING",
    "tlm_shipment_joined_do_prepared"."IS_TIME_FEAS_ENABLED" AS "IS_TIME_FEAS_ENABLED",
    "tlm_shipment_joined_do_prepared"."EXT_SYS_SHIPMENT_ID" AS "EXT_SYS_SHIPMENT_ID",
    "tlm_shipment_joined_do_prepared"."EXTRACTION_DTTM" AS "EXTRACTION_DTTM",
    "tlm_shipment_joined_do_prepared"."ASSIGNED_BROKER_CARRIER_CODE" AS "ASSIGNED_BROKER_CARRIER_CODE",
    "tlm_shipment_joined_do_prepared"."USE_BROKER_AS_CARRIER" AS "USE_BROKER_AS_CARRIER",
    "tlm_shipment_joined_do_prepared"."BROKER_REF" AS "BROKER_REF",
    "tlm_shipment_joined_do_prepared"."RATING_QUALIFIER" AS "RATING_QUALIFIER",
    "tlm_shipment_joined_do_prepared"."STATUS_CHANGE_DTTM" AS "STATUS_CHANGE_DTTM",
    "tlm_shipment_joined_do_prepared"."BUDG_TOTAL_COST" AS "BUDG_TOTAL_COST",
    "tlm_shipment_joined_do_prepared"."NORMALIZED_MARGIN" AS "NORMALIZED_MARGIN",
    "tlm_shipment_joined_do_prepared"."NORMALIZED_TOTAL_COST" AS "NORMALIZED_TOTAL_COST",
    "tlm_shipment_joined_do_prepared"."BUDG_NORMALIZED_TOTAL_COST" AS "BUDG_NORMALIZED_TOTAL_COST",
    "tlm_shipment_joined_do_prepared"."REC_BUDG_LINEHAUL_COST" AS "REC_BUDG_LINEHAUL_COST",
    "tlm_shipment_joined_do_prepared"."REC_BUDG_STOP_COST" AS "REC_BUDG_STOP_COST",
    "tlm_shipment_joined_do_prepared"."REC_BUDG_CM_DISCOUNT" AS "REC_BUDG_CM_DISCOUNT",
    "tlm_shipment_joined_do_prepared"."REC_BUDG_ACCESSORIAL_COST" AS "REC_BUDG_ACCESSORIAL_COST",
    "tlm_shipment_joined_do_prepared"."REC_BUDG_TOTAL_COST" AS "REC_BUDG_TOTAL_COST",
    "tlm_shipment_joined_do_prepared"."REC_MARGIN" AS "REC_MARGIN",
    "tlm_shipment_joined_do_prepared"."REC_NORMALIZED_MARGIN" AS "REC_NORMALIZED_MARGIN",
    "tlm_shipment_joined_do_prepared"."REC_NORMALIZED_TOTAL_COST" AS "REC_NORMALIZED_TOTAL_COST",
    "tlm_shipment_joined_do_prepared"."REC_BUDG_NORMALIZED_TOTAL_COST" AS "REC_BUDG_NORMALIZED_TOTAL_COST",
    "tlm_shipment_joined_do_prepared"."BUDG_CURRENCY_CODE" AS "BUDG_CURRENCY_CODE",
    "tlm_shipment_joined_do_prepared"."SPOT_CHARGE_CURRENCY_CODE" AS "SPOT_CHARGE_CURRENCY_CODE",
    "tlm_shipment_joined_do_prepared"."REC_CURRENCY_CODE" AS "REC_CURRENCY_CODE",
    "tlm_shipment_joined_do_prepared"."REC_BUDG_CURRENCY_CODE" AS "REC_BUDG_CURRENCY_CODE",
    "tlm_shipment_joined_do_prepared"."REC_SPOT_CHARGE_CURRENCY_CODE" AS "REC_SPOT_CHARGE_CURRENCY_CODE",
    "tlm_shipment_joined_do_prepared"."RATING_LANE_ID" AS "RATING_LANE_ID",
    "tlm_shipment_joined_do_prepared"."FRT_REV_RATING_LANE_ID" AS "FRT_REV_RATING_LANE_ID",
    "tlm_shipment_joined_do_prepared"."REC_RATING_LANE_ID" AS "REC_RATING_LANE_ID",
    "tlm_shipment_joined_do_prepared"."REC_BUDG_RATING_LANE_ID" AS "REC_BUDG_RATING_LANE_ID",
    "tlm_shipment_joined_do_prepared"."RATING_LANE_DETAIL_ID" AS "RATING_LANE_DETAIL_ID",
    "tlm_shipment_joined_do_prepared"."FRT_REV_RATING_LANE_DETAIL_ID" AS "FRT_REV_RATING_LANE_DETAIL_ID",
    "tlm_shipment_joined_do_prepared"."REC_RATING_LANE_DETAIL_ID" AS "REC_RATING_LANE_DETAIL_ID",
    "tlm_shipment_joined_do_prepared"."REC_BUDG_RATING_LANE_DETAIL_ID" AS "REC_BUDG_RATING_LANE_DETAIL_ID",
    "tlm_shipment_joined_do_prepared"."BUDG_CM_DISCOUNT" AS "BUDG_CM_DISCOUNT",
    "tlm_shipment_joined_do_prepared"."NORMALIZED_BASELINE_COST" AS "NORMALIZED_BASELINE_COST",
    "tlm_shipment_joined_do_prepared"."BASELINE_COST_CURRENCY_CODE" AS "BASELINE_COST_CURRENCY_CODE",
    "tlm_shipment_joined_do_prepared"."REPORTED_COST" AS "REPORTED_COST",
    "tlm_shipment_joined_do_prepared"."TRACTOR_NUMBER" AS "TRACTOR_NUMBER",
    "tlm_shipment_joined_do_prepared"."IS_AUTO_DELIVERED" AS "IS_AUTO_DELIVERED",
    "tlm_shipment_joined_do_prepared"."SHIPMENT_TYPE" AS "SHIPMENT_TYPE",
    "tlm_shipment_joined_do_prepared"."ORIG_BUDG_TOTAL_COST" AS "ORIG_BUDG_TOTAL_COST",
    "tlm_shipment_joined_do_prepared"."ACCESSORIAL_COST_TO_CARRIER" AS "ACCESSORIAL_COST_TO_CARRIER",
    "tlm_shipment_joined_do_prepared"."CARRIER_CHARGE" AS "CARRIER_CHARGE",
    "tlm_shipment_joined_do_prepared"."ACTUAL_COST" AS "ACTUAL_COST",
    "tlm_shipment_joined_do_prepared"."EARNED_INCOME" AS "EARNED_INCOME",
    "tlm_shipment_joined_do_prepared"."SENT_TO_PKMS" AS "SENT_TO_PKMS",
    "tlm_shipment_joined_do_prepared"."IS_SHIPMENT_RECONCILED" AS "IS_SHIPMENT_RECONCILED",
    "tlm_shipment_joined_do_prepared"."DELIVERY_REQ" AS "DELIVERY_REQ",
    "tlm_shipment_joined_do_prepared"."DROPOFF_PICKUP" AS "DROPOFF_PICKUP",
    "tlm_shipment_joined_do_prepared"."PACKAGING" AS "PACKAGING",
    "tlm_shipment_joined_do_prepared"."SENT_TO_PKMS_DTTM" AS "SENT_TO_PKMS_DTTM",
    "tlm_shipment_joined_do_prepared"."WMS_STATUS_CODE" AS "WMS_STATUS_CODE",
    "tlm_shipment_joined_do_prepared"."SPOT_CHARGE_AND_PAYEE_ACC" AS "SPOT_CHARGE_AND_PAYEE_ACC",
    "tlm_shipment_joined_do_prepared"."SPOT_CHARGE_AND_PAYEE_ACC_CC" AS "SPOT_CHARGE_AND_PAYEE_ACC_CC",
    "tlm_shipment_joined_do_prepared"."NORM_SPOT_CHARGE_AND_PAYEE_ACC" AS "NORM_SPOT_CHARGE_AND_PAYEE_ACC",
    "tlm_shipment_joined_do_prepared"."FACILITY_SCHEDULE_ID" AS "FACILITY_SCHEDULE_ID",
    "tlm_shipment_joined_do_prepared"."EARNED_INCOME_CURRENCY_CODE" AS "EARNED_INCOME_CURRENCY_CODE",
    "tlm_shipment_joined_do_prepared"."ACTUAL_COST_CURRENCY_CODE" AS "ACTUAL_COST_CURRENCY_CODE",
    "tlm_shipment_joined_do_prepared"."SHIPMENT_RECON_DTTM" AS "SHIPMENT_RECON_DTTM",
    "tlm_shipment_joined_do_prepared"."PLN_RATING_LANE_ID" AS "PLN_RATING_LANE_ID",
    "tlm_shipment_joined_do_prepared"."PLN_RATING_LANE_DETAIL_ID" AS "PLN_RATING_LANE_DETAIL_ID",
    "tlm_shipment_joined_do_prepared"."PLN_TOTAL_COST" AS "PLN_TOTAL_COST",
    "tlm_shipment_joined_do_prepared"."PLN_LINEHAUL_COST" AS "PLN_LINEHAUL_COST",
    "tlm_shipment_joined_do_prepared"."PLN_TOTAL_ACCESSORIAL_COST" AS "PLN_TOTAL_ACCESSORIAL_COST",
    "tlm_shipment_joined_do_prepared"."PLN_STOP_OFF_COST" AS "PLN_STOP_OFF_COST",
    "tlm_shipment_joined_do_prepared"."PLN_NORMALIZED_TOTAL_COST" AS "PLN_NORMALIZED_TOTAL_COST",
    "tlm_shipment_joined_do_prepared"."PLN_CURRENCY_CODE" AS "PLN_CURRENCY_CODE",
    "tlm_shipment_joined_do_prepared"."PLN_ACCESSORL_COST_TO_CARRIER" AS "PLN_ACCESSORL_COST_TO_CARRIER",
    "tlm_shipment_joined_do_prepared"."PLN_CARRIER_CHARGE" AS "PLN_CARRIER_CHARGE",
    "tlm_shipment_joined_do_prepared"."WAYPOINT_TOTAL_COST" AS "WAYPOINT_TOTAL_COST",
    "tlm_shipment_joined_do_prepared"."WAYPOINT_HANDLING_COST" AS "WAYPOINT_HANDLING_COST",
    "tlm_shipment_joined_do_prepared"."GRS_OPERATION" AS "GRS_OPERATION",
    "tlm_shipment_joined_do_prepared"."IS_GRS_OPT_CYCLE_RUNNING" AS "IS_GRS_OPT_CYCLE_RUNNING",
    "tlm_shipment_joined_do_prepared"."IS_MANUAL_ASSIGN" AS "IS_MANUAL_ASSIGN",
    "tlm_shipment_joined_do_prepared"."LAST_RUN_GRS_DTTM" AS "LAST_RUN_GRS_DTTM",
    "tlm_shipment_joined_do_prepared"."GRS_MAX_SHIPMENT_STATUS" AS "GRS_MAX_SHIPMENT_STATUS",
    "tlm_shipment_joined_do_prepared"."PRIORITY_TYPE" AS "PRIORITY_TYPE",
    "tlm_shipment_joined_do_prepared"."MV_CURRENCY_CODE" AS "MV_CURRENCY_CODE",
    "tlm_shipment_joined_do_prepared"."PROD_SCHED_REF_NUMBER" AS "PROD_SCHED_REF_NUMBER",
    "tlm_shipment_joined_do_prepared"."COMMODITY_CODE_ID" AS "COMMODITY_CODE_ID",
    "tlm_shipment_joined_do_prepared"."UN_NUMBER_ID" AS "UN_NUMBER_ID",
    "tlm_shipment_joined_do_prepared"."CONTRACT_NUMBER" AS "CONTRACT_NUMBER",
    "tlm_shipment_joined_do_prepared"."BOOKING_REF_SHIPPER" AS "BOOKING_REF_SHIPPER",
    "tlm_shipment_joined_do_prepared"."BOOKING_REF_CARRIER" AS "BOOKING_REF_CARRIER",
    "tlm_shipment_joined_do_prepared"."BK_RESOURCE_REF_EXTERNAL" AS "BK_RESOURCE_REF_EXTERNAL",
    "tlm_shipment_joined_do_prepared"."BK_RESOURCE_NAME_EXTERNAL" AS "BK_RESOURCE_NAME_EXTERNAL",
    "tlm_shipment_joined_do_prepared"."BK_O_FACILITY_ID" AS "BK_O_FACILITY_ID",
    "tlm_shipment_joined_do_prepared"."BK_D_FACILITY_ID" AS "BK_D_FACILITY_ID",
    "tlm_shipment_joined_do_prepared"."BK_MASTER_AIRWAY_BILL" AS "BK_MASTER_AIRWAY_BILL",
    "tlm_shipment_joined_do_prepared"."BK_FORWARDER_AIRWAY_BILL" AS "BK_FORWARDER_AIRWAY_BILL",
    "tlm_shipment_joined_do_prepared"."ASSIGNED_SCNDR_CARRIER_CODE" AS "ASSIGNED_SCNDR_CARRIER_CODE",
    "tlm_shipment_joined_do_prepared"."CUSTOMER_CREDIT_LIMIT_ID" AS "CUSTOMER_CREDIT_LIMIT_ID",
    "tlm_shipment_joined_do_prepared"."SHIPMENT_LEG_TYPE" AS "SHIPMENT_LEG_TYPE",
    "tlm_shipment_joined_do_prepared"."SHIPMENT_CLOSED_INDICATOR" AS "SHIPMENT_CLOSED_INDICATOR",
    "tlm_shipment_joined_do_prepared"."OCEAN_ROUTING_STAGE" AS "OCEAN_ROUTING_STAGE",
    "tlm_shipment_joined_do_prepared"."BK_DEPARTURE_DTTM" AS "BK_DEPARTURE_DTTM",
    "tlm_shipment_joined_do_prepared"."BK_DEPARTURE_TZ" AS "BK_DEPARTURE_TZ",
    "tlm_shipment_joined_do_prepared"."BK_ARRIVAL_DTTM" AS "BK_ARRIVAL_DTTM",
    "tlm_shipment_joined_do_prepared"."BK_ARRIVAL_TZ" AS "BK_ARRIVAL_TZ",
    "tlm_shipment_joined_do_prepared"."BK_PICKUP_DTTM" AS "BK_PICKUP_DTTM",
    "tlm_shipment_joined_do_prepared"."BK_PICKUP_TZ" AS "BK_PICKUP_TZ",
    "tlm_shipment_joined_do_prepared"."BK_CUTOFF_DTTM" AS "BK_CUTOFF_DTTM",
    "tlm_shipment_joined_do_prepared"."BK_CUTOFF_TZ" AS "BK_CUTOFF_TZ",
    "tlm_shipment_joined_do_prepared"."NUM_CHARGE_LAYOVERS" AS "NUM_CHARGE_LAYOVERS",
    "tlm_shipment_joined_do_prepared"."RATE_TYPE" AS "RATE_TYPE",
    "tlm_shipment_joined_do_prepared"."RATE_UOM" AS "RATE_UOM",
    "tlm_shipment_joined_do_prepared"."PICK_START_DTTM" AS "PICK_START_DTTM",
    "tlm_shipment_joined_do_prepared"."PAPERWORK_START_DTTM" AS "PAPERWORK_START_DTTM",
    "tlm_shipment_joined_do_prepared"."VEHICLE_CHECK_START_DTTM" AS "VEHICLE_CHECK_START_DTTM",
    "tlm_shipment_joined_do_prepared"."SHIPMENT_START_DTTM" AS "SHIPMENT_START_DTTM",
    "tlm_shipment_joined_do_prepared"."SHIPMENT_END_DTTM" AS "SHIPMENT_END_DTTM",
    "tlm_shipment_joined_do_prepared"."FEASIBLE_DRIVER_TYPE" AS "FEASIBLE_DRIVER_TYPE",
    "tlm_shipment_joined_do_prepared"."WAVE_ID" AS "WAVE_ID",
    "tlm_shipment_joined_do_prepared"."ESTIMATED_DISPATCH_DTTM" AS "ESTIMATED_DISPATCH_DTTM",
    "tlm_shipment_joined_do_prepared"."TOTAL_TIME" AS "TOTAL_TIME",
    "tlm_shipment_joined_do_prepared"."LOC_REFERENCE" AS "LOC_REFERENCE",
    "tlm_shipment_joined_do_prepared"."BK_O_FACILITY_ALIAS_ID" AS "BK_O_FACILITY_ALIAS_ID",
    "tlm_shipment_joined_do_prepared"."BK_D_FACILITY_ALIAS_ID" AS "BK_D_FACILITY_ALIAS_ID",
    "tlm_shipment_joined_do_prepared"."EQUIP_UTIL_PER" AS "EQUIP_UTIL_PER",
    "tlm_shipment_joined_do_prepared"."MOVE_TYPE" AS "MOVE_TYPE",
    "tlm_shipment_joined_do_prepared"."DRIVER_TYPE_ID" AS "DRIVER_TYPE_ID",
    "tlm_shipment_joined_do_prepared"."EQUIPMENT_TYPE" AS "EQUIPMENT_TYPE",
    "tlm_shipment_joined_do_prepared"."RADIAL_DISTANCE" AS "RADIAL_DISTANCE",
    "tlm_shipment_joined_do_prepared"."RADIAL_DISTANCE_UOM" AS "RADIAL_DISTANCE_UOM",
    "tlm_shipment_joined_do_prepared"."DESIGNATED_TRACTOR_CODE" AS "DESIGNATED_TRACTOR_CODE",
    "tlm_shipment_joined_do_prepared"."DESIGNATED_DRIVER_TYPE" AS "DESIGNATED_DRIVER_TYPE",
    "tlm_shipment_joined_do_prepared"."IS_WAVE_MAN_CHANGED" AS "IS_WAVE_MAN_CHANGED",
    "tlm_shipment_joined_do_prepared"."RETAIN_CONSOLIDATOR_TIMES" AS "RETAIN_CONSOLIDATOR_TIMES",
    "tlm_shipment_joined_do_prepared"."TARIFF" AS "TARIFF",
    "tlm_shipment_joined_do_prepared"."MIN_RATE" AS "MIN_RATE",
    "tlm_shipment_joined_do_prepared"."FIRST_UPDATE_SENT_TO_PKMS" AS "FIRST_UPDATE_SENT_TO_PKMS",
    "tlm_shipment_joined_do_prepared"."EVENT_IND_TYPEID" AS "EVENT_IND_TYPEID",
    "tlm_shipment_joined_do_prepared"."TANDEM_PATH_ID" AS "TANDEM_PATH_ID",
    "tlm_shipment_joined_do_prepared"."O_TANDEM_FACILITY" AS "O_TANDEM_FACILITY",
    "tlm_shipment_joined_do_prepared"."D_TANDEM_FACILITY" AS "D_TANDEM_FACILITY",
    "tlm_shipment_joined_do_prepared"."O_TANDEM_FACILITY_ALIAS" AS "O_TANDEM_FACILITY_ALIAS",
    "tlm_shipment_joined_do_prepared"."D_TANDEM_FACILITY_ALIAS" AS "D_TANDEM_FACILITY_ALIAS",
    "tlm_shipment_joined_do_prepared"."DELAY_TYPE" AS "DELAY_TYPE",
    "tlm_shipment_joined_do_prepared"."ASSIGNED_CARRIER_ID" AS "ASSIGNED_CARRIER_ID",
    "tlm_shipment_joined_do_prepared"."DSG_CARRIER_ID" AS "DSG_CARRIER_ID",
    "tlm_shipment_joined_do_prepared"."REC_CARRIER_ID" AS "REC_CARRIER_ID",
    "tlm_shipment_joined_do_prepared"."FEASIBLE_CARRIER_ID" AS "FEASIBLE_CARRIER_ID",
    "tlm_shipment_joined_do_prepared"."PAYEE_CARRIER_ID" AS "PAYEE_CARRIER_ID",
    "tlm_shipment_joined_do_prepared"."SCNDR_CARRIER_ID" AS "SCNDR_CARRIER_ID",
    "tlm_shipment_joined_do_prepared"."BROKER_CARRIER_ID" AS "BROKER_CARRIER_ID",
    "tlm_shipment_joined_do_prepared"."ASSIGNED_SCNDR_CARRIER_ID" AS "ASSIGNED_SCNDR_CARRIER_ID",
    "tlm_shipment_joined_do_prepared"."DSG_SCNDR_CARRIER_ID" AS "DSG_SCNDR_CARRIER_ID",
    "tlm_shipment_joined_do_prepared"."ASSIGNED_BROKER_CARRIER_ID" AS "ASSIGNED_BROKER_CARRIER_ID",
    "tlm_shipment_joined_do_prepared"."LH_PAYEE_CARRIER_ID" AS "LH_PAYEE_CARRIER_ID",
    "tlm_shipment_joined_do_prepared"."REC_BROKER_CARRIER_ID" AS "REC_BROKER_CARRIER_ID",
    "tlm_shipment_joined_do_prepared"."ASSIGNED_EQUIPMENT_ID" AS "ASSIGNED_EQUIPMENT_ID",
    "tlm_shipment_joined_do_prepared"."DSG_EQUIPMENT_ID" AS "DSG_EQUIPMENT_ID",
    "tlm_shipment_joined_do_prepared"."FEASIBLE_EQUIPMENT_ID" AS "FEASIBLE_EQUIPMENT_ID",
    "tlm_shipment_joined_do_prepared"."FEASIBLE_EQUIPMENT2_ID" AS "FEASIBLE_EQUIPMENT2_ID",
    "tlm_shipment_joined_do_prepared"."REC_EQUIPMENT_ID" AS "REC_EQUIPMENT_ID",
    "tlm_shipment_joined_do_prepared"."ASSIGNED_MOT_ID" AS "ASSIGNED_MOT_ID",
    "tlm_shipment_joined_do_prepared"."DSG_MOT_ID" AS "DSG_MOT_ID",
    "tlm_shipment_joined_do_prepared"."FEASIBLE_MOT_ID" AS "FEASIBLE_MOT_ID",
    "tlm_shipment_joined_do_prepared"."REC_MOT_ID" AS "REC_MOT_ID",
    "tlm_shipment_joined_do_prepared"."PRODUCT_CLASS_ID" AS "PRODUCT_CLASS_ID",
    "tlm_shipment_joined_do_prepared"."PROTECTION_LEVEL_ID" AS "PROTECTION_LEVEL_ID",
    "tlm_shipment_joined_do_prepared"."ASSIGNED_SERVICE_LEVEL_ID" AS "ASSIGNED_SERVICE_LEVEL_ID",
    "tlm_shipment_joined_do_prepared"."DSG_SERVICE_LEVEL_ID" AS "DSG_SERVICE_LEVEL_ID",
    "tlm_shipment_joined_do_prepared"."FEASIBLE_SERVICE_LEVEL_ID" AS "FEASIBLE_SERVICE_LEVEL_ID",
    "tlm_shipment_joined_do_prepared"."REC_SERVICE_LEVEL_ID" AS "REC_SERVICE_LEVEL_ID",
    "tlm_shipment_joined_do_prepared"."HAS_EM_NOTIFY_FLAG" AS "HAS_EM_NOTIFY_FLAG",
    "tlm_shipment_joined_do_prepared"."REGION_ID" AS "REGION_ID",
    "tlm_shipment_joined_do_prepared"."INBOUND_REGION_ID" AS "INBOUND_REGION_ID",
    "tlm_shipment_joined_do_prepared"."OUTBOUND_REGION_ID" AS "OUTBOUND_REGION_ID",
    "tlm_shipment_joined_do_prepared"."FINANCIAL_WT" AS "FINANCIAL_WT",
    "tlm_shipment_joined_do_prepared"."IS_BOOKING_REQUIRED" AS "IS_BOOKING_REQUIRED",
    "tlm_shipment_joined_do_prepared"."TOTAL_COST_EXCL_TAX" AS "TOTAL_COST_EXCL_TAX",
    "tlm_shipment_joined_do_prepared"."TOTAL_TAX_AMOUNT" AS "TOTAL_TAX_AMOUNT",
    "tlm_shipment_joined_do_prepared"."IS_ASSOCIATED_TO_OUTBOUND" AS "IS_ASSOCIATED_TO_OUTBOUND",
    "tlm_shipment_joined_do_prepared"."RECEIVED_DTTM" AS "RECEIVED_DTTM",
    "tlm_shipment_joined_do_prepared"."BOOKING_ID" AS "BOOKING_ID",
    "tlm_shipment_joined_do_prepared"."IS_MISROUTED" AS "IS_MISROUTED",
    "tlm_shipment_joined_do_prepared"."FEASIBLE_CARRIER_CODE" AS "FEASIBLE_CARRIER_CODE",
    "tlm_shipment_joined_do_prepared"."SHIPMENT_WIN_ADJ_FLAG" AS "SHIPMENT_WIN_ADJ_FLAG",
    "tlm_shipment_joined_do_prepared"."DT_PARAM_SET_ID" AS "DT_PARAM_SET_ID",
    "tlm_shipment_joined_do_prepared"."MERCHANDIZING_DEPARTMENT_ID" AS "MERCHANDIZING_DEPARTMENT_ID",
    "tlm_shipment_joined_do_prepared"."STATIC_ROUTE_ID" AS "STATIC_ROUTE_ID",
    "tlm_shipment_joined_do_prepared"."IS_FILO" AS "IS_FILO",
    "tlm_shipment_joined_do_prepared"."IS_COOLER_AT_NOSE" AS "IS_COOLER_AT_NOSE",
    "tlm_shipment_joined_do_prepared"."AUTH_NBR" AS "AUTH_NBR",
    "tlm_shipment_joined_do_prepared"."CONS_LOCN_ID" AS "CONS_LOCN_ID",
    "tlm_shipment_joined_do_prepared"."RTE_TYPE" AS "RTE_TYPE",
    "tlm_shipment_joined_do_prepared"."TRLR_TYPE" AS "TRLR_TYPE",
    "tlm_shipment_joined_do_prepared"."TRLR_SIZE" AS "TRLR_SIZE",
    "tlm_shipment_joined_do_prepared"."CONS_ADDR_CODE" AS "CONS_ADDR_CODE",
    "tlm_shipment_joined_do_prepared"."HUB_ID" AS "HUB_ID",
    "tlm_shipment_joined_do_prepared"."TRLR_GEN_CODE" AS "TRLR_GEN_CODE",
    "tlm_shipment_joined_do_prepared"."MAX_NBR_OF_CTNS" AS "MAX_NBR_OF_CTNS",
    "tlm_shipment_joined_do_prepared"."APPT_DOOR_SCHED_TYPE" AS "APPT_DOOR_SCHED_TYPE",
    "tlm_shipment_joined_do_prepared"."CREATED_SOURCE_TYPE" AS "CREATED_SOURCE_TYPE",
    "tlm_shipment_joined_do_prepared"."CREATED_SOURCE" AS "CREATED_SOURCE",
    "tlm_shipment_joined_do_prepared"."CREATED_DTTM" AS "CREATED_DTTM",
    "tlm_shipment_joined_do_prepared"."LAST_UPDATED_SOURCE_TYPE" AS "LAST_UPDATED_SOURCE_TYPE",
    "tlm_shipment_joined_do_prepared"."LAST_UPDATED_SOURCE" AS "LAST_UPDATED_SOURCE",
    "tlm_shipment_joined_do_prepared"."LAST_UPDATED_DTTM" AS "LAST_UPDATED_DTTM",
    "tlm_shipment_joined_do_prepared"."DSG_SCNDR_CARRIER_CODE" AS "DSG_SCNDR_CARRIER_CODE",
    "tlm_shipment_joined_do_prepared"."LH_PAYEE_CARRIER_CODE" AS "LH_PAYEE_CARRIER_CODE",
    "tlm_shipment_joined_do_prepared"."REC_BROKER_CARRIER_CODE" AS "REC_BROKER_CARRIER_CODE",
    "tlm_shipment_joined_do_prepared"."REC_CARRIER_CODE" AS "REC_CARRIER_CODE",
    "tlm_shipment_joined_do_prepared"."LPN_ASSIGNMENT_STOPPED" AS "LPN_ASSIGNMENT_STOPPED",
    "tlm_shipment_joined_do_prepared"."SEAL_NUMBER" AS "SEAL_NUMBER",
    "tlm_shipment_joined_do_prepared"."HIBERNATE_VERSION" AS "HIBERNATE_VERSION",
    "tlm_shipment_joined_do_prepared"."SHIP_GROUP_ID" AS "SHIP_GROUP_ID",
    "tlm_shipment_joined_do_prepared"."RATE" AS "RATE",
    "tlm_shipment_joined_do_prepared"."MONETARY_VALUE" AS "MONETARY_VALUE",
    "tlm_shipment_joined_do_prepared"."DOOR" AS "DOOR",
    "tlm_shipment_joined_do_prepared"."RTE_TYPE_1" AS "RTE_TYPE_1",
    "tlm_shipment_joined_do_prepared"."RTE_TYPE_2" AS "RTE_TYPE_2",
    "tlm_shipment_joined_do_prepared"."SCHEDULED_PICKUP_DTTM" AS "SCHEDULED_PICKUP_DTTM",
    "tlm_shipment_joined_do_prepared"."MANIFEST_ID" AS "MANIFEST_ID",
    "tlm_shipment_joined_do_prepared"."DAYS_TO_DELIVER" AS "DAYS_TO_DELIVER",
    "tlm_shipment_joined_do_prepared"."SED_GENERATED_FLAG" AS "SED_GENERATED_FLAG",
    "tlm_shipment_joined_do_prepared"."SERV_AREA_CODE" AS "SERV_AREA_CODE",
    "tlm_shipment_joined_do_prepared"."TENDER_RESP_DEADLINE_DTTM" AS "TENDER_RESP_DEADLINE_DTTM",
    "tlm_shipment_joined_do_prepared"."PRINT_CONS_BOL" AS "PRINT_CONS_BOL",
    "tlm_shipment_joined_do_prepared"."LEFT_WT" AS "LEFT_WT",
    "tlm_shipment_joined_do_prepared"."RIGHT_WT" AS "RIGHT_WT",
    "tlm_shipment_joined_do_prepared"."LANE_NAME" AS "LANE_NAME",
    "tlm_shipment_joined_do_prepared"."DECLARED_VALUE" AS "DECLARED_VALUE",
    "tlm_shipment_joined_do_prepared"."DV_CURRENCY_CODE" AS "DV_CURRENCY_CODE",
    "tlm_shipment_joined_do_prepared"."COD_AMOUNT" AS "COD_AMOUNT",
    "tlm_shipment_joined_do_prepared"."CUSTOMER_ID" AS "CUSTOMER_ID",
    "tlm_shipment_joined_do_prepared"."CUST_FRGT_CHARGE" AS "CUST_FRGT_CHARGE",
    "tlm_shipment_joined_do_prepared"."COD_CURRENCY_CODE" AS "COD_CURRENCY_CODE",
    "tlm_shipment_joined_do_prepared"."PLANNED_WEIGHT" AS "PLANNED_WEIGHT",
    "tlm_shipment_joined_do_prepared"."WEIGHT_UOM_ID_BASE" AS "WEIGHT_UOM_ID_BASE",
    "tlm_shipment_joined_do_prepared"."PLANNED_VOLUME" AS "PLANNED_VOLUME",
    "tlm_shipment_joined_do_prepared"."VOLUME_UOM_ID_BASE" AS "VOLUME_UOM_ID_BASE",
    "tlm_shipment_joined_do_prepared"."SIZE1_VALUE" AS "SIZE1_VALUE",
    "tlm_shipment_joined_do_prepared"."SIZE1_UOM_ID" AS "SIZE1_UOM_ID",
    "tlm_shipment_joined_do_prepared"."SIZE2_VALUE" AS "SIZE2_VALUE",
    "tlm_shipment_joined_do_prepared"."SIZE2_UOM_ID" AS "SIZE2_UOM_ID",
    "tlm_shipment_joined_do_prepared"."ASSIGNED_SHIP_VIA" AS "ASSIGNED_SHIP_VIA",
    "tlm_shipment_joined_do_prepared"."INSURANCE_STATUS" AS "INSURANCE_STATUS",
    "tlm_shipment_joined_do_prepared"."RTE_SWC_NBR" AS "RTE_SWC_NBR",
    "tlm_shipment_joined_do_prepared"."RTE_TO" AS "RTE_TO",
    "tlm_shipment_joined_do_prepared"."BILL_OF_LADING_NUMBER" AS "BILL_OF_LADING_NUMBER",
    "tlm_shipment_joined_do_prepared"."TRAILER_NUMBER" AS "TRAILER_NUMBER",
    "tlm_shipment_joined_do_prepared"."TRANS_PLAN_OWNER" AS "TRANS_PLAN_OWNER",
    "tlm_shipment_joined_do_prepared"."TOTAL_REVENUE_CURRENCY_CODE" AS "TOTAL_REVENUE_CURRENCY_CODE",
    "tlm_shipment_joined_do_prepared"."TOTAL_REVENUE" AS "TOTAL_REVENUE",
    "tlm_shipment_joined_do_prepared"."FRT_REV_SPOT_CHARGE_CURR_CODE" AS "FRT_REV_SPOT_CHARGE_CURR_CODE",
    "tlm_shipment_joined_do_prepared"."NORMALIZED_TOTAL_REVENUE" AS "NORMALIZED_TOTAL_REVENUE",
    "tlm_shipment_joined_do_prepared"."FRT_REV_SPOT_CHARGE" AS "FRT_REV_SPOT_CHARGE",
    "tlm_shipment_joined_do_prepared"."DSG_VOYAGE_FLIGHT" AS "DSG_VOYAGE_FLIGHT",
    "tlm_shipment_joined_do_prepared"."FEASIBLE_VOYAGE_FLIGHT" AS "FEASIBLE_VOYAGE_FLIGHT",
    "tlm_shipment_joined_do_prepared"."CURRENCY_DTTM" AS "CURRENCY_DTTM",
    "tlm_shipment_joined_do_prepared"."FRT_REV_LINEHAUL_CHARGE" AS "FRT_REV_LINEHAUL_CHARGE",
    "tlm_shipment_joined_do_prepared"."FRT_REV_STOP_CHARGE" AS "FRT_REV_STOP_CHARGE",
    "tlm_shipment_joined_do_prepared"."FRT_REV_ACCESSORIAL_CHARGE" AS "FRT_REV_ACCESSORIAL_CHARGE",
    "tlm_shipment_joined_do_prepared"."MARGIN" AS "MARGIN",
    "tlm_shipment_joined_do_prepared"."INCOTERM_ID" AS "INCOTERM_ID",
    "tlm_shipment_joined_do_prepared"."ORDER_QTY" AS "ORDER_QTY",
    "tlm_shipment_joined_do_prepared"."QTY_UOM_ID" AS "QTY_UOM_ID",
    "tlm_shipment_joined_do_prepared"."REF_SHIPMENT_NBR" AS "REF_SHIPMENT_NBR",
    "tlm_shipment_joined_do_prepared"."STAGING_LOCN_ID" AS "STAGING_LOCN_ID",
    "tlm_shipment_joined_do_prepared"."LOADING_SEQ_ORD" AS "LOADING_SEQ_ORD",
    "tlm_shipment_joined_do_prepared"."HAZMAT_CERT_CONTACT" AS "HAZMAT_CERT_CONTACT",
    "tlm_shipment_joined_do_prepared"."HAZMAT_CERT_DECLARATION" AS "HAZMAT_CERT_DECLARATION",
    "tlm_shipment_joined_do_prepared"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP",
    "tlm_shipment_joined_do_prepared"."OPERATION_TYPE" AS "OPERATION_TYPE",
    "tlm_shipment_joined_do_prepared"."ARCHIVED_DTTM" AS "ARCHIVED_DTTM",
    "tlm_shipment_joined_do_prepared"."ORIGIN" AS "ORIGIN",
    "tlm_shipment_joined_do_prepared"."FINAL_DESTINATION" AS "FINAL_DESTINATION",
    "tlm_shipment_joined_do_prepared"."actual_delivery_date_parsed" AS "actual_delivery_date_parsed",
    "tlm_shipment_joined_do_prepared"."wood_pellet" AS "wood_pellet",
    "tlm_shipment_joined_do_prepared"."act_del_MERCH_YEAR" AS "act_del_MERCH_YEAR",
    "tlm_shipment_joined_do_prepared"."act_del_YEAR_WEEK" AS "act_del_YEAR_WEEK",
    "tlm_shipment_joined_do_prepared"."act_del_YEAR_QUARTER" AS "act_del_YEAR_QUARTER",
    "tlm_shipment_joined_do_prepared"."act_del_YEAR_PERIOD" AS "act_del_YEAR_PERIOD",
    "tlm_shipment_joined_do_prepared"."invoice_shipping_id" AS "invoice_shipping_id",
    "tlm_shipment_joined_do_prepared"."TOTAL_COST" AS "TOTAL_COST",
    "tlm_shipment_joined_do_prepared"."org_Facility_Code" AS "org_Facility_Code",
    "tlm_shipment_joined_do_prepared"."org_Facility_Name" AS "org_Facility_Name",
    "tlm_shipment_joined_do_prepared"."org_Facility_Type" AS "org_Facility_Type",
    "tlm_shipment_joined_do_prepared"."dest_Facility_Code" AS "dest_Facility_Code",
    "tlm_shipment_joined_do_prepared"."dest_Facility_Name" AS "dest_Facility_Name",
    "tlm_shipment_joined_do_prepared"."dest_Facility_Type" AS "dest_Facility_Type",
    "tlm_shipment_joined_do_prepared"."inbound_flag" AS "inbound_flag",
    "tlm_shipment_joined_do_prepared"."do_ORDER_ID" AS "do_ORDER_ID",
     "sc_tlm_order_line_item"."do_ORDER_ID_2",
     "sc_tlm_order_line_item"."do_LINE_ITEM_ID",
     "sc_tlm_order_line_item"."do_PARENT_LINE_ITEM_ID",
     "sc_tlm_order_line_item"."do_TC_COMPANY_ID",
     "sc_tlm_order_line_item"."do_COMMODITY_CLASS",
     "sc_tlm_order_line_item"."do_REF_FIELD1",
     "sc_tlm_order_line_item"."do_REF_FIELD2",
     "sc_tlm_order_line_item"."do_REF_FIELD3",
     "sc_tlm_order_line_item"."do_EXT_SYS_LINE_ITEM_ID",
     "sc_tlm_order_line_item"."do_MASTER_ORDER_ID",
     "sc_tlm_order_line_item"."do_MO_LINE_ITEM_ID",
     "sc_tlm_order_line_item"."do_IS_HAZMAT",
     "sc_tlm_order_line_item"."do_IS_STACKABLE",
     "sc_tlm_order_line_item"."do_HAS_ERRORS",
     "sc_tlm_order_line_item"."do_ORIG_BUDG_COST",
     "sc_tlm_order_line_item"."do_BUDG_COST_CURRENCY_CODE",
     "sc_tlm_order_line_item"."do_BUDG_COST",
     "sc_tlm_order_line_item"."do_ACTUAL_COST_CURRENCY_CODE",
     "sc_tlm_order_line_item"."do_TOTAL_MONETARY_VALUE",
     "sc_tlm_order_line_item"."do_UNIT_MONETARY_VALUE",
     "sc_tlm_order_line_item"."do_UNIT_TAX_AMOUNT",
     "sc_tlm_order_line_item"."do_RTS_ID",
     "sc_tlm_order_line_item"."do_RTS_LINE_ITEM_ID",
     "sc_tlm_order_line_item"."do_STD_PACK_QTY",
     "sc_tlm_order_line_item"."do_PRODUCT_CLASS_ID",
     "sc_tlm_order_line_item"."do_PROTECTION_LEVEL_ID",
     "sc_tlm_order_line_item"."do_PACKAGE_TYPE_ID",
     "sc_tlm_order_line_item"."do_COMMODITY_CODE_ID",
     "sc_tlm_order_line_item"."do_MV_SIZE_UOM_ID",
     "sc_tlm_order_line_item"."do_QTY_UOM_ID_BASE",
     "sc_tlm_order_line_item"."do_MV_CURRENCY_CODE",
     "sc_tlm_order_line_item"."do_SHIPPED_QTY",
     "sc_tlm_order_line_item"."do_RECEIVED_QTY",
     "sc_tlm_order_line_item"."do_PRIORITY",
     "sc_tlm_order_line_item"."do_MERCHANDIZING_DEPARTMENT_ID",
     "sc_tlm_order_line_item"."do_UN_NUMBER_ID",
     "sc_tlm_order_line_item"."do_PICKUP_REFERENCE_NUMBER",
     "sc_tlm_order_line_item"."do_DELIVERY_REFERENCE_NUMBER",
     "sc_tlm_order_line_item"."do_CNTRY_OF_ORGN",
     "sc_tlm_order_line_item"."do_PROD_STAT",
     "sc_tlm_order_line_item"."do_STACK_RANK",
     "sc_tlm_order_line_item"."do_STACK_LENGTH_VALUE",
     "sc_tlm_order_line_item"."do_STACK_LENGTH_STANDARD_UOM",
     "sc_tlm_order_line_item"."do_STACK_WIDTH_VALUE",
     "sc_tlm_order_line_item"."do_STACK_WIDTH_STANDARD_UOM",
     "sc_tlm_order_line_item"."do_STACK_HEIGHT_VALUE",
     "sc_tlm_order_line_item"."do_STACK_HEIGHT_STANDARD_UOM",
     "sc_tlm_order_line_item"."do_STACK_DIAMETER_VALUE",
     "sc_tlm_order_line_item"."do_STACK_DIAMETER_STANDARD_UOM",
     "sc_tlm_order_line_item"."do_HIBERNATE_VERSION",
     "sc_tlm_order_line_item"."do_CUBE_MULTIPLE_QTY",
     "sc_tlm_order_line_item"."do_DO_DTL_STATUS",
     "sc_tlm_order_line_item"."do_INTERNAL_ORDER_SEQ_NBR",
     "sc_tlm_order_line_item"."do_IS_EMERGENCY",
     "sc_tlm_order_line_item"."do_LPN_SIZE",
     "sc_tlm_order_line_item"."do_MANUFACTURING_DTTM",
     "sc_tlm_order_line_item"."do_ORDER_LINE_ID",
     "sc_tlm_order_line_item"."do_PACK_RATE",
     "sc_tlm_order_line_item"."do_ALLOCATED_QTY",
     "sc_tlm_order_line_item"."do_PLANNED_SHIP_DATE",
     "sc_tlm_order_line_item"."do_PPACK_QTY",
     "sc_tlm_order_line_item"."do_STD_BUNDLE_QTY",
     "sc_tlm_order_line_item"."do_STD_LPN_QTY",
     "sc_tlm_order_line_item"."do_STD_LPN_VOL",
     "sc_tlm_order_line_item"."do_STD_LPN_WT",
     "sc_tlm_order_line_item"."do_UNIT_COST",
     "sc_tlm_order_line_item"."do_UNIT_PRICE_AMOUNT",
     "sc_tlm_order_line_item"."do_UNIT_VOL",
     "sc_tlm_order_line_item"."do_UNIT_WT",
     "sc_tlm_order_line_item"."do_USER_CANCELED_QTY",
     "sc_tlm_order_line_item"."do_WAVE_PROC_TYPE",
     "sc_tlm_order_line_item"."do_EVENT_CODE",
     "sc_tlm_order_line_item"."do_REASON_CODE",
     "sc_tlm_order_line_item"."do_EXP_INFO_CODE",
     "sc_tlm_order_line_item"."do_PARTL_FILL",
     "sc_tlm_order_line_item"."do_LINE_TYPE",
     "sc_tlm_order_line_item"."do_REPL_PROC_TYPE",
     "sc_tlm_order_line_item"."do_ORDER_QTY",
     "sc_tlm_order_line_item"."do_ORIG_ORDER_QTY",
     "sc_tlm_order_line_item"."do_RTL_TO_BE_DISTROED_QTY",
     "sc_tlm_order_line_item"."do_PRICE",
     "sc_tlm_order_line_item"."do_RETAIL_PRICE",
     "sc_tlm_order_line_item"."do_UNITS_PAKD",
     "sc_tlm_order_line_item"."do_MINOR_ORDER_NBR",
     "sc_tlm_order_line_item"."do_ITEM_ID",
     "sc_tlm_order_line_item"."do_TC_ORDER_LINE_ID",
     "sc_tlm_order_line_item"."do_ACTUAL_SHIPPED_DTTM",
     "sc_tlm_order_line_item"."do_QTY_UOM_ID",
     "sc_tlm_order_line_item"."do_PICKUP_END_DTTM",
     "sc_tlm_order_line_item"."do_PURCHASE_ORDER_LINE_NUMBER",
     "sc_tlm_order_line_item"."do_PICKUP_START_DTTM",
     "sc_tlm_order_line_item"."do_REFERENCE_LINE_ITEM_ID",
     "sc_tlm_order_line_item"."do_REFERENCE_ORDER_ID",
     "sc_tlm_order_line_item"."do_REPL_WAVE_RUN",
     "sc_tlm_order_line_item"."do_STD_PALLET_QTY",
     "sc_tlm_order_line_item"."do_STD_SUB_PACK_QTY",
     "sc_tlm_order_line_item"."do_STORE_DEPT",
     "sc_tlm_order_line_item"."do_ALLOC_TYPE",
     "sc_tlm_order_line_item"."do_BATCH_NBR",
     "sc_tlm_order_line_item"."do_BATCH_REQUIREMENT_TYPE",
     "sc_tlm_order_line_item"."do_CHUTE_ASSIGN_TYPE",
     "sc_tlm_order_line_item"."do_CUSTOM_TAG",
     "sc_tlm_order_line_item"."do_CUSTOMER_ITEM",
     "sc_tlm_order_line_item"."do_INTERNAL_ORDER_ID",
     "sc_tlm_order_line_item"."do_INVN_TYPE",
     "sc_tlm_order_line_item"."do_ITEM_ATTR_1",
     "sc_tlm_order_line_item"."do_ITEM_ATTR_2",
     "sc_tlm_order_line_item"."do_ITEM_ATTR_3",
     "sc_tlm_order_line_item"."do_ITEM_ATTR_4",
     "sc_tlm_order_line_item"."do_ITEM_ATTR_5",
     "sc_tlm_order_line_item"."do_LPN_BRK_ATTRIB",
     "sc_tlm_order_line_item"."do_MERCH_GRP",
     "sc_tlm_order_line_item"."do_MERCH_TYPE",
     "sc_tlm_order_line_item"."do_PACK_ZONE",
     "sc_tlm_order_line_item"."do_PALLET_TYPE",
     "sc_tlm_order_line_item"."do_PICK_LOCN_ASSIGN_TYPE",
     "sc_tlm_order_line_item"."do_PICK_LOCN_ID",
     "sc_tlm_order_line_item"."do_PPACK_GRP_CODE",
     "sc_tlm_order_line_item"."do_PRICE_TKT_TYPE",
     "sc_tlm_order_line_item"."do_SERIAL_NUMBER_REQUIRED_FLAG",
     "sc_tlm_order_line_item"."do_SKU_GTIN",
     "sc_tlm_order_line_item"."do_SKU_SUB_CODE_ID",
     "sc_tlm_order_line_item"."do_SKU_SUB_CODE_VALUE",
     "sc_tlm_order_line_item"."do_VAS_PROCESS_TYPE",
     "sc_tlm_order_line_item"."do_SUBSTITUTED_PARENT_LINE_ID",
     "sc_tlm_order_line_item"."do_IS_CANCELLED",
     "sc_tlm_order_line_item"."do_ITEM_NAME",
     "sc_tlm_order_line_item"."do_ALLOC_LINE_ID",
     "sc_tlm_order_line_item"."do_ALLOCATION_SOURCE_ID",
     "sc_tlm_order_line_item"."do_ALLOCATION_SOURCE_LINE_ID",
     "sc_tlm_order_line_item"."do_ALLOCATION_SOURCE",
     "sc_tlm_order_line_item"."do_SHELF_DAYS",
     "sc_tlm_order_line_item"."do_FULFILLMENT_TYPE",
     "sc_tlm_order_line_item"."do_WAVE_NBR",
     "sc_tlm_order_line_item"."do_SHIP_WAVE_NBR",
     "sc_tlm_order_line_item"."do_REPL_WAVE_NBR",
     "sc_tlm_order_line_item"."do_SINGLE_UNIT_FLAG",
     "sc_tlm_order_line_item"."do_ACTUAL_COST",
     "sc_tlm_order_line_item"."do_QTY_CONV_FACTOR",
     "sc_tlm_order_line_item"."do_PLANNED_WEIGHT",
     "sc_tlm_order_line_item"."do_RECEIVED_WEIGHT",
     "sc_tlm_order_line_item"."do_SHIPPED_WEIGHT",
     "sc_tlm_order_line_item"."do_WEIGHT_UOM_ID_BASE",
     "sc_tlm_order_line_item"."do_WEIGHT_UOM_ID",
     "sc_tlm_order_line_item"."do_PLANNED_VOLUME",
     "sc_tlm_order_line_item"."do_RECEIVED_VOLUME",
     "sc_tlm_order_line_item"."do_SHIPPED_VOLUME",
     "sc_tlm_order_line_item"."do_VOLUME_UOM_ID_BASE",
     "sc_tlm_order_line_item"."do_VOLUME_UOM_ID",
     "sc_tlm_order_line_item"."do_SIZE1_UOM_ID",
     "sc_tlm_order_line_item"."do_SIZE1_VALUE",
     "sc_tlm_order_line_item"."do_RECEIVED_SIZE1",
     "sc_tlm_order_line_item"."do_SHIPPED_SIZE1",
     "sc_tlm_order_line_item"."do_SIZE2_UOM_ID",
     "sc_tlm_order_line_item"."do_SIZE2_VALUE",
     "sc_tlm_order_line_item"."do_RECEIVED_SIZE2",
     "sc_tlm_order_line_item"."do_SHIPPED_SIZE2",
     "sc_tlm_order_line_item"."do_LPN_TYPE",
     "sc_tlm_order_line_item"."do_ORDER_CONSOL_ATTR",
     "sc_tlm_order_line_item"."do_SKU_BREAK_ATTR",
     "sc_tlm_order_line_item"."do_PURCHASE_ORDER_NUMBER",
     "sc_tlm_order_line_item"."do_EXT_PURCHASE_ORDER",
     "sc_tlm_order_line_item"."do_CRITCL_DIM_1",
     "sc_tlm_order_line_item"."do_CRITCL_DIM_2",
     "sc_tlm_order_line_item"."do_CRITCL_DIM_3",
     "sc_tlm_order_line_item"."do_ASSORT_NBR",
     "sc_tlm_order_line_item"."do_DESCRIPTION",
     "sc_tlm_order_line_item"."do_ORIGINAL_ORDERED_ITEM_ID",
     "sc_tlm_order_line_item"."do_SUBSTITUTION_TYPE",
     "sc_tlm_order_line_item"."do_BACK_ORD_REASON",
     "sc_tlm_order_line_item"."do_FREIGHT_REVENUE_CURRENCY_CODE",
     "sc_tlm_order_line_item"."do_FREIGHT_REVENUE",
     "sc_tlm_order_line_item"."do_IS_CHASE_CREATED_LINE",
     "sc_tlm_order_line_item"."do_REF_FIELD4",
     "sc_tlm_order_line_item"."do_REF_FIELD5",
     "sc_tlm_order_line_item"."do_REF_FIELD6",
     "sc_tlm_order_line_item"."do_REF_FIELD7",
     "sc_tlm_order_line_item"."do_REF_FIELD8",
     "sc_tlm_order_line_item"."do_REF_FIELD9",
     "sc_tlm_order_line_item"."do_REF_FIELD10",
     "sc_tlm_order_line_item"."do_REF_NUM1",
     "sc_tlm_order_line_item"."do_REF_NUM2",
     "sc_tlm_order_line_item"."do_REF_NUM3",
     "sc_tlm_order_line_item"."do_REF_NUM4",
     "sc_tlm_order_line_item"."do_REF_NUM5",
     "sc_tlm_order_line_item"."do_IS_GIFT",
     "sc_tlm_order_line_item"."do_ADJUSTED_ORDER_QTY",
     "sc_tlm_order_line_item"."do_PRE_RECEIPT_STATUS",
     "sc_tlm_order_line_item"."do_ALLOW_REVIVAL_RECEIPT_ALLOC",
     "sc_tlm_order_line_item"."do_SEGMENT_NAME",
     "sc_tlm_order_line_item"."do_EFFECTIVE_RANK",
     "sc_tlm_order_line_item"."do_WM_RECEIPT_ALLOCATED",
     "sc_tlm_order_line_item"."do_GIFT_CARD_VALUE",
     "sc_tlm_order_line_item"."do_REF_BOOLEAN1",
     "sc_tlm_order_line_item"."do_REF_BOOLEAN2",
     "sc_tlm_order_line_item"."do_REF_SYSCODE1",
     "sc_tlm_order_line_item"."do_REF_SYSCODE2",
     "sc_tlm_order_line_item"."do_REF_SYSCODE3"
  FROM CTE "tlm_shipment_joined_do_prepared"
  LEFT JOIN (

    SELECT DISTINCT "sc_tlm_order_line_item"."ORDER_ID" AS "do_ORDER_ID_2",
    "sc_tlm_order_line_item"."LINE_ITEM_ID" AS "do_LINE_ITEM_ID",
    "sc_tlm_order_line_item"."PARENT_LINE_ITEM_ID" AS "do_PARENT_LINE_ITEM_ID",
    "sc_tlm_order_line_item"."TC_COMPANY_ID" AS "do_TC_COMPANY_ID",
    "sc_tlm_order_line_item"."COMMODITY_CLASS" AS "do_COMMODITY_CLASS",
    "sc_tlm_order_line_item"."REF_FIELD1" AS "do_REF_FIELD1",
    "sc_tlm_order_line_item"."REF_FIELD2" AS "do_REF_FIELD2",
    "sc_tlm_order_line_item"."REF_FIELD3" AS "do_REF_FIELD3",
    "sc_tlm_order_line_item"."EXT_SYS_LINE_ITEM_ID" AS "do_EXT_SYS_LINE_ITEM_ID",
    "sc_tlm_order_line_item"."MASTER_ORDER_ID" AS "do_MASTER_ORDER_ID",
    "sc_tlm_order_line_item"."MO_LINE_ITEM_ID" AS "do_MO_LINE_ITEM_ID",
    "sc_tlm_order_line_item"."IS_HAZMAT" AS "do_IS_HAZMAT",
    "sc_tlm_order_line_item"."IS_STACKABLE" AS "do_IS_STACKABLE",
    "sc_tlm_order_line_item"."HAS_ERRORS" AS "do_HAS_ERRORS",
    "sc_tlm_order_line_item"."ORIG_BUDG_COST" AS "do_ORIG_BUDG_COST",
    "sc_tlm_order_line_item"."BUDG_COST_CURRENCY_CODE" AS "do_BUDG_COST_CURRENCY_CODE",
    "sc_tlm_order_line_item"."BUDG_COST" AS "do_BUDG_COST",
    "sc_tlm_order_line_item"."ACTUAL_COST_CURRENCY_CODE" AS "do_ACTUAL_COST_CURRENCY_CODE",
    "sc_tlm_order_line_item"."TOTAL_MONETARY_VALUE" AS "do_TOTAL_MONETARY_VALUE",
    "sc_tlm_order_line_item"."UNIT_MONETARY_VALUE" AS "do_UNIT_MONETARY_VALUE",
    "sc_tlm_order_line_item"."UNIT_TAX_AMOUNT" AS "do_UNIT_TAX_AMOUNT",
    "sc_tlm_order_line_item"."RTS_ID" AS "do_RTS_ID",
    "sc_tlm_order_line_item"."RTS_LINE_ITEM_ID" AS "do_RTS_LINE_ITEM_ID",
    "sc_tlm_order_line_item"."STD_PACK_QTY" AS "do_STD_PACK_QTY",
    "sc_tlm_order_line_item"."PRODUCT_CLASS_ID" AS "do_PRODUCT_CLASS_ID",
    "sc_tlm_order_line_item"."PROTECTION_LEVEL_ID" AS "do_PROTECTION_LEVEL_ID",
    "sc_tlm_order_line_item"."PACKAGE_TYPE_ID" AS "do_PACKAGE_TYPE_ID",
    "sc_tlm_order_line_item"."COMMODITY_CODE_ID" AS "do_COMMODITY_CODE_ID",
    "sc_tlm_order_line_item"."MV_SIZE_UOM_ID" AS "do_MV_SIZE_UOM_ID",
    "sc_tlm_order_line_item"."QTY_UOM_ID_BASE" AS "do_QTY_UOM_ID_BASE",
    "sc_tlm_order_line_item"."MV_CURRENCY_CODE" AS "do_MV_CURRENCY_CODE",
    "sc_tlm_order_line_item"."SHIPPED_QTY" AS "do_SHIPPED_QTY",
    "sc_tlm_order_line_item"."RECEIVED_QTY" AS "do_RECEIVED_QTY",
    "sc_tlm_order_line_item"."PRIORITY" AS "do_PRIORITY",
    "sc_tlm_order_line_item"."MERCHANDIZING_DEPARTMENT_ID" AS "do_MERCHANDIZING_DEPARTMENT_ID",
    "sc_tlm_order_line_item"."UN_NUMBER_ID" AS "do_UN_NUMBER_ID",
    "sc_tlm_order_line_item"."PICKUP_REFERENCE_NUMBER" AS "do_PICKUP_REFERENCE_NUMBER",
    "sc_tlm_order_line_item"."DELIVERY_REFERENCE_NUMBER" AS "do_DELIVERY_REFERENCE_NUMBER",
    "sc_tlm_order_line_item"."CNTRY_OF_ORGN" AS "do_CNTRY_OF_ORGN",
    "sc_tlm_order_line_item"."PROD_STAT" AS "do_PROD_STAT",
    "sc_tlm_order_line_item"."STACK_RANK" AS "do_STACK_RANK",
    "sc_tlm_order_line_item"."STACK_LENGTH_VALUE" AS "do_STACK_LENGTH_VALUE",
    "sc_tlm_order_line_item"."STACK_LENGTH_STANDARD_UOM" AS "do_STACK_LENGTH_STANDARD_UOM",
    "sc_tlm_order_line_item"."STACK_WIDTH_VALUE" AS "do_STACK_WIDTH_VALUE",
    "sc_tlm_order_line_item"."STACK_WIDTH_STANDARD_UOM" AS "do_STACK_WIDTH_STANDARD_UOM",
    "sc_tlm_order_line_item"."STACK_HEIGHT_VALUE" AS "do_STACK_HEIGHT_VALUE",
    "sc_tlm_order_line_item"."STACK_HEIGHT_STANDARD_UOM" AS "do_STACK_HEIGHT_STANDARD_UOM",
    "sc_tlm_order_line_item"."STACK_DIAMETER_VALUE" AS "do_STACK_DIAMETER_VALUE",
    "sc_tlm_order_line_item"."STACK_DIAMETER_STANDARD_UOM" AS "do_STACK_DIAMETER_STANDARD_UOM",
    "sc_tlm_order_line_item"."HIBERNATE_VERSION" AS "do_HIBERNATE_VERSION",
    "sc_tlm_order_line_item"."CUBE_MULTIPLE_QTY" AS "do_CUBE_MULTIPLE_QTY",
    "sc_tlm_order_line_item"."DO_DTL_STATUS" AS "do_DO_DTL_STATUS",
    "sc_tlm_order_line_item"."INTERNAL_ORDER_SEQ_NBR" AS "do_INTERNAL_ORDER_SEQ_NBR",
    "sc_tlm_order_line_item"."IS_EMERGENCY" AS "do_IS_EMERGENCY",
    "sc_tlm_order_line_item"."LPN_SIZE" AS "do_LPN_SIZE",
    "sc_tlm_order_line_item"."MANUFACTURING_DTTM" AS "do_MANUFACTURING_DTTM",
    "sc_tlm_order_line_item"."ORDER_LINE_ID" AS "do_ORDER_LINE_ID",
    "sc_tlm_order_line_item"."PACK_RATE" AS "do_PACK_RATE",
    "sc_tlm_order_line_item"."ALLOCATED_QTY" AS "do_ALLOCATED_QTY",
    "sc_tlm_order_line_item"."PLANNED_SHIP_DATE" AS "do_PLANNED_SHIP_DATE",
    "sc_tlm_order_line_item"."PPACK_QTY" AS "do_PPACK_QTY",
    "sc_tlm_order_line_item"."STD_BUNDLE_QTY" AS "do_STD_BUNDLE_QTY",
    "sc_tlm_order_line_item"."STD_LPN_QTY" AS "do_STD_LPN_QTY",
    "sc_tlm_order_line_item"."STD_LPN_VOL" AS "do_STD_LPN_VOL",
    "sc_tlm_order_line_item"."STD_LPN_WT" AS "do_STD_LPN_WT",
    "sc_tlm_order_line_item"."UNIT_COST" AS "do_UNIT_COST",
    "sc_tlm_order_line_item"."UNIT_PRICE_AMOUNT" AS "do_UNIT_PRICE_AMOUNT",
    "sc_tlm_order_line_item"."UNIT_VOL" AS "do_UNIT_VOL",
    "sc_tlm_order_line_item"."UNIT_WT" AS "do_UNIT_WT",
    "sc_tlm_order_line_item"."USER_CANCELED_QTY" AS "do_USER_CANCELED_QTY",
    "sc_tlm_order_line_item"."WAVE_PROC_TYPE" AS "do_WAVE_PROC_TYPE",
    "sc_tlm_order_line_item"."EVENT_CODE" AS "do_EVENT_CODE",
    "sc_tlm_order_line_item"."REASON_CODE" AS "do_REASON_CODE",
    "sc_tlm_order_line_item"."EXP_INFO_CODE" AS "do_EXP_INFO_CODE",
    "sc_tlm_order_line_item"."PARTL_FILL" AS "do_PARTL_FILL",
    "sc_tlm_order_line_item"."LINE_TYPE" AS "do_LINE_TYPE",
    "sc_tlm_order_line_item"."REPL_PROC_TYPE" AS "do_REPL_PROC_TYPE",
    "sc_tlm_order_line_item"."ORDER_QTY" AS "do_ORDER_QTY",
    "sc_tlm_order_line_item"."ORIG_ORDER_QTY" AS "do_ORIG_ORDER_QTY",
    "sc_tlm_order_line_item"."RTL_TO_BE_DISTROED_QTY" AS "do_RTL_TO_BE_DISTROED_QTY",
    "sc_tlm_order_line_item"."PRICE" AS "do_PRICE",
    "sc_tlm_order_line_item"."RETAIL_PRICE" AS "do_RETAIL_PRICE",
    "sc_tlm_order_line_item"."UNITS_PAKD" AS "do_UNITS_PAKD",
    "sc_tlm_order_line_item"."MINOR_ORDER_NBR" AS "do_MINOR_ORDER_NBR",
    "sc_tlm_order_line_item"."ITEM_ID" AS "do_ITEM_ID",
    "sc_tlm_order_line_item"."TC_ORDER_LINE_ID" AS "do_TC_ORDER_LINE_ID",
    "sc_tlm_order_line_item"."ACTUAL_SHIPPED_DTTM" AS "do_ACTUAL_SHIPPED_DTTM",
    "sc_tlm_order_line_item"."QTY_UOM_ID" AS "do_QTY_UOM_ID",
    "sc_tlm_order_line_item"."PICKUP_END_DTTM" AS "do_PICKUP_END_DTTM",
    "sc_tlm_order_line_item"."PURCHASE_ORDER_LINE_NUMBER" AS "do_PURCHASE_ORDER_LINE_NUMBER",
    "sc_tlm_order_line_item"."PICKUP_START_DTTM" AS "do_PICKUP_START_DTTM",
    "sc_tlm_order_line_item"."REFERENCE_LINE_ITEM_ID" AS "do_REFERENCE_LINE_ITEM_ID",
    "sc_tlm_order_line_item"."REFERENCE_ORDER_ID" AS "do_REFERENCE_ORDER_ID",
    "sc_tlm_order_line_item"."REPL_WAVE_RUN" AS "do_REPL_WAVE_RUN",
    "sc_tlm_order_line_item"."STD_PALLET_QTY" AS "do_STD_PALLET_QTY",
    "sc_tlm_order_line_item"."STD_SUB_PACK_QTY" AS "do_STD_SUB_PACK_QTY",
    "sc_tlm_order_line_item"."STORE_DEPT" AS "do_STORE_DEPT",
    "sc_tlm_order_line_item"."ALLOC_TYPE" AS "do_ALLOC_TYPE",
    "sc_tlm_order_line_item"."BATCH_NBR" AS "do_BATCH_NBR",
    "sc_tlm_order_line_item"."BATCH_REQUIREMENT_TYPE" AS "do_BATCH_REQUIREMENT_TYPE",
    "sc_tlm_order_line_item"."CHUTE_ASSIGN_TYPE" AS "do_CHUTE_ASSIGN_TYPE",
    "sc_tlm_order_line_item"."CUSTOM_TAG" AS "do_CUSTOM_TAG",
    "sc_tlm_order_line_item"."CUSTOMER_ITEM" AS "do_CUSTOMER_ITEM",
    "sc_tlm_order_line_item"."INTERNAL_ORDER_ID" AS "do_INTERNAL_ORDER_ID",
    "sc_tlm_order_line_item"."INVN_TYPE" AS "do_INVN_TYPE",
    "sc_tlm_order_line_item"."ITEM_ATTR_1" AS "do_ITEM_ATTR_1",
    "sc_tlm_order_line_item"."ITEM_ATTR_2" AS "do_ITEM_ATTR_2",
    "sc_tlm_order_line_item"."ITEM_ATTR_3" AS "do_ITEM_ATTR_3",
    "sc_tlm_order_line_item"."ITEM_ATTR_4" AS "do_ITEM_ATTR_4",
    "sc_tlm_order_line_item"."ITEM_ATTR_5" AS "do_ITEM_ATTR_5",
    "sc_tlm_order_line_item"."LPN_BRK_ATTRIB" AS "do_LPN_BRK_ATTRIB",
    "sc_tlm_order_line_item"."MERCH_GRP" AS "do_MERCH_GRP",
    "sc_tlm_order_line_item"."MERCH_TYPE" AS "do_MERCH_TYPE",
    "sc_tlm_order_line_item"."PACK_ZONE" AS "do_PACK_ZONE",
    "sc_tlm_order_line_item"."PALLET_TYPE" AS "do_PALLET_TYPE",
    "sc_tlm_order_line_item"."PICK_LOCN_ASSIGN_TYPE" AS "do_PICK_LOCN_ASSIGN_TYPE",
    "sc_tlm_order_line_item"."PICK_LOCN_ID" AS "do_PICK_LOCN_ID",
    "sc_tlm_order_line_item"."PPACK_GRP_CODE" AS "do_PPACK_GRP_CODE",
    "sc_tlm_order_line_item"."PRICE_TKT_TYPE" AS "do_PRICE_TKT_TYPE",
    "sc_tlm_order_line_item"."SERIAL_NUMBER_REQUIRED_FLAG" AS "do_SERIAL_NUMBER_REQUIRED_FLAG",
    "sc_tlm_order_line_item"."SKU_GTIN" AS "do_SKU_GTIN",
    "sc_tlm_order_line_item"."SKU_SUB_CODE_ID" AS "do_SKU_SUB_CODE_ID",
    "sc_tlm_order_line_item"."SKU_SUB_CODE_VALUE" AS "do_SKU_SUB_CODE_VALUE",
    "sc_tlm_order_line_item"."VAS_PROCESS_TYPE" AS "do_VAS_PROCESS_TYPE",
    "sc_tlm_order_line_item"."SUBSTITUTED_PARENT_LINE_ID" AS "do_SUBSTITUTED_PARENT_LINE_ID",
    "sc_tlm_order_line_item"."IS_CANCELLED" AS "do_IS_CANCELLED",
    "sc_tlm_order_line_item"."ITEM_NAME" AS "do_ITEM_NAME",
    "sc_tlm_order_line_item"."ALLOC_LINE_ID" AS "do_ALLOC_LINE_ID",
    "sc_tlm_order_line_item"."ALLOCATION_SOURCE_ID" AS "do_ALLOCATION_SOURCE_ID",
    "sc_tlm_order_line_item"."ALLOCATION_SOURCE_LINE_ID" AS "do_ALLOCATION_SOURCE_LINE_ID",
    "sc_tlm_order_line_item"."ALLOCATION_SOURCE" AS "do_ALLOCATION_SOURCE",
    "sc_tlm_order_line_item"."SHELF_DAYS" AS "do_SHELF_DAYS",
    "sc_tlm_order_line_item"."FULFILLMENT_TYPE" AS "do_FULFILLMENT_TYPE",
    "sc_tlm_order_line_item"."WAVE_NBR" AS "do_WAVE_NBR",
    "sc_tlm_order_line_item"."SHIP_WAVE_NBR" AS "do_SHIP_WAVE_NBR",
    "sc_tlm_order_line_item"."REPL_WAVE_NBR" AS "do_REPL_WAVE_NBR",
    "sc_tlm_order_line_item"."SINGLE_UNIT_FLAG" AS "do_SINGLE_UNIT_FLAG",
    "sc_tlm_order_line_item"."ACTUAL_COST" AS "do_ACTUAL_COST",
    "sc_tlm_order_line_item"."QTY_CONV_FACTOR" AS "do_QTY_CONV_FACTOR",
    "sc_tlm_order_line_item"."PLANNED_WEIGHT" AS "do_PLANNED_WEIGHT",
    "sc_tlm_order_line_item"."RECEIVED_WEIGHT" AS "do_RECEIVED_WEIGHT",
    "sc_tlm_order_line_item"."SHIPPED_WEIGHT" AS "do_SHIPPED_WEIGHT",
    "sc_tlm_order_line_item"."WEIGHT_UOM_ID_BASE" AS "do_WEIGHT_UOM_ID_BASE",
    "sc_tlm_order_line_item"."WEIGHT_UOM_ID" AS "do_WEIGHT_UOM_ID",
    "sc_tlm_order_line_item"."PLANNED_VOLUME" AS "do_PLANNED_VOLUME",
    "sc_tlm_order_line_item"."RECEIVED_VOLUME" AS "do_RECEIVED_VOLUME",
    "sc_tlm_order_line_item"."SHIPPED_VOLUME" AS "do_SHIPPED_VOLUME",
    "sc_tlm_order_line_item"."VOLUME_UOM_ID_BASE" AS "do_VOLUME_UOM_ID_BASE",
    "sc_tlm_order_line_item"."VOLUME_UOM_ID" AS "do_VOLUME_UOM_ID",
    "sc_tlm_order_line_item"."SIZE1_UOM_ID" AS "do_SIZE1_UOM_ID",
    "sc_tlm_order_line_item"."SIZE1_VALUE" AS "do_SIZE1_VALUE",
    "sc_tlm_order_line_item"."RECEIVED_SIZE1" AS "do_RECEIVED_SIZE1",
    "sc_tlm_order_line_item"."SHIPPED_SIZE1" AS "do_SHIPPED_SIZE1",
    "sc_tlm_order_line_item"."SIZE2_UOM_ID" AS "do_SIZE2_UOM_ID",
    "sc_tlm_order_line_item"."SIZE2_VALUE" AS "do_SIZE2_VALUE",
    "sc_tlm_order_line_item"."RECEIVED_SIZE2" AS "do_RECEIVED_SIZE2",
    "sc_tlm_order_line_item"."SHIPPED_SIZE2" AS "do_SHIPPED_SIZE2",
    "sc_tlm_order_line_item"."LPN_TYPE" AS "do_LPN_TYPE",
    "sc_tlm_order_line_item"."ORDER_CONSOL_ATTR" AS "do_ORDER_CONSOL_ATTR",
    "sc_tlm_order_line_item"."SKU_BREAK_ATTR" AS "do_SKU_BREAK_ATTR",
    "sc_tlm_order_line_item"."PURCHASE_ORDER_NUMBER" AS "do_PURCHASE_ORDER_NUMBER",
    "sc_tlm_order_line_item"."EXT_PURCHASE_ORDER" AS "do_EXT_PURCHASE_ORDER",
    "sc_tlm_order_line_item"."CRITCL_DIM_1" AS "do_CRITCL_DIM_1",
    "sc_tlm_order_line_item"."CRITCL_DIM_2" AS "do_CRITCL_DIM_2",
    "sc_tlm_order_line_item"."CRITCL_DIM_3" AS "do_CRITCL_DIM_3",
    "sc_tlm_order_line_item"."ASSORT_NBR" AS "do_ASSORT_NBR",
    "sc_tlm_order_line_item"."DESCRIPTION" AS "do_DESCRIPTION",
    "sc_tlm_order_line_item"."ORIGINAL_ORDERED_ITEM_ID" AS "do_ORIGINAL_ORDERED_ITEM_ID",
    "sc_tlm_order_line_item"."SUBSTITUTION_TYPE" AS "do_SUBSTITUTION_TYPE",
    "sc_tlm_order_line_item"."BACK_ORD_REASON" AS "do_BACK_ORD_REASON",
    "sc_tlm_order_line_item"."FREIGHT_REVENUE_CURRENCY_CODE" AS "do_FREIGHT_REVENUE_CURRENCY_CODE",
    "sc_tlm_order_line_item"."FREIGHT_REVENUE" AS "do_FREIGHT_REVENUE",
    "sc_tlm_order_line_item"."IS_CHASE_CREATED_LINE" AS "do_IS_CHASE_CREATED_LINE",
    "sc_tlm_order_line_item"."REF_FIELD4" AS "do_REF_FIELD4",
    "sc_tlm_order_line_item"."REF_FIELD5" AS "do_REF_FIELD5",
    "sc_tlm_order_line_item"."REF_FIELD6" AS "do_REF_FIELD6",
    "sc_tlm_order_line_item"."REF_FIELD7" AS "do_REF_FIELD7",
    "sc_tlm_order_line_item"."REF_FIELD8" AS "do_REF_FIELD8",
    "sc_tlm_order_line_item"."REF_FIELD9" AS "do_REF_FIELD9",
    "sc_tlm_order_line_item"."REF_FIELD10" AS "do_REF_FIELD10",
    "sc_tlm_order_line_item"."REF_NUM1" AS "do_REF_NUM1",
    "sc_tlm_order_line_item"."REF_NUM2" AS "do_REF_NUM2",
    "sc_tlm_order_line_item"."REF_NUM3" AS "do_REF_NUM3",
    "sc_tlm_order_line_item"."REF_NUM4" AS "do_REF_NUM4",
    "sc_tlm_order_line_item"."REF_NUM5" AS "do_REF_NUM5",
    "sc_tlm_order_line_item"."IS_GIFT" AS "do_IS_GIFT",
    "sc_tlm_order_line_item"."ADJUSTED_ORDER_QTY" AS "do_ADJUSTED_ORDER_QTY",
    "sc_tlm_order_line_item"."PRE_RECEIPT_STATUS" AS "do_PRE_RECEIPT_STATUS",
    "sc_tlm_order_line_item"."ALLOW_REVIVAL_RECEIPT_ALLOC" AS "do_ALLOW_REVIVAL_RECEIPT_ALLOC",
    "sc_tlm_order_line_item"."SEGMENT_NAME" AS "do_SEGMENT_NAME",
    "sc_tlm_order_line_item"."EFFECTIVE_RANK" AS "do_EFFECTIVE_RANK",
    "sc_tlm_order_line_item"."WM_RECEIPT_ALLOCATED" AS "do_WM_RECEIPT_ALLOCATED",
    "sc_tlm_order_line_item"."GIFT_CARD_VALUE" AS "do_GIFT_CARD_VALUE",
    "sc_tlm_order_line_item"."REF_BOOLEAN1" AS "do_REF_BOOLEAN1",
    "sc_tlm_order_line_item"."REF_BOOLEAN2" AS "do_REF_BOOLEAN2",
    "sc_tlm_order_line_item"."REF_SYSCODE1" AS "do_REF_SYSCODE1",
    "sc_tlm_order_line_item"."REF_SYSCODE2" AS "do_REF_SYSCODE2",
    "sc_tlm_order_line_item"."REF_SYSCODE3" AS "do_REF_SYSCODE3"
    FROM  "EDW"."VW_SC_TLM_ORDER_LINE_ITEM"  "sc_tlm_order_line_item"

  ) "sc_tlm_order_line_item"
    ON "tlm_shipment_joined_do_prepared"."do_ORDER_ID" = "sc_tlm_order_line_item"."do_ORDER_ID_2";

<br>	
--TLM_SHIPMENT_JOINED_DO_VOl_WGT_ALLOCATION
</br>  
CREATE OR REPLACE TEMPORARY TABLE "TLM_SHIPMENT_JOINED_DO_VOl_WGT_ALLOCATION"
AS
WITH CTE AS 
(SELECT 
    "tlm_shipment_joined_do_w_article_prepared"."SHIPMENT_ID" AS "SHIPMENT_ID",
    "tlm_shipment_joined_do_w_article_prepared"."TC_COMPANY_ID" AS "TC_COMPANY_ID",
    "tlm_shipment_joined_do_w_article_prepared"."RS_AREA_ID" AS "RS_AREA_ID",
    "tlm_shipment_joined_do_w_article_prepared"."TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID",
    "tlm_shipment_joined_do_w_article_prepared"."PP_SHIPMENT_ID" AS "PP_SHIPMENT_ID",
    "tlm_shipment_joined_do_w_article_prepared"."SHIPMENT_STATUS" AS "SHIPMENT_STATUS",
    "tlm_shipment_joined_do_w_article_prepared"."UPDATE_SENT" AS "UPDATE_SENT",
    "tlm_shipment_joined_do_w_article_prepared"."BUSINESS_PROCESS" AS "BUSINESS_PROCESS",
    "tlm_shipment_joined_do_w_article_prepared"."CREATION_TYPE" AS "CREATION_TYPE",
    "tlm_shipment_joined_do_w_article_prepared"."CONS_RUN_ID" AS "CONS_RUN_ID",
    "tlm_shipment_joined_do_w_article_prepared"."IS_CANCELLED" AS "IS_CANCELLED",
    "tlm_shipment_joined_do_w_article_prepared"."RS_TYPE" AS "RS_TYPE",
    "tlm_shipment_joined_do_w_article_prepared"."RS_CONFIG_ID" AS "RS_CONFIG_ID",
    "tlm_shipment_joined_do_w_article_prepared"."RS_CONFIG_CYCLE_ID" AS "RS_CONFIG_CYCLE_ID",
    "tlm_shipment_joined_do_w_article_prepared"."CONFIG_CYCLE_SEQ" AS "CONFIG_CYCLE_SEQ",
    "tlm_shipment_joined_do_w_article_prepared"."CYCLE_DEADLINE_DTTM" AS "CYCLE_DEADLINE_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."CYCLE_EXECUTION_DTTM" AS "CYCLE_EXECUTION_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."LAST_RS_NOTIFICATION_DTTM" AS "LAST_RS_NOTIFICATION_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."CFMF_STATUS" AS "CFMF_STATUS",
    "tlm_shipment_joined_do_w_article_prepared"."AVAILABLE_DTTM" AS "AVAILABLE_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."CMID" AS "CMID",
    "tlm_shipment_joined_do_w_article_prepared"."CM_DISCOUNT" AS "CM_DISCOUNT",
    "tlm_shipment_joined_do_w_article_prepared"."O_FACILITY_NUMBER" AS "O_FACILITY_NUMBER",
    "tlm_shipment_joined_do_w_article_prepared"."O_FACILITY_ID" AS "O_FACILITY_ID",
    "tlm_shipment_joined_do_w_article_prepared"."O_ADDRESS" AS "O_ADDRESS",
    "tlm_shipment_joined_do_w_article_prepared"."O_CITY" AS "O_CITY",
    "tlm_shipment_joined_do_w_article_prepared"."O_STATE_PROV" AS "O_STATE_PROV",
    "tlm_shipment_joined_do_w_article_prepared"."O_POSTAL_CODE" AS "O_POSTAL_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."O_COUNTY" AS "O_COUNTY",
    "tlm_shipment_joined_do_w_article_prepared"."O_COUNTRY_CODE" AS "O_COUNTRY_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."D_FACILITY_NUMBER" AS "D_FACILITY_NUMBER",
    "tlm_shipment_joined_do_w_article_prepared"."D_FACILITY_ID" AS "D_FACILITY_ID",
    "tlm_shipment_joined_do_w_article_prepared"."D_ADDRESS" AS "D_ADDRESS",
    "tlm_shipment_joined_do_w_article_prepared"."D_CITY" AS "D_CITY",
    "tlm_shipment_joined_do_w_article_prepared"."D_STATE_PROV" AS "D_STATE_PROV",
    "tlm_shipment_joined_do_w_article_prepared"."D_POSTAL_CODE" AS "D_POSTAL_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."D_COUNTY" AS "D_COUNTY",
    "tlm_shipment_joined_do_w_article_prepared"."D_COUNTRY_CODE" AS "D_COUNTRY_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."DISTANCE" AS "DISTANCE",
    "tlm_shipment_joined_do_w_article_prepared"."DIRECT_DISTANCE" AS "DIRECT_DISTANCE",
    "tlm_shipment_joined_do_w_article_prepared"."OUT_OF_ROUTE_DISTANCE" AS "OUT_OF_ROUTE_DISTANCE",
    "tlm_shipment_joined_do_w_article_prepared"."DISTANCE_UOM" AS "DISTANCE_UOM",
    "tlm_shipment_joined_do_w_article_prepared"."BUSINESS_PARTNER_ID" AS "BUSINESS_PARTNER_ID",
    "tlm_shipment_joined_do_w_article_prepared"."COMMODITY_CLASS" AS "COMMODITY_CLASS",
    "tlm_shipment_joined_do_w_article_prepared"."IS_HAZMAT" AS "IS_HAZMAT",
    "tlm_shipment_joined_do_w_article_prepared"."IS_PERISHABLE" AS "IS_PERISHABLE",
    "tlm_shipment_joined_do_w_article_prepared"."BILLING_METHOD" AS "BILLING_METHOD",
    "tlm_shipment_joined_do_w_article_prepared"."DSG_CARRIER_CODE" AS "DSG_CARRIER_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."REC_CMID" AS "REC_CMID",
    "tlm_shipment_joined_do_w_article_prepared"."REC_CM_SHIPMENT_ID" AS "REC_CM_SHIPMENT_ID",
    "tlm_shipment_joined_do_w_article_prepared"."ASSIGNED_CARRIER_CODE" AS "ASSIGNED_CARRIER_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."SHIPMENT_REF_ID" AS "SHIPMENT_REF_ID",
    "tlm_shipment_joined_do_w_article_prepared"."BILL_TO_CODE" AS "BILL_TO_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."BILL_TO_TITLE" AS "BILL_TO_TITLE",
    "tlm_shipment_joined_do_w_article_prepared"."BILL_TO_NAME" AS "BILL_TO_NAME",
    "tlm_shipment_joined_do_w_article_prepared"."BILL_TO_ADDRESS" AS "BILL_TO_ADDRESS",
    "tlm_shipment_joined_do_w_article_prepared"."BILL_TO_CITY" AS "BILL_TO_CITY",
    "tlm_shipment_joined_do_w_article_prepared"."BILL_TO_STATE_PROV" AS "BILL_TO_STATE_PROV",
    "tlm_shipment_joined_do_w_article_prepared"."BILL_TO_POSTAL_CODE" AS "BILL_TO_POSTAL_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."BILL_TO_COUNTRY_CODE" AS "BILL_TO_COUNTRY_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."BILL_TO_PHONE_NUMBER" AS "BILL_TO_PHONE_NUMBER",
    "tlm_shipment_joined_do_w_article_prepared"."PURCHASE_ORDER" AS "PURCHASE_ORDER",
    "tlm_shipment_joined_do_w_article_prepared"."PRO_NUMBER" AS "PRO_NUMBER",
    "tlm_shipment_joined_do_w_article_prepared"."TRANS_RESP_CODE" AS "TRANS_RESP_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."BASELINE_COST" AS "BASELINE_COST",
    "tlm_shipment_joined_do_w_article_prepared"."ESTIMATED_COST" AS "ESTIMATED_COST",
    "tlm_shipment_joined_do_w_article_prepared"."LINEHAUL_COST" AS "LINEHAUL_COST",
    "tlm_shipment_joined_do_w_article_prepared"."ACCESSORIAL_COST" AS "ACCESSORIAL_COST",
    "tlm_shipment_joined_do_w_article_prepared"."STOP_COST" AS "STOP_COST",
    "tlm_shipment_joined_do_w_article_prepared"."ESTIMATED_SAVINGS" AS "ESTIMATED_SAVINGS",
    "tlm_shipment_joined_do_w_article_prepared"."SPOT_CHARGE" AS "SPOT_CHARGE",
    "tlm_shipment_joined_do_w_article_prepared"."CURRENCY_CODE" AS "CURRENCY_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."PICKUP_START_DTTM" AS "PICKUP_START_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."PICKUP_END_DTTM" AS "PICKUP_END_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."DELIVERY_START_DTTM" AS "DELIVERY_START_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."DELIVERY_END_DTTM" AS "DELIVERY_END_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."NUM_STOPS" AS "NUM_STOPS",
    "tlm_shipment_joined_do_w_article_prepared"."NUM_DOCKS" AS "NUM_DOCKS",
    "tlm_shipment_joined_do_w_article_prepared"."ON_TIME_INDICATOR" AS "ON_TIME_INDICATOR",
    "tlm_shipment_joined_do_w_article_prepared"."HAS_NOTES" AS "HAS_NOTES",
    "tlm_shipment_joined_do_w_article_prepared"."HAS_ALERTS" AS "HAS_ALERTS",
    "tlm_shipment_joined_do_w_article_prepared"."HAS_IMPORT_ERROR" AS "HAS_IMPORT_ERROR",
    "tlm_shipment_joined_do_w_article_prepared"."HAS_SOFT_CHECK_ERROR" AS "HAS_SOFT_CHECK_ERROR",
    "tlm_shipment_joined_do_w_article_prepared"."HAS_TRACKING_MSG" AS "HAS_TRACKING_MSG",
    "tlm_shipment_joined_do_w_article_prepared"."TRACKING_MSG_PROBLEM" AS "TRACKING_MSG_PROBLEM",
    "tlm_shipment_joined_do_w_article_prepared"."REC_LINEHAUL_COST" AS "REC_LINEHAUL_COST",
    "tlm_shipment_joined_do_w_article_prepared"."REC_ACCESSORIAL_COST" AS "REC_ACCESSORIAL_COST",
    "tlm_shipment_joined_do_w_article_prepared"."REC_TOTAL_COST" AS "REC_TOTAL_COST",
    "tlm_shipment_joined_do_w_article_prepared"."CYCLE_RESP_DEADLINE_TZ" AS "CYCLE_RESP_DEADLINE_TZ",
    "tlm_shipment_joined_do_w_article_prepared"."TENDER_RESP_DEADLINE_TZ" AS "TENDER_RESP_DEADLINE_TZ",
    "tlm_shipment_joined_do_w_article_prepared"."PICKUP_TZ" AS "PICKUP_TZ",
    "tlm_shipment_joined_do_w_article_prepared"."DELIVERY_TZ" AS "DELIVERY_TZ",
    "tlm_shipment_joined_do_w_article_prepared"."ASSIGNED_LANE_ID" AS "ASSIGNED_LANE_ID",
    "tlm_shipment_joined_do_w_article_prepared"."ASSIGNED_LANE_DETAIL_ID" AS "ASSIGNED_LANE_DETAIL_ID",
    "tlm_shipment_joined_do_w_article_prepared"."REC_SPOT_CHARGE" AS "REC_SPOT_CHARGE",
    "tlm_shipment_joined_do_w_article_prepared"."REC_LANE_ID" AS "REC_LANE_ID",
    "tlm_shipment_joined_do_w_article_prepared"."REC_LANE_DETAIL_ID" AS "REC_LANE_DETAIL_ID",
    "tlm_shipment_joined_do_w_article_prepared"."TENDER_DTTM" AS "TENDER_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."O_STOP_LOCATION_NAME" AS "O_STOP_LOCATION_NAME",
    "tlm_shipment_joined_do_w_article_prepared"."D_STOP_LOCATION_NAME" AS "D_STOP_LOCATION_NAME",
    "tlm_shipment_joined_do_w_article_prepared"."ASSIGNED_CM_SHIPMENT_ID" AS "ASSIGNED_CM_SHIPMENT_ID",
    "tlm_shipment_joined_do_w_article_prepared"."REC_CM_DISCOUNT" AS "REC_CM_DISCOUNT",
    "tlm_shipment_joined_do_w_article_prepared"."REC_STOP_COST" AS "REC_STOP_COST",
    "tlm_shipment_joined_do_w_article_prepared"."LAST_SELECTOR_RUN_DTTM" AS "LAST_SELECTOR_RUN_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."LAST_CM_OPTION_GEN_DTTM" AS "LAST_CM_OPTION_GEN_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."IS_CM_OPTION_GEN_ACTIVE" AS "IS_CM_OPTION_GEN_ACTIVE",
    "tlm_shipment_joined_do_w_article_prepared"."RS_CYCLE_REMAINING" AS "RS_CYCLE_REMAINING",
    "tlm_shipment_joined_do_w_article_prepared"."IS_TIME_FEAS_ENABLED" AS "IS_TIME_FEAS_ENABLED",
    "tlm_shipment_joined_do_w_article_prepared"."EXT_SYS_SHIPMENT_ID" AS "EXT_SYS_SHIPMENT_ID",
    "tlm_shipment_joined_do_w_article_prepared"."EXTRACTION_DTTM" AS "EXTRACTION_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."ASSIGNED_BROKER_CARRIER_CODE" AS "ASSIGNED_BROKER_CARRIER_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."USE_BROKER_AS_CARRIER" AS "USE_BROKER_AS_CARRIER",
    "tlm_shipment_joined_do_w_article_prepared"."BROKER_REF" AS "BROKER_REF",
    "tlm_shipment_joined_do_w_article_prepared"."RATING_QUALIFIER" AS "RATING_QUALIFIER",
    "tlm_shipment_joined_do_w_article_prepared"."STATUS_CHANGE_DTTM" AS "STATUS_CHANGE_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."BUDG_TOTAL_COST" AS "BUDG_TOTAL_COST",
    "tlm_shipment_joined_do_w_article_prepared"."NORMALIZED_MARGIN" AS "NORMALIZED_MARGIN",
    "tlm_shipment_joined_do_w_article_prepared"."NORMALIZED_TOTAL_COST" AS "NORMALIZED_TOTAL_COST",
    "tlm_shipment_joined_do_w_article_prepared"."BUDG_NORMALIZED_TOTAL_COST" AS "BUDG_NORMALIZED_TOTAL_COST",
    "tlm_shipment_joined_do_w_article_prepared"."REC_BUDG_LINEHAUL_COST" AS "REC_BUDG_LINEHAUL_COST",
    "tlm_shipment_joined_do_w_article_prepared"."REC_BUDG_STOP_COST" AS "REC_BUDG_STOP_COST",
    "tlm_shipment_joined_do_w_article_prepared"."REC_BUDG_CM_DISCOUNT" AS "REC_BUDG_CM_DISCOUNT",
    "tlm_shipment_joined_do_w_article_prepared"."REC_BUDG_ACCESSORIAL_COST" AS "REC_BUDG_ACCESSORIAL_COST",
    "tlm_shipment_joined_do_w_article_prepared"."REC_BUDG_TOTAL_COST" AS "REC_BUDG_TOTAL_COST",
    "tlm_shipment_joined_do_w_article_prepared"."REC_MARGIN" AS "REC_MARGIN",
    "tlm_shipment_joined_do_w_article_prepared"."REC_NORMALIZED_MARGIN" AS "REC_NORMALIZED_MARGIN",
    "tlm_shipment_joined_do_w_article_prepared"."REC_NORMALIZED_TOTAL_COST" AS "REC_NORMALIZED_TOTAL_COST",
    "tlm_shipment_joined_do_w_article_prepared"."REC_BUDG_NORMALIZED_TOTAL_COST" AS "REC_BUDG_NORMALIZED_TOTAL_COST",
    "tlm_shipment_joined_do_w_article_prepared"."BUDG_CURRENCY_CODE" AS "BUDG_CURRENCY_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."SPOT_CHARGE_CURRENCY_CODE" AS "SPOT_CHARGE_CURRENCY_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."REC_CURRENCY_CODE" AS "REC_CURRENCY_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."REC_BUDG_CURRENCY_CODE" AS "REC_BUDG_CURRENCY_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."REC_SPOT_CHARGE_CURRENCY_CODE" AS "REC_SPOT_CHARGE_CURRENCY_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."RATING_LANE_ID" AS "RATING_LANE_ID",
    "tlm_shipment_joined_do_w_article_prepared"."FRT_REV_RATING_LANE_ID" AS "FRT_REV_RATING_LANE_ID",
    "tlm_shipment_joined_do_w_article_prepared"."REC_RATING_LANE_ID" AS "REC_RATING_LANE_ID",
    "tlm_shipment_joined_do_w_article_prepared"."REC_BUDG_RATING_LANE_ID" AS "REC_BUDG_RATING_LANE_ID",
    "tlm_shipment_joined_do_w_article_prepared"."RATING_LANE_DETAIL_ID" AS "RATING_LANE_DETAIL_ID",
    "tlm_shipment_joined_do_w_article_prepared"."FRT_REV_RATING_LANE_DETAIL_ID" AS "FRT_REV_RATING_LANE_DETAIL_ID",
    "tlm_shipment_joined_do_w_article_prepared"."REC_RATING_LANE_DETAIL_ID" AS "REC_RATING_LANE_DETAIL_ID",
    "tlm_shipment_joined_do_w_article_prepared"."REC_BUDG_RATING_LANE_DETAIL_ID" AS "REC_BUDG_RATING_LANE_DETAIL_ID",
    "tlm_shipment_joined_do_w_article_prepared"."BUDG_CM_DISCOUNT" AS "BUDG_CM_DISCOUNT",
    "tlm_shipment_joined_do_w_article_prepared"."NORMALIZED_BASELINE_COST" AS "NORMALIZED_BASELINE_COST",
    "tlm_shipment_joined_do_w_article_prepared"."BASELINE_COST_CURRENCY_CODE" AS "BASELINE_COST_CURRENCY_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."REPORTED_COST" AS "REPORTED_COST",
    "tlm_shipment_joined_do_w_article_prepared"."TRACTOR_NUMBER" AS "TRACTOR_NUMBER",
    "tlm_shipment_joined_do_w_article_prepared"."IS_AUTO_DELIVERED" AS "IS_AUTO_DELIVERED",
    "tlm_shipment_joined_do_w_article_prepared"."SHIPMENT_TYPE" AS "SHIPMENT_TYPE",
    "tlm_shipment_joined_do_w_article_prepared"."ORIG_BUDG_TOTAL_COST" AS "ORIG_BUDG_TOTAL_COST",
    "tlm_shipment_joined_do_w_article_prepared"."ACCESSORIAL_COST_TO_CARRIER" AS "ACCESSORIAL_COST_TO_CARRIER",
    "tlm_shipment_joined_do_w_article_prepared"."CARRIER_CHARGE" AS "CARRIER_CHARGE",
    "tlm_shipment_joined_do_w_article_prepared"."ACTUAL_COST" AS "ACTUAL_COST",
    "tlm_shipment_joined_do_w_article_prepared"."EARNED_INCOME" AS "EARNED_INCOME",
    "tlm_shipment_joined_do_w_article_prepared"."SENT_TO_PKMS" AS "SENT_TO_PKMS",
    "tlm_shipment_joined_do_w_article_prepared"."IS_SHIPMENT_RECONCILED" AS "IS_SHIPMENT_RECONCILED",
    "tlm_shipment_joined_do_w_article_prepared"."DELIVERY_REQ" AS "DELIVERY_REQ",
    "tlm_shipment_joined_do_w_article_prepared"."DROPOFF_PICKUP" AS "DROPOFF_PICKUP",
    "tlm_shipment_joined_do_w_article_prepared"."PACKAGING" AS "PACKAGING",
    "tlm_shipment_joined_do_w_article_prepared"."SENT_TO_PKMS_DTTM" AS "SENT_TO_PKMS_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."WMS_STATUS_CODE" AS "WMS_STATUS_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."SPOT_CHARGE_AND_PAYEE_ACC" AS "SPOT_CHARGE_AND_PAYEE_ACC",
    "tlm_shipment_joined_do_w_article_prepared"."SPOT_CHARGE_AND_PAYEE_ACC_CC" AS "SPOT_CHARGE_AND_PAYEE_ACC_CC",
    "tlm_shipment_joined_do_w_article_prepared"."NORM_SPOT_CHARGE_AND_PAYEE_ACC" AS "NORM_SPOT_CHARGE_AND_PAYEE_ACC",
    "tlm_shipment_joined_do_w_article_prepared"."FACILITY_SCHEDULE_ID" AS "FACILITY_SCHEDULE_ID",
    "tlm_shipment_joined_do_w_article_prepared"."EARNED_INCOME_CURRENCY_CODE" AS "EARNED_INCOME_CURRENCY_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."ACTUAL_COST_CURRENCY_CODE" AS "ACTUAL_COST_CURRENCY_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."SHIPMENT_RECON_DTTM" AS "SHIPMENT_RECON_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."PLN_RATING_LANE_ID" AS "PLN_RATING_LANE_ID",
    "tlm_shipment_joined_do_w_article_prepared"."PLN_RATING_LANE_DETAIL_ID" AS "PLN_RATING_LANE_DETAIL_ID",
    "tlm_shipment_joined_do_w_article_prepared"."PLN_TOTAL_COST" AS "PLN_TOTAL_COST",
    "tlm_shipment_joined_do_w_article_prepared"."PLN_LINEHAUL_COST" AS "PLN_LINEHAUL_COST",
    "tlm_shipment_joined_do_w_article_prepared"."PLN_TOTAL_ACCESSORIAL_COST" AS "PLN_TOTAL_ACCESSORIAL_COST",
    "tlm_shipment_joined_do_w_article_prepared"."PLN_STOP_OFF_COST" AS "PLN_STOP_OFF_COST",
    "tlm_shipment_joined_do_w_article_prepared"."PLN_NORMALIZED_TOTAL_COST" AS "PLN_NORMALIZED_TOTAL_COST",
    "tlm_shipment_joined_do_w_article_prepared"."PLN_CURRENCY_CODE" AS "PLN_CURRENCY_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."PLN_ACCESSORL_COST_TO_CARRIER" AS "PLN_ACCESSORL_COST_TO_CARRIER",
    "tlm_shipment_joined_do_w_article_prepared"."PLN_CARRIER_CHARGE" AS "PLN_CARRIER_CHARGE",
    "tlm_shipment_joined_do_w_article_prepared"."WAYPOINT_TOTAL_COST" AS "WAYPOINT_TOTAL_COST",
    "tlm_shipment_joined_do_w_article_prepared"."WAYPOINT_HANDLING_COST" AS "WAYPOINT_HANDLING_COST",
    "tlm_shipment_joined_do_w_article_prepared"."GRS_OPERATION" AS "GRS_OPERATION",
    "tlm_shipment_joined_do_w_article_prepared"."IS_GRS_OPT_CYCLE_RUNNING" AS "IS_GRS_OPT_CYCLE_RUNNING",
    "tlm_shipment_joined_do_w_article_prepared"."IS_MANUAL_ASSIGN" AS "IS_MANUAL_ASSIGN",
    "tlm_shipment_joined_do_w_article_prepared"."LAST_RUN_GRS_DTTM" AS "LAST_RUN_GRS_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."GRS_MAX_SHIPMENT_STATUS" AS "GRS_MAX_SHIPMENT_STATUS",
    "tlm_shipment_joined_do_w_article_prepared"."PRIORITY_TYPE" AS "PRIORITY_TYPE",
    "tlm_shipment_joined_do_w_article_prepared"."MV_CURRENCY_CODE" AS "MV_CURRENCY_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."PROD_SCHED_REF_NUMBER" AS "PROD_SCHED_REF_NUMBER",
    "tlm_shipment_joined_do_w_article_prepared"."COMMODITY_CODE_ID" AS "COMMODITY_CODE_ID",
    "tlm_shipment_joined_do_w_article_prepared"."UN_NUMBER_ID" AS "UN_NUMBER_ID",
    "tlm_shipment_joined_do_w_article_prepared"."CONTRACT_NUMBER" AS "CONTRACT_NUMBER",
    "tlm_shipment_joined_do_w_article_prepared"."BOOKING_REF_SHIPPER" AS "BOOKING_REF_SHIPPER",
    "tlm_shipment_joined_do_w_article_prepared"."BOOKING_REF_CARRIER" AS "BOOKING_REF_CARRIER",
    "tlm_shipment_joined_do_w_article_prepared"."BK_RESOURCE_REF_EXTERNAL" AS "BK_RESOURCE_REF_EXTERNAL",
    "tlm_shipment_joined_do_w_article_prepared"."BK_RESOURCE_NAME_EXTERNAL" AS "BK_RESOURCE_NAME_EXTERNAL",
    "tlm_shipment_joined_do_w_article_prepared"."BK_O_FACILITY_ID" AS "BK_O_FACILITY_ID",
    "tlm_shipment_joined_do_w_article_prepared"."BK_D_FACILITY_ID" AS "BK_D_FACILITY_ID",
    "tlm_shipment_joined_do_w_article_prepared"."BK_MASTER_AIRWAY_BILL" AS "BK_MASTER_AIRWAY_BILL",
    "tlm_shipment_joined_do_w_article_prepared"."BK_FORWARDER_AIRWAY_BILL" AS "BK_FORWARDER_AIRWAY_BILL",
    "tlm_shipment_joined_do_w_article_prepared"."ASSIGNED_SCNDR_CARRIER_CODE" AS "ASSIGNED_SCNDR_CARRIER_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."CUSTOMER_CREDIT_LIMIT_ID" AS "CUSTOMER_CREDIT_LIMIT_ID",
    "tlm_shipment_joined_do_w_article_prepared"."SHIPMENT_LEG_TYPE" AS "SHIPMENT_LEG_TYPE",
    "tlm_shipment_joined_do_w_article_prepared"."SHIPMENT_CLOSED_INDICATOR" AS "SHIPMENT_CLOSED_INDICATOR",
    "tlm_shipment_joined_do_w_article_prepared"."OCEAN_ROUTING_STAGE" AS "OCEAN_ROUTING_STAGE",
    "tlm_shipment_joined_do_w_article_prepared"."BK_DEPARTURE_DTTM" AS "BK_DEPARTURE_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."BK_DEPARTURE_TZ" AS "BK_DEPARTURE_TZ",
    "tlm_shipment_joined_do_w_article_prepared"."BK_ARRIVAL_DTTM" AS "BK_ARRIVAL_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."BK_ARRIVAL_TZ" AS "BK_ARRIVAL_TZ",
    "tlm_shipment_joined_do_w_article_prepared"."BK_PICKUP_DTTM" AS "BK_PICKUP_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."BK_PICKUP_TZ" AS "BK_PICKUP_TZ",
    "tlm_shipment_joined_do_w_article_prepared"."BK_CUTOFF_DTTM" AS "BK_CUTOFF_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."BK_CUTOFF_TZ" AS "BK_CUTOFF_TZ",
    "tlm_shipment_joined_do_w_article_prepared"."NUM_CHARGE_LAYOVERS" AS "NUM_CHARGE_LAYOVERS",
    "tlm_shipment_joined_do_w_article_prepared"."RATE_TYPE" AS "RATE_TYPE",
    "tlm_shipment_joined_do_w_article_prepared"."RATE_UOM" AS "RATE_UOM",
    "tlm_shipment_joined_do_w_article_prepared"."PICK_START_DTTM" AS "PICK_START_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."PAPERWORK_START_DTTM" AS "PAPERWORK_START_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."VEHICLE_CHECK_START_DTTM" AS "VEHICLE_CHECK_START_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."SHIPMENT_START_DTTM" AS "SHIPMENT_START_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."SHIPMENT_END_DTTM" AS "SHIPMENT_END_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."FEASIBLE_DRIVER_TYPE" AS "FEASIBLE_DRIVER_TYPE",
    "tlm_shipment_joined_do_w_article_prepared"."WAVE_ID" AS "WAVE_ID",
    "tlm_shipment_joined_do_w_article_prepared"."ESTIMATED_DISPATCH_DTTM" AS "ESTIMATED_DISPATCH_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."TOTAL_TIME" AS "TOTAL_TIME",
    "tlm_shipment_joined_do_w_article_prepared"."LOC_REFERENCE" AS "LOC_REFERENCE",
    "tlm_shipment_joined_do_w_article_prepared"."BK_O_FACILITY_ALIAS_ID" AS "BK_O_FACILITY_ALIAS_ID",
    "tlm_shipment_joined_do_w_article_prepared"."BK_D_FACILITY_ALIAS_ID" AS "BK_D_FACILITY_ALIAS_ID",
    "tlm_shipment_joined_do_w_article_prepared"."EQUIP_UTIL_PER" AS "EQUIP_UTIL_PER",
    "tlm_shipment_joined_do_w_article_prepared"."MOVE_TYPE" AS "MOVE_TYPE",
    "tlm_shipment_joined_do_w_article_prepared"."DRIVER_TYPE_ID" AS "DRIVER_TYPE_ID",
    "tlm_shipment_joined_do_w_article_prepared"."EQUIPMENT_TYPE" AS "EQUIPMENT_TYPE",
    "tlm_shipment_joined_do_w_article_prepared"."RADIAL_DISTANCE" AS "RADIAL_DISTANCE",
    "tlm_shipment_joined_do_w_article_prepared"."RADIAL_DISTANCE_UOM" AS "RADIAL_DISTANCE_UOM",
    "tlm_shipment_joined_do_w_article_prepared"."DESIGNATED_TRACTOR_CODE" AS "DESIGNATED_TRACTOR_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."DESIGNATED_DRIVER_TYPE" AS "DESIGNATED_DRIVER_TYPE",
    "tlm_shipment_joined_do_w_article_prepared"."IS_WAVE_MAN_CHANGED" AS "IS_WAVE_MAN_CHANGED",
    "tlm_shipment_joined_do_w_article_prepared"."RETAIN_CONSOLIDATOR_TIMES" AS "RETAIN_CONSOLIDATOR_TIMES",
    "tlm_shipment_joined_do_w_article_prepared"."TARIFF" AS "TARIFF",
    "tlm_shipment_joined_do_w_article_prepared"."MIN_RATE" AS "MIN_RATE",
    "tlm_shipment_joined_do_w_article_prepared"."FIRST_UPDATE_SENT_TO_PKMS" AS "FIRST_UPDATE_SENT_TO_PKMS",
    "tlm_shipment_joined_do_w_article_prepared"."EVENT_IND_TYPEID" AS "EVENT_IND_TYPEID",
    "tlm_shipment_joined_do_w_article_prepared"."TANDEM_PATH_ID" AS "TANDEM_PATH_ID",
    "tlm_shipment_joined_do_w_article_prepared"."O_TANDEM_FACILITY" AS "O_TANDEM_FACILITY",
    "tlm_shipment_joined_do_w_article_prepared"."D_TANDEM_FACILITY" AS "D_TANDEM_FACILITY",
    "tlm_shipment_joined_do_w_article_prepared"."O_TANDEM_FACILITY_ALIAS" AS "O_TANDEM_FACILITY_ALIAS",
    "tlm_shipment_joined_do_w_article_prepared"."D_TANDEM_FACILITY_ALIAS" AS "D_TANDEM_FACILITY_ALIAS",
    "tlm_shipment_joined_do_w_article_prepared"."DELAY_TYPE" AS "DELAY_TYPE",
    "tlm_shipment_joined_do_w_article_prepared"."ASSIGNED_CARRIER_ID" AS "ASSIGNED_CARRIER_ID",
    "tlm_shipment_joined_do_w_article_prepared"."DSG_CARRIER_ID" AS "DSG_CARRIER_ID",
    "tlm_shipment_joined_do_w_article_prepared"."REC_CARRIER_ID" AS "REC_CARRIER_ID",
    "tlm_shipment_joined_do_w_article_prepared"."FEASIBLE_CARRIER_ID" AS "FEASIBLE_CARRIER_ID",
    "tlm_shipment_joined_do_w_article_prepared"."PAYEE_CARRIER_ID" AS "PAYEE_CARRIER_ID",
    "tlm_shipment_joined_do_w_article_prepared"."SCNDR_CARRIER_ID" AS "SCNDR_CARRIER_ID",
    "tlm_shipment_joined_do_w_article_prepared"."BROKER_CARRIER_ID" AS "BROKER_CARRIER_ID",
    "tlm_shipment_joined_do_w_article_prepared"."ASSIGNED_SCNDR_CARRIER_ID" AS "ASSIGNED_SCNDR_CARRIER_ID",
    "tlm_shipment_joined_do_w_article_prepared"."DSG_SCNDR_CARRIER_ID" AS "DSG_SCNDR_CARRIER_ID",
    "tlm_shipment_joined_do_w_article_prepared"."ASSIGNED_BROKER_CARRIER_ID" AS "ASSIGNED_BROKER_CARRIER_ID",
    "tlm_shipment_joined_do_w_article_prepared"."LH_PAYEE_CARRIER_ID" AS "LH_PAYEE_CARRIER_ID",
    "tlm_shipment_joined_do_w_article_prepared"."REC_BROKER_CARRIER_ID" AS "REC_BROKER_CARRIER_ID",
    "tlm_shipment_joined_do_w_article_prepared"."ASSIGNED_EQUIPMENT_ID" AS "ASSIGNED_EQUIPMENT_ID",
    "tlm_shipment_joined_do_w_article_prepared"."DSG_EQUIPMENT_ID" AS "DSG_EQUIPMENT_ID",
    "tlm_shipment_joined_do_w_article_prepared"."FEASIBLE_EQUIPMENT_ID" AS "FEASIBLE_EQUIPMENT_ID",
    "tlm_shipment_joined_do_w_article_prepared"."FEASIBLE_EQUIPMENT2_ID" AS "FEASIBLE_EQUIPMENT2_ID",
    "tlm_shipment_joined_do_w_article_prepared"."REC_EQUIPMENT_ID" AS "REC_EQUIPMENT_ID",
    "tlm_shipment_joined_do_w_article_prepared"."ASSIGNED_MOT_ID" AS "ASSIGNED_MOT_ID",
    "tlm_shipment_joined_do_w_article_prepared"."DSG_MOT_ID" AS "DSG_MOT_ID",
    "tlm_shipment_joined_do_w_article_prepared"."FEASIBLE_MOT_ID" AS "FEASIBLE_MOT_ID",
    "tlm_shipment_joined_do_w_article_prepared"."REC_MOT_ID" AS "REC_MOT_ID",
    "tlm_shipment_joined_do_w_article_prepared"."PRODUCT_CLASS_ID" AS "PRODUCT_CLASS_ID",
    "tlm_shipment_joined_do_w_article_prepared"."PROTECTION_LEVEL_ID" AS "PROTECTION_LEVEL_ID",
    "tlm_shipment_joined_do_w_article_prepared"."ASSIGNED_SERVICE_LEVEL_ID" AS "ASSIGNED_SERVICE_LEVEL_ID",
    "tlm_shipment_joined_do_w_article_prepared"."DSG_SERVICE_LEVEL_ID" AS "DSG_SERVICE_LEVEL_ID",
    "tlm_shipment_joined_do_w_article_prepared"."FEASIBLE_SERVICE_LEVEL_ID" AS "FEASIBLE_SERVICE_LEVEL_ID",
    "tlm_shipment_joined_do_w_article_prepared"."REC_SERVICE_LEVEL_ID" AS "REC_SERVICE_LEVEL_ID",
    "tlm_shipment_joined_do_w_article_prepared"."HAS_EM_NOTIFY_FLAG" AS "HAS_EM_NOTIFY_FLAG",
    "tlm_shipment_joined_do_w_article_prepared"."REGION_ID" AS "REGION_ID",
    "tlm_shipment_joined_do_w_article_prepared"."INBOUND_REGION_ID" AS "INBOUND_REGION_ID",
    "tlm_shipment_joined_do_w_article_prepared"."OUTBOUND_REGION_ID" AS "OUTBOUND_REGION_ID",
    "tlm_shipment_joined_do_w_article_prepared"."FINANCIAL_WT" AS "FINANCIAL_WT",
    "tlm_shipment_joined_do_w_article_prepared"."IS_BOOKING_REQUIRED" AS "IS_BOOKING_REQUIRED",
    "tlm_shipment_joined_do_w_article_prepared"."TOTAL_COST_EXCL_TAX" AS "TOTAL_COST_EXCL_TAX",
    "tlm_shipment_joined_do_w_article_prepared"."TOTAL_TAX_AMOUNT" AS "TOTAL_TAX_AMOUNT",
    "tlm_shipment_joined_do_w_article_prepared"."IS_ASSOCIATED_TO_OUTBOUND" AS "IS_ASSOCIATED_TO_OUTBOUND",
    "tlm_shipment_joined_do_w_article_prepared"."RECEIVED_DTTM" AS "RECEIVED_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."BOOKING_ID" AS "BOOKING_ID",
    "tlm_shipment_joined_do_w_article_prepared"."IS_MISROUTED" AS "IS_MISROUTED",
    "tlm_shipment_joined_do_w_article_prepared"."FEASIBLE_CARRIER_CODE" AS "FEASIBLE_CARRIER_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."SHIPMENT_WIN_ADJ_FLAG" AS "SHIPMENT_WIN_ADJ_FLAG",
    "tlm_shipment_joined_do_w_article_prepared"."DT_PARAM_SET_ID" AS "DT_PARAM_SET_ID",
    "tlm_shipment_joined_do_w_article_prepared"."MERCHANDIZING_DEPARTMENT_ID" AS "MERCHANDIZING_DEPARTMENT_ID",
    "tlm_shipment_joined_do_w_article_prepared"."STATIC_ROUTE_ID" AS "STATIC_ROUTE_ID",
    "tlm_shipment_joined_do_w_article_prepared"."IS_FILO" AS "IS_FILO",
    "tlm_shipment_joined_do_w_article_prepared"."IS_COOLER_AT_NOSE" AS "IS_COOLER_AT_NOSE",
    "tlm_shipment_joined_do_w_article_prepared"."AUTH_NBR" AS "AUTH_NBR",
    "tlm_shipment_joined_do_w_article_prepared"."CONS_LOCN_ID" AS "CONS_LOCN_ID",
    "tlm_shipment_joined_do_w_article_prepared"."RTE_TYPE" AS "RTE_TYPE",
    "tlm_shipment_joined_do_w_article_prepared"."TRLR_TYPE" AS "TRLR_TYPE",
    "tlm_shipment_joined_do_w_article_prepared"."TRLR_SIZE" AS "TRLR_SIZE",
    "tlm_shipment_joined_do_w_article_prepared"."CONS_ADDR_CODE" AS "CONS_ADDR_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."HUB_ID" AS "HUB_ID",
    "tlm_shipment_joined_do_w_article_prepared"."TRLR_GEN_CODE" AS "TRLR_GEN_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."MAX_NBR_OF_CTNS" AS "MAX_NBR_OF_CTNS",
    "tlm_shipment_joined_do_w_article_prepared"."APPT_DOOR_SCHED_TYPE" AS "APPT_DOOR_SCHED_TYPE",
    "tlm_shipment_joined_do_w_article_prepared"."CREATED_SOURCE_TYPE" AS "CREATED_SOURCE_TYPE",
    "tlm_shipment_joined_do_w_article_prepared"."CREATED_SOURCE" AS "CREATED_SOURCE",
    "tlm_shipment_joined_do_w_article_prepared"."CREATED_DTTM" AS "CREATED_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."LAST_UPDATED_SOURCE_TYPE" AS "LAST_UPDATED_SOURCE_TYPE",
    "tlm_shipment_joined_do_w_article_prepared"."LAST_UPDATED_SOURCE" AS "LAST_UPDATED_SOURCE",
    "tlm_shipment_joined_do_w_article_prepared"."LAST_UPDATED_DTTM" AS "LAST_UPDATED_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."DSG_SCNDR_CARRIER_CODE" AS "DSG_SCNDR_CARRIER_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."LH_PAYEE_CARRIER_CODE" AS "LH_PAYEE_CARRIER_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."REC_BROKER_CARRIER_CODE" AS "REC_BROKER_CARRIER_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."REC_CARRIER_CODE" AS "REC_CARRIER_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."LPN_ASSIGNMENT_STOPPED" AS "LPN_ASSIGNMENT_STOPPED",
    "tlm_shipment_joined_do_w_article_prepared"."SEAL_NUMBER" AS "SEAL_NUMBER",
    "tlm_shipment_joined_do_w_article_prepared"."HIBERNATE_VERSION" AS "HIBERNATE_VERSION",
    "tlm_shipment_joined_do_w_article_prepared"."SHIP_GROUP_ID" AS "SHIP_GROUP_ID",
    "tlm_shipment_joined_do_w_article_prepared"."RATE" AS "RATE",
    "tlm_shipment_joined_do_w_article_prepared"."MONETARY_VALUE" AS "MONETARY_VALUE",
    "tlm_shipment_joined_do_w_article_prepared"."DOOR" AS "DOOR",
    "tlm_shipment_joined_do_w_article_prepared"."RTE_TYPE_1" AS "RTE_TYPE_1",
    "tlm_shipment_joined_do_w_article_prepared"."RTE_TYPE_2" AS "RTE_TYPE_2",
    "tlm_shipment_joined_do_w_article_prepared"."SCHEDULED_PICKUP_DTTM" AS "SCHEDULED_PICKUP_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."MANIFEST_ID" AS "MANIFEST_ID",
    "tlm_shipment_joined_do_w_article_prepared"."DAYS_TO_DELIVER" AS "DAYS_TO_DELIVER",
    "tlm_shipment_joined_do_w_article_prepared"."SED_GENERATED_FLAG" AS "SED_GENERATED_FLAG",
    "tlm_shipment_joined_do_w_article_prepared"."SERV_AREA_CODE" AS "SERV_AREA_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."TENDER_RESP_DEADLINE_DTTM" AS "TENDER_RESP_DEADLINE_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."PRINT_CONS_BOL" AS "PRINT_CONS_BOL",
    "tlm_shipment_joined_do_w_article_prepared"."LEFT_WT" AS "LEFT_WT",
    "tlm_shipment_joined_do_w_article_prepared"."RIGHT_WT" AS "RIGHT_WT",
    "tlm_shipment_joined_do_w_article_prepared"."LANE_NAME" AS "LANE_NAME",
    "tlm_shipment_joined_do_w_article_prepared"."DECLARED_VALUE" AS "DECLARED_VALUE",
    "tlm_shipment_joined_do_w_article_prepared"."DV_CURRENCY_CODE" AS "DV_CURRENCY_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."COD_AMOUNT" AS "COD_AMOUNT",
    "tlm_shipment_joined_do_w_article_prepared"."CUSTOMER_ID" AS "CUSTOMER_ID",
    "tlm_shipment_joined_do_w_article_prepared"."CUST_FRGT_CHARGE" AS "CUST_FRGT_CHARGE",
    "tlm_shipment_joined_do_w_article_prepared"."COD_CURRENCY_CODE" AS "COD_CURRENCY_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."PLANNED_WEIGHT" AS "PLANNED_WEIGHT",
    "tlm_shipment_joined_do_w_article_prepared"."WEIGHT_UOM_ID_BASE" AS "WEIGHT_UOM_ID_BASE",
    "tlm_shipment_joined_do_w_article_prepared"."PLANNED_VOLUME" AS "PLANNED_VOLUME",
    "tlm_shipment_joined_do_w_article_prepared"."VOLUME_UOM_ID_BASE" AS "VOLUME_UOM_ID_BASE",
    "tlm_shipment_joined_do_w_article_prepared"."SIZE1_VALUE" AS "SIZE1_VALUE",
    "tlm_shipment_joined_do_w_article_prepared"."SIZE1_UOM_ID" AS "SIZE1_UOM_ID",
    "tlm_shipment_joined_do_w_article_prepared"."SIZE2_VALUE" AS "SIZE2_VALUE",
    "tlm_shipment_joined_do_w_article_prepared"."SIZE2_UOM_ID" AS "SIZE2_UOM_ID",
    "tlm_shipment_joined_do_w_article_prepared"."ASSIGNED_SHIP_VIA" AS "ASSIGNED_SHIP_VIA",
    "tlm_shipment_joined_do_w_article_prepared"."INSURANCE_STATUS" AS "INSURANCE_STATUS",
    "tlm_shipment_joined_do_w_article_prepared"."RTE_SWC_NBR" AS "RTE_SWC_NBR",
    "tlm_shipment_joined_do_w_article_prepared"."RTE_TO" AS "RTE_TO",
    "tlm_shipment_joined_do_w_article_prepared"."BILL_OF_LADING_NUMBER" AS "BILL_OF_LADING_NUMBER",
    "tlm_shipment_joined_do_w_article_prepared"."TRAILER_NUMBER" AS "TRAILER_NUMBER",
    "tlm_shipment_joined_do_w_article_prepared"."TRANS_PLAN_OWNER" AS "TRANS_PLAN_OWNER",
    "tlm_shipment_joined_do_w_article_prepared"."TOTAL_REVENUE_CURRENCY_CODE" AS "TOTAL_REVENUE_CURRENCY_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."TOTAL_REVENUE" AS "TOTAL_REVENUE",
    "tlm_shipment_joined_do_w_article_prepared"."FRT_REV_SPOT_CHARGE_CURR_CODE" AS "FRT_REV_SPOT_CHARGE_CURR_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."NORMALIZED_TOTAL_REVENUE" AS "NORMALIZED_TOTAL_REVENUE",
    "tlm_shipment_joined_do_w_article_prepared"."FRT_REV_SPOT_CHARGE" AS "FRT_REV_SPOT_CHARGE",
    "tlm_shipment_joined_do_w_article_prepared"."DSG_VOYAGE_FLIGHT" AS "DSG_VOYAGE_FLIGHT",
    "tlm_shipment_joined_do_w_article_prepared"."FEASIBLE_VOYAGE_FLIGHT" AS "FEASIBLE_VOYAGE_FLIGHT",
    "tlm_shipment_joined_do_w_article_prepared"."CURRENCY_DTTM" AS "CURRENCY_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."FRT_REV_LINEHAUL_CHARGE" AS "FRT_REV_LINEHAUL_CHARGE",
    "tlm_shipment_joined_do_w_article_prepared"."FRT_REV_STOP_CHARGE" AS "FRT_REV_STOP_CHARGE",
    "tlm_shipment_joined_do_w_article_prepared"."FRT_REV_ACCESSORIAL_CHARGE" AS "FRT_REV_ACCESSORIAL_CHARGE",
    "tlm_shipment_joined_do_w_article_prepared"."MARGIN" AS "MARGIN",
    "tlm_shipment_joined_do_w_article_prepared"."INCOTERM_ID" AS "INCOTERM_ID",
    "tlm_shipment_joined_do_w_article_prepared"."ORDER_QTY" AS "ORDER_QTY",
    "tlm_shipment_joined_do_w_article_prepared"."QTY_UOM_ID" AS "QTY_UOM_ID",
    "tlm_shipment_joined_do_w_article_prepared"."REF_SHIPMENT_NBR" AS "REF_SHIPMENT_NBR",
    "tlm_shipment_joined_do_w_article_prepared"."STAGING_LOCN_ID" AS "STAGING_LOCN_ID",
    "tlm_shipment_joined_do_w_article_prepared"."LOADING_SEQ_ORD" AS "LOADING_SEQ_ORD",
    "tlm_shipment_joined_do_w_article_prepared"."HAZMAT_CERT_CONTACT" AS "HAZMAT_CERT_CONTACT",
    "tlm_shipment_joined_do_w_article_prepared"."HAZMAT_CERT_DECLARATION" AS "HAZMAT_CERT_DECLARATION",
    "tlm_shipment_joined_do_w_article_prepared"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP",
    "tlm_shipment_joined_do_w_article_prepared"."OPERATION_TYPE" AS "OPERATION_TYPE",
    "tlm_shipment_joined_do_w_article_prepared"."ARCHIVED_DTTM" AS "ARCHIVED_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."ORIGIN" AS "ORIGIN",
    "tlm_shipment_joined_do_w_article_prepared"."FINAL_DESTINATION" AS "FINAL_DESTINATION",
    "tlm_shipment_joined_do_w_article_prepared"."actual_delivery_date_parsed" AS "actual_delivery_date_parsed",
    "tlm_shipment_joined_do_w_article_prepared"."wood_pellet" AS "wood_pellet",
    "tlm_shipment_joined_do_w_article_prepared"."act_del_MERCH_YEAR" AS "act_del_MERCH_YEAR",
    "tlm_shipment_joined_do_w_article_prepared"."act_del_YEAR_WEEK" AS "act_del_YEAR_WEEK",
    "tlm_shipment_joined_do_w_article_prepared"."act_del_YEAR_QUARTER" AS "act_del_YEAR_QUARTER",
    "tlm_shipment_joined_do_w_article_prepared"."act_del_YEAR_PERIOD" AS "act_del_YEAR_PERIOD",
    "tlm_shipment_joined_do_w_article_prepared"."invoice_shipping_id" AS "invoice_shipping_id",
    "tlm_shipment_joined_do_w_article_prepared"."TOTAL_COST" AS "TOTAL_COST",
    "tlm_shipment_joined_do_w_article_prepared"."org_Facility_Code" AS "org_Facility_Code",
    "tlm_shipment_joined_do_w_article_prepared"."org_Facility_Name" AS "org_Facility_Name",
    "tlm_shipment_joined_do_w_article_prepared"."org_Facility_Type" AS "org_Facility_Type",
    "tlm_shipment_joined_do_w_article_prepared"."dest_Facility_Code" AS "dest_Facility_Code",
    "tlm_shipment_joined_do_w_article_prepared"."dest_Facility_Name" AS "dest_Facility_Name",
    "tlm_shipment_joined_do_w_article_prepared"."dest_Facility_Type" AS "dest_Facility_Type",
    "tlm_shipment_joined_do_w_article_prepared"."inbound_flag" AS "inbound_flag",
    "tlm_shipment_joined_do_w_article_prepared"."do_ORDER_ID" AS "do_ORDER_ID",
    "tlm_shipment_joined_do_w_article_prepared"."do_ORDER_ID_2" AS "do_ORDER_ID_2",
    "tlm_shipment_joined_do_w_article_prepared"."do_LINE_ITEM_ID" AS "do_LINE_ITEM_ID",
    "tlm_shipment_joined_do_w_article_prepared"."do_PARENT_LINE_ITEM_ID" AS "do_PARENT_LINE_ITEM_ID",
    "tlm_shipment_joined_do_w_article_prepared"."do_TC_COMPANY_ID" AS "do_TC_COMPANY_ID",
    "tlm_shipment_joined_do_w_article_prepared"."do_COMMODITY_CLASS" AS "do_COMMODITY_CLASS",
    "tlm_shipment_joined_do_w_article_prepared"."do_REF_FIELD1" AS "do_REF_FIELD1",
    "tlm_shipment_joined_do_w_article_prepared"."do_REF_FIELD2" AS "do_REF_FIELD2",
    "tlm_shipment_joined_do_w_article_prepared"."do_REF_FIELD3" AS "do_REF_FIELD3",
    "tlm_shipment_joined_do_w_article_prepared"."do_EXT_SYS_LINE_ITEM_ID" AS "do_EXT_SYS_LINE_ITEM_ID",
    "tlm_shipment_joined_do_w_article_prepared"."do_MASTER_ORDER_ID" AS "do_MASTER_ORDER_ID",
    "tlm_shipment_joined_do_w_article_prepared"."do_MO_LINE_ITEM_ID" AS "do_MO_LINE_ITEM_ID",
    "tlm_shipment_joined_do_w_article_prepared"."do_IS_STACKABLE" AS "do_IS_STACKABLE",
    "tlm_shipment_joined_do_w_article_prepared"."do_HAS_ERRORS" AS "do_HAS_ERRORS",
    "tlm_shipment_joined_do_w_article_prepared"."do_ORIG_BUDG_COST" AS "do_ORIG_BUDG_COST",
    "tlm_shipment_joined_do_w_article_prepared"."do_BUDG_COST_CURRENCY_CODE" AS "do_BUDG_COST_CURRENCY_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."do_BUDG_COST" AS "do_BUDG_COST",
    "tlm_shipment_joined_do_w_article_prepared"."do_ACTUAL_COST_CURRENCY_CODE" AS "do_ACTUAL_COST_CURRENCY_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."do_TOTAL_MONETARY_VALUE" AS "do_TOTAL_MONETARY_VALUE",
    "tlm_shipment_joined_do_w_article_prepared"."do_UNIT_MONETARY_VALUE" AS "do_UNIT_MONETARY_VALUE",
    "tlm_shipment_joined_do_w_article_prepared"."do_UNIT_TAX_AMOUNT" AS "do_UNIT_TAX_AMOUNT",
    "tlm_shipment_joined_do_w_article_prepared"."do_RTS_ID" AS "do_RTS_ID",
    "tlm_shipment_joined_do_w_article_prepared"."do_RTS_LINE_ITEM_ID" AS "do_RTS_LINE_ITEM_ID",
    "tlm_shipment_joined_do_w_article_prepared"."do_STD_PACK_QTY" AS "do_STD_PACK_QTY",
    "tlm_shipment_joined_do_w_article_prepared"."do_PRODUCT_CLASS_ID" AS "do_PRODUCT_CLASS_ID",
    "tlm_shipment_joined_do_w_article_prepared"."do_PROTECTION_LEVEL_ID" AS "do_PROTECTION_LEVEL_ID",
    "tlm_shipment_joined_do_w_article_prepared"."do_PACKAGE_TYPE_ID" AS "do_PACKAGE_TYPE_ID",
    "tlm_shipment_joined_do_w_article_prepared"."do_COMMODITY_CODE_ID" AS "do_COMMODITY_CODE_ID",
    "tlm_shipment_joined_do_w_article_prepared"."do_MV_SIZE_UOM_ID" AS "do_MV_SIZE_UOM_ID",
    "tlm_shipment_joined_do_w_article_prepared"."do_QTY_UOM_ID_BASE" AS "do_QTY_UOM_ID_BASE",
    "tlm_shipment_joined_do_w_article_prepared"."do_MV_CURRENCY_CODE" AS "do_MV_CURRENCY_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."do_SHIPPED_QTY" AS "do_SHIPPED_QTY",
    "tlm_shipment_joined_do_w_article_prepared"."do_RECEIVED_QTY" AS "do_RECEIVED_QTY",
    "tlm_shipment_joined_do_w_article_prepared"."do_PRIORITY" AS "do_PRIORITY",
    "tlm_shipment_joined_do_w_article_prepared"."do_MERCHANDIZING_DEPARTMENT_ID" AS "do_MERCHANDIZING_DEPARTMENT_ID",
    "tlm_shipment_joined_do_w_article_prepared"."do_UN_NUMBER_ID" AS "do_UN_NUMBER_ID",
    "tlm_shipment_joined_do_w_article_prepared"."do_PICKUP_REFERENCE_NUMBER" AS "do_PICKUP_REFERENCE_NUMBER",
    "tlm_shipment_joined_do_w_article_prepared"."do_DELIVERY_REFERENCE_NUMBER" AS "do_DELIVERY_REFERENCE_NUMBER",
    "tlm_shipment_joined_do_w_article_prepared"."do_CNTRY_OF_ORGN" AS "do_CNTRY_OF_ORGN",
    "tlm_shipment_joined_do_w_article_prepared"."do_PROD_STAT" AS "do_PROD_STAT",
    "tlm_shipment_joined_do_w_article_prepared"."do_STACK_RANK" AS "do_STACK_RANK",
    "tlm_shipment_joined_do_w_article_prepared"."do_STACK_LENGTH_VALUE" AS "do_STACK_LENGTH_VALUE",
    "tlm_shipment_joined_do_w_article_prepared"."do_STACK_LENGTH_STANDARD_UOM" AS "do_STACK_LENGTH_STANDARD_UOM",
    "tlm_shipment_joined_do_w_article_prepared"."do_STACK_WIDTH_VALUE" AS "do_STACK_WIDTH_VALUE",
    "tlm_shipment_joined_do_w_article_prepared"."do_STACK_WIDTH_STANDARD_UOM" AS "do_STACK_WIDTH_STANDARD_UOM",
    "tlm_shipment_joined_do_w_article_prepared"."do_STACK_HEIGHT_VALUE" AS "do_STACK_HEIGHT_VALUE",
    "tlm_shipment_joined_do_w_article_prepared"."do_STACK_HEIGHT_STANDARD_UOM" AS "do_STACK_HEIGHT_STANDARD_UOM",
    "tlm_shipment_joined_do_w_article_prepared"."do_STACK_DIAMETER_VALUE" AS "do_STACK_DIAMETER_VALUE",
    "tlm_shipment_joined_do_w_article_prepared"."do_STACK_DIAMETER_STANDARD_UOM" AS "do_STACK_DIAMETER_STANDARD_UOM",
    "tlm_shipment_joined_do_w_article_prepared"."do_CUBE_MULTIPLE_QTY" AS "do_CUBE_MULTIPLE_QTY",
    "tlm_shipment_joined_do_w_article_prepared"."do_DO_DTL_STATUS" AS "do_DO_DTL_STATUS",
    "tlm_shipment_joined_do_w_article_prepared"."do_INTERNAL_ORDER_SEQ_NBR" AS "do_INTERNAL_ORDER_SEQ_NBR",
    "tlm_shipment_joined_do_w_article_prepared"."do_IS_EMERGENCY" AS "do_IS_EMERGENCY",
    "tlm_shipment_joined_do_w_article_prepared"."do_LPN_SIZE" AS "do_LPN_SIZE",
    "tlm_shipment_joined_do_w_article_prepared"."do_MANUFACTURING_DTTM" AS "do_MANUFACTURING_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."do_ORDER_LINE_ID" AS "do_ORDER_LINE_ID",
    "tlm_shipment_joined_do_w_article_prepared"."do_PACK_RATE" AS "do_PACK_RATE",
    "tlm_shipment_joined_do_w_article_prepared"."do_ALLOCATED_QTY" AS "do_ALLOCATED_QTY",
    "tlm_shipment_joined_do_w_article_prepared"."do_PLANNED_SHIP_DATE" AS "do_PLANNED_SHIP_DATE",
    "tlm_shipment_joined_do_w_article_prepared"."do_PPACK_QTY" AS "do_PPACK_QTY",
    "tlm_shipment_joined_do_w_article_prepared"."do_STD_BUNDLE_QTY" AS "do_STD_BUNDLE_QTY",
    "tlm_shipment_joined_do_w_article_prepared"."do_STD_LPN_QTY" AS "do_STD_LPN_QTY",
    "tlm_shipment_joined_do_w_article_prepared"."do_STD_LPN_VOL" AS "do_STD_LPN_VOL",
    "tlm_shipment_joined_do_w_article_prepared"."do_STD_LPN_WT" AS "do_STD_LPN_WT",
    "tlm_shipment_joined_do_w_article_prepared"."do_UNIT_COST" AS "do_UNIT_COST",
    "tlm_shipment_joined_do_w_article_prepared"."do_UNIT_PRICE_AMOUNT" AS "do_UNIT_PRICE_AMOUNT",
    "tlm_shipment_joined_do_w_article_prepared"."do_UNIT_VOL" AS "do_UNIT_VOL",
    "tlm_shipment_joined_do_w_article_prepared"."do_UNIT_WT" AS "do_UNIT_WT",
    "tlm_shipment_joined_do_w_article_prepared"."do_USER_CANCELED_QTY" AS "do_USER_CANCELED_QTY",
    "tlm_shipment_joined_do_w_article_prepared"."do_WAVE_PROC_TYPE" AS "do_WAVE_PROC_TYPE",
    "tlm_shipment_joined_do_w_article_prepared"."do_EVENT_CODE" AS "do_EVENT_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."do_REASON_CODE" AS "do_REASON_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."do_EXP_INFO_CODE" AS "do_EXP_INFO_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."do_PARTL_FILL" AS "do_PARTL_FILL",
    "tlm_shipment_joined_do_w_article_prepared"."do_LINE_TYPE" AS "do_LINE_TYPE",
    "tlm_shipment_joined_do_w_article_prepared"."do_REPL_PROC_TYPE" AS "do_REPL_PROC_TYPE",
    "tlm_shipment_joined_do_w_article_prepared"."do_ORDER_QTY" AS "do_ORDER_QTY",
    "tlm_shipment_joined_do_w_article_prepared"."do_ORIG_ORDER_QTY" AS "do_ORIG_ORDER_QTY",
    "tlm_shipment_joined_do_w_article_prepared"."do_RTL_TO_BE_DISTROED_QTY" AS "do_RTL_TO_BE_DISTROED_QTY",
    "tlm_shipment_joined_do_w_article_prepared"."do_PRICE" AS "do_PRICE",
    "tlm_shipment_joined_do_w_article_prepared"."do_RETAIL_PRICE" AS "do_RETAIL_PRICE",
    "tlm_shipment_joined_do_w_article_prepared"."do_UNITS_PAKD" AS "do_UNITS_PAKD",
    "tlm_shipment_joined_do_w_article_prepared"."do_MINOR_ORDER_NBR" AS "do_MINOR_ORDER_NBR",
    "tlm_shipment_joined_do_w_article_prepared"."do_ITEM_ID" AS "do_ITEM_ID",
    "tlm_shipment_joined_do_w_article_prepared"."do_TC_ORDER_LINE_ID" AS "do_TC_ORDER_LINE_ID",
    "tlm_shipment_joined_do_w_article_prepared"."do_ACTUAL_SHIPPED_DTTM" AS "do_ACTUAL_SHIPPED_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."do_QTY_UOM_ID" AS "do_QTY_UOM_ID",
    "tlm_shipment_joined_do_w_article_prepared"."do_PICKUP_END_DTTM" AS "do_PICKUP_END_DTTM",
    "tlm_shipment_joined_do_w_article_prepared"."do_PURCHASE_ORDER_LINE_NUMBER" AS "do_PURCHASE_ORDER_LINE_NUMBER",
    "tlm_shipment_joined_do_w_article_prepared"."do_REFERENCE_LINE_ITEM_ID" AS "do_REFERENCE_LINE_ITEM_ID",
    "tlm_shipment_joined_do_w_article_prepared"."do_REFERENCE_ORDER_ID" AS "do_REFERENCE_ORDER_ID",
    "tlm_shipment_joined_do_w_article_prepared"."do_REPL_WAVE_RUN" AS "do_REPL_WAVE_RUN",
    "tlm_shipment_joined_do_w_article_prepared"."do_STD_PALLET_QTY" AS "do_STD_PALLET_QTY",
    "tlm_shipment_joined_do_w_article_prepared"."do_STD_SUB_PACK_QTY" AS "do_STD_SUB_PACK_QTY",
    "tlm_shipment_joined_do_w_article_prepared"."do_STORE_DEPT" AS "do_STORE_DEPT",
    "tlm_shipment_joined_do_w_article_prepared"."do_ALLOC_TYPE" AS "do_ALLOC_TYPE",
    "tlm_shipment_joined_do_w_article_prepared"."do_BATCH_NBR" AS "do_BATCH_NBR",
    "tlm_shipment_joined_do_w_article_prepared"."do_BATCH_REQUIREMENT_TYPE" AS "do_BATCH_REQUIREMENT_TYPE",
    "tlm_shipment_joined_do_w_article_prepared"."do_CHUTE_ASSIGN_TYPE" AS "do_CHUTE_ASSIGN_TYPE",
    "tlm_shipment_joined_do_w_article_prepared"."do_CUSTOM_TAG" AS "do_CUSTOM_TAG",
    "tlm_shipment_joined_do_w_article_prepared"."do_CUSTOMER_ITEM" AS "do_CUSTOMER_ITEM",
    "tlm_shipment_joined_do_w_article_prepared"."do_INTERNAL_ORDER_ID" AS "do_INTERNAL_ORDER_ID",
    "tlm_shipment_joined_do_w_article_prepared"."do_INVN_TYPE" AS "do_INVN_TYPE",
    "tlm_shipment_joined_do_w_article_prepared"."do_ITEM_ATTR_1" AS "do_ITEM_ATTR_1",
    "tlm_shipment_joined_do_w_article_prepared"."do_ITEM_ATTR_2" AS "do_ITEM_ATTR_2",
    "tlm_shipment_joined_do_w_article_prepared"."do_ITEM_ATTR_3" AS "do_ITEM_ATTR_3",
    "tlm_shipment_joined_do_w_article_prepared"."do_ITEM_ATTR_4" AS "do_ITEM_ATTR_4",
    "tlm_shipment_joined_do_w_article_prepared"."do_ITEM_ATTR_5" AS "do_ITEM_ATTR_5",
    "tlm_shipment_joined_do_w_article_prepared"."do_LPN_BRK_ATTRIB" AS "do_LPN_BRK_ATTRIB",
    "tlm_shipment_joined_do_w_article_prepared"."do_MERCH_GRP" AS "do_MERCH_GRP",
    "tlm_shipment_joined_do_w_article_prepared"."do_MERCH_TYPE" AS "do_MERCH_TYPE",
    "tlm_shipment_joined_do_w_article_prepared"."do_PACK_ZONE" AS "do_PACK_ZONE",
    "tlm_shipment_joined_do_w_article_prepared"."do_PALLET_TYPE" AS "do_PALLET_TYPE",
    "tlm_shipment_joined_do_w_article_prepared"."do_PICK_LOCN_ASSIGN_TYPE" AS "do_PICK_LOCN_ASSIGN_TYPE",
    "tlm_shipment_joined_do_w_article_prepared"."do_PICK_LOCN_ID" AS "do_PICK_LOCN_ID",
    "tlm_shipment_joined_do_w_article_prepared"."do_PPACK_GRP_CODE" AS "do_PPACK_GRP_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."do_PRICE_TKT_TYPE" AS "do_PRICE_TKT_TYPE",
    "tlm_shipment_joined_do_w_article_prepared"."do_SERIAL_NUMBER_REQUIRED_FLAG" AS "do_SERIAL_NUMBER_REQUIRED_FLAG",
    "tlm_shipment_joined_do_w_article_prepared"."do_SKU_GTIN" AS "do_SKU_GTIN",
    "tlm_shipment_joined_do_w_article_prepared"."do_SKU_SUB_CODE_ID" AS "do_SKU_SUB_CODE_ID",
    "tlm_shipment_joined_do_w_article_prepared"."do_SKU_SUB_CODE_VALUE" AS "do_SKU_SUB_CODE_VALUE",
    "tlm_shipment_joined_do_w_article_prepared"."do_VAS_PROCESS_TYPE" AS "do_VAS_PROCESS_TYPE",
    "tlm_shipment_joined_do_w_article_prepared"."do_SUBSTITUTED_PARENT_LINE_ID" AS "do_SUBSTITUTED_PARENT_LINE_ID",
    "tlm_shipment_joined_do_w_article_prepared"."do_IS_CANCELLED" AS "do_IS_CANCELLED",
    "tlm_shipment_joined_do_w_article_prepared"."do_ITEM_NAME" AS "do_ITEM_NAME",
    "tlm_shipment_joined_do_w_article_prepared"."do_ALLOC_LINE_ID" AS "do_ALLOC_LINE_ID",
    "tlm_shipment_joined_do_w_article_prepared"."do_ALLOCATION_SOURCE_ID" AS "do_ALLOCATION_SOURCE_ID",
    "tlm_shipment_joined_do_w_article_prepared"."do_ALLOCATION_SOURCE_LINE_ID" AS "do_ALLOCATION_SOURCE_LINE_ID",
    "tlm_shipment_joined_do_w_article_prepared"."do_ALLOCATION_SOURCE" AS "do_ALLOCATION_SOURCE",
    "tlm_shipment_joined_do_w_article_prepared"."do_SHELF_DAYS" AS "do_SHELF_DAYS",
    "tlm_shipment_joined_do_w_article_prepared"."do_FULFILLMENT_TYPE" AS "do_FULFILLMENT_TYPE",
    "tlm_shipment_joined_do_w_article_prepared"."do_WAVE_NBR" AS "do_WAVE_NBR",
    "tlm_shipment_joined_do_w_article_prepared"."do_SHIP_WAVE_NBR" AS "do_SHIP_WAVE_NBR",
    "tlm_shipment_joined_do_w_article_prepared"."do_REPL_WAVE_NBR" AS "do_REPL_WAVE_NBR",
    "tlm_shipment_joined_do_w_article_prepared"."do_SINGLE_UNIT_FLAG" AS "do_SINGLE_UNIT_FLAG",
    "tlm_shipment_joined_do_w_article_prepared"."do_ACTUAL_COST" AS "do_ACTUAL_COST",
    "tlm_shipment_joined_do_w_article_prepared"."do_QTY_CONV_FACTOR" AS "do_QTY_CONV_FACTOR",
    "tlm_shipment_joined_do_w_article_prepared"."do_PLANNED_WEIGHT" AS "do_PLANNED_WEIGHT",
    "tlm_shipment_joined_do_w_article_prepared"."do_RECEIVED_WEIGHT" AS "do_RECEIVED_WEIGHT",
    "tlm_shipment_joined_do_w_article_prepared"."do_SHIPPED_WEIGHT" AS "do_SHIPPED_WEIGHT",
    "tlm_shipment_joined_do_w_article_prepared"."do_WEIGHT_UOM_ID_BASE" AS "do_WEIGHT_UOM_ID_BASE",
    "tlm_shipment_joined_do_w_article_prepared"."do_WEIGHT_UOM_ID" AS "do_WEIGHT_UOM_ID",
    "tlm_shipment_joined_do_w_article_prepared"."do_PLANNED_VOLUME" AS "do_PLANNED_VOLUME",
    "tlm_shipment_joined_do_w_article_prepared"."do_RECEIVED_VOLUME" AS "do_RECEIVED_VOLUME",
    "tlm_shipment_joined_do_w_article_prepared"."do_SHIPPED_VOLUME" AS "do_SHIPPED_VOLUME",
    "tlm_shipment_joined_do_w_article_prepared"."do_VOLUME_UOM_ID_BASE" AS "do_VOLUME_UOM_ID_BASE",
    "tlm_shipment_joined_do_w_article_prepared"."do_VOLUME_UOM_ID" AS "do_VOLUME_UOM_ID",
    "tlm_shipment_joined_do_w_article_prepared"."do_SIZE1_UOM_ID" AS "do_SIZE1_UOM_ID",
    "tlm_shipment_joined_do_w_article_prepared"."do_SIZE1_VALUE" AS "do_SIZE1_VALUE",
    "tlm_shipment_joined_do_w_article_prepared"."do_RECEIVED_SIZE1" AS "do_RECEIVED_SIZE1",
    "tlm_shipment_joined_do_w_article_prepared"."do_SHIPPED_SIZE1" AS "do_SHIPPED_SIZE1",
    "tlm_shipment_joined_do_w_article_prepared"."do_SIZE2_UOM_ID" AS "do_SIZE2_UOM_ID",
    "tlm_shipment_joined_do_w_article_prepared"."do_SIZE2_VALUE" AS "do_SIZE2_VALUE",
    "tlm_shipment_joined_do_w_article_prepared"."do_RECEIVED_SIZE2" AS "do_RECEIVED_SIZE2",
    "tlm_shipment_joined_do_w_article_prepared"."do_SHIPPED_SIZE2" AS "do_SHIPPED_SIZE2",
    "tlm_shipment_joined_do_w_article_prepared"."do_LPN_TYPE" AS "do_LPN_TYPE",
    "tlm_shipment_joined_do_w_article_prepared"."do_ORDER_CONSOL_ATTR" AS "do_ORDER_CONSOL_ATTR",
    "tlm_shipment_joined_do_w_article_prepared"."do_SKU_BREAK_ATTR" AS "do_SKU_BREAK_ATTR",
    "tlm_shipment_joined_do_w_article_prepared"."do_PURCHASE_ORDER_NUMBER" AS "do_PURCHASE_ORDER_NUMBER",
    "tlm_shipment_joined_do_w_article_prepared"."do_EXT_PURCHASE_ORDER" AS "do_EXT_PURCHASE_ORDER",
    "tlm_shipment_joined_do_w_article_prepared"."do_CRITCL_DIM_1" AS "do_CRITCL_DIM_1",
    "tlm_shipment_joined_do_w_article_prepared"."do_CRITCL_DIM_2" AS "do_CRITCL_DIM_2",
    "tlm_shipment_joined_do_w_article_prepared"."do_CRITCL_DIM_3" AS "do_CRITCL_DIM_3",
    "tlm_shipment_joined_do_w_article_prepared"."do_ASSORT_NBR" AS "do_ASSORT_NBR",
    "tlm_shipment_joined_do_w_article_prepared"."do_DESCRIPTION" AS "do_DESCRIPTION",
    "tlm_shipment_joined_do_w_article_prepared"."do_ORIGINAL_ORDERED_ITEM_ID" AS "do_ORIGINAL_ORDERED_ITEM_ID",
    "tlm_shipment_joined_do_w_article_prepared"."do_SUBSTITUTION_TYPE" AS "do_SUBSTITUTION_TYPE",
    "tlm_shipment_joined_do_w_article_prepared"."do_BACK_ORD_REASON" AS "do_BACK_ORD_REASON",
    "tlm_shipment_joined_do_w_article_prepared"."do_FREIGHT_REVENUE_CURRENCY_CODE" AS "do_FREIGHT_REVENUE_CURRENCY_CODE",
    "tlm_shipment_joined_do_w_article_prepared"."do_FREIGHT_REVENUE" AS "do_FREIGHT_REVENUE",
    "tlm_shipment_joined_do_w_article_prepared"."do_IS_CHASE_CREATED_LINE" AS "do_IS_CHASE_CREATED_LINE",
    "tlm_shipment_joined_do_w_article_prepared"."do_REF_FIELD4" AS "do_REF_FIELD4",
    "tlm_shipment_joined_do_w_article_prepared"."do_REF_FIELD5" AS "do_REF_FIELD5",
    "tlm_shipment_joined_do_w_article_prepared"."do_REF_FIELD6" AS "do_REF_FIELD6",
    "tlm_shipment_joined_do_w_article_prepared"."do_REF_FIELD7" AS "do_REF_FIELD7",
    "tlm_shipment_joined_do_w_article_prepared"."do_REF_FIELD8" AS "do_REF_FIELD8",
    "tlm_shipment_joined_do_w_article_prepared"."do_REF_FIELD9" AS "do_REF_FIELD9",
    "tlm_shipment_joined_do_w_article_prepared"."do_REF_FIELD10" AS "do_REF_FIELD10",
    "tlm_shipment_joined_do_w_article_prepared"."do_REF_NUM1" AS "do_REF_NUM1",
    "tlm_shipment_joined_do_w_article_prepared"."do_REF_NUM2" AS "do_REF_NUM2",
    "tlm_shipment_joined_do_w_article_prepared"."do_REF_NUM3" AS "do_REF_NUM3",
    "tlm_shipment_joined_do_w_article_prepared"."do_REF_NUM4" AS "do_REF_NUM4",
    "tlm_shipment_joined_do_w_article_prepared"."do_REF_NUM5" AS "do_REF_NUM5",
    "tlm_shipment_joined_do_w_article_prepared"."do_IS_GIFT" AS "do_IS_GIFT",
    "tlm_shipment_joined_do_w_article_prepared"."do_ADJUSTED_ORDER_QTY" AS "do_ADJUSTED_ORDER_QTY",
    "tlm_shipment_joined_do_w_article_prepared"."do_PRE_RECEIPT_STATUS" AS "do_PRE_RECEIPT_STATUS",
    "tlm_shipment_joined_do_w_article_prepared"."do_ALLOW_REVIVAL_RECEIPT_ALLOC" AS "do_ALLOW_REVIVAL_RECEIPT_ALLOC",
    "tlm_shipment_joined_do_w_article_prepared"."do_SEGMENT_NAME" AS "do_SEGMENT_NAME",
    "tlm_shipment_joined_do_w_article_prepared"."do_EFFECTIVE_RANK" AS "do_EFFECTIVE_RANK",
    "tlm_shipment_joined_do_w_article_prepared"."do_WM_RECEIPT_ALLOCATED" AS "do_WM_RECEIPT_ALLOCATED",
    "tlm_shipment_joined_do_w_article_prepared"."do_GIFT_CARD_VALUE" AS "do_GIFT_CARD_VALUE",
    "tlm_shipment_joined_do_w_article_prepared"."do_REF_BOOLEAN1" AS "do_REF_BOOLEAN1",
    "tlm_shipment_joined_do_w_article_prepared"."do_REF_BOOLEAN2" AS "do_REF_BOOLEAN2",
    "tlm_shipment_joined_do_w_article_prepared"."do_REF_SYSCODE1" AS "do_REF_SYSCODE1",
    "tlm_shipment_joined_do_w_article_prepared"."do_REF_SYSCODE2" AS "do_REF_SYSCODE2",
    "tlm_shipment_joined_do_w_article_prepared"."do_REF_SYSCODE3" AS "do_REF_SYSCODE3",
    "article"."ARTICLE_LENGTH" AS "a_ARTICLE_LENGTH",
    "article"."ARTICLE_WIDTH" AS "a_ARTICLE_WIDTH",
    "article"."ARTICLE_HEIGHT" AS "a_ARTICLE_HEIGHT",
    "article"."ARTICLE_WEIGHT" AS "a_ARTICLE_WEIGHT",
    "article"."ARTICLE_SIZE" AS "a_ARTICLE_SIZE",
    "article"."ARTICLE_40HC_QTY" AS "a_ARTICLE_40HC_QTY",
    "article"."ARTICLE_40GP_QTY" AS "a_ARTICLE_40GP_QTY",
    round(coalesce("a_ARTICLE_LENGTH",0)*coalesce("a_ARTICLE_WIDTH",0)*coalesce("a_ARTICLE_HEIGHT",0)*coalesce("do_ORDER_QTY",0)/1728) AS 
    "item_volume",
    round(coalesce("a_ARTICLE_WEIGHT",0)*coalesce("do_ORDER_QTY",0)) AS "item_weight"
  FROM "TLM_SHIPMENT_JOINED_DO_W_ARTICLE_PREPARED" "tlm_shipment_joined_do_w_article_prepared" 
  LEFT JOIN ARTICLE_W_SHP_DIM_PREP"article"
    ON TRY_TO_NUMBER("tlm_shipment_joined_do_w_article_prepared"."do_ITEM_NAME") = TRY_TO_NUMBER("article"."ARTICLE_NO")
    )
   SELECT *, CASE WHEN "weight_volume_flag" = 'V' THEN "allocation_by_vol" ELSE "allocation_by_wgt" END AS "allocation_final"
   FROM (
               SELECT *, CASE WHEN CAST("item_volume_sum" AS DOUBLE) / NULLIF("max_volume", 0) >= CAST("item_weight_sum" AS DOUBLE) / 
                          NULLIF("max_weight",0) THEN 'V' ELSE 'W' END AS "weight_volume_flag"
               FROM 
   (
    
    SELECT * ,        (CAST("item_volume" AS DOUBLE) / NULLIF("item_volume_sum", 0)) * COALESCE("TOTAL_COST", 0) AS "allocation_by_vol",
            (CAST("item_weight" AS DOUBLE) / NULLIF("item_weight_sum", 0)) * COALESCE("TOTAL_COST", 0) AS "allocation_by_wgt",
            2366 AS "max_volume",
            44000 AS "max_weight"
    FROM(
    SELECT 
    "SHIPMENT_ID" AS "SHIPMENT_ID",
    "TC_COMPANY_ID" AS "TC_COMPANY_ID",
    "RS_AREA_ID" AS "RS_AREA_ID",
    "TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID",
    "PP_SHIPMENT_ID" AS "PP_SHIPMENT_ID",
    "SHIPMENT_STATUS" AS "SHIPMENT_STATUS",
    "UPDATE_SENT" AS "UPDATE_SENT",
    "BUSINESS_PROCESS" AS "BUSINESS_PROCESS",
    "CREATION_TYPE" AS "CREATION_TYPE",
    "CONS_RUN_ID" AS "CONS_RUN_ID",
    "IS_CANCELLED" AS "IS_CANCELLED",
    "RS_TYPE" AS "RS_TYPE",
    "RS_CONFIG_ID" AS "RS_CONFIG_ID",
    "RS_CONFIG_CYCLE_ID" AS "RS_CONFIG_CYCLE_ID",
    "CONFIG_CYCLE_SEQ" AS "CONFIG_CYCLE_SEQ",
    "CYCLE_DEADLINE_DTTM" AS "CYCLE_DEADLINE_DTTM",
    "CYCLE_EXECUTION_DTTM" AS "CYCLE_EXECUTION_DTTM",
    "LAST_RS_NOTIFICATION_DTTM" AS "LAST_RS_NOTIFICATION_DTTM",
    "CFMF_STATUS" AS "CFMF_STATUS",
    "AVAILABLE_DTTM" AS "AVAILABLE_DTTM",
    "CMID" AS "CMID",
    "CM_DISCOUNT" AS "CM_DISCOUNT",
    "O_FACILITY_NUMBER" AS "O_FACILITY_NUMBER",
    "O_FACILITY_ID" AS "O_FACILITY_ID",
    "O_ADDRESS" AS "O_ADDRESS",
    "O_CITY" AS "O_CITY",
    "O_STATE_PROV" AS "O_STATE_PROV",
    "O_POSTAL_CODE" AS "O_POSTAL_CODE",
    "O_COUNTY" AS "O_COUNTY",
    "O_COUNTRY_CODE" AS "O_COUNTRY_CODE",
    "D_FACILITY_NUMBER" AS "D_FACILITY_NUMBER",
    "D_FACILITY_ID" AS "D_FACILITY_ID",
    "D_ADDRESS" AS "D_ADDRESS",
    "D_CITY" AS "D_CITY",
    "D_STATE_PROV" AS "D_STATE_PROV",
    "D_POSTAL_CODE" AS "D_POSTAL_CODE",
    "D_COUNTY" AS "D_COUNTY",
    "D_COUNTRY_CODE" AS "D_COUNTRY_CODE",
    "DISTANCE" AS "DISTANCE",
    "DIRECT_DISTANCE" AS "DIRECT_DISTANCE",
    "OUT_OF_ROUTE_DISTANCE" AS "OUT_OF_ROUTE_DISTANCE",
    "DISTANCE_UOM" AS "DISTANCE_UOM",
    "BUSINESS_PARTNER_ID" AS "BUSINESS_PARTNER_ID",
    "COMMODITY_CLASS" AS "COMMODITY_CLASS",
    "IS_HAZMAT" AS "IS_HAZMAT",
    "IS_PERISHABLE" AS "IS_PERISHABLE",
    "BILLING_METHOD" AS "BILLING_METHOD",
    "DSG_CARRIER_CODE" AS "DSG_CARRIER_CODE",
    "REC_CMID" AS "REC_CMID",
    "REC_CM_SHIPMENT_ID" AS "REC_CM_SHIPMENT_ID",
    "ASSIGNED_CARRIER_CODE" AS "ASSIGNED_CARRIER_CODE",
    "SHIPMENT_REF_ID" AS "SHIPMENT_REF_ID",
    "BILL_TO_CODE" AS "BILL_TO_CODE",
    "BILL_TO_TITLE" AS "BILL_TO_TITLE",
    "BILL_TO_NAME" AS "BILL_TO_NAME",
    "BILL_TO_ADDRESS" AS "BILL_TO_ADDRESS",
    "BILL_TO_CITY" AS "BILL_TO_CITY",
    "BILL_TO_STATE_PROV" AS "BILL_TO_STATE_PROV",
    "BILL_TO_POSTAL_CODE" AS "BILL_TO_POSTAL_CODE",
    "BILL_TO_COUNTRY_CODE" AS "BILL_TO_COUNTRY_CODE",
    "BILL_TO_PHONE_NUMBER" AS "BILL_TO_PHONE_NUMBER",
    "PURCHASE_ORDER" AS "PURCHASE_ORDER",
    "PRO_NUMBER" AS "PRO_NUMBER",
    "TRANS_RESP_CODE" AS "TRANS_RESP_CODE",
    "BASELINE_COST" AS "BASELINE_COST",
    "ESTIMATED_COST" AS "ESTIMATED_COST",
    "LINEHAUL_COST" AS "LINEHAUL_COST",
    "ACCESSORIAL_COST" AS "ACCESSORIAL_COST",
    "STOP_COST" AS "STOP_COST",
    "ESTIMATED_SAVINGS" AS "ESTIMATED_SAVINGS",
    "SPOT_CHARGE" AS "SPOT_CHARGE",
    "CURRENCY_CODE" AS "CURRENCY_CODE",
    "PICKUP_START_DTTM" AS "PICKUP_START_DTTM",
    "PICKUP_END_DTTM" AS "PICKUP_END_DTTM",
    "DELIVERY_START_DTTM" AS "DELIVERY_START_DTTM",
    "DELIVERY_END_DTTM" AS "DELIVERY_END_DTTM",
    "NUM_STOPS" AS "NUM_STOPS",
    "NUM_DOCKS" AS "NUM_DOCKS",
    "ON_TIME_INDICATOR" AS "ON_TIME_INDICATOR",
    "HAS_NOTES" AS "HAS_NOTES",
    "HAS_ALERTS" AS "HAS_ALERTS",
    "HAS_IMPORT_ERROR" AS "HAS_IMPORT_ERROR",
    "HAS_SOFT_CHECK_ERROR" AS "HAS_SOFT_CHECK_ERROR",
    "HAS_TRACKING_MSG" AS "HAS_TRACKING_MSG",
    "TRACKING_MSG_PROBLEM" AS "TRACKING_MSG_PROBLEM",
    "REC_LINEHAUL_COST" AS "REC_LINEHAUL_COST",
    "REC_ACCESSORIAL_COST" AS "REC_ACCESSORIAL_COST",
    "REC_TOTAL_COST" AS "REC_TOTAL_COST",
    "CYCLE_RESP_DEADLINE_TZ" AS "CYCLE_RESP_DEADLINE_TZ",
    "TENDER_RESP_DEADLINE_TZ" AS "TENDER_RESP_DEADLINE_TZ",
    "PICKUP_TZ" AS "PICKUP_TZ",
    "DELIVERY_TZ" AS "DELIVERY_TZ",
    "ASSIGNED_LANE_ID" AS "ASSIGNED_LANE_ID",
    "ASSIGNED_LANE_DETAIL_ID" AS "ASSIGNED_LANE_DETAIL_ID",
    "REC_SPOT_CHARGE" AS "REC_SPOT_CHARGE",
    "REC_LANE_ID" AS "REC_LANE_ID",
    "REC_LANE_DETAIL_ID" AS "REC_LANE_DETAIL_ID",
    "TENDER_DTTM" AS "TENDER_DTTM",
    "O_STOP_LOCATION_NAME" AS "O_STOP_LOCATION_NAME",
    "D_STOP_LOCATION_NAME" AS "D_STOP_LOCATION_NAME",
    "ASSIGNED_CM_SHIPMENT_ID" AS "ASSIGNED_CM_SHIPMENT_ID",
    "REC_CM_DISCOUNT" AS "REC_CM_DISCOUNT",
    "REC_STOP_COST" AS "REC_STOP_COST",
    "LAST_SELECTOR_RUN_DTTM" AS "LAST_SELECTOR_RUN_DTTM",
    "LAST_CM_OPTION_GEN_DTTM" AS "LAST_CM_OPTION_GEN_DTTM",
    "IS_CM_OPTION_GEN_ACTIVE" AS "IS_CM_OPTION_GEN_ACTIVE",
    "RS_CYCLE_REMAINING" AS "RS_CYCLE_REMAINING",
    "IS_TIME_FEAS_ENABLED" AS "IS_TIME_FEAS_ENABLED",
    "EXT_SYS_SHIPMENT_ID" AS "EXT_SYS_SHIPMENT_ID",
    "EXTRACTION_DTTM" AS "EXTRACTION_DTTM",
    "ASSIGNED_BROKER_CARRIER_CODE" AS "ASSIGNED_BROKER_CARRIER_CODE",
    "USE_BROKER_AS_CARRIER" AS "USE_BROKER_AS_CARRIER",
    "BROKER_REF" AS "BROKER_REF",
    "RATING_QUALIFIER" AS "RATING_QUALIFIER",
    "STATUS_CHANGE_DTTM" AS "STATUS_CHANGE_DTTM",
    "BUDG_TOTAL_COST" AS "BUDG_TOTAL_COST",
    "NORMALIZED_MARGIN" AS "NORMALIZED_MARGIN",
    "NORMALIZED_TOTAL_COST" AS "NORMALIZED_TOTAL_COST",
    "BUDG_NORMALIZED_TOTAL_COST" AS "BUDG_NORMALIZED_TOTAL_COST",
    "REC_BUDG_LINEHAUL_COST" AS "REC_BUDG_LINEHAUL_COST",
    "REC_BUDG_STOP_COST" AS "REC_BUDG_STOP_COST",
    "REC_BUDG_CM_DISCOUNT" AS "REC_BUDG_CM_DISCOUNT",
    "REC_BUDG_ACCESSORIAL_COST" AS "REC_BUDG_ACCESSORIAL_COST",
    "REC_BUDG_TOTAL_COST" AS "REC_BUDG_TOTAL_COST",
    "REC_MARGIN" AS "REC_MARGIN",
    "REC_NORMALIZED_MARGIN" AS "REC_NORMALIZED_MARGIN",
    "REC_NORMALIZED_TOTAL_COST" AS "REC_NORMALIZED_TOTAL_COST",
    "REC_BUDG_NORMALIZED_TOTAL_COST" AS "REC_BUDG_NORMALIZED_TOTAL_COST",
    "BUDG_CURRENCY_CODE" AS "BUDG_CURRENCY_CODE",
    "SPOT_CHARGE_CURRENCY_CODE" AS "SPOT_CHARGE_CURRENCY_CODE",
    "REC_CURRENCY_CODE" AS "REC_CURRENCY_CODE",
    "REC_BUDG_CURRENCY_CODE" AS "REC_BUDG_CURRENCY_CODE",
    "REC_SPOT_CHARGE_CURRENCY_CODE" AS "REC_SPOT_CHARGE_CURRENCY_CODE",
    "RATING_LANE_ID" AS "RATING_LANE_ID",
    "FRT_REV_RATING_LANE_ID" AS "FRT_REV_RATING_LANE_ID",
    "REC_RATING_LANE_ID" AS "REC_RATING_LANE_ID",
    "REC_BUDG_RATING_LANE_ID" AS "REC_BUDG_RATING_LANE_ID",
    "RATING_LANE_DETAIL_ID" AS "RATING_LANE_DETAIL_ID",
    "FRT_REV_RATING_LANE_DETAIL_ID" AS "FRT_REV_RATING_LANE_DETAIL_ID",
    "REC_RATING_LANE_DETAIL_ID" AS "REC_RATING_LANE_DETAIL_ID",
    "REC_BUDG_RATING_LANE_DETAIL_ID" AS "REC_BUDG_RATING_LANE_DETAIL_ID",
    "BUDG_CM_DISCOUNT" AS "BUDG_CM_DISCOUNT",
    "NORMALIZED_BASELINE_COST" AS "NORMALIZED_BASELINE_COST",
    "BASELINE_COST_CURRENCY_CODE" AS "BASELINE_COST_CURRENCY_CODE",
    "REPORTED_COST" AS "REPORTED_COST",
    "TRACTOR_NUMBER" AS "TRACTOR_NUMBER",
    "IS_AUTO_DELIVERED" AS "IS_AUTO_DELIVERED",
    "SHIPMENT_TYPE" AS "SHIPMENT_TYPE",
    "ORIG_BUDG_TOTAL_COST" AS "ORIG_BUDG_TOTAL_COST",
    "ACCESSORIAL_COST_TO_CARRIER" AS "ACCESSORIAL_COST_TO_CARRIER",
    "CARRIER_CHARGE" AS "CARRIER_CHARGE",
    "ACTUAL_COST" AS "ACTUAL_COST",
    "EARNED_INCOME" AS "EARNED_INCOME",
    "SENT_TO_PKMS" AS "SENT_TO_PKMS",
    "IS_SHIPMENT_RECONCILED" AS "IS_SHIPMENT_RECONCILED",
    "DELIVERY_REQ" AS "DELIVERY_REQ",
    "DROPOFF_PICKUP" AS "DROPOFF_PICKUP",
    "PACKAGING" AS "PACKAGING",
    "SENT_TO_PKMS_DTTM" AS "SENT_TO_PKMS_DTTM",
    "WMS_STATUS_CODE" AS "WMS_STATUS_CODE",
    "SPOT_CHARGE_AND_PAYEE_ACC" AS "SPOT_CHARGE_AND_PAYEE_ACC",
    "SPOT_CHARGE_AND_PAYEE_ACC_CC" AS "SPOT_CHARGE_AND_PAYEE_ACC_CC",
    "NORM_SPOT_CHARGE_AND_PAYEE_ACC" AS "NORM_SPOT_CHARGE_AND_PAYEE_ACC",
    "FACILITY_SCHEDULE_ID" AS "FACILITY_SCHEDULE_ID",
    "EARNED_INCOME_CURRENCY_CODE" AS "EARNED_INCOME_CURRENCY_CODE",
    "ACTUAL_COST_CURRENCY_CODE" AS "ACTUAL_COST_CURRENCY_CODE",
    "SHIPMENT_RECON_DTTM" AS "SHIPMENT_RECON_DTTM",
    "PLN_RATING_LANE_ID" AS "PLN_RATING_LANE_ID",
    "PLN_RATING_LANE_DETAIL_ID" AS "PLN_RATING_LANE_DETAIL_ID",
    "PLN_TOTAL_COST" AS "PLN_TOTAL_COST",
    "PLN_LINEHAUL_COST" AS "PLN_LINEHAUL_COST",
    "PLN_TOTAL_ACCESSORIAL_COST" AS "PLN_TOTAL_ACCESSORIAL_COST",
    "PLN_STOP_OFF_COST" AS "PLN_STOP_OFF_COST",
    "PLN_NORMALIZED_TOTAL_COST" AS "PLN_NORMALIZED_TOTAL_COST",
    "PLN_CURRENCY_CODE" AS "PLN_CURRENCY_CODE",
    "PLN_ACCESSORL_COST_TO_CARRIER" AS "PLN_ACCESSORL_COST_TO_CARRIER",
    "PLN_CARRIER_CHARGE" AS "PLN_CARRIER_CHARGE",
    "WAYPOINT_TOTAL_COST" AS "WAYPOINT_TOTAL_COST",
    "WAYPOINT_HANDLING_COST" AS "WAYPOINT_HANDLING_COST",
    "GRS_OPERATION" AS "GRS_OPERATION",
    "IS_GRS_OPT_CYCLE_RUNNING" AS "IS_GRS_OPT_CYCLE_RUNNING",
    "IS_MANUAL_ASSIGN" AS "IS_MANUAL_ASSIGN",
    "LAST_RUN_GRS_DTTM" AS "LAST_RUN_GRS_DTTM",
    "GRS_MAX_SHIPMENT_STATUS" AS "GRS_MAX_SHIPMENT_STATUS",
    "PRIORITY_TYPE" AS "PRIORITY_TYPE",
    "MV_CURRENCY_CODE" AS "MV_CURRENCY_CODE",
    "PROD_SCHED_REF_NUMBER" AS "PROD_SCHED_REF_NUMBER",
    "COMMODITY_CODE_ID" AS "COMMODITY_CODE_ID",
    "UN_NUMBER_ID" AS "UN_NUMBER_ID",
    "CONTRACT_NUMBER" AS "CONTRACT_NUMBER",
    "BOOKING_REF_SHIPPER" AS "BOOKING_REF_SHIPPER",
    "BOOKING_REF_CARRIER" AS "BOOKING_REF_CARRIER",
    "BK_RESOURCE_REF_EXTERNAL" AS "BK_RESOURCE_REF_EXTERNAL",
    "BK_RESOURCE_NAME_EXTERNAL" AS "BK_RESOURCE_NAME_EXTERNAL",
    "BK_O_FACILITY_ID" AS "BK_O_FACILITY_ID",
    "BK_D_FACILITY_ID" AS "BK_D_FACILITY_ID",
    "BK_MASTER_AIRWAY_BILL" AS "BK_MASTER_AIRWAY_BILL",
    "BK_FORWARDER_AIRWAY_BILL" AS "BK_FORWARDER_AIRWAY_BILL",
    "ASSIGNED_SCNDR_CARRIER_CODE" AS "ASSIGNED_SCNDR_CARRIER_CODE",
    "CUSTOMER_CREDIT_LIMIT_ID" AS "CUSTOMER_CREDIT_LIMIT_ID",
    "SHIPMENT_LEG_TYPE" AS "SHIPMENT_LEG_TYPE",
    "SHIPMENT_CLOSED_INDICATOR" AS "SHIPMENT_CLOSED_INDICATOR",
    "OCEAN_ROUTING_STAGE" AS "OCEAN_ROUTING_STAGE",
    "BK_DEPARTURE_DTTM" AS "BK_DEPARTURE_DTTM",
    "BK_DEPARTURE_TZ" AS "BK_DEPARTURE_TZ",
    "BK_ARRIVAL_DTTM" AS "BK_ARRIVAL_DTTM",
    "BK_ARRIVAL_TZ" AS "BK_ARRIVAL_TZ",
    "BK_PICKUP_DTTM" AS "BK_PICKUP_DTTM",
    "BK_PICKUP_TZ" AS "BK_PICKUP_TZ",
    "BK_CUTOFF_DTTM" AS "BK_CUTOFF_DTTM",
    "BK_CUTOFF_TZ" AS "BK_CUTOFF_TZ",
    "NUM_CHARGE_LAYOVERS" AS "NUM_CHARGE_LAYOVERS",
    "RATE_TYPE" AS "RATE_TYPE",
    "RATE_UOM" AS "RATE_UOM",
    "PICK_START_DTTM" AS "PICK_START_DTTM",
    "PAPERWORK_START_DTTM" AS "PAPERWORK_START_DTTM",
    "VEHICLE_CHECK_START_DTTM" AS "VEHICLE_CHECK_START_DTTM",
    "SHIPMENT_START_DTTM" AS "SHIPMENT_START_DTTM",
    "SHIPMENT_END_DTTM" AS "SHIPMENT_END_DTTM",
    "FEASIBLE_DRIVER_TYPE" AS "FEASIBLE_DRIVER_TYPE",
    "WAVE_ID" AS "WAVE_ID",
    "ESTIMATED_DISPATCH_DTTM" AS "ESTIMATED_DISPATCH_DTTM",
    "TOTAL_TIME" AS "TOTAL_TIME",
    "LOC_REFERENCE" AS "LOC_REFERENCE",
    "BK_O_FACILITY_ALIAS_ID" AS "BK_O_FACILITY_ALIAS_ID",
    "BK_D_FACILITY_ALIAS_ID" AS "BK_D_FACILITY_ALIAS_ID",
    "EQUIP_UTIL_PER" AS "EQUIP_UTIL_PER",
    "MOVE_TYPE" AS "MOVE_TYPE",
    "DRIVER_TYPE_ID" AS "DRIVER_TYPE_ID",
    "EQUIPMENT_TYPE" AS "EQUIPMENT_TYPE",
    "RADIAL_DISTANCE" AS "RADIAL_DISTANCE",
    "RADIAL_DISTANCE_UOM" AS "RADIAL_DISTANCE_UOM",
    "DESIGNATED_TRACTOR_CODE" AS "DESIGNATED_TRACTOR_CODE",
    "DESIGNATED_DRIVER_TYPE" AS "DESIGNATED_DRIVER_TYPE",
    "IS_WAVE_MAN_CHANGED" AS "IS_WAVE_MAN_CHANGED",
    "RETAIN_CONSOLIDATOR_TIMES" AS "RETAIN_CONSOLIDATOR_TIMES",
    "TARIFF" AS "TARIFF",
    "MIN_RATE" AS "MIN_RATE",
    "FIRST_UPDATE_SENT_TO_PKMS" AS "FIRST_UPDATE_SENT_TO_PKMS",
    "EVENT_IND_TYPEID" AS "EVENT_IND_TYPEID",
    "TANDEM_PATH_ID" AS "TANDEM_PATH_ID",
    "O_TANDEM_FACILITY" AS "O_TANDEM_FACILITY",
    "D_TANDEM_FACILITY" AS "D_TANDEM_FACILITY",
    "O_TANDEM_FACILITY_ALIAS" AS "O_TANDEM_FACILITY_ALIAS",
    "D_TANDEM_FACILITY_ALIAS" AS "D_TANDEM_FACILITY_ALIAS",
    "DELAY_TYPE" AS "DELAY_TYPE",
    "ASSIGNED_CARRIER_ID" AS "ASSIGNED_CARRIER_ID",
    "DSG_CARRIER_ID" AS "DSG_CARRIER_ID",
    "REC_CARRIER_ID" AS "REC_CARRIER_ID",
    "FEASIBLE_CARRIER_ID" AS "FEASIBLE_CARRIER_ID",
    "PAYEE_CARRIER_ID" AS "PAYEE_CARRIER_ID",
    "SCNDR_CARRIER_ID" AS "SCNDR_CARRIER_ID",
    "BROKER_CARRIER_ID" AS "BROKER_CARRIER_ID",
    "ASSIGNED_SCNDR_CARRIER_ID" AS "ASSIGNED_SCNDR_CARRIER_ID",
    "DSG_SCNDR_CARRIER_ID" AS "DSG_SCNDR_CARRIER_ID",
    "ASSIGNED_BROKER_CARRIER_ID" AS "ASSIGNED_BROKER_CARRIER_ID",
    "LH_PAYEE_CARRIER_ID" AS "LH_PAYEE_CARRIER_ID",
    "REC_BROKER_CARRIER_ID" AS "REC_BROKER_CARRIER_ID",
    "ASSIGNED_EQUIPMENT_ID" AS "ASSIGNED_EQUIPMENT_ID",
    "DSG_EQUIPMENT_ID" AS "DSG_EQUIPMENT_ID",
    "FEASIBLE_EQUIPMENT_ID" AS "FEASIBLE_EQUIPMENT_ID",
    "FEASIBLE_EQUIPMENT2_ID" AS "FEASIBLE_EQUIPMENT2_ID",
    "REC_EQUIPMENT_ID" AS "REC_EQUIPMENT_ID",
    "ASSIGNED_MOT_ID" AS "ASSIGNED_MOT_ID",
    "DSG_MOT_ID" AS "DSG_MOT_ID",
    "FEASIBLE_MOT_ID" AS "FEASIBLE_MOT_ID",
    "REC_MOT_ID" AS "REC_MOT_ID",
    "PRODUCT_CLASS_ID" AS "PRODUCT_CLASS_ID",
    "PROTECTION_LEVEL_ID" AS "PROTECTION_LEVEL_ID",
    "ASSIGNED_SERVICE_LEVEL_ID" AS "ASSIGNED_SERVICE_LEVEL_ID",
    "DSG_SERVICE_LEVEL_ID" AS "DSG_SERVICE_LEVEL_ID",
    "FEASIBLE_SERVICE_LEVEL_ID" AS "FEASIBLE_SERVICE_LEVEL_ID",
    "REC_SERVICE_LEVEL_ID" AS "REC_SERVICE_LEVEL_ID",
    "HAS_EM_NOTIFY_FLAG" AS "HAS_EM_NOTIFY_FLAG",
    "REGION_ID" AS "REGION_ID",
    "INBOUND_REGION_ID" AS "INBOUND_REGION_ID",
    "OUTBOUND_REGION_ID" AS "OUTBOUND_REGION_ID",
    "FINANCIAL_WT" AS "FINANCIAL_WT",
    "IS_BOOKING_REQUIRED" AS "IS_BOOKING_REQUIRED",
    "TOTAL_COST_EXCL_TAX" AS "TOTAL_COST_EXCL_TAX",
    "TOTAL_TAX_AMOUNT" AS "TOTAL_TAX_AMOUNT",
    "IS_ASSOCIATED_TO_OUTBOUND" AS "IS_ASSOCIATED_TO_OUTBOUND",
    "RECEIVED_DTTM" AS "RECEIVED_DTTM",
    "BOOKING_ID" AS "BOOKING_ID",
    "IS_MISROUTED" AS "IS_MISROUTED",
    "FEASIBLE_CARRIER_CODE" AS "FEASIBLE_CARRIER_CODE",
    "SHIPMENT_WIN_ADJ_FLAG" AS "SHIPMENT_WIN_ADJ_FLAG",
    "DT_PARAM_SET_ID" AS "DT_PARAM_SET_ID",
    "MERCHANDIZING_DEPARTMENT_ID" AS "MERCHANDIZING_DEPARTMENT_ID",
    "STATIC_ROUTE_ID" AS "STATIC_ROUTE_ID",
    "IS_FILO" AS "IS_FILO",
    "IS_COOLER_AT_NOSE" AS "IS_COOLER_AT_NOSE",
    "AUTH_NBR" AS "AUTH_NBR",
    "CONS_LOCN_ID" AS "CONS_LOCN_ID",
    "RTE_TYPE" AS "RTE_TYPE",
    "TRLR_TYPE" AS "TRLR_TYPE",
    "TRLR_SIZE" AS "TRLR_SIZE",
    "CONS_ADDR_CODE" AS "CONS_ADDR_CODE",
    "HUB_ID" AS "HUB_ID",
    "TRLR_GEN_CODE" AS "TRLR_GEN_CODE",
    "MAX_NBR_OF_CTNS" AS "MAX_NBR_OF_CTNS",
    "APPT_DOOR_SCHED_TYPE" AS "APPT_DOOR_SCHED_TYPE",
    "CREATED_SOURCE_TYPE" AS "CREATED_SOURCE_TYPE",
    "CREATED_SOURCE" AS "CREATED_SOURCE",
    "CREATED_DTTM" AS "CREATED_DTTM",
    "LAST_UPDATED_SOURCE_TYPE" AS "LAST_UPDATED_SOURCE_TYPE",
    "LAST_UPDATED_SOURCE" AS "LAST_UPDATED_SOURCE",
    "LAST_UPDATED_DTTM" AS "LAST_UPDATED_DTTM",
    "DSG_SCNDR_CARRIER_CODE" AS "DSG_SCNDR_CARRIER_CODE",
    "LH_PAYEE_CARRIER_CODE" AS "LH_PAYEE_CARRIER_CODE",
    "REC_BROKER_CARRIER_CODE" AS "REC_BROKER_CARRIER_CODE",
    "REC_CARRIER_CODE" AS "REC_CARRIER_CODE",
    "LPN_ASSIGNMENT_STOPPED" AS "LPN_ASSIGNMENT_STOPPED",
    "SEAL_NUMBER" AS "SEAL_NUMBER",
    "HIBERNATE_VERSION" AS "HIBERNATE_VERSION",
    "SHIP_GROUP_ID" AS "SHIP_GROUP_ID",
    "RATE" AS "RATE",
    "MONETARY_VALUE" AS "MONETARY_VALUE",
    "DOOR" AS "DOOR",
    "RTE_TYPE_1" AS "RTE_TYPE_1",
    "RTE_TYPE_2" AS "RTE_TYPE_2",
    "SCHEDULED_PICKUP_DTTM" AS "SCHEDULED_PICKUP_DTTM",
    "MANIFEST_ID" AS "MANIFEST_ID",
    "DAYS_TO_DELIVER" AS "DAYS_TO_DELIVER",
    "SED_GENERATED_FLAG" AS "SED_GENERATED_FLAG",
    "SERV_AREA_CODE" AS "SERV_AREA_CODE",
    "TENDER_RESP_DEADLINE_DTTM" AS "TENDER_RESP_DEADLINE_DTTM",
    "PRINT_CONS_BOL" AS "PRINT_CONS_BOL",
    "LEFT_WT" AS "LEFT_WT",
    "RIGHT_WT" AS "RIGHT_WT",
    "LANE_NAME" AS "LANE_NAME",
    "DECLARED_VALUE" AS "DECLARED_VALUE",
    "DV_CURRENCY_CODE" AS "DV_CURRENCY_CODE",
    "COD_AMOUNT" AS "COD_AMOUNT",
    "CUSTOMER_ID" AS "CUSTOMER_ID",
    "CUST_FRGT_CHARGE" AS "CUST_FRGT_CHARGE",
    "COD_CURRENCY_CODE" AS "COD_CURRENCY_CODE",
    "PLANNED_WEIGHT" AS "PLANNED_WEIGHT",
    "WEIGHT_UOM_ID_BASE" AS "WEIGHT_UOM_ID_BASE",
    "PLANNED_VOLUME" AS "PLANNED_VOLUME",
    "VOLUME_UOM_ID_BASE" AS "VOLUME_UOM_ID_BASE",
    "SIZE1_VALUE" AS "SIZE1_VALUE",
    "SIZE1_UOM_ID" AS "SIZE1_UOM_ID",
    "SIZE2_VALUE" AS "SIZE2_VALUE",
    "SIZE2_UOM_ID" AS "SIZE2_UOM_ID",
    "ASSIGNED_SHIP_VIA" AS "ASSIGNED_SHIP_VIA",
    "INSURANCE_STATUS" AS "INSURANCE_STATUS",
    "RTE_SWC_NBR" AS "RTE_SWC_NBR",
    "RTE_TO" AS "RTE_TO",
    "BILL_OF_LADING_NUMBER" AS "BILL_OF_LADING_NUMBER",
    "TRAILER_NUMBER" AS "TRAILER_NUMBER",
    "TRANS_PLAN_OWNER" AS "TRANS_PLAN_OWNER",
    "TOTAL_REVENUE_CURRENCY_CODE" AS "TOTAL_REVENUE_CURRENCY_CODE",
    "TOTAL_REVENUE" AS "TOTAL_REVENUE",
    "FRT_REV_SPOT_CHARGE_CURR_CODE" AS "FRT_REV_SPOT_CHARGE_CURR_CODE",
    "NORMALIZED_TOTAL_REVENUE" AS "NORMALIZED_TOTAL_REVENUE",
    "FRT_REV_SPOT_CHARGE" AS "FRT_REV_SPOT_CHARGE",
    "DSG_VOYAGE_FLIGHT" AS "DSG_VOYAGE_FLIGHT",
    "FEASIBLE_VOYAGE_FLIGHT" AS "FEASIBLE_VOYAGE_FLIGHT",
    "CURRENCY_DTTM" AS "CURRENCY_DTTM",
    "FRT_REV_LINEHAUL_CHARGE" AS "FRT_REV_LINEHAUL_CHARGE",
    "FRT_REV_STOP_CHARGE" AS "FRT_REV_STOP_CHARGE",
    "FRT_REV_ACCESSORIAL_CHARGE" AS "FRT_REV_ACCESSORIAL_CHARGE",
    "MARGIN" AS "MARGIN",
    "INCOTERM_ID" AS "INCOTERM_ID",
    "ORDER_QTY" AS "ORDER_QTY",
    "QTY_UOM_ID" AS "QTY_UOM_ID",
    "REF_SHIPMENT_NBR" AS "REF_SHIPMENT_NBR",
    "STAGING_LOCN_ID" AS "STAGING_LOCN_ID",
    "LOADING_SEQ_ORD" AS "LOADING_SEQ_ORD",
    "HAZMAT_CERT_CONTACT" AS "HAZMAT_CERT_CONTACT",
    "HAZMAT_CERT_DECLARATION" AS "HAZMAT_CERT_DECLARATION",
    "CDC_TIMESTAMP" AS "CDC_TIMESTAMP",
    "OPERATION_TYPE" AS "OPERATION_TYPE",
    "ARCHIVED_DTTM" AS "ARCHIVED_DTTM",
    "ORIGIN" AS "ORIGIN",
    "FINAL_DESTINATION" AS "FINAL_DESTINATION",
    "actual_delivery_date_parsed" AS "actual_delivery_date_parsed",
    "wood_pellet" AS "wood_pellet",
    "act_del_MERCH_YEAR" AS "act_del_MERCH_YEAR",
    "act_del_YEAR_WEEK" AS "act_del_YEAR_WEEK",
    "act_del_YEAR_QUARTER" AS "act_del_YEAR_QUARTER",
    "act_del_YEAR_PERIOD" AS "act_del_YEAR_PERIOD",
    "invoice_shipping_id" AS "invoice_shipping_id",
    "TOTAL_COST" AS "TOTAL_COST",
    "org_Facility_Code" AS "org_Facility_Code",
    "org_Facility_Name" AS "org_Facility_Name",
    "org_Facility_Type" AS "org_Facility_Type",
    "dest_Facility_Code" AS "dest_Facility_Code",
    "dest_Facility_Name" AS "dest_Facility_Name",
    "dest_Facility_Type" AS "dest_Facility_Type",
    "inbound_flag" AS "inbound_flag",
    "do_ORDER_ID" AS "do_ORDER_ID",
    "do_ORDER_ID_2" AS "do_ORDER_ID_2",
    "do_LINE_ITEM_ID" AS "do_LINE_ITEM_ID",
    "do_PARENT_LINE_ITEM_ID" AS "do_PARENT_LINE_ITEM_ID",
    "do_TC_COMPANY_ID" AS "do_TC_COMPANY_ID",
    "do_COMMODITY_CLASS" AS "do_COMMODITY_CLASS",
    "do_REF_FIELD1" AS "do_REF_FIELD1",
    "do_REF_FIELD2" AS "do_REF_FIELD2",
    "do_REF_FIELD3" AS "do_REF_FIELD3",
    "do_EXT_SYS_LINE_ITEM_ID" AS "do_EXT_SYS_LINE_ITEM_ID",
    "do_MASTER_ORDER_ID" AS "do_MASTER_ORDER_ID",
    "do_MO_LINE_ITEM_ID" AS "do_MO_LINE_ITEM_ID",
    "do_IS_STACKABLE" AS "do_IS_STACKABLE",
    "do_HAS_ERRORS" AS "do_HAS_ERRORS",
    "do_ORIG_BUDG_COST" AS "do_ORIG_BUDG_COST",
    "do_BUDG_COST_CURRENCY_CODE" AS "do_BUDG_COST_CURRENCY_CODE",
    "do_BUDG_COST" AS "do_BUDG_COST",
    "do_ACTUAL_COST_CURRENCY_CODE" AS "do_ACTUAL_COST_CURRENCY_CODE",
    "do_TOTAL_MONETARY_VALUE" AS "do_TOTAL_MONETARY_VALUE",
    "do_UNIT_MONETARY_VALUE" AS "do_UNIT_MONETARY_VALUE",
    "do_UNIT_TAX_AMOUNT" AS "do_UNIT_TAX_AMOUNT",
    "do_RTS_ID" AS "do_RTS_ID",
    "do_RTS_LINE_ITEM_ID" AS "do_RTS_LINE_ITEM_ID",
    "do_STD_PACK_QTY" AS "do_STD_PACK_QTY",
    "do_PRODUCT_CLASS_ID" AS "do_PRODUCT_CLASS_ID",
    "do_PROTECTION_LEVEL_ID" AS "do_PROTECTION_LEVEL_ID",
    "do_PACKAGE_TYPE_ID" AS "do_PACKAGE_TYPE_ID",
    "do_COMMODITY_CODE_ID" AS "do_COMMODITY_CODE_ID",
    "do_MV_SIZE_UOM_ID" AS "do_MV_SIZE_UOM_ID",
    "do_QTY_UOM_ID_BASE" AS "do_QTY_UOM_ID_BASE",
    "do_MV_CURRENCY_CODE" AS "do_MV_CURRENCY_CODE",
    "do_SHIPPED_QTY" AS "do_SHIPPED_QTY",
    "do_RECEIVED_QTY" AS "do_RECEIVED_QTY",
    "do_PRIORITY" AS "do_PRIORITY",
    "do_MERCHANDIZING_DEPARTMENT_ID" AS "do_MERCHANDIZING_DEPARTMENT_ID",
    "do_UN_NUMBER_ID" AS "do_UN_NUMBER_ID",
    "do_PICKUP_REFERENCE_NUMBER" AS "do_PICKUP_REFERENCE_NUMBER",
    "do_DELIVERY_REFERENCE_NUMBER" AS "do_DELIVERY_REFERENCE_NUMBER",
    "do_CNTRY_OF_ORGN" AS "do_CNTRY_OF_ORGN",
    "do_PROD_STAT" AS "do_PROD_STAT",
    "do_STACK_RANK" AS "do_STACK_RANK",
    "do_STACK_LENGTH_VALUE" AS "do_STACK_LENGTH_VALUE",
    "do_STACK_LENGTH_STANDARD_UOM" AS "do_STACK_LENGTH_STANDARD_UOM",
    "do_STACK_WIDTH_VALUE" AS "do_STACK_WIDTH_VALUE",
    "do_STACK_WIDTH_STANDARD_UOM" AS "do_STACK_WIDTH_STANDARD_UOM",
    "do_STACK_HEIGHT_VALUE" AS "do_STACK_HEIGHT_VALUE",
    "do_STACK_HEIGHT_STANDARD_UOM" AS "do_STACK_HEIGHT_STANDARD_UOM",
    "do_STACK_DIAMETER_VALUE" AS "do_STACK_DIAMETER_VALUE",
    "do_STACK_DIAMETER_STANDARD_UOM" AS "do_STACK_DIAMETER_STANDARD_UOM",
    "do_CUBE_MULTIPLE_QTY" AS "do_CUBE_MULTIPLE_QTY",
    "do_DO_DTL_STATUS" AS "do_DO_DTL_STATUS",
    "do_INTERNAL_ORDER_SEQ_NBR" AS "do_INTERNAL_ORDER_SEQ_NBR",
    "do_IS_EMERGENCY" AS "do_IS_EMERGENCY",
    "do_LPN_SIZE" AS "do_LPN_SIZE",
    "do_MANUFACTURING_DTTM" AS "do_MANUFACTURING_DTTM",
    "do_ORDER_LINE_ID" AS "do_ORDER_LINE_ID",
    "do_PACK_RATE" AS "do_PACK_RATE",
    "do_ALLOCATED_QTY" AS "do_ALLOCATED_QTY",
    "do_PLANNED_SHIP_DATE" AS "do_PLANNED_SHIP_DATE",
    "do_PPACK_QTY" AS "do_PPACK_QTY",
    "do_STD_BUNDLE_QTY" AS "do_STD_BUNDLE_QTY",
    "do_STD_LPN_QTY" AS "do_STD_LPN_QTY",
    "do_STD_LPN_VOL" AS "do_STD_LPN_VOL",
    "do_STD_LPN_WT" AS "do_STD_LPN_WT",
    "do_UNIT_COST" AS "do_UNIT_COST",
    "do_UNIT_PRICE_AMOUNT" AS "do_UNIT_PRICE_AMOUNT",
    "do_UNIT_VOL" AS "do_UNIT_VOL",
    "do_UNIT_WT" AS "do_UNIT_WT",
    "do_USER_CANCELED_QTY" AS "do_USER_CANCELED_QTY",
    "do_WAVE_PROC_TYPE" AS "do_WAVE_PROC_TYPE",
    "do_EVENT_CODE" AS "do_EVENT_CODE",
    "do_REASON_CODE" AS "do_REASON_CODE",
    "do_EXP_INFO_CODE" AS "do_EXP_INFO_CODE",
    "do_PARTL_FILL" AS "do_PARTL_FILL",
    "do_LINE_TYPE" AS "do_LINE_TYPE",
    "do_REPL_PROC_TYPE" AS "do_REPL_PROC_TYPE",
    "do_ORDER_QTY" AS "do_ORDER_QTY",
    "do_ORIG_ORDER_QTY" AS "do_ORIG_ORDER_QTY",
    "do_RTL_TO_BE_DISTROED_QTY" AS "do_RTL_TO_BE_DISTROED_QTY",
    "do_PRICE" AS "do_PRICE",
    "do_RETAIL_PRICE" AS "do_RETAIL_PRICE",
    "do_UNITS_PAKD" AS "do_UNITS_PAKD",
    "do_MINOR_ORDER_NBR" AS "do_MINOR_ORDER_NBR",
    "do_ITEM_ID" AS "do_ITEM_ID",
    "do_TC_ORDER_LINE_ID" AS "do_TC_ORDER_LINE_ID",
    "do_ACTUAL_SHIPPED_DTTM" AS "do_ACTUAL_SHIPPED_DTTM",
    "do_QTY_UOM_ID" AS "do_QTY_UOM_ID",
    "do_PICKUP_END_DTTM" AS "do_PICKUP_END_DTTM",
    "do_PURCHASE_ORDER_LINE_NUMBER" AS "do_PURCHASE_ORDER_LINE_NUMBER",
    "do_REFERENCE_LINE_ITEM_ID" AS "do_REFERENCE_LINE_ITEM_ID",
    "do_REFERENCE_ORDER_ID" AS "do_REFERENCE_ORDER_ID",
    "do_REPL_WAVE_RUN" AS "do_REPL_WAVE_RUN",
    "do_STD_PALLET_QTY" AS "do_STD_PALLET_QTY",
    "do_STD_SUB_PACK_QTY" AS "do_STD_SUB_PACK_QTY",
    "do_STORE_DEPT" AS "do_STORE_DEPT",
    "do_ALLOC_TYPE" AS "do_ALLOC_TYPE",
    "do_BATCH_NBR" AS "do_BATCH_NBR",
    "do_BATCH_REQUIREMENT_TYPE" AS "do_BATCH_REQUIREMENT_TYPE",
    "do_CHUTE_ASSIGN_TYPE" AS "do_CHUTE_ASSIGN_TYPE",
    "do_CUSTOM_TAG" AS "do_CUSTOM_TAG",
    "do_CUSTOMER_ITEM" AS "do_CUSTOMER_ITEM",
    "do_INTERNAL_ORDER_ID" AS "do_INTERNAL_ORDER_ID",
    "do_INVN_TYPE" AS "do_INVN_TYPE",
    "do_ITEM_ATTR_1" AS "do_ITEM_ATTR_1",
    "do_ITEM_ATTR_2" AS "do_ITEM_ATTR_2",
    "do_ITEM_ATTR_3" AS "do_ITEM_ATTR_3",
    "do_ITEM_ATTR_4" AS "do_ITEM_ATTR_4",
    "do_ITEM_ATTR_5" AS "do_ITEM_ATTR_5",
    "do_LPN_BRK_ATTRIB" AS "do_LPN_BRK_ATTRIB",
    "do_MERCH_GRP" AS "do_MERCH_GRP",
    "do_MERCH_TYPE" AS "do_MERCH_TYPE",
    "do_PACK_ZONE" AS "do_PACK_ZONE",
    "do_PALLET_TYPE" AS "do_PALLET_TYPE",
    "do_PICK_LOCN_ASSIGN_TYPE" AS "do_PICK_LOCN_ASSIGN_TYPE",
    "do_PICK_LOCN_ID" AS "do_PICK_LOCN_ID",
    "do_PPACK_GRP_CODE" AS "do_PPACK_GRP_CODE",
    "do_PRICE_TKT_TYPE" AS "do_PRICE_TKT_TYPE",
    "do_SERIAL_NUMBER_REQUIRED_FLAG" AS "do_SERIAL_NUMBER_REQUIRED_FLAG",
    "do_SKU_GTIN" AS "do_SKU_GTIN",
    "do_SKU_SUB_CODE_ID" AS "do_SKU_SUB_CODE_ID",
    "do_SKU_SUB_CODE_VALUE" AS "do_SKU_SUB_CODE_VALUE",
    "do_VAS_PROCESS_TYPE" AS "do_VAS_PROCESS_TYPE",
    "do_SUBSTITUTED_PARENT_LINE_ID" AS "do_SUBSTITUTED_PARENT_LINE_ID",
    "do_IS_CANCELLED" AS "do_IS_CANCELLED",
    "do_ITEM_NAME" AS "do_ITEM_NAME",
    "do_ALLOC_LINE_ID" AS "do_ALLOC_LINE_ID",
    "do_ALLOCATION_SOURCE_ID" AS "do_ALLOCATION_SOURCE_ID",
    "do_ALLOCATION_SOURCE_LINE_ID" AS "do_ALLOCATION_SOURCE_LINE_ID",
    "do_ALLOCATION_SOURCE" AS "do_ALLOCATION_SOURCE",
    "do_SHELF_DAYS" AS "do_SHELF_DAYS",
    "do_FULFILLMENT_TYPE" AS "do_FULFILLMENT_TYPE",
    "do_WAVE_NBR" AS "do_WAVE_NBR",
    "do_SHIP_WAVE_NBR" AS "do_SHIP_WAVE_NBR",
    "do_REPL_WAVE_NBR" AS "do_REPL_WAVE_NBR",
    "do_SINGLE_UNIT_FLAG" AS "do_SINGLE_UNIT_FLAG",
    "do_ACTUAL_COST" AS "do_ACTUAL_COST",
    "do_QTY_CONV_FACTOR" AS "do_QTY_CONV_FACTOR",
    "do_PLANNED_WEIGHT" AS "do_PLANNED_WEIGHT",
    "do_RECEIVED_WEIGHT" AS "do_RECEIVED_WEIGHT",
    "do_SHIPPED_WEIGHT" AS "do_SHIPPED_WEIGHT",
    "do_WEIGHT_UOM_ID_BASE" AS "do_WEIGHT_UOM_ID_BASE",
    "do_WEIGHT_UOM_ID" AS "do_WEIGHT_UOM_ID",
    "do_PLANNED_VOLUME" AS "do_PLANNED_VOLUME",
    "do_RECEIVED_VOLUME" AS "do_RECEIVED_VOLUME",
    "do_SHIPPED_VOLUME" AS "do_SHIPPED_VOLUME",
    "do_VOLUME_UOM_ID_BASE" AS "do_VOLUME_UOM_ID_BASE",
    "do_VOLUME_UOM_ID" AS "do_VOLUME_UOM_ID",
    "do_SIZE1_UOM_ID" AS "do_SIZE1_UOM_ID",
    "do_SIZE1_VALUE" AS "do_SIZE1_VALUE",
    "do_RECEIVED_SIZE1" AS "do_RECEIVED_SIZE1",
    "do_SHIPPED_SIZE1" AS "do_SHIPPED_SIZE1",
    "do_SIZE2_UOM_ID" AS "do_SIZE2_UOM_ID",
    "do_SIZE2_VALUE" AS "do_SIZE2_VALUE",
    "do_RECEIVED_SIZE2" AS "do_RECEIVED_SIZE2",
    "do_SHIPPED_SIZE2" AS "do_SHIPPED_SIZE2",
    "do_LPN_TYPE" AS "do_LPN_TYPE",
    "do_ORDER_CONSOL_ATTR" AS "do_ORDER_CONSOL_ATTR",
    "do_SKU_BREAK_ATTR" AS "do_SKU_BREAK_ATTR",
    "do_PURCHASE_ORDER_NUMBER" AS "do_PURCHASE_ORDER_NUMBER",
    "do_EXT_PURCHASE_ORDER" AS "do_EXT_PURCHASE_ORDER",
    "do_CRITCL_DIM_1" AS "do_CRITCL_DIM_1",
    "do_CRITCL_DIM_2" AS "do_CRITCL_DIM_2",
    "do_CRITCL_DIM_3" AS "do_CRITCL_DIM_3",
    "do_ASSORT_NBR" AS "do_ASSORT_NBR",
    "do_DESCRIPTION" AS "do_DESCRIPTION",
    "do_ORIGINAL_ORDERED_ITEM_ID" AS "do_ORIGINAL_ORDERED_ITEM_ID",
    "do_SUBSTITUTION_TYPE" AS "do_SUBSTITUTION_TYPE",
    "do_BACK_ORD_REASON" AS "do_BACK_ORD_REASON",
    "do_FREIGHT_REVENUE_CURRENCY_CODE" AS "do_FREIGHT_REVENUE_CURRENCY_CODE",
    "do_FREIGHT_REVENUE" AS "do_FREIGHT_REVENUE",
    "do_IS_CHASE_CREATED_LINE" AS "do_IS_CHASE_CREATED_LINE",
    "do_REF_FIELD4" AS "do_REF_FIELD4",
    "do_REF_FIELD5" AS "do_REF_FIELD5",
    "do_REF_FIELD6" AS "do_REF_FIELD6",
    "do_REF_FIELD7" AS "do_REF_FIELD7",
    "do_REF_FIELD8" AS "do_REF_FIELD8",
    "do_REF_FIELD9" AS "do_REF_FIELD9",
    "do_REF_FIELD10" AS "do_REF_FIELD10",
    "do_REF_NUM1" AS "do_REF_NUM1",
    "do_REF_NUM2" AS "do_REF_NUM2",
    "do_REF_NUM3" AS "do_REF_NUM3",
    "do_REF_NUM4" AS "do_REF_NUM4",
    "do_REF_NUM5" AS "do_REF_NUM5",
    "do_IS_GIFT" AS "do_IS_GIFT",
    "do_ADJUSTED_ORDER_QTY" AS "do_ADJUSTED_ORDER_QTY",
    "do_PRE_RECEIPT_STATUS" AS "do_PRE_RECEIPT_STATUS",
    "do_ALLOW_REVIVAL_RECEIPT_ALLOC" AS "do_ALLOW_REVIVAL_RECEIPT_ALLOC",
    "do_SEGMENT_NAME" AS "do_SEGMENT_NAME",
    "do_EFFECTIVE_RANK" AS "do_EFFECTIVE_RANK",
    "do_WM_RECEIPT_ALLOCATED" AS "do_WM_RECEIPT_ALLOCATED",
    "do_GIFT_CARD_VALUE" AS "do_GIFT_CARD_VALUE",
    "do_REF_BOOLEAN1" AS "do_REF_BOOLEAN1",
    "do_REF_BOOLEAN2" AS "do_REF_BOOLEAN2",
    "do_REF_SYSCODE1" AS "do_REF_SYSCODE1",
    "do_REF_SYSCODE2" AS "do_REF_SYSCODE2",
    "do_REF_SYSCODE3" AS "do_REF_SYSCODE3",
    "a_ARTICLE_LENGTH" AS "a_ARTICLE_LENGTH",
    "a_ARTICLE_WIDTH" AS "a_ARTICLE_WIDTH",
    "a_ARTICLE_HEIGHT" AS "a_ARTICLE_HEIGHT",
    "item_volume" AS "item_volume",
    "a_ARTICLE_WEIGHT" AS "a_ARTICLE_WEIGHT",
    "item_weight" AS "item_weight",
    "a_ARTICLE_SIZE" AS "a_ARTICLE_SIZE",
    "a_ARTICLE_40HC_QTY" AS "a_ARTICLE_40HC_QTY",
    "a_ARTICLE_40GP_QTY" AS "a_ARTICLE_40GP_QTY",
    SUM("item_volume") OVER (PARTITION BY "TC_SHIPMENT_ID") AS "item_volume_sum",
    SUM("item_weight") OVER (PARTITION BY "TC_SHIPMENT_ID") AS "item_weight_sum"
  FROM CTE)A)B)FINAL ;

<br>
--DOMESTIC_SHIPPING_FREIGHT_OUTBOUND_PREP
</br>
CREATE OR REPLACE TEMPORARY TABLE "DOMESTIC_SHIPPING_FREIGHT_OUTBOUND_PREP"
   AS
   WITH CTE AS 
   (
   SELECT 
        "domestic_shipping_freight_w_facilities"."INV_ID" AS "INV_ID",
        "domestic_shipping_freight_w_facilities"."INV_OBJECT_ID" AS "INV_OBJECT_ID",
        "domestic_shipping_freight_w_facilities"."TC_COMPANY_ID" AS "TC_COMPANY_ID",
        "domestic_shipping_freight_w_facilities"."TC_OBJECT_ID" AS "TC_OBJECT_ID",
        "domestic_shipping_freight_w_facilities"."INV_OBJECT_STATUS" AS "INV_OBJECT_STATUS",
        "domestic_shipping_freight_w_facilities"."O_NAME" AS "O_NAME",
        "domestic_shipping_freight_w_facilities"."O_ADDRESS" AS "O_ADDRESS",
        "domestic_shipping_freight_w_facilities"."O_CITY" AS "O_CITY",
        "domestic_shipping_freight_w_facilities"."O_COUNTY" AS "O_COUNTY",
        "domestic_shipping_freight_w_facilities"."O_STATE_PROV" AS "O_STATE_PROV",
        "domestic_shipping_freight_w_facilities"."O_POSTAL_CODE" AS "O_POSTAL_CODE",
        "domestic_shipping_freight_w_facilities"."O_COUNTRY_CODE" AS "O_COUNTRY_CODE",
        "domestic_shipping_freight_w_facilities"."D_NAME" AS "D_NAME",
        "domestic_shipping_freight_w_facilities"."D_ADDRESS" AS "D_ADDRESS",
        "domestic_shipping_freight_w_facilities"."D_CITY" AS "D_CITY",
        "domestic_shipping_freight_w_facilities"."D_COUNTY" AS "D_COUNTY",
        "domestic_shipping_freight_w_facilities"."D_STATE_PROV" AS "D_STATE_PROV",
        "domestic_shipping_freight_w_facilities"."D_POSTAL_CODE" AS "D_POSTAL_CODE",
        "domestic_shipping_freight_w_facilities"."D_COUNTRY_CODE" AS "D_COUNTRY_CODE",
        "domestic_shipping_freight_w_facilities"."MOT_DESC" AS "MOT_DESC",
        "domestic_shipping_freight_w_facilities"."EQUIPMENT_DESC" AS "EQUIPMENT_DESC",
        "domestic_shipping_freight_w_facilities"."SERVICE_LEVEL_DESC" AS "SERVICE_LEVEL_DESC",
        "domestic_shipping_freight_w_facilities"."PROTECTION_LEVEL_DESC" AS "PROTECTION_LEVEL_DESC",
        "domestic_shipping_freight_w_facilities"."FINANCIAL_WEIGHT" AS "FINANCIAL_WEIGHT",
        "domestic_shipping_freight_w_facilities"."ACTUAL_WEIGHT" AS "ACTUAL_WEIGHT",
        "domestic_shipping_freight_w_facilities"."LH_COST" AS "LH_COST",
        "domestic_shipping_freight_w_facilities"."DISTANCE" AS "DISTANCE",
        "domestic_shipping_freight_w_facilities"."DISTANCE_UOM" AS "DISTANCE_UOM",
        "domestic_shipping_freight_w_facilities"."BILL_OF_LADING_NUMBER" AS "BILL_OF_LADING_NUMBER",
        "domestic_shipping_freight_w_facilities"."PO_NUMBER" AS "PO_NUMBER",
        "domestic_shipping_freight_w_facilities"."SPEC_HANDLING_METHOD" AS "SPEC_HANDLING_METHOD",
        "domestic_shipping_freight_w_facilities"."COMMENTS" AS "COMMENTS",
        "domestic_shipping_freight_w_facilities"."HAS_IMPORT_ERROR" AS "HAS_IMPORT_ERROR",
        "domestic_shipping_freight_w_facilities"."HAS_WARNING" AS "HAS_WARNING",
        "domestic_shipping_freight_w_facilities"."IS_VALID" AS "IS_VALID",
        "domestic_shipping_freight_w_facilities"."CREATED_SOURCE_TYPE" AS "CREATED_SOURCE_TYPE",
        "domestic_shipping_freight_w_facilities"."CREATED_SOURCE" AS "CREATED_SOURCE",
        "domestic_shipping_freight_w_facilities"."CREATED_DTTM" AS "CREATED_DTTM",
        "domestic_shipping_freight_w_facilities"."LAST_UPDATED_SOURCE" AS "LAST_UPDATED_SOURCE",
        "domestic_shipping_freight_w_facilities"."LAST_UPDATED_DTTM" AS "LAST_UPDATED_DTTM",
        "domestic_shipping_freight_w_facilities"."STOP_COST" AS "STOP_COST",
        "domestic_shipping_freight_w_facilities"."AUXILARY_DATA" AS "AUXILARY_DATA",
        "domestic_shipping_freight_w_facilities"."PICKUP_DTTM" AS "PICKUP_DTTM",
        "domestic_shipping_freight_w_facilities"."DELIVERY_DTTM" AS "DELIVERY_DTTM",
        "domestic_shipping_freight_w_facilities"."CURRENCY_CODE" AS "CURRENCY_CODE",
        "domestic_shipping_freight_w_facilities"."LH_CURRENCY_CODE" AS "LH_CURRENCY_CODE",
        "domestic_shipping_freight_w_facilities"."STOP_CURRENCY_CODE" AS "STOP_CURRENCY_CODE",
        "domestic_shipping_freight_w_facilities"."SPOT_CHARGE_COST" AS "SPOT_CHARGE_COST",
        "domestic_shipping_freight_w_facilities"."SPOT_CHARGE_CURRENCY_CODE" AS "SPOT_CHARGE_CURRENCY_CODE",
        "domestic_shipping_freight_w_facilities"."ASSIGNED_CARRIER_CODE" AS "ASSIGNED_CARRIER_CODE",
        "domestic_shipping_freight_w_facilities"."NUM_PICKUPS" AS "NUM_PICKUPS",
        "domestic_shipping_freight_w_facilities"."NUM_DELIVERIES" AS "NUM_DELIVERIES",
        "domestic_shipping_freight_w_facilities"."RATE" AS "RATE",
        "domestic_shipping_freight_w_facilities"."RATE_CALC_METHOD" AS "RATE_CALC_METHOD",
        "domestic_shipping_freight_w_facilities"."RATE_UOM" AS "RATE_UOM",
        "domestic_shipping_freight_w_facilities"."TPE_OBJECT_ID" AS "TPE_OBJECT_ID",
        "domestic_shipping_freight_w_facilities"."O_FACILITY_ID" AS "O_FACILITY_ID",
        "domestic_shipping_freight_w_facilities"."D_FACILITY_ID" AS "D_FACILITY_ID",
        "domestic_shipping_freight_w_facilities"."TP_COMPANY_ID" AS "TP_COMPANY_ID",
        "domestic_shipping_freight_w_facilities"."PACKAGE_TYPE_ID" AS "PACKAGE_TYPE_ID",
        "domestic_shipping_freight_w_facilities"."COMPUTED_RATE" AS "COMPUTED_RATE",
        "domestic_shipping_freight_w_facilities"."COMPUTED_RATE_UOM" AS "COMPUTED_RATE_UOM",
        "domestic_shipping_freight_w_facilities"."COMPUTED_RATE_CALC_METHOD" AS "COMPUTED_RATE_CALC_METHOD",
        "domestic_shipping_freight_w_facilities"."COMPUTED_TOTAL_COST" AS "COMPUTED_TOTAL_COST",
        "domestic_shipping_freight_w_facilities"."COMPUTED_TOTAL_COST_CURR_CODE" AS "COMPUTED_TOTAL_COST_CURR_CODE",
        "domestic_shipping_freight_w_facilities"."O_FACILITY_NAME" AS "O_FACILITY_NAME",
        "domestic_shipping_freight_w_facilities"."D_FACILITY_NAME" AS "D_FACILITY_NAME",
        "domestic_shipping_freight_w_facilities"."COMPUTED_DISTANCE" AS "COMPUTED_DISTANCE",
        "domestic_shipping_freight_w_facilities"."COMPUTED_DISTANCE_UOM" AS "COMPUTED_DISTANCE_UOM",
        "domestic_shipping_freight_w_facilities"."COMPUTED_STOP_COST" AS "COMPUTED_STOP_COST",
        "domestic_shipping_freight_w_facilities"."COMPUTED_STOP_COST_CURR_CODE" AS "COMPUTED_STOP_COST_CURR_CODE",
        "domestic_shipping_freight_w_facilities"."APPROVED_DISTANCE" AS "APPROVED_DISTANCE",
        "domestic_shipping_freight_w_facilities"."APPROVED_LH_COST" AS "APPROVED_LH_COST",
        "domestic_shipping_freight_w_facilities"."APPROVED_RATE" AS "APPROVED_RATE",
        "domestic_shipping_freight_w_facilities"."APPROVED_FINANCIAL_WEIGHT" AS "APPROVED_FINANCIAL_WEIGHT",
        "domestic_shipping_freight_w_facilities"."APPROVED_ACTUAL_WEIGHT" AS "APPROVED_ACTUAL_WEIGHT",
        "domestic_shipping_freight_w_facilities"."RATE_ADJUSTMENT" AS "RATE_ADJUSTMENT",
        "domestic_shipping_freight_w_facilities"."MIN_CHARGE" AS "MIN_CHARGE",
        "domestic_shipping_freight_w_facilities"."COMPUTED_TARIFF" AS "COMPUTED_TARIFF",
        "domestic_shipping_freight_w_facilities"."COMPUTED_MIN_RATE" AS "COMPUTED_MIN_RATE",
        "domestic_shipping_freight_w_facilities"."UNDEFINED_ADJUSTMENT" AS "UNDEFINED_ADJUSTMENT",
        "domestic_shipping_freight_w_facilities"."DISCOUNT_AMOUNT" AS "DISCOUNT_AMOUNT",
        "domestic_shipping_freight_w_facilities"."UNDEFINED_ADJ_CURR_CODE" AS "UNDEFINED_ADJ_CURR_CODE",
        "domestic_shipping_freight_w_facilities"."DISCOUNT_AMT_CURR_CODE" AS "DISCOUNT_AMT_CURR_CODE",
        "domestic_shipping_freight_w_facilities"."RATE_CURR_CODE" AS "RATE_CURR_CODE",
        "domestic_shipping_freight_w_facilities"."CARRIER_ID" AS "CARRIER_ID",
        "domestic_shipping_freight_w_facilities"."ASSIGNED_CARRIER_ID" AS "ASSIGNED_CARRIER_ID",
        "domestic_shipping_freight_w_facilities"."EQUIPMENT_ID" AS "EQUIPMENT_ID",
        "domestic_shipping_freight_w_facilities"."MOT_ID" AS "MOT_ID",
        "domestic_shipping_freight_w_facilities"."PROTECTION_LEVEL_ID" AS "PROTECTION_LEVEL_ID",
        "domestic_shipping_freight_w_facilities"."SERVICE_LEVEL_ID" AS "SERVICE_LEVEL_ID",
        "domestic_shipping_freight_w_facilities"."UNDF_ADJ_CURR_CODE" AS "UNDF_ADJ_CURR_CODE",
        "domestic_shipping_freight_w_facilities"."COMPUTED_FINANCIAL_WEIGHT" AS "COMPUTED_FINANCIAL_WEIGHT",
        "domestic_shipping_freight_w_facilities"."ADJUSTMENT_AMOUNT" AS "ADJUSTMENT_AMOUNT",
        "domestic_shipping_freight_w_facilities"."APPROVED_ADJUSTMENT_AMOUNT" AS "APPROVED_ADJUSTMENT_AMOUNT",
        "domestic_shipping_freight_w_facilities"."APPROVED_STOP_COST" AS "APPROVED_STOP_COST",
        "domestic_shipping_freight_w_facilities"."APPROVED_RATE_ADJUSTMENT" AS "APPROVED_RATE_ADJUSTMENT",
        "domestic_shipping_freight_w_facilities"."APPROVED_RATE_CALC_METHOD" AS "APPROVED_RATE_CALC_METHOD",
        "domestic_shipping_freight_w_facilities"."APPROVED_RATE_UOM" AS "APPROVED_RATE_UOM",
        "domestic_shipping_freight_w_facilities"."APPROVED_DISTANCE_UOM" AS "APPROVED_DISTANCE_UOM",
        "domestic_shipping_freight_w_facilities"."COMPUTED_LH_COST" AS "COMPUTED_LH_COST",
        "domestic_shipping_freight_w_facilities"."COMPUTED_LH_COST_CURR_CODE" AS "COMPUTED_LH_COST_CURR_CODE",
        "domestic_shipping_freight_w_facilities"."WEIGHT_UOM_ID" AS "WEIGHT_UOM_ID",
        "domestic_shipping_freight_w_facilities"."APPROVED_WEIGHT_UOM_ID" AS "APPROVED_WEIGHT_UOM_ID",
        "domestic_shipping_freight_w_facilities"."INV_MIN_RATE" AS "INV_MIN_RATE",
        "domestic_shipping_freight_w_facilities"."SYS_MIN_RATE" AS "SYS_MIN_RATE",
        "domestic_shipping_freight_w_facilities"."UNAPPLIED_LH_COST" AS "UNAPPLIED_LH_COST",
        "domestic_shipping_freight_w_facilities"."UNAPPLIED_LH_CURRENCY_CODE" AS "UNAPPLIED_LH_CURRENCY_CODE",
        "domestic_shipping_freight_w_facilities"."UNAPPLIED_STOP_COST" AS "UNAPPLIED_STOP_COST",
        "domestic_shipping_freight_w_facilities"."UNAPPLIED_STOP_CURRENCY_CODE" AS "UNAPPLIED_STOP_CURRENCY_CODE",
        "domestic_shipping_freight_w_facilities"."ORG_SHIP_VIA_FACILITY_ID" AS "ORG_SHIP_VIA_FACILITY_ID",
        "domestic_shipping_freight_w_facilities"."ORG_SHIP_VIA_FACILITY_ALIAS_ID" AS "ORG_SHIP_VIA_FACILITY_ALIAS_ID",
        "domestic_shipping_freight_w_facilities"."DES_SHIP_VIA_FACILITY_ID" AS "DES_SHIP_VIA_FACILITY_ID",
        "domestic_shipping_freight_w_facilities"."DES_SHIP_VIA_FACILITY_ALIAS_ID" AS "DES_SHIP_VIA_FACILITY_ALIAS_ID",
        "domestic_shipping_freight_w_facilities"."INCOTERM_ID" AS "INCOTERM_ID",
        "domestic_shipping_freight_w_facilities"."SEC_CARRIER_ID" AS "SEC_CARRIER_ID",
        "domestic_shipping_freight_w_facilities"."COMMODITY_CLASS" AS "COMMODITY_CLASS",
        "domestic_shipping_freight_w_facilities"."ACTUAL_PAYMENT_AMOUNT" AS "ACTUAL_PAYMENT_AMOUNT",
        "domestic_shipping_freight_w_facilities"."ACTUAL_CURRENCY_CODE" AS "ACTUAL_CURRENCY_CODE",
        "domestic_shipping_freight_w_facilities"."NET_AMOUNT_CURRENCY_CODE" AS "NET_AMOUNT_CURRENCY_CODE",
        "domestic_shipping_freight_w_facilities"."NET_AMOUNT_DUE" AS "NET_AMOUNT_DUE",
        "domestic_shipping_freight_w_facilities"."NORMALIZED_NET_AMOUNT_DUE" AS "NORMALIZED_NET_AMOUNT_DUE",
        "domestic_shipping_freight_w_facilities"."REF_INV_OBJECT_PAID_AMOUNT" AS "REF_INV_OBJECT_PAID_AMOUNT",
        "domestic_shipping_freight_w_facilities"."REF_INV_OBJECT_PAID_AMOUNT_CC" AS "REF_INV_OBJECT_PAID_AMOUNT_CC",
        "domestic_shipping_freight_w_facilities"."REF_INV_OBJECT_AMOUNT" AS "REF_INV_OBJECT_AMOUNT",
        "domestic_shipping_freight_w_facilities"."REF_INV_OBJECT_AMOUNT_CC" AS "REF_INV_OBJECT_AMOUNT_CC",
        "domestic_shipping_freight_w_facilities"."REF_INVOICED_OBJECT_ID" AS "REF_INVOICED_OBJECT_ID",
        "domestic_shipping_freight_w_facilities"."INCOTERM_CODE" AS "INCOTERM_CODE",
        "domestic_shipping_freight_w_facilities"."ACTUAL_VOLUME" AS "ACTUAL_VOLUME",
        "domestic_shipping_freight_w_facilities"."VOLUME_UOM_ID" AS "VOLUME_UOM_ID",
        "domestic_shipping_freight_w_facilities"."COMPUTED_VOLUME" AS "COMPUTED_VOLUME",
        "domestic_shipping_freight_w_facilities"."COMPUTED_VOLUME_UOM_ID" AS "COMPUTED_VOLUME_UOM_ID",
        "domestic_shipping_freight_w_facilities"."APPROVED_VOLUME" AS "APPROVED_VOLUME",
        "domestic_shipping_freight_w_facilities"."APPROVED_VOLUME_UOM_ID" AS "APPROVED_VOLUME_UOM_ID",
        "domestic_shipping_freight_w_facilities"."VOLUME_UOM" AS "VOLUME_UOM",
        "domestic_shipping_freight_w_facilities"."WEIGHT_UOM" AS "WEIGHT_UOM",
        "domestic_shipping_freight_w_facilities"."INV_OBJ_GRS_AMT_DUE_CURR_CODE" AS "INV_OBJ_GRS_AMT_DUE_CURR_CODE",
        "domestic_shipping_freight_w_facilities"."INV_OBJ_TAX_AM_DUE_CURR_CODE" AS "INV_OBJ_TAX_AM_DUE_CURR_CODE",
        "domestic_shipping_freight_w_facilities"."INV_OBJ_TAX_AMT_DUE" AS "INV_OBJ_TAX_AMT_DUE",
        "domestic_shipping_freight_w_facilities"."INV_OBJ_GRS_AMT_DUE" AS "INV_OBJ_GRS_AMT_DUE",
        "domestic_shipping_freight_w_facilities"."TRACKING_NUMBER" AS "TRACKING_NUMBER",
        "domestic_shipping_freight_w_facilities"."LENGTH" AS "LENGTH",
        "domestic_shipping_freight_w_facilities"."WIDTH" AS "WIDTH",
        "domestic_shipping_freight_w_facilities"."HEIGHT" AS "HEIGHT",
        "domestic_shipping_freight_w_facilities"."ADJ_RATE" AS "ADJ_RATE",
        "domestic_shipping_freight_w_facilities"."COMPUTED_ADJ_RATE" AS "COMPUTED_ADJ_RATE",
        "domestic_shipping_freight_w_facilities"."APPROVED_ADJ_RATE" AS "APPROVED_ADJ_RATE",
        "domestic_shipping_freight_w_facilities"."ADJ_LH_COST" AS "ADJ_LH_COST",
        "domestic_shipping_freight_w_facilities"."COMPUTED_ADJ_LH_COST" AS "COMPUTED_ADJ_LH_COST",
        "domestic_shipping_freight_w_facilities"."APPROVED_ADJ_LH_COST" AS "APPROVED_ADJ_LH_COST",
        "domestic_shipping_freight_w_facilities"."ENTRY_TYPE" AS "ENTRY_TYPE",
        "domestic_shipping_freight_w_facilities"."PICKUP_NUMBER" AS "PICKUP_NUMBER",
        "domestic_shipping_freight_w_facilities"."MONETARY_VALUE" AS "MONETARY_VALUE",
        "domestic_shipping_freight_w_facilities"."MONETARY_VALUE_CURRENCY_CODE" AS "MONETARY_VALUE_CURRENCY_CODE",
        "domestic_shipping_freight_w_facilities"."MANIFEST_TYPE" AS "MANIFEST_TYPE",
        "domestic_shipping_freight_w_facilities"."NON_MACHINABLE" AS "NON_MACHINABLE",
        "domestic_shipping_freight_w_facilities"."LENGTH_UOM_ID" AS "LENGTH_UOM_ID",
        "domestic_shipping_freight_w_facilities"."RATING_LEVEL" AS "RATING_LEVEL",
        "domestic_shipping_freight_w_facilities"."WIDTH_UOM_ID" AS "WIDTH_UOM_ID",
        "domestic_shipping_freight_w_facilities"."HEIGHT_UOM_ID" AS "HEIGHT_UOM_ID",
        "domestic_shipping_freight_w_facilities"."MARK_FOR_DELETION" AS "MARK_FOR_DELETION",
        "domestic_shipping_freight_w_facilities"."BILLING_METHOD" AS "BILLING_METHOD",
        "domestic_shipping_freight_w_facilities"."LAST_UPDATED_SOURCE_TYPE" AS "LAST_UPDATED_SOURCE_TYPE",
        "domestic_shipping_freight_w_facilities"."UNAPPLIED_SPOT_COST" AS "UNAPPLIED_SPOT_COST",
        "domestic_shipping_freight_w_facilities"."UNAPPLIED_SPOT_CURRENCY_CODE" AS "UNAPPLIED_SPOT_CURRENCY_CODE",
        "domestic_shipping_freight_w_facilities"."APPROVED_SPOT_COST" AS "APPROVED_SPOT_COST",
        "domestic_shipping_freight_w_facilities"."INVOICE_DTL_ID" AS "INVOICE_DTL_ID",
        "domestic_shipping_freight_w_facilities"."VESSEL_NUMBER" AS "VESSEL_NUMBER",
        "domestic_shipping_freight_w_facilities"."VOYAGE_FLIGHT_NUMBER" AS "VOYAGE_FLIGHT_NUMBER",
        "domestic_shipping_freight_w_facilities"."BOOKING_TYPE" AS "BOOKING_TYPE",
        "domestic_shipping_freight_w_facilities"."PRO_NUMBER" AS "PRO_NUMBER",
        "domestic_shipping_freight_w_facilities"."TRAILER_NUMBER" AS "TRAILER_NUMBER",
        "domestic_shipping_freight_w_facilities"."COMMODITY_CODE_ID" AS "COMMODITY_CODE_ID",
        "domestic_shipping_freight_w_facilities"."UNAPPLIED_TOTAL_BALANCE" AS "UNAPPLIED_TOTAL_BALANCE",
        "domestic_shipping_freight_w_facilities"."APPROVED_TOTAL_BALANCE" AS "APPROVED_TOTAL_BALANCE",
        "domestic_shipping_freight_w_facilities"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP",
        "domestic_shipping_freight_w_facilities"."OPERATION_TYPE" AS "OPERATION_TYPE",
        "domestic_shipping_freight_w_facilities"."ARCHIVED_DTTM" AS "ARCHIVED_DTTM",
        "domestic_shipping_freight_w_facilities"."INVOICE_DT" AS "INVOICE_DT",
        "domestic_shipping_freight_w_facilities"."invoice_date_parsed" AS "invoice_date_parsed",
        "domestic_shipping_freight_w_facilities"."NUM_REJECTIONS" AS "NUM_REJECTIONS",
        "domestic_shipping_freight_w_facilities"."TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID",
        "domestic_shipping_freight_w_facilities"."DELIVERY_START_DTTM" AS "DELIVERY_START_DTTM",
        "domestic_shipping_freight_w_facilities"."delivery_date_parsed" AS "delivery_date_parsed",
        "domestic_shipping_freight_w_facilities"."DELIVERY_END_DTTM" AS "DELIVERY_END_DTTM",
        "domestic_shipping_freight_w_facilities"."ORIGIN" AS "ORIGIN",
        "domestic_shipping_freight_w_facilities"."FINAL_DESTINATION" AS "FINAL_DESTINATION",
        "domestic_shipping_freight_w_facilities"."actual_delivery_date_parsed" AS "actual_delivery_date_parsed",
        "domestic_shipping_freight_w_facilities"."VENDOR_ID" AS "VENDOR_ID",
        "domestic_shipping_freight_w_facilities"."VENDOR_NAME" AS "VENDOR_NAME",
        "domestic_shipping_freight_w_facilities"."flag_wood_pellet_combined" AS "flag_wood_pellet_combined",
        "domestic_shipping_freight_w_facilities"."cal_MERCH_YEAR" AS "cal_MERCH_YEAR",
        "domestic_shipping_freight_w_facilities"."cal_YEAR_WEEK" AS "cal_YEAR_WEEK",
        "domestic_shipping_freight_w_facilities"."cal_YEAR_QUARTER" AS "cal_YEAR_QUARTER",
        "domestic_shipping_freight_w_facilities"."cal_YEAR_PERIOD" AS "cal_YEAR_PERIOD",
        "domestic_shipping_freight_w_facilities"."del_MERCH_YEAR" AS "del_MERCH_YEAR",
        "domestic_shipping_freight_w_facilities"."del_YEAR_WEEK" AS "del_YEAR_WEEK",
        "domestic_shipping_freight_w_facilities"."del_YEAR_QUARTER" AS "del_YEAR_QUARTER",
        "domestic_shipping_freight_w_facilities"."del_YEAR_PERIOD" AS "del_YEAR_PERIOD",
        "domestic_shipping_freight_w_facilities"."act_del_MERCH_YEAR" AS "act_del_MERCH_YEAR",
        "domestic_shipping_freight_w_facilities"."act_del_YEAR_WEEK" AS "act_del_YEAR_WEEK",
        "domestic_shipping_freight_w_facilities"."act_del_YEAR_QUARTER" AS "act_del_YEAR_QUARTER",
        "domestic_shipping_freight_w_facilities"."act_del_YEAR_PERIOD" AS "act_del_YEAR_PERIOD",
        "domestic_shipping_freight_w_facilities"."TOTAL_COST" AS "TOTAL_COST",
        "domestic_shipping_freight_w_facilities"."org_Facility_Code" AS "org_Facility_Code",
        "domestic_shipping_freight_w_facilities"."org_Facility_Name" AS "org_Facility_Name",
        "domestic_shipping_freight_w_facilities"."org_Facility_Type" AS "org_Facility_Type",
        "domestic_shipping_freight_w_facilities"."dest_Facility_Code" AS "dest_Facility_Code",
        "domestic_shipping_freight_w_facilities"."dest_Facility_Name" AS "dest_Facility_Name",
        "domestic_shipping_freight_w_facilities"."dest_Facility_Type" AS "dest_Facility_Type",
        "domestic_shipping_freight_w_facilities"."inbound_flag" AS "inbound_flag"
      FROM "DOMESTIC_SHIPPING_FREIGHT_W_FACILITIES" "domestic_shipping_freight_w_facilities"
      LEFT JOIN (
        SELECT 
            "VENDOR_ID" AS "VENDOR_ID",
            1 AS "wood_pellet"
          FROM (
            SELECT *
              FROM wood_pellet_vendors_w_number_by_vendor_id "TENANT149_DATA_wood_pellet_vendors_w_number_by_VENDOR_ID_prepared"
            ) "withoutcomputedcols_query"
        ) "TENANT149_DATA_wood_pellet_vendors_w_number_by_VENDOR_ID_prepared"
        ON "domestic_shipping_freight_w_facilities"."org_Facility_Code" = "TENANT149_DATA_wood_pellet_vendors_w_number_by_VENDOR_ID_prepared"."VENDOR_ID"
      LEFT JOIN (
        SELECT 
            "VENDOR_NAME" AS "VENDOR_NAME",
            1 AS "wood_pellet_2"
          FROM (
            SELECT *
              FROM "WOOD_PELLET_VENDORS_PREPARED_W_NAME" "wood_pellet_vendors_prepared_w_name"
            ) "withoutcomputedcols_query"
        ) "wood_pellet_vendors_prepared_w_name"
        ON "domestic_shipping_freight_w_facilities"."org_Facility_Name" = "wood_pellet_vendors_prepared_w_name"."VENDOR_NAME"
      LEFT JOIN (
        SELECT 
            "VENDOR_ID" AS "vendor_id",
            1 AS "wood_pellet_3"
          FROM (
            SELECT *
              FROM "WOOD_PELLET_VENDORS_W_IDS_PREPARED_BY_VENDOR_ID" "wood_pellet_vendors_w_ids_prepared_by_vendor_id"
            ) "withoutcomputedcols_query"
        ) "wood_pellet_vendors_w_ids_prepared_by_vendor_id"
        ON "domestic_shipping_freight_w_facilities"."ORIGIN" = "wood_pellet_vendors_w_ids_prepared_by_vendor_id"."vendor_id"
          WHERE  COALESCE("wood_pellet_vendors_w_ids_prepared_by_vendor_id"."wood_pellet_3","wood_pellet_vendors_prepared_w_name"."wood_pellet_2" , 
      "TENANT149_DATA_wood_pellet_vendors_w_number_by_VENDOR_ID_prepared"."wood_pellet", 0) = 0
       AND ( ("inbound_flag" = 'Outbound') AND "org_Facility_Code" IS NOT NULL AND "dest_Facility_Code" IS NOT NULL)
       )
     SELECT 
    "domestic_shipping_freight_outbound"."INV_ID" AS "INV_ID",
    "domestic_shipping_freight_outbound"."INV_OBJECT_ID" AS "INV_OBJECT_ID",
    "domestic_shipping_freight_outbound"."TC_COMPANY_ID" AS "TC_COMPANY_ID",
    "domestic_shipping_freight_outbound"."TC_OBJECT_ID" AS "TC_OBJECT_ID",
    "domestic_shipping_freight_outbound"."INV_OBJECT_STATUS" AS "INV_OBJECT_STATUS",
    "domestic_shipping_freight_outbound"."O_NAME" AS "O_NAME",
    "domestic_shipping_freight_outbound"."O_ADDRESS" AS "O_ADDRESS",
    "domestic_shipping_freight_outbound"."O_CITY" AS "O_CITY",
    "domestic_shipping_freight_outbound"."O_COUNTY" AS "O_COUNTY",
    "domestic_shipping_freight_outbound"."O_STATE_PROV" AS "O_STATE_PROV",
    "domestic_shipping_freight_outbound"."O_POSTAL_CODE" AS "O_POSTAL_CODE",
    "domestic_shipping_freight_outbound"."O_COUNTRY_CODE" AS "O_COUNTRY_CODE",
    "domestic_shipping_freight_outbound"."D_NAME" AS "D_NAME",
    "domestic_shipping_freight_outbound"."D_ADDRESS" AS "D_ADDRESS",
    "domestic_shipping_freight_outbound"."D_CITY" AS "D_CITY",
    "domestic_shipping_freight_outbound"."D_COUNTY" AS "D_COUNTY",
    "domestic_shipping_freight_outbound"."D_STATE_PROV" AS "D_STATE_PROV",
    "domestic_shipping_freight_outbound"."D_POSTAL_CODE" AS "D_POSTAL_CODE",
    "domestic_shipping_freight_outbound"."D_COUNTRY_CODE" AS "D_COUNTRY_CODE",
    "domestic_shipping_freight_outbound"."MOT_DESC" AS "MOT_DESC",
    "domestic_shipping_freight_outbound"."EQUIPMENT_DESC" AS "EQUIPMENT_DESC",
    "domestic_shipping_freight_outbound"."SERVICE_LEVEL_DESC" AS "SERVICE_LEVEL_DESC",
    "domestic_shipping_freight_outbound"."PROTECTION_LEVEL_DESC" AS "PROTECTION_LEVEL_DESC",
    "domestic_shipping_freight_outbound"."FINANCIAL_WEIGHT" AS "FINANCIAL_WEIGHT",
    "domestic_shipping_freight_outbound"."ACTUAL_WEIGHT" AS "ACTUAL_WEIGHT",
    "domestic_shipping_freight_outbound"."LH_COST" AS "LH_COST",
    "domestic_shipping_freight_outbound"."DISTANCE" AS "DISTANCE",
    "domestic_shipping_freight_outbound"."DISTANCE_UOM" AS "DISTANCE_UOM",
    "domestic_shipping_freight_outbound"."BILL_OF_LADING_NUMBER" AS "BILL_OF_LADING_NUMBER",
    "domestic_shipping_freight_outbound"."PO_NUMBER" AS "PO_NUMBER",
    "domestic_shipping_freight_outbound"."SPEC_HANDLING_METHOD" AS "SPEC_HANDLING_METHOD",
    "domestic_shipping_freight_outbound"."COMMENTS" AS "COMMENTS",
    "domestic_shipping_freight_outbound"."HAS_IMPORT_ERROR" AS "HAS_IMPORT_ERROR",
    "domestic_shipping_freight_outbound"."HAS_WARNING" AS "HAS_WARNING",
    "domestic_shipping_freight_outbound"."IS_VALID" AS "IS_VALID",
    "domestic_shipping_freight_outbound"."CREATED_SOURCE_TYPE" AS "CREATED_SOURCE_TYPE",
    "domestic_shipping_freight_outbound"."CREATED_SOURCE" AS "CREATED_SOURCE",
    "domestic_shipping_freight_outbound"."CREATED_DTTM" AS "CREATED_DTTM",
    "domestic_shipping_freight_outbound"."LAST_UPDATED_SOURCE" AS "LAST_UPDATED_SOURCE",
    "domestic_shipping_freight_outbound"."LAST_UPDATED_DTTM" AS "LAST_UPDATED_DTTM",
    "domestic_shipping_freight_outbound"."STOP_COST" AS "STOP_COST",
    "domestic_shipping_freight_outbound"."AUXILARY_DATA" AS "AUXILARY_DATA",
    "domestic_shipping_freight_outbound"."PICKUP_DTTM" AS "PICKUP_DTTM",
    "domestic_shipping_freight_outbound"."DELIVERY_DTTM" AS "DELIVERY_DTTM",
    "domestic_shipping_freight_outbound"."CURRENCY_CODE" AS "CURRENCY_CODE",
    "domestic_shipping_freight_outbound"."LH_CURRENCY_CODE" AS "LH_CURRENCY_CODE",
    "domestic_shipping_freight_outbound"."STOP_CURRENCY_CODE" AS "STOP_CURRENCY_CODE",
    "domestic_shipping_freight_outbound"."SPOT_CHARGE_COST" AS "SPOT_CHARGE_COST",
    "domestic_shipping_freight_outbound"."SPOT_CHARGE_CURRENCY_CODE" AS "SPOT_CHARGE_CURRENCY_CODE",
    "domestic_shipping_freight_outbound"."ASSIGNED_CARRIER_CODE" AS "ASSIGNED_CARRIER_CODE",
    "domestic_shipping_freight_outbound"."NUM_PICKUPS" AS "NUM_PICKUPS",
    "domestic_shipping_freight_outbound"."NUM_DELIVERIES" AS "NUM_DELIVERIES",
    "domestic_shipping_freight_outbound"."RATE" AS "RATE",
    "domestic_shipping_freight_outbound"."RATE_CALC_METHOD" AS "RATE_CALC_METHOD",
    "domestic_shipping_freight_outbound"."RATE_UOM" AS "RATE_UOM",
    "domestic_shipping_freight_outbound"."TPE_OBJECT_ID" AS "TPE_OBJECT_ID",
    "domestic_shipping_freight_outbound"."O_FACILITY_ID" AS "O_FACILITY_ID",
    "domestic_shipping_freight_outbound"."D_FACILITY_ID" AS "D_FACILITY_ID",
    "domestic_shipping_freight_outbound"."TP_COMPANY_ID" AS "TP_COMPANY_ID",
    "domestic_shipping_freight_outbound"."PACKAGE_TYPE_ID" AS "PACKAGE_TYPE_ID",
    "domestic_shipping_freight_outbound"."COMPUTED_RATE" AS "COMPUTED_RATE",
    "domestic_shipping_freight_outbound"."COMPUTED_RATE_UOM" AS "COMPUTED_RATE_UOM",
    "domestic_shipping_freight_outbound"."COMPUTED_RATE_CALC_METHOD" AS "COMPUTED_RATE_CALC_METHOD",
    "domestic_shipping_freight_outbound"."COMPUTED_TOTAL_COST" AS "COMPUTED_TOTAL_COST",
    "domestic_shipping_freight_outbound"."COMPUTED_TOTAL_COST_CURR_CODE" AS "COMPUTED_TOTAL_COST_CURR_CODE",
    "domestic_shipping_freight_outbound"."O_FACILITY_NAME" AS "O_FACILITY_NAME",
    "domestic_shipping_freight_outbound"."D_FACILITY_NAME" AS "D_FACILITY_NAME",
    "domestic_shipping_freight_outbound"."COMPUTED_DISTANCE" AS "COMPUTED_DISTANCE",
    "domestic_shipping_freight_outbound"."COMPUTED_DISTANCE_UOM" AS "COMPUTED_DISTANCE_UOM",
    "domestic_shipping_freight_outbound"."COMPUTED_STOP_COST" AS "COMPUTED_STOP_COST",
    "domestic_shipping_freight_outbound"."COMPUTED_STOP_COST_CURR_CODE" AS "COMPUTED_STOP_COST_CURR_CODE",
    "domestic_shipping_freight_outbound"."APPROVED_DISTANCE" AS "APPROVED_DISTANCE",
    "domestic_shipping_freight_outbound"."APPROVED_LH_COST" AS "APPROVED_LH_COST",
    "domestic_shipping_freight_outbound"."APPROVED_RATE" AS "APPROVED_RATE",
    "domestic_shipping_freight_outbound"."APPROVED_FINANCIAL_WEIGHT" AS "APPROVED_FINANCIAL_WEIGHT",
    "domestic_shipping_freight_outbound"."APPROVED_ACTUAL_WEIGHT" AS "APPROVED_ACTUAL_WEIGHT",
    "domestic_shipping_freight_outbound"."RATE_ADJUSTMENT" AS "RATE_ADJUSTMENT",
    "domestic_shipping_freight_outbound"."MIN_CHARGE" AS "MIN_CHARGE",
    "domestic_shipping_freight_outbound"."COMPUTED_TARIFF" AS "COMPUTED_TARIFF",
    "domestic_shipping_freight_outbound"."COMPUTED_MIN_RATE" AS "COMPUTED_MIN_RATE",
    "domestic_shipping_freight_outbound"."UNDEFINED_ADJUSTMENT" AS "UNDEFINED_ADJUSTMENT",
    "domestic_shipping_freight_outbound"."DISCOUNT_AMOUNT" AS "DISCOUNT_AMOUNT",
    "domestic_shipping_freight_outbound"."UNDEFINED_ADJ_CURR_CODE" AS "UNDEFINED_ADJ_CURR_CODE",
    "domestic_shipping_freight_outbound"."DISCOUNT_AMT_CURR_CODE" AS "DISCOUNT_AMT_CURR_CODE",
    "domestic_shipping_freight_outbound"."RATE_CURR_CODE" AS "RATE_CURR_CODE",
    "domestic_shipping_freight_outbound"."CARRIER_ID" AS "CARRIER_ID",
    "domestic_shipping_freight_outbound"."ASSIGNED_CARRIER_ID" AS "ASSIGNED_CARRIER_ID",
    "domestic_shipping_freight_outbound"."EQUIPMENT_ID" AS "EQUIPMENT_ID",
    "domestic_shipping_freight_outbound"."MOT_ID" AS "MOT_ID",
    "domestic_shipping_freight_outbound"."PROTECTION_LEVEL_ID" AS "PROTECTION_LEVEL_ID",
    "domestic_shipping_freight_outbound"."SERVICE_LEVEL_ID" AS "SERVICE_LEVEL_ID",
    "domestic_shipping_freight_outbound"."UNDF_ADJ_CURR_CODE" AS "UNDF_ADJ_CURR_CODE",
    "domestic_shipping_freight_outbound"."COMPUTED_FINANCIAL_WEIGHT" AS "COMPUTED_FINANCIAL_WEIGHT",
    "domestic_shipping_freight_outbound"."ADJUSTMENT_AMOUNT" AS "ADJUSTMENT_AMOUNT",
    "domestic_shipping_freight_outbound"."APPROVED_ADJUSTMENT_AMOUNT" AS "APPROVED_ADJUSTMENT_AMOUNT",
    "domestic_shipping_freight_outbound"."APPROVED_STOP_COST" AS "APPROVED_STOP_COST",
    "domestic_shipping_freight_outbound"."APPROVED_RATE_ADJUSTMENT" AS "APPROVED_RATE_ADJUSTMENT",
    "domestic_shipping_freight_outbound"."APPROVED_RATE_CALC_METHOD" AS "APPROVED_RATE_CALC_METHOD",
    "domestic_shipping_freight_outbound"."APPROVED_RATE_UOM" AS "APPROVED_RATE_UOM",
    "domestic_shipping_freight_outbound"."APPROVED_DISTANCE_UOM" AS "APPROVED_DISTANCE_UOM",
    "domestic_shipping_freight_outbound"."COMPUTED_LH_COST" AS "COMPUTED_LH_COST",
    "domestic_shipping_freight_outbound"."COMPUTED_LH_COST_CURR_CODE" AS "COMPUTED_LH_COST_CURR_CODE",
    "domestic_shipping_freight_outbound"."WEIGHT_UOM_ID" AS "WEIGHT_UOM_ID",
    "domestic_shipping_freight_outbound"."APPROVED_WEIGHT_UOM_ID" AS "APPROVED_WEIGHT_UOM_ID",
    "domestic_shipping_freight_outbound"."INV_MIN_RATE" AS "INV_MIN_RATE",
    "domestic_shipping_freight_outbound"."SYS_MIN_RATE" AS "SYS_MIN_RATE",
    "domestic_shipping_freight_outbound"."UNAPPLIED_LH_COST" AS "UNAPPLIED_LH_COST",
    "domestic_shipping_freight_outbound"."UNAPPLIED_LH_CURRENCY_CODE" AS "UNAPPLIED_LH_CURRENCY_CODE",
    "domestic_shipping_freight_outbound"."UNAPPLIED_STOP_COST" AS "UNAPPLIED_STOP_COST",
    "domestic_shipping_freight_outbound"."UNAPPLIED_STOP_CURRENCY_CODE" AS "UNAPPLIED_STOP_CURRENCY_CODE",
    "domestic_shipping_freight_outbound"."ORG_SHIP_VIA_FACILITY_ID" AS "ORG_SHIP_VIA_FACILITY_ID",
    "domestic_shipping_freight_outbound"."ORG_SHIP_VIA_FACILITY_ALIAS_ID" AS "ORG_SHIP_VIA_FACILITY_ALIAS_ID",
    "domestic_shipping_freight_outbound"."DES_SHIP_VIA_FACILITY_ID" AS "DES_SHIP_VIA_FACILITY_ID",
    "domestic_shipping_freight_outbound"."DES_SHIP_VIA_FACILITY_ALIAS_ID" AS "DES_SHIP_VIA_FACILITY_ALIAS_ID",
    "domestic_shipping_freight_outbound"."INCOTERM_ID" AS "INCOTERM_ID",
    "domestic_shipping_freight_outbound"."SEC_CARRIER_ID" AS "SEC_CARRIER_ID",
    "domestic_shipping_freight_outbound"."COMMODITY_CLASS" AS "COMMODITY_CLASS",
    "domestic_shipping_freight_outbound"."ACTUAL_PAYMENT_AMOUNT" AS "ACTUAL_PAYMENT_AMOUNT",
    "domestic_shipping_freight_outbound"."ACTUAL_CURRENCY_CODE" AS "ACTUAL_CURRENCY_CODE",
    "domestic_shipping_freight_outbound"."NET_AMOUNT_CURRENCY_CODE" AS "NET_AMOUNT_CURRENCY_CODE",
    "domestic_shipping_freight_outbound"."NET_AMOUNT_DUE" AS "NET_AMOUNT_DUE",
    "domestic_shipping_freight_outbound"."NORMALIZED_NET_AMOUNT_DUE" AS "NORMALIZED_NET_AMOUNT_DUE",
    "domestic_shipping_freight_outbound"."REF_INV_OBJECT_PAID_AMOUNT" AS "REF_INV_OBJECT_PAID_AMOUNT",
    "domestic_shipping_freight_outbound"."REF_INV_OBJECT_PAID_AMOUNT_CC" AS "REF_INV_OBJECT_PAID_AMOUNT_CC",
    "domestic_shipping_freight_outbound"."REF_INV_OBJECT_AMOUNT" AS "REF_INV_OBJECT_AMOUNT",
    "domestic_shipping_freight_outbound"."REF_INV_OBJECT_AMOUNT_CC" AS "REF_INV_OBJECT_AMOUNT_CC",
    "domestic_shipping_freight_outbound"."REF_INVOICED_OBJECT_ID" AS "REF_INVOICED_OBJECT_ID",
    "domestic_shipping_freight_outbound"."INCOTERM_CODE" AS "INCOTERM_CODE",
    "domestic_shipping_freight_outbound"."ACTUAL_VOLUME" AS "ACTUAL_VOLUME",
    "domestic_shipping_freight_outbound"."VOLUME_UOM_ID" AS "VOLUME_UOM_ID",
    "domestic_shipping_freight_outbound"."COMPUTED_VOLUME" AS "COMPUTED_VOLUME",
    "domestic_shipping_freight_outbound"."COMPUTED_VOLUME_UOM_ID" AS "COMPUTED_VOLUME_UOM_ID",
    "domestic_shipping_freight_outbound"."APPROVED_VOLUME" AS "APPROVED_VOLUME",
    "domestic_shipping_freight_outbound"."APPROVED_VOLUME_UOM_ID" AS "APPROVED_VOLUME_UOM_ID",
    "domestic_shipping_freight_outbound"."VOLUME_UOM" AS "VOLUME_UOM",
    "domestic_shipping_freight_outbound"."WEIGHT_UOM" AS "WEIGHT_UOM",
    "domestic_shipping_freight_outbound"."INV_OBJ_GRS_AMT_DUE_CURR_CODE" AS "INV_OBJ_GRS_AMT_DUE_CURR_CODE",
    "domestic_shipping_freight_outbound"."INV_OBJ_TAX_AM_DUE_CURR_CODE" AS "INV_OBJ_TAX_AM_DUE_CURR_CODE",
    "domestic_shipping_freight_outbound"."INV_OBJ_TAX_AMT_DUE" AS "INV_OBJ_TAX_AMT_DUE",
    "domestic_shipping_freight_outbound"."INV_OBJ_GRS_AMT_DUE" AS "INV_OBJ_GRS_AMT_DUE",
    "domestic_shipping_freight_outbound"."TRACKING_NUMBER" AS "TRACKING_NUMBER",
    "domestic_shipping_freight_outbound"."LENGTH" AS "LENGTH",
    "domestic_shipping_freight_outbound"."WIDTH" AS "WIDTH",
    "domestic_shipping_freight_outbound"."HEIGHT" AS "HEIGHT",
    "domestic_shipping_freight_outbound"."ADJ_RATE" AS "ADJ_RATE",
    "domestic_shipping_freight_outbound"."COMPUTED_ADJ_RATE" AS "COMPUTED_ADJ_RATE",
    "domestic_shipping_freight_outbound"."APPROVED_ADJ_RATE" AS "APPROVED_ADJ_RATE",
    "domestic_shipping_freight_outbound"."ADJ_LH_COST" AS "ADJ_LH_COST",
    "domestic_shipping_freight_outbound"."COMPUTED_ADJ_LH_COST" AS "COMPUTED_ADJ_LH_COST",
    "domestic_shipping_freight_outbound"."APPROVED_ADJ_LH_COST" AS "APPROVED_ADJ_LH_COST",
    "domestic_shipping_freight_outbound"."ENTRY_TYPE" AS "ENTRY_TYPE",
    "domestic_shipping_freight_outbound"."PICKUP_NUMBER" AS "PICKUP_NUMBER",
    "domestic_shipping_freight_outbound"."MONETARY_VALUE" AS "MONETARY_VALUE",
    "domestic_shipping_freight_outbound"."MONETARY_VALUE_CURRENCY_CODE" AS "MONETARY_VALUE_CURRENCY_CODE",
    "domestic_shipping_freight_outbound"."MANIFEST_TYPE" AS "MANIFEST_TYPE",
    "domestic_shipping_freight_outbound"."NON_MACHINABLE" AS "NON_MACHINABLE",
    "domestic_shipping_freight_outbound"."LENGTH_UOM_ID" AS "LENGTH_UOM_ID",
    "domestic_shipping_freight_outbound"."RATING_LEVEL" AS "RATING_LEVEL",
    "domestic_shipping_freight_outbound"."WIDTH_UOM_ID" AS "WIDTH_UOM_ID",
    "domestic_shipping_freight_outbound"."HEIGHT_UOM_ID" AS "HEIGHT_UOM_ID",
    "domestic_shipping_freight_outbound"."MARK_FOR_DELETION" AS "MARK_FOR_DELETION",
    "domestic_shipping_freight_outbound"."BILLING_METHOD" AS "BILLING_METHOD",
    "domestic_shipping_freight_outbound"."LAST_UPDATED_SOURCE_TYPE" AS "LAST_UPDATED_SOURCE_TYPE",
    "domestic_shipping_freight_outbound"."UNAPPLIED_SPOT_COST" AS "UNAPPLIED_SPOT_COST",
    "domestic_shipping_freight_outbound"."UNAPPLIED_SPOT_CURRENCY_CODE" AS "UNAPPLIED_SPOT_CURRENCY_CODE",
    "domestic_shipping_freight_outbound"."APPROVED_SPOT_COST" AS "APPROVED_SPOT_COST",
    "domestic_shipping_freight_outbound"."INVOICE_DTL_ID" AS "INVOICE_DTL_ID",
    "domestic_shipping_freight_outbound"."VESSEL_NUMBER" AS "VESSEL_NUMBER",
    "domestic_shipping_freight_outbound"."VOYAGE_FLIGHT_NUMBER" AS "VOYAGE_FLIGHT_NUMBER",
    "domestic_shipping_freight_outbound"."BOOKING_TYPE" AS "BOOKING_TYPE",
    "domestic_shipping_freight_outbound"."PRO_NUMBER" AS "PRO_NUMBER",
    "domestic_shipping_freight_outbound"."TRAILER_NUMBER" AS "TRAILER_NUMBER",
    "domestic_shipping_freight_outbound"."COMMODITY_CODE_ID" AS "COMMODITY_CODE_ID",
    "domestic_shipping_freight_outbound"."UNAPPLIED_TOTAL_BALANCE" AS "UNAPPLIED_TOTAL_BALANCE",
    "domestic_shipping_freight_outbound"."APPROVED_TOTAL_BALANCE" AS "APPROVED_TOTAL_BALANCE",
    "domestic_shipping_freight_outbound"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP",
    "domestic_shipping_freight_outbound"."OPERATION_TYPE" AS "OPERATION_TYPE",
    "domestic_shipping_freight_outbound"."ARCHIVED_DTTM" AS "ARCHIVED_DTTM",
    "domestic_shipping_freight_outbound"."INVOICE_DT" AS "INVOICE_DT",
    "domestic_shipping_freight_outbound"."invoice_date_parsed" AS "invoice_date_parsed",
    "domestic_shipping_freight_outbound"."NUM_REJECTIONS" AS "NUM_REJECTIONS",
    "domestic_shipping_freight_outbound"."TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID",
    "domestic_shipping_freight_outbound"."DELIVERY_START_DTTM" AS "DELIVERY_START_DTTM",
    "domestic_shipping_freight_outbound"."delivery_date_parsed" AS "delivery_date_parsed",
    "domestic_shipping_freight_outbound"."DELIVERY_END_DTTM" AS "DELIVERY_END_DTTM",
    "domestic_shipping_freight_outbound"."ORIGIN" AS "ORIGIN",
    "domestic_shipping_freight_outbound"."FINAL_DESTINATION" AS "FINAL_DESTINATION",
    "domestic_shipping_freight_outbound"."actual_delivery_date_parsed" AS "actual_delivery_date_parsed",
    "domestic_shipping_freight_outbound"."VENDOR_ID" AS "VENDOR_ID",
    "domestic_shipping_freight_outbound"."VENDOR_NAME" AS "VENDOR_NAME",
    "domestic_shipping_freight_outbound"."flag_wood_pellet_combined" AS "flag_wood_pellet_combined",
    "domestic_shipping_freight_outbound"."cal_MERCH_YEAR" AS "cal_MERCH_YEAR",
    "domestic_shipping_freight_outbound"."cal_YEAR_WEEK" AS "cal_YEAR_WEEK",
    "domestic_shipping_freight_outbound"."cal_YEAR_QUARTER" AS "cal_YEAR_QUARTER",
    "domestic_shipping_freight_outbound"."cal_YEAR_PERIOD" AS "cal_YEAR_PERIOD",
    "domestic_shipping_freight_outbound"."del_MERCH_YEAR" AS "del_MERCH_YEAR",
    "domestic_shipping_freight_outbound"."del_YEAR_WEEK" AS "del_YEAR_WEEK",
    "domestic_shipping_freight_outbound"."del_YEAR_QUARTER" AS "del_YEAR_QUARTER",
    "domestic_shipping_freight_outbound"."del_YEAR_PERIOD" AS "del_YEAR_PERIOD",
    "domestic_shipping_freight_outbound"."act_del_MERCH_YEAR" AS "act_del_MERCH_YEAR",
    "domestic_shipping_freight_outbound"."act_del_YEAR_WEEK" AS "act_del_YEAR_WEEK",
    "domestic_shipping_freight_outbound"."act_del_YEAR_QUARTER" AS "act_del_YEAR_QUARTER",
    "domestic_shipping_freight_outbound"."act_del_YEAR_PERIOD" AS "act_del_YEAR_PERIOD",
    "domestic_shipping_freight_outbound"."TOTAL_COST" AS "TOTAL_COST",
    "domestic_shipping_freight_outbound"."org_Facility_Code" AS "org_Facility_Code",
    "domestic_shipping_freight_outbound"."org_Facility_Name" AS "org_Facility_Name",
    "domestic_shipping_freight_outbound"."org_Facility_Type" AS "org_Facility_Type",
    "domestic_shipping_freight_outbound"."dest_Facility_Code" AS "dest_Facility_Code",
    "domestic_shipping_freight_outbound"."dest_Facility_Name" AS "dest_Facility_Name",
    "domestic_shipping_freight_outbound"."dest_Facility_Type" AS "dest_Facility_Type",
    "domestic_shipping_freight_outbound"."inbound_flag" AS "inbound_flag",
    "sc_tlm_orders_prepared_by_ORDER_ID"."ORDER_ID" AS "do_ORDER_ID"
  FROM CTE "domestic_shipping_freight_outbound"
  LEFT JOIN "SC_TLM_ORDERS_PREPARED_BY_ORDER_ID" "sc_tlm_orders_prepared_by_ORDER_ID"
    ON "domestic_shipping_freight_outbound"."TC_SHIPMENT_ID" = "sc_tlm_orders_prepared_by_ORDER_ID"."TC_SHIPMENT_ID";

<br>
--DOMESTIC_SHIPPING_FREIGHT_DO_ALLOCATION
</br>
INSERT INTO "DOMESTIC_SHIPPING_FREIGHT_DO_ALLOCATION"
(
 "TC_OBJECT_ID"
,"act_del_YEAR_PERIOD"
,"TOTAL_COST"
,"org_Facility_Code"
,"org_Facility_Name"
,"org_Facility_Type"
,"dest_Facility_Code"
,"dest_Facility_Name"
,"dest_Facility_Type"
,"do_ORDER_QTY"
,"do_ITEM_NAME" 
,"allocation_final"
)
WITH CTE AS 
(
SELECT 
    "domestic_shipping_freight_outbound_prep"."TC_OBJECT_ID" AS "TC_OBJECT_ID",  
    "domestic_shipping_freight_outbound_prep"."act_del_YEAR_PERIOD" AS "act_del_YEAR_PERIOD", 
    "domestic_shipping_freight_outbound_prep"."TOTAL_COST" AS "TOTAL_COST",
    "domestic_shipping_freight_outbound_prep"."org_Facility_Code" AS "org_Facility_Code",
    "domestic_shipping_freight_outbound_prep"."org_Facility_Name" AS "org_Facility_Name",
    "domestic_shipping_freight_outbound_prep"."org_Facility_Type" AS "org_Facility_Type",
    "domestic_shipping_freight_outbound_prep"."dest_Facility_Code" AS "dest_Facility_Code",
    "domestic_shipping_freight_outbound_prep"."dest_Facility_Name" AS "dest_Facility_Name",
    "domestic_shipping_freight_outbound_prep"."dest_Facility_Type" AS "dest_Facility_Type", 
	"domestic_shipping_freight_outbound_prep"."do_ORDER_ID" AS "do_ORDER_ID",
    "sc_tlm_order_line_item"."do_ORDER_QTY",
    "sc_tlm_order_line_item"."do_ITEM_NAME"
  FROM "DOMESTIC_SHIPPING_FREIGHT_OUTBOUND_PREP" "domestic_shipping_freight_outbound_prep"  
  LEFT JOIN (
             SELECT           "sc_tlm_order_line_item"."ORDER_ID" AS "do_ORDER_ID_2",
			                  "sc_tlm_order_line_item"."ITEM_NAME" AS "do_ITEM_NAME",
                              "sc_tlm_order_line_item"."ORDER_QTY" AS "do_ORDER_QTY" 
             FROM  "EDW"."VW_SC_TLM_ORDER_LINE_ITEM"  "sc_tlm_order_line_item"
			 ) "sc_tlm_order_line_item" ON "domestic_shipping_freight_outbound_prep"."do_ORDER_ID" = "sc_tlm_order_line_item"."do_ORDER_ID_2"
 )
SELECT  				"TC_OBJECT_ID" 
							,"act_del_YEAR_PERIOD" 
							,"TOTAL_COST"
							,"org_Facility_Code" 
							,"org_Facility_Name" 
							,"org_Facility_Type" 
							,"dest_Facility_Code" 
							,"dest_Facility_Name" 
							,"dest_Facility_Type" 
							,"do_ORDER_QTY"  
							, "do_ITEM_NAME"
             ,CASE WHEN "weight_volume_flag" = 'V' THEN "allocation_by_vol" ELSE "allocation_by_wgt" END AS "allocation_final"
FROM       (
            SELECT *,
            CASE WHEN "item_volume_sum" / NULLIF("max_volume", 0) >= "item_weight_sum" / NULLIF("max_weight", 0) THEN 'V' ELSE 'W' END AS "weight_volume_flag"
             FROM (
                 SELECT *, ("item_volume" / NULLIF("item_volume_sum", 0)) * COALESCE("TOTAL_COST", 0) AS "allocation_by_vol",
                           ("item_weight" / NULLIF("item_weight_sum", 0)) * COALESCE("TOTAL_COST", 0) AS "allocation_by_wgt",
                           2366 AS "max_volume",
                           44000 AS "max_weight"
                 FROM  (
                        SELECT *,
                               SUM("item_volume") OVER (PARTITION BY "TC_OBJECT_ID") AS "item_volume_sum",
                               SUM("item_weight") OVER (PARTITION BY "TC_OBJECT_ID") AS "item_weight_sum"
                        FROM 
						(
							SELECT
							  c."TC_OBJECT_ID" 
							, c."act_del_YEAR_PERIOD" 
							, c."TOTAL_COST"
							, c."org_Facility_Code" 
							, c."org_Facility_Name" 
							, c."org_Facility_Type" 
							, c."dest_Facility_Code" 
							, c."dest_Facility_Name" 
							, c."dest_Facility_Type" 
							, c."do_ORDER_QTY"
							, c."do_ITEM_NAME"
							,"article"."ARTICLE_LENGTH" AS "a_ARTICLE_LENGTH",
							"article"."ARTICLE_WIDTH" AS "a_ARTICLE_WIDTH",
							"article"."ARTICLE_HEIGHT" AS "a_ARTICLE_HEIGHT",
							"article"."ARTICLE_WEIGHT" AS "a_ARTICLE_WEIGHT",
							"article"."ARTICLE_SIZE" AS "a_ARTICLE_SIZE",
							"article"."ARTICLE_40HC_QTY" AS "a_ARTICLE_40HC_QTY",
							"article"."ARTICLE_40GP_QTY" AS "a_ARTICLE_40GP_QTY",    
							(coalesce("article"."ARTICLE_LENGTH",0)*coalesce("article"."ARTICLE_WIDTH",0)*coalesce("article"."ARTICLE_HEIGHT",0)*coalesce(c."do_ORDER_QTY",0)/1728) AS "item_volume",
							(coalesce("article"."ARTICLE_WEIGHT",0)*coalesce(c."do_ORDER_QTY",0)) AS "item_weight"   
							FROM CTE c
							LEFT JOIN ARTICLE_W_SHP_DIM_PREP "article" ON TRY_TO_NUMBER(c."do_ITEM_NAME")= TRY_TO_NUMBER("article"."ARTICLE_NO")
								)A ) B 	)C )FINAL  ;

<br> 
  --6.OCEAN_FREIGHT_ALLOCATION_ARTICLE
  --DOMESTIC_SHIPPING_FREIGHT_W_CAL_FILTERED_TEST_FILTERED_1_FILTERED
</br>

CREATE OR REPLACE TEMPORARY TABLE  "DOMESTIC_SHIPPING_FREIGHT_W_CAL_FILTERED_TEST_FILTERED_1_FILTERED"
AS
SELECT   "INV_ID" AS "INV_ID",
    "INV_OBJECT_ID" AS "INV_OBJECT_ID",
    "TC_COMPANY_ID" AS "TC_COMPANY_ID",
    "TC_OBJECT_ID" AS "TC_OBJECT_ID",
    "INV_OBJECT_STATUS" AS "INV_OBJECT_STATUS",
    "O_NAME" AS "O_NAME",
    "O_ADDRESS" AS "O_ADDRESS",
    "O_CITY" AS "O_CITY",
    "O_COUNTY" AS "O_COUNTY",
    "O_STATE_PROV" AS "O_STATE_PROV",
    "O_POSTAL_CODE" AS "O_POSTAL_CODE",
    "O_COUNTRY_CODE" AS "O_COUNTRY_CODE",
    "D_NAME" AS "D_NAME",
    "D_ADDRESS" AS "D_ADDRESS",
    "D_CITY" AS "D_CITY",
    "D_COUNTY" AS "D_COUNTY",
    "D_STATE_PROV" AS "D_STATE_PROV",
    "D_POSTAL_CODE" AS "D_POSTAL_CODE",
    "D_COUNTRY_CODE" AS "D_COUNTRY_CODE",
    "MOT_DESC" AS "MOT_DESC",
    "EQUIPMENT_DESC" AS "EQUIPMENT_DESC",
    "SERVICE_LEVEL_DESC" AS "SERVICE_LEVEL_DESC",
    "PROTECTION_LEVEL_DESC" AS "PROTECTION_LEVEL_DESC",
    "FINANCIAL_WEIGHT" AS "FINANCIAL_WEIGHT",
    "ACTUAL_WEIGHT" AS "ACTUAL_WEIGHT",
    "LH_COST" AS "LH_COST",
    "DISTANCE" AS "DISTANCE",
    "DISTANCE_UOM" AS "DISTANCE_UOM",
    "BILL_OF_LADING_NUMBER" AS "BILL_OF_LADING_NUMBER",
    "PO_NUMBER" AS "PO_NUMBER",
    "SPEC_HANDLING_METHOD" AS "SPEC_HANDLING_METHOD",
    "COMMENTS" AS "COMMENTS",
    "HAS_IMPORT_ERROR" AS "HAS_IMPORT_ERROR",
    "HAS_WARNING" AS "HAS_WARNING",
    "IS_VALID" AS "IS_VALID",
    "CREATED_SOURCE_TYPE" AS "CREATED_SOURCE_TYPE",
    "CREATED_SOURCE" AS "CREATED_SOURCE",
    "CREATED_DTTM" AS "CREATED_DTTM",
    "LAST_UPDATED_SOURCE" AS "LAST_UPDATED_SOURCE",
    "LAST_UPDATED_DTTM" AS "LAST_UPDATED_DTTM",
    "STOP_COST" AS "STOP_COST",
    "AUXILARY_DATA" AS "AUXILARY_DATA",
    "PICKUP_DTTM" AS "PICKUP_DTTM",
    "DELIVERY_DTTM" AS "DELIVERY_DTTM",
    "CURRENCY_CODE" AS "CURRENCY_CODE",
    "LH_CURRENCY_CODE" AS "LH_CURRENCY_CODE",
    "STOP_CURRENCY_CODE" AS "STOP_CURRENCY_CODE",
    "SPOT_CHARGE_COST" AS "SPOT_CHARGE_COST",
    "SPOT_CHARGE_CURRENCY_CODE" AS "SPOT_CHARGE_CURRENCY_CODE",
    "ASSIGNED_CARRIER_CODE" AS "ASSIGNED_CARRIER_CODE",
    "NUM_PICKUPS" AS "NUM_PICKUPS",
    "NUM_DELIVERIES" AS "NUM_DELIVERIES",
    "RATE" AS "RATE",
    "RATE_CALC_METHOD" AS "RATE_CALC_METHOD",
    "RATE_UOM" AS "RATE_UOM",
    "TPE_OBJECT_ID" AS "TPE_OBJECT_ID",
    "O_FACILITY_ID" AS "O_FACILITY_ID",
    "D_FACILITY_ID" AS "D_FACILITY_ID",
    "TP_COMPANY_ID" AS "TP_COMPANY_ID",
    "PACKAGE_TYPE_ID" AS "PACKAGE_TYPE_ID",
    "COMPUTED_RATE" AS "COMPUTED_RATE",
    "COMPUTED_RATE_UOM" AS "COMPUTED_RATE_UOM",
    "COMPUTED_RATE_CALC_METHOD" AS "COMPUTED_RATE_CALC_METHOD",
    "COMPUTED_TOTAL_COST" AS "COMPUTED_TOTAL_COST",
    "COMPUTED_TOTAL_COST_CURR_CODE" AS "COMPUTED_TOTAL_COST_CURR_CODE",
    "O_FACILITY_NAME" AS "O_FACILITY_NAME",
    "D_FACILITY_NAME" AS "D_FACILITY_NAME",
    "COMPUTED_DISTANCE" AS "COMPUTED_DISTANCE",
    "COMPUTED_DISTANCE_UOM" AS "COMPUTED_DISTANCE_UOM",
    "COMPUTED_STOP_COST" AS "COMPUTED_STOP_COST",
    "COMPUTED_STOP_COST_CURR_CODE" AS "COMPUTED_STOP_COST_CURR_CODE",
    "APPROVED_DISTANCE" AS "APPROVED_DISTANCE",
    "APPROVED_LH_COST" AS "APPROVED_LH_COST",
    "APPROVED_RATE" AS "APPROVED_RATE",
    "APPROVED_FINANCIAL_WEIGHT" AS "APPROVED_FINANCIAL_WEIGHT",
    "APPROVED_ACTUAL_WEIGHT" AS "APPROVED_ACTUAL_WEIGHT",
    "RATE_ADJUSTMENT" AS "RATE_ADJUSTMENT",
    "MIN_CHARGE" AS "MIN_CHARGE",
    "COMPUTED_TARIFF" AS "COMPUTED_TARIFF",
    "COMPUTED_MIN_RATE" AS "COMPUTED_MIN_RATE",
    "UNDEFINED_ADJUSTMENT" AS "UNDEFINED_ADJUSTMENT",
    "DISCOUNT_AMOUNT" AS "DISCOUNT_AMOUNT",
    "UNDEFINED_ADJ_CURR_CODE" AS "UNDEFINED_ADJ_CURR_CODE",
    "DISCOUNT_AMT_CURR_CODE" AS "DISCOUNT_AMT_CURR_CODE",
    "RATE_CURR_CODE" AS "RATE_CURR_CODE",
    "CARRIER_ID" AS "CARRIER_ID",
    "ASSIGNED_CARRIER_ID" AS "ASSIGNED_CARRIER_ID",
    "EQUIPMENT_ID" AS "EQUIPMENT_ID",
    "MOT_ID" AS "MOT_ID",
    "PROTECTION_LEVEL_ID" AS "PROTECTION_LEVEL_ID",
    "SERVICE_LEVEL_ID" AS "SERVICE_LEVEL_ID",
    "UNDF_ADJ_CURR_CODE" AS "UNDF_ADJ_CURR_CODE",
    "COMPUTED_FINANCIAL_WEIGHT" AS "COMPUTED_FINANCIAL_WEIGHT",
    "ADJUSTMENT_AMOUNT" AS "ADJUSTMENT_AMOUNT",
    "APPROVED_ADJUSTMENT_AMOUNT" AS "APPROVED_ADJUSTMENT_AMOUNT",
    "APPROVED_STOP_COST" AS "APPROVED_STOP_COST",
    "APPROVED_RATE_ADJUSTMENT" AS "APPROVED_RATE_ADJUSTMENT",
    "APPROVED_RATE_CALC_METHOD" AS "APPROVED_RATE_CALC_METHOD",
    "APPROVED_RATE_UOM" AS "APPROVED_RATE_UOM",
    "APPROVED_DISTANCE_UOM" AS "APPROVED_DISTANCE_UOM",
    "COMPUTED_LH_COST" AS "COMPUTED_LH_COST",
    "COMPUTED_LH_COST_CURR_CODE" AS "COMPUTED_LH_COST_CURR_CODE",
    "WEIGHT_UOM_ID" AS "WEIGHT_UOM_ID",
    "APPROVED_WEIGHT_UOM_ID" AS "APPROVED_WEIGHT_UOM_ID",
    "INV_MIN_RATE" AS "INV_MIN_RATE",
    "SYS_MIN_RATE" AS "SYS_MIN_RATE",
    "UNAPPLIED_LH_COST" AS "UNAPPLIED_LH_COST",
    "UNAPPLIED_LH_CURRENCY_CODE" AS "UNAPPLIED_LH_CURRENCY_CODE",
    "UNAPPLIED_STOP_COST" AS "UNAPPLIED_STOP_COST",
    "UNAPPLIED_STOP_CURRENCY_CODE" AS "UNAPPLIED_STOP_CURRENCY_CODE",
    "ORG_SHIP_VIA_FACILITY_ID" AS "ORG_SHIP_VIA_FACILITY_ID",
    "ORG_SHIP_VIA_FACILITY_ALIAS_ID" AS "ORG_SHIP_VIA_FACILITY_ALIAS_ID",
    "DES_SHIP_VIA_FACILITY_ID" AS "DES_SHIP_VIA_FACILITY_ID",
    "DES_SHIP_VIA_FACILITY_ALIAS_ID" AS "DES_SHIP_VIA_FACILITY_ALIAS_ID",
    "INCOTERM_ID" AS "INCOTERM_ID",
    "SEC_CARRIER_ID" AS "SEC_CARRIER_ID",
    "COMMODITY_CLASS" AS "COMMODITY_CLASS",
    "ACTUAL_PAYMENT_AMOUNT" AS "ACTUAL_PAYMENT_AMOUNT",
    "ACTUAL_CURRENCY_CODE" AS "ACTUAL_CURRENCY_CODE",
    "NET_AMOUNT_CURRENCY_CODE" AS "NET_AMOUNT_CURRENCY_CODE",
    "NET_AMOUNT_DUE" AS "NET_AMOUNT_DUE",
    "NORMALIZED_NET_AMOUNT_DUE" AS "NORMALIZED_NET_AMOUNT_DUE",
    "REF_INV_OBJECT_PAID_AMOUNT" AS "REF_INV_OBJECT_PAID_AMOUNT",
    "REF_INV_OBJECT_PAID_AMOUNT_CC" AS "REF_INV_OBJECT_PAID_AMOUNT_CC",
    "REF_INV_OBJECT_AMOUNT" AS "REF_INV_OBJECT_AMOUNT",
    "REF_INV_OBJECT_AMOUNT_CC" AS "REF_INV_OBJECT_AMOUNT_CC",
    "REF_INVOICED_OBJECT_ID" AS "REF_INVOICED_OBJECT_ID",
    "INCOTERM_CODE" AS "INCOTERM_CODE",
    "ACTUAL_VOLUME" AS "ACTUAL_VOLUME",
    "VOLUME_UOM_ID" AS "VOLUME_UOM_ID",
    "COMPUTED_VOLUME" AS "COMPUTED_VOLUME",
    "COMPUTED_VOLUME_UOM_ID" AS "COMPUTED_VOLUME_UOM_ID",
    "APPROVED_VOLUME" AS "APPROVED_VOLUME",
    "APPROVED_VOLUME_UOM_ID" AS "APPROVED_VOLUME_UOM_ID",
    "VOLUME_UOM" AS "VOLUME_UOM",
    "WEIGHT_UOM" AS "WEIGHT_UOM",
    "INV_OBJ_GRS_AMT_DUE_CURR_CODE" AS "INV_OBJ_GRS_AMT_DUE_CURR_CODE",
    "INV_OBJ_TAX_AM_DUE_CURR_CODE" AS "INV_OBJ_TAX_AM_DUE_CURR_CODE",
    "INV_OBJ_TAX_AMT_DUE" AS "INV_OBJ_TAX_AMT_DUE",
    "INV_OBJ_GRS_AMT_DUE" AS "INV_OBJ_GRS_AMT_DUE",
    "TRACKING_NUMBER" AS "TRACKING_NUMBER",
    "LENGTH" AS "LENGTH",
    "WIDTH" AS "WIDTH",
    "HEIGHT" AS "HEIGHT",
    "ADJ_RATE" AS "ADJ_RATE",
    "COMPUTED_ADJ_RATE" AS "COMPUTED_ADJ_RATE",
    "APPROVED_ADJ_RATE" AS "APPROVED_ADJ_RATE",
    "ADJ_LH_COST" AS "ADJ_LH_COST",
    "COMPUTED_ADJ_LH_COST" AS "COMPUTED_ADJ_LH_COST",
    "APPROVED_ADJ_LH_COST" AS "APPROVED_ADJ_LH_COST",
    "ENTRY_TYPE" AS "ENTRY_TYPE",
    "PICKUP_NUMBER" AS "PICKUP_NUMBER",
    "MONETARY_VALUE" AS "MONETARY_VALUE",
    "MONETARY_VALUE_CURRENCY_CODE" AS "MONETARY_VALUE_CURRENCY_CODE",
    "MANIFEST_TYPE" AS "MANIFEST_TYPE",
    "NON_MACHINABLE" AS "NON_MACHINABLE",
    "LENGTH_UOM_ID" AS "LENGTH_UOM_ID",
    "RATING_LEVEL" AS "RATING_LEVEL",
    "WIDTH_UOM_ID" AS "WIDTH_UOM_ID",
    "HEIGHT_UOM_ID" AS "HEIGHT_UOM_ID",
    "MARK_FOR_DELETION" AS "MARK_FOR_DELETION",
    "BILLING_METHOD" AS "BILLING_METHOD",
    "LAST_UPDATED_SOURCE_TYPE" AS "LAST_UPDATED_SOURCE_TYPE",
    "UNAPPLIED_SPOT_COST" AS "UNAPPLIED_SPOT_COST",
    "UNAPPLIED_SPOT_CURRENCY_CODE" AS "UNAPPLIED_SPOT_CURRENCY_CODE",
    "APPROVED_SPOT_COST" AS "APPROVED_SPOT_COST",
    "INVOICE_DTL_ID" AS "INVOICE_DTL_ID",
    "VESSEL_NUMBER" AS "VESSEL_NUMBER",
    "VOYAGE_FLIGHT_NUMBER" AS "VOYAGE_FLIGHT_NUMBER",
    "BOOKING_TYPE" AS "BOOKING_TYPE",
    "PRO_NUMBER" AS "PRO_NUMBER",
    "TRAILER_NUMBER" AS "TRAILER_NUMBER",
    "COMMODITY_CODE_ID" AS "COMMODITY_CODE_ID",
    "UNAPPLIED_TOTAL_BALANCE" AS "UNAPPLIED_TOTAL_BALANCE",
    "APPROVED_TOTAL_BALANCE" AS "APPROVED_TOTAL_BALANCE",
    "CDC_TIMESTAMP" AS "CDC_TIMESTAMP",
    "OPERATION_TYPE" AS "OPERATION_TYPE",
    "ARCHIVED_DTTM" AS "ARCHIVED_DTTM",
    "INVOICE_DT" AS "INVOICE_DT",
    "invoice_date_parsed" AS "invoice_date_parsed",
    "NUM_REJECTIONS" AS "NUM_REJECTIONS",
    "TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID",
    "DELIVERY_START_DTTM" AS "DELIVERY_START_DTTM",
    "delivery_date_parsed" AS "delivery_date_parsed",
    "DELIVERY_END_DTTM" AS "DELIVERY_END_DTTM",
    "ORIGIN" AS "ORIGIN",
    "FINAL_DESTINATION" AS "FINAL_DESTINATION",
    "actual_delivery_date_parsed" AS "actual_delivery_date_parsed",
    "VENDOR_ID" AS "VENDOR_ID",
    "VENDOR_NAME" AS "VENDOR_NAME",
    "flag_wood_pellet_combined" AS "flag_wood_pellet_combined",
    "cal_MERCH_YEAR" AS "cal_MERCH_YEAR",
    "cal_YEAR_WEEK" AS "cal_YEAR_WEEK",
    "cal_YEAR_QUARTER" AS "cal_YEAR_QUARTER",
    "cal_YEAR_PERIOD" AS "cal_YEAR_PERIOD",
    "del_MERCH_YEAR" AS "del_MERCH_YEAR",
    "del_YEAR_WEEK" AS "del_YEAR_WEEK",
    "del_YEAR_QUARTER" AS "del_YEAR_QUARTER",
    "del_YEAR_PERIOD" AS "del_YEAR_PERIOD",
    "act_del_MERCH_YEAR" AS "act_del_MERCH_YEAR",
    "act_del_YEAR_WEEK" AS "act_del_YEAR_WEEK",
    "act_del_YEAR_QUARTER" AS "act_del_YEAR_QUARTER",
    "act_del_YEAR_PERIOD" AS "act_del_YEAR_PERIOD",
    "TOTAL_COST_sum" AS "TOTAL_COST",
    "rownumber" AS "rownumber"
    FROM (
    SELECT 
    ds."INV_ID" AS "INV_ID",
    ds."INV_OBJECT_ID" AS "INV_OBJECT_ID",
    ds."TC_COMPANY_ID" AS "TC_COMPANY_ID",
    ds."TC_OBJECT_ID" AS "TC_OBJECT_ID",
    ds."INV_OBJECT_STATUS" AS "INV_OBJECT_STATUS",
    ds."O_NAME" AS "O_NAME",
    ds."O_ADDRESS" AS "O_ADDRESS",
    ds."O_CITY" AS "O_CITY",
    ds."O_COUNTY" AS "O_COUNTY",
    ds."O_STATE_PROV" AS "O_STATE_PROV",
    ds."O_POSTAL_CODE" AS "O_POSTAL_CODE",
    ds."O_COUNTRY_CODE" AS "O_COUNTRY_CODE",
    ds."D_NAME" AS "D_NAME",
    ds."D_ADDRESS" AS "D_ADDRESS",
    ds."D_CITY" AS "D_CITY",
    ds."D_COUNTY" AS "D_COUNTY",
    ds."D_STATE_PROV" AS "D_STATE_PROV",
    ds."D_POSTAL_CODE" AS "D_POSTAL_CODE",
    ds."D_COUNTRY_CODE" AS "D_COUNTRY_CODE",
    ds."MOT_DESC" AS "MOT_DESC",
    ds."EQUIPMENT_DESC" AS "EQUIPMENT_DESC",
    ds."SERVICE_LEVEL_DESC" AS "SERVICE_LEVEL_DESC",
    ds."PROTECTION_LEVEL_DESC" AS "PROTECTION_LEVEL_DESC",
    ds."FINANCIAL_WEIGHT" AS "FINANCIAL_WEIGHT",
    ds."ACTUAL_WEIGHT" AS "ACTUAL_WEIGHT",
    ds."TOTAL_COST" AS "TOTAL_COST",
    ds."LH_COST" AS "LH_COST",
    ds."DISTANCE" AS "DISTANCE",
    ds."DISTANCE_UOM" AS "DISTANCE_UOM",
    ds."BILL_OF_LADING_NUMBER" AS "BILL_OF_LADING_NUMBER",
    ds."PO_NUMBER" AS "PO_NUMBER",
    ds."SPEC_HANDLING_METHOD" AS "SPEC_HANDLING_METHOD",
    ds."COMMENTS" AS "COMMENTS",
    ds."HAS_IMPORT_ERROR" AS "HAS_IMPORT_ERROR",
    ds."HAS_WARNING" AS "HAS_WARNING",
    ds."IS_VALID" AS "IS_VALID",
    ds."CREATED_SOURCE_TYPE" AS "CREATED_SOURCE_TYPE",
    ds."CREATED_SOURCE" AS "CREATED_SOURCE",
    ds."CREATED_DTTM" AS "CREATED_DTTM",
    ds."LAST_UPDATED_SOURCE" AS "LAST_UPDATED_SOURCE",
    ds."LAST_UPDATED_DTTM" AS "LAST_UPDATED_DTTM",
    ds."STOP_COST" AS "STOP_COST",
    ds."AUXILARY_DATA" AS "AUXILARY_DATA",
    ds."PICKUP_DTTM" AS "PICKUP_DTTM",
    ds."DELIVERY_DTTM" AS "DELIVERY_DTTM",
    ds."CURRENCY_CODE" AS "CURRENCY_CODE",
    ds."LH_CURRENCY_CODE" AS "LH_CURRENCY_CODE",
    ds."STOP_CURRENCY_CODE" AS "STOP_CURRENCY_CODE",
    ds."SPOT_CHARGE_COST" AS "SPOT_CHARGE_COST",
    ds."SPOT_CHARGE_CURRENCY_CODE" AS "SPOT_CHARGE_CURRENCY_CODE",
    ds."ASSIGNED_CARRIER_CODE" AS "ASSIGNED_CARRIER_CODE",
    ds."NUM_PICKUPS" AS "NUM_PICKUPS",
    ds."NUM_DELIVERIES" AS "NUM_DELIVERIES",
    ds."RATE" AS "RATE",
    ds."RATE_CALC_METHOD" AS "RATE_CALC_METHOD",
    ds."RATE_UOM" AS "RATE_UOM",
    ds."TPE_OBJECT_ID" AS "TPE_OBJECT_ID",
    ds."O_FACILITY_ID" AS "O_FACILITY_ID",
    ds."D_FACILITY_ID" AS "D_FACILITY_ID",
    ds."TP_COMPANY_ID" AS "TP_COMPANY_ID",
    ds."PACKAGE_TYPE_ID" AS "PACKAGE_TYPE_ID",
    ds."COMPUTED_RATE" AS "COMPUTED_RATE",
    ds."COMPUTED_RATE_UOM" AS "COMPUTED_RATE_UOM",
    ds."COMPUTED_RATE_CALC_METHOD" AS "COMPUTED_RATE_CALC_METHOD",
    ds."COMPUTED_TOTAL_COST" AS "COMPUTED_TOTAL_COST",
    ds."COMPUTED_TOTAL_COST_CURR_CODE" AS "COMPUTED_TOTAL_COST_CURR_CODE",
    ds."O_FACILITY_NAME" AS "O_FACILITY_NAME",
    ds."D_FACILITY_NAME" AS "D_FACILITY_NAME",
    ds."COMPUTED_DISTANCE" AS "COMPUTED_DISTANCE",
    ds."COMPUTED_DISTANCE_UOM" AS "COMPUTED_DISTANCE_UOM",
    ds."COMPUTED_STOP_COST" AS "COMPUTED_STOP_COST",
    ds."COMPUTED_STOP_COST_CURR_CODE" AS "COMPUTED_STOP_COST_CURR_CODE",
    ds."APPROVED_DISTANCE" AS "APPROVED_DISTANCE",
    ds."APPROVED_LH_COST" AS "APPROVED_LH_COST",
    ds."APPROVED_RATE" AS "APPROVED_RATE",
    ds."APPROVED_FINANCIAL_WEIGHT" AS "APPROVED_FINANCIAL_WEIGHT",
    ds."APPROVED_ACTUAL_WEIGHT" AS "APPROVED_ACTUAL_WEIGHT",
    ds."RATE_ADJUSTMENT" AS "RATE_ADJUSTMENT",
    ds."MIN_CHARGE" AS "MIN_CHARGE",
    ds."COMPUTED_TARIFF" AS "COMPUTED_TARIFF",
    ds."COMPUTED_MIN_RATE" AS "COMPUTED_MIN_RATE",
    ds."UNDEFINED_ADJUSTMENT" AS "UNDEFINED_ADJUSTMENT",
    ds."DISCOUNT_AMOUNT" AS "DISCOUNT_AMOUNT",
    ds."UNDEFINED_ADJ_CURR_CODE" AS "UNDEFINED_ADJ_CURR_CODE",
    ds."DISCOUNT_AMT_CURR_CODE" AS "DISCOUNT_AMT_CURR_CODE",
    ds."RATE_CURR_CODE" AS "RATE_CURR_CODE",
    ds."CARRIER_ID" AS "CARRIER_ID",
    ds."ASSIGNED_CARRIER_ID" AS "ASSIGNED_CARRIER_ID",
    ds."EQUIPMENT_ID" AS "EQUIPMENT_ID",
    ds."MOT_ID" AS "MOT_ID",
    ds."PROTECTION_LEVEL_ID" AS "PROTECTION_LEVEL_ID",
    ds."SERVICE_LEVEL_ID" AS "SERVICE_LEVEL_ID",
    ds."UNDF_ADJ_CURR_CODE" AS "UNDF_ADJ_CURR_CODE",
    ds."COMPUTED_FINANCIAL_WEIGHT" AS "COMPUTED_FINANCIAL_WEIGHT",
    ds."ADJUSTMENT_AMOUNT" AS "ADJUSTMENT_AMOUNT",
    ds."APPROVED_ADJUSTMENT_AMOUNT" AS "APPROVED_ADJUSTMENT_AMOUNT",
    ds."APPROVED_STOP_COST" AS "APPROVED_STOP_COST",
    ds."APPROVED_RATE_ADJUSTMENT" AS "APPROVED_RATE_ADJUSTMENT",
    ds."APPROVED_RATE_CALC_METHOD" AS "APPROVED_RATE_CALC_METHOD",
    ds."APPROVED_RATE_UOM" AS "APPROVED_RATE_UOM",
    ds."APPROVED_DISTANCE_UOM" AS "APPROVED_DISTANCE_UOM",
    ds."COMPUTED_LH_COST" AS "COMPUTED_LH_COST",
    ds."COMPUTED_LH_COST_CURR_CODE" AS "COMPUTED_LH_COST_CURR_CODE",
    ds."WEIGHT_UOM_ID" AS "WEIGHT_UOM_ID",
    ds."APPROVED_WEIGHT_UOM_ID" AS "APPROVED_WEIGHT_UOM_ID",
    ds."INV_MIN_RATE" AS "INV_MIN_RATE",
    ds."SYS_MIN_RATE" AS "SYS_MIN_RATE",
    ds."UNAPPLIED_LH_COST" AS "UNAPPLIED_LH_COST",
    ds."UNAPPLIED_LH_CURRENCY_CODE" AS "UNAPPLIED_LH_CURRENCY_CODE",
    ds."UNAPPLIED_STOP_COST" AS "UNAPPLIED_STOP_COST",
    ds."UNAPPLIED_STOP_CURRENCY_CODE" AS "UNAPPLIED_STOP_CURRENCY_CODE",
    ds."ORG_SHIP_VIA_FACILITY_ID" AS "ORG_SHIP_VIA_FACILITY_ID",
    ds."ORG_SHIP_VIA_FACILITY_ALIAS_ID" AS "ORG_SHIP_VIA_FACILITY_ALIAS_ID",
    ds."DES_SHIP_VIA_FACILITY_ID" AS "DES_SHIP_VIA_FACILITY_ID",
    ds."DES_SHIP_VIA_FACILITY_ALIAS_ID" AS "DES_SHIP_VIA_FACILITY_ALIAS_ID",
    ds."INCOTERM_ID" AS "INCOTERM_ID",
    ds."SEC_CARRIER_ID" AS "SEC_CARRIER_ID",
    ds."COMMODITY_CLASS" AS "COMMODITY_CLASS",
    ds."ACTUAL_PAYMENT_AMOUNT" AS "ACTUAL_PAYMENT_AMOUNT",
    ds."ACTUAL_CURRENCY_CODE" AS "ACTUAL_CURRENCY_CODE",
    ds."NET_AMOUNT_CURRENCY_CODE" AS "NET_AMOUNT_CURRENCY_CODE",
    ds."NET_AMOUNT_DUE" AS "NET_AMOUNT_DUE",
    ds."NORMALIZED_NET_AMOUNT_DUE" AS "NORMALIZED_NET_AMOUNT_DUE",
    ds."REF_INV_OBJECT_PAID_AMOUNT" AS "REF_INV_OBJECT_PAID_AMOUNT",
    ds."REF_INV_OBJECT_PAID_AMOUNT_CC" AS "REF_INV_OBJECT_PAID_AMOUNT_CC",
    ds."REF_INV_OBJECT_AMOUNT" AS "REF_INV_OBJECT_AMOUNT",
    ds."REF_INV_OBJECT_AMOUNT_CC" AS "REF_INV_OBJECT_AMOUNT_CC",
    ds."REF_INVOICED_OBJECT_ID" AS "REF_INVOICED_OBJECT_ID",
    ds."INCOTERM_CODE" AS "INCOTERM_CODE",
    ds."ACTUAL_VOLUME" AS "ACTUAL_VOLUME",
    ds."VOLUME_UOM_ID" AS "VOLUME_UOM_ID",
    ds."COMPUTED_VOLUME" AS "COMPUTED_VOLUME",
    ds."COMPUTED_VOLUME_UOM_ID" AS "COMPUTED_VOLUME_UOM_ID",
    ds."APPROVED_VOLUME" AS "APPROVED_VOLUME",
    ds."APPROVED_VOLUME_UOM_ID" AS "APPROVED_VOLUME_UOM_ID",
    ds."VOLUME_UOM" AS "VOLUME_UOM",
    ds."WEIGHT_UOM" AS "WEIGHT_UOM",
    ds."INV_OBJ_GRS_AMT_DUE_CURR_CODE" AS "INV_OBJ_GRS_AMT_DUE_CURR_CODE",
    ds."INV_OBJ_TAX_AM_DUE_CURR_CODE" AS "INV_OBJ_TAX_AM_DUE_CURR_CODE",
    ds."INV_OBJ_TAX_AMT_DUE" AS "INV_OBJ_TAX_AMT_DUE",
    ds."INV_OBJ_GRS_AMT_DUE" AS "INV_OBJ_GRS_AMT_DUE",
    ds."TRACKING_NUMBER" AS "TRACKING_NUMBER",
    ds."LENGTH" AS "LENGTH",
    ds."WIDTH" AS "WIDTH",
    ds."HEIGHT" AS "HEIGHT",
    ds."ADJ_RATE" AS "ADJ_RATE",
    ds."COMPUTED_ADJ_RATE" AS "COMPUTED_ADJ_RATE",
    ds."APPROVED_ADJ_RATE" AS "APPROVED_ADJ_RATE",
    ds."ADJ_LH_COST" AS "ADJ_LH_COST",
    ds."COMPUTED_ADJ_LH_COST" AS "COMPUTED_ADJ_LH_COST",
    ds."APPROVED_ADJ_LH_COST" AS "APPROVED_ADJ_LH_COST",
    ds."ENTRY_TYPE" AS "ENTRY_TYPE",
    ds."PICKUP_NUMBER" AS "PICKUP_NUMBER",
    ds."MONETARY_VALUE" AS "MONETARY_VALUE",
    ds."MONETARY_VALUE_CURRENCY_CODE" AS "MONETARY_VALUE_CURRENCY_CODE",
    ds."MANIFEST_TYPE" AS "MANIFEST_TYPE",
    ds."NON_MACHINABLE" AS "NON_MACHINABLE",
    ds."LENGTH_UOM_ID" AS "LENGTH_UOM_ID",
    ds."RATING_LEVEL" AS "RATING_LEVEL",
    ds."WIDTH_UOM_ID" AS "WIDTH_UOM_ID",
    ds."HEIGHT_UOM_ID" AS "HEIGHT_UOM_ID",
    ds."MARK_FOR_DELETION" AS "MARK_FOR_DELETION",
    ds."BILLING_METHOD" AS "BILLING_METHOD",
    ds."LAST_UPDATED_SOURCE_TYPE" AS "LAST_UPDATED_SOURCE_TYPE",
    ds."UNAPPLIED_SPOT_COST" AS "UNAPPLIED_SPOT_COST",
    ds."UNAPPLIED_SPOT_CURRENCY_CODE" AS "UNAPPLIED_SPOT_CURRENCY_CODE",
    ds."APPROVED_SPOT_COST" AS "APPROVED_SPOT_COST",
    ds."INVOICE_DTL_ID" AS "INVOICE_DTL_ID",
    ds."VESSEL_NUMBER" AS "VESSEL_NUMBER",
    ds."VOYAGE_FLIGHT_NUMBER" AS "VOYAGE_FLIGHT_NUMBER",
    ds."BOOKING_TYPE" AS "BOOKING_TYPE",
    ds."PRO_NUMBER" AS "PRO_NUMBER",
    ds."TRAILER_NUMBER" AS "TRAILER_NUMBER",
    ds."COMMODITY_CODE_ID" AS "COMMODITY_CODE_ID",
    ds."UNAPPLIED_TOTAL_BALANCE" AS "UNAPPLIED_TOTAL_BALANCE",
    ds."APPROVED_TOTAL_BALANCE" AS "APPROVED_TOTAL_BALANCE",
    ds."CDC_TIMESTAMP" AS "CDC_TIMESTAMP",
    ds."OPERATION_TYPE" AS "OPERATION_TYPE",
    ds."ARCHIVED_DTTM" AS "ARCHIVED_DTTM",
    ds."INVOICE_DT" AS "INVOICE_DT",
    ds."INVOICE_DATE_PARSED" AS "invoice_date_parsed",
    ds."NUM_REJECTIONS" AS "NUM_REJECTIONS",
    ds."TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID",
    ds."DELIVERY_START_DTTM" AS "DELIVERY_START_DTTM",
    ds."DELIVERY_DATE_PARSED" AS "delivery_date_parsed",
    ds."DELIVERY_END_DTTM" AS "DELIVERY_END_DTTM",
    ds."ORIGIN" AS "ORIGIN",
    ds."FINAL_DESTINATION" AS "FINAL_DESTINATION",
    ds."actual_delivery_date_parsed" AS "actual_delivery_date_parsed",
    ds."VENDOR_ID" AS "VENDOR_ID",
    ds."VENDOR_NAME" AS "VENDOR_NAME",
    ds."flag_wood_pellet_combined" AS "flag_wood_pellet_combined",
   t1."MERCH_YEAR" AS "cal_MERCH_YEAR",
   t1."YEAR_WEEK" AS "cal_YEAR_WEEK",
   t1."YEAR_QUARTER" AS "cal_YEAR_QUARTER",
   t1."YEAR_PERIOD" AS "cal_YEAR_PERIOD",
   t2."MERCH_YEAR" AS "del_MERCH_YEAR",
   t2."YEAR_WEEK" AS "del_YEAR_WEEK",
   t2."YEAR_QUARTER" AS "del_YEAR_QUARTER",
   t2."YEAR_PERIOD" AS "del_YEAR_PERIOD",
   t2."MERCH_YEAR" AS "act_del_MERCH_YEAR",
  t3."YEAR_WEEK" AS "act_del_YEAR_WEEK",
  t3."YEAR_QUARTER" AS "act_del_YEAR_QUARTER",
  t3."YEAR_PERIOD" AS "act_del_YEAR_PERIOD",
   SUM(ds."TOTAL_COST") OVER (PARTITION BY "TC_OBJECT_ID") AS "TOTAL_COST_sum",
    ROW_NUMBER() OVER (PARTITION BY "TC_OBJECT_ID" ORDER BY "INV_ID" ASC NULLS FIRST) AS "rownumber"
  FROM "DOMESTIC_SHIPPING_FREIGHT_PREPARED_1" ds
  LEFT JOIN "TIME_DIMENSION_PREPARED" t1
    ON CAST(ds."INVOICE_DATE_PARSED" AS DATE) = CAST(t1."DATE" AS DATE)
  LEFT JOIN "TIME_DIMENSION_PREPARED" t2
    ON CAST(ds."DELIVERY_DATE_PARSED"  AS DATE)=  CAST(t2."DATE" AS DATE)
  LEFT JOIN "TIME_DIMENSION_PREPARED" t3
    ON CAST(LEFT(ds."actual_delivery_date_parsed",10) AS DATE) =CAST(LEFT (t3."DATE",10) AS DATE)
 )  WHERE "NUM_REJECTIONS" = 0
 AND  (("INV_OBJECT_STATUS" = 40) OR ("INV_OBJECT_STATUS" = 20) OR ("INV_OBJECT_STATUS" = 30));

<br>
  --TLM_SHIPMENT_JOINED_FILTER_SHIPPING_WINDOWS
</br>  
CREATE OR REPLACE TEMPORARY TABLE  "TLM_SHIPMENT_JOINED_FILTER_SHIPPING_WINDOWS"
  AS
  WITH "DOMESTIC_SHIPPING_FREIGHT_W_CAL_FILTERED_TEST_TC_OBJECT_ID" AS
  (
  SELECT  "TC_OBJECT_ID" AS "TC_OBJECT_ID"
  FROM 
 "DOMESTIC_SHIPPING_FREIGHT_W_CAL_FILTERED_TEST_FILTERED_1_FILTERED"
  GROUP BY "TC_OBJECT_ID"
  )
  SELECT  *
  FROM 
  (
  SELECT *, SUM("TOTAL_COST") OVER (PARTITION BY "TC_SHIPMENT_ID" ORDER BY "SHIPMENT_ID" ASC NULLS FIRST) AS "TOTAL_COST_sum",
         ROW_NUMBER() OVER (PARTITION BY "TC_SHIPMENT_ID" ORDER BY "SHIPMENT_ID" ASC NULLS FIRST) AS "rownumber"
  FROM (
    SELECT 
        "tlm_shipment_joined_w_cal_filtered"."SHIPMENT_ID" AS "SHIPMENT_ID",
        "tlm_shipment_joined_w_cal_filtered"."TC_COMPANY_ID" AS "TC_COMPANY_ID",
        "tlm_shipment_joined_w_cal_filtered"."RS_AREA_ID" AS "RS_AREA_ID",
        "tlm_shipment_joined_w_cal_filtered"."TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID",
        "tlm_shipment_joined_w_cal_filtered"."PP_SHIPMENT_ID" AS "PP_SHIPMENT_ID",
        "tlm_shipment_joined_w_cal_filtered"."SHIPMENT_STATUS" AS "SHIPMENT_STATUS",
        "tlm_shipment_joined_w_cal_filtered"."UPDATE_SENT" AS "UPDATE_SENT",
        "tlm_shipment_joined_w_cal_filtered"."BUSINESS_PROCESS" AS "BUSINESS_PROCESS",
        "tlm_shipment_joined_w_cal_filtered"."CREATION_TYPE" AS "CREATION_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."CONS_RUN_ID" AS "CONS_RUN_ID",
        "tlm_shipment_joined_w_cal_filtered"."IS_CANCELLED" AS "IS_CANCELLED",
        "tlm_shipment_joined_w_cal_filtered"."RS_TYPE" AS "RS_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."RS_CONFIG_ID" AS "RS_CONFIG_ID",
        "tlm_shipment_joined_w_cal_filtered"."RS_CONFIG_CYCLE_ID" AS "RS_CONFIG_CYCLE_ID",
        "tlm_shipment_joined_w_cal_filtered"."CONFIG_CYCLE_SEQ" AS "CONFIG_CYCLE_SEQ",
        "tlm_shipment_joined_w_cal_filtered"."CYCLE_DEADLINE_DTTM" AS "CYCLE_DEADLINE_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."CYCLE_EXECUTION_DTTM" AS "CYCLE_EXECUTION_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."LAST_RS_NOTIFICATION_DTTM" AS "LAST_RS_NOTIFICATION_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."CFMF_STATUS" AS "CFMF_STATUS",
        "tlm_shipment_joined_w_cal_filtered"."AVAILABLE_DTTM" AS "AVAILABLE_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."CMID" AS "CMID",
        "tlm_shipment_joined_w_cal_filtered"."CM_DISCOUNT" AS "CM_DISCOUNT",
        "tlm_shipment_joined_w_cal_filtered"."O_FACILITY_NUMBER" AS "O_FACILITY_NUMBER",
        "tlm_shipment_joined_w_cal_filtered"."O_FACILITY_ID" AS "O_FACILITY_ID",
        "tlm_shipment_joined_w_cal_filtered"."O_ADDRESS" AS "O_ADDRESS",
        "tlm_shipment_joined_w_cal_filtered"."O_CITY" AS "O_CITY",
        "tlm_shipment_joined_w_cal_filtered"."O_STATE_PROV" AS "O_STATE_PROV",
        "tlm_shipment_joined_w_cal_filtered"."O_POSTAL_CODE" AS "O_POSTAL_CODE",
        "tlm_shipment_joined_w_cal_filtered"."O_COUNTY" AS "O_COUNTY",
        "tlm_shipment_joined_w_cal_filtered"."O_COUNTRY_CODE" AS "O_COUNTRY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."D_FACILITY_NUMBER" AS "D_FACILITY_NUMBER",
        "tlm_shipment_joined_w_cal_filtered"."D_FACILITY_ID" AS "D_FACILITY_ID",
        "tlm_shipment_joined_w_cal_filtered"."D_ADDRESS" AS "D_ADDRESS",
        "tlm_shipment_joined_w_cal_filtered"."D_CITY" AS "D_CITY",
        "tlm_shipment_joined_w_cal_filtered"."D_STATE_PROV" AS "D_STATE_PROV",
        "tlm_shipment_joined_w_cal_filtered"."D_POSTAL_CODE" AS "D_POSTAL_CODE",
        "tlm_shipment_joined_w_cal_filtered"."D_COUNTY" AS "D_COUNTY",
        "tlm_shipment_joined_w_cal_filtered"."D_COUNTRY_CODE" AS "D_COUNTRY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."DISTANCE" AS "DISTANCE",
        "tlm_shipment_joined_w_cal_filtered"."DIRECT_DISTANCE" AS "DIRECT_DISTANCE",
        "tlm_shipment_joined_w_cal_filtered"."OUT_OF_ROUTE_DISTANCE" AS "OUT_OF_ROUTE_DISTANCE",
        "tlm_shipment_joined_w_cal_filtered"."DISTANCE_UOM" AS "DISTANCE_UOM",
        "tlm_shipment_joined_w_cal_filtered"."BUSINESS_PARTNER_ID" AS "BUSINESS_PARTNER_ID",
        "tlm_shipment_joined_w_cal_filtered"."COMMODITY_CLASS" AS "COMMODITY_CLASS",
        "tlm_shipment_joined_w_cal_filtered"."IS_HAZMAT" AS "IS_HAZMAT",
        "tlm_shipment_joined_w_cal_filtered"."IS_PERISHABLE" AS "IS_PERISHABLE",
        "tlm_shipment_joined_w_cal_filtered"."BILLING_METHOD" AS "BILLING_METHOD",
        "tlm_shipment_joined_w_cal_filtered"."DSG_CARRIER_CODE" AS "DSG_CARRIER_CODE",
        "tlm_shipment_joined_w_cal_filtered"."REC_CMID" AS "REC_CMID",
        "tlm_shipment_joined_w_cal_filtered"."REC_CM_SHIPMENT_ID" AS "REC_CM_SHIPMENT_ID",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_CARRIER_CODE" AS "ASSIGNED_CARRIER_CODE",
        "tlm_shipment_joined_w_cal_filtered"."SHIPMENT_REF_ID" AS "SHIPMENT_REF_ID",
        "tlm_shipment_joined_w_cal_filtered"."BILL_TO_CODE" AS "BILL_TO_CODE",
        "tlm_shipment_joined_w_cal_filtered"."BILL_TO_TITLE" AS "BILL_TO_TITLE",
        "tlm_shipment_joined_w_cal_filtered"."BILL_TO_NAME" AS "BILL_TO_NAME",
        "tlm_shipment_joined_w_cal_filtered"."BILL_TO_ADDRESS" AS "BILL_TO_ADDRESS",
        "tlm_shipment_joined_w_cal_filtered"."BILL_TO_CITY" AS "BILL_TO_CITY",
        "tlm_shipment_joined_w_cal_filtered"."BILL_TO_STATE_PROV" AS "BILL_TO_STATE_PROV",
        "tlm_shipment_joined_w_cal_filtered"."BILL_TO_POSTAL_CODE" AS "BILL_TO_POSTAL_CODE",
        "tlm_shipment_joined_w_cal_filtered"."BILL_TO_COUNTRY_CODE" AS "BILL_TO_COUNTRY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."BILL_TO_PHONE_NUMBER" AS "BILL_TO_PHONE_NUMBER",
        "tlm_shipment_joined_w_cal_filtered"."PURCHASE_ORDER" AS "PURCHASE_ORDER",
        "tlm_shipment_joined_w_cal_filtered"."PRO_NUMBER" AS "PRO_NUMBER",
        "tlm_shipment_joined_w_cal_filtered"."TRANS_RESP_CODE" AS "TRANS_RESP_CODE",
        "tlm_shipment_joined_w_cal_filtered"."BASELINE_COST" AS "BASELINE_COST",
        "tlm_shipment_joined_w_cal_filtered"."ESTIMATED_COST" AS "ESTIMATED_COST",
        "tlm_shipment_joined_w_cal_filtered"."LINEHAUL_COST" AS "LINEHAUL_COST",
        "tlm_shipment_joined_w_cal_filtered"."ACCESSORIAL_COST" AS "ACCESSORIAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."STOP_COST" AS "STOP_COST",
        "tlm_shipment_joined_w_cal_filtered"."ESTIMATED_SAVINGS" AS "ESTIMATED_SAVINGS",
        "tlm_shipment_joined_w_cal_filtered"."SPOT_CHARGE" AS "SPOT_CHARGE",
        "tlm_shipment_joined_w_cal_filtered"."CURRENCY_CODE" AS "CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."PICKUP_START_DTTM" AS "PICKUP_START_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."PICKUP_END_DTTM" AS "PICKUP_END_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."DELIVERY_START_DTTM" AS "DELIVERY_START_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."DELIVERY_END_DTTM" AS "DELIVERY_END_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."NUM_STOPS" AS "NUM_STOPS",
        "tlm_shipment_joined_w_cal_filtered"."NUM_DOCKS" AS "NUM_DOCKS",
        "tlm_shipment_joined_w_cal_filtered"."ON_TIME_INDICATOR" AS "ON_TIME_INDICATOR",
        "tlm_shipment_joined_w_cal_filtered"."HAS_NOTES" AS "HAS_NOTES",
        "tlm_shipment_joined_w_cal_filtered"."HAS_ALERTS" AS "HAS_ALERTS",
        "tlm_shipment_joined_w_cal_filtered"."HAS_IMPORT_ERROR" AS "HAS_IMPORT_ERROR",
        "tlm_shipment_joined_w_cal_filtered"."HAS_SOFT_CHECK_ERROR" AS "HAS_SOFT_CHECK_ERROR",
        "tlm_shipment_joined_w_cal_filtered"."HAS_TRACKING_MSG" AS "HAS_TRACKING_MSG",
        "tlm_shipment_joined_w_cal_filtered"."TRACKING_MSG_PROBLEM" AS "TRACKING_MSG_PROBLEM",
        "tlm_shipment_joined_w_cal_filtered"."REC_LINEHAUL_COST" AS "REC_LINEHAUL_COST",
        "tlm_shipment_joined_w_cal_filtered"."REC_ACCESSORIAL_COST" AS "REC_ACCESSORIAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."REC_TOTAL_COST" AS "REC_TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."CYCLE_RESP_DEADLINE_TZ" AS "CYCLE_RESP_DEADLINE_TZ",
        "tlm_shipment_joined_w_cal_filtered"."TENDER_RESP_DEADLINE_TZ" AS "TENDER_RESP_DEADLINE_TZ",
        "tlm_shipment_joined_w_cal_filtered"."PICKUP_TZ" AS "PICKUP_TZ",
        "tlm_shipment_joined_w_cal_filtered"."DELIVERY_TZ" AS "DELIVERY_TZ",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_LANE_ID" AS "ASSIGNED_LANE_ID",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_LANE_DETAIL_ID" AS "ASSIGNED_LANE_DETAIL_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_SPOT_CHARGE" AS "REC_SPOT_CHARGE",
        "tlm_shipment_joined_w_cal_filtered"."REC_LANE_ID" AS "REC_LANE_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_LANE_DETAIL_ID" AS "REC_LANE_DETAIL_ID",
        "tlm_shipment_joined_w_cal_filtered"."TENDER_DTTM" AS "TENDER_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."O_STOP_LOCATION_NAME" AS "O_STOP_LOCATION_NAME",
        "tlm_shipment_joined_w_cal_filtered"."D_STOP_LOCATION_NAME" AS "D_STOP_LOCATION_NAME",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_CM_SHIPMENT_ID" AS "ASSIGNED_CM_SHIPMENT_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_CM_DISCOUNT" AS "REC_CM_DISCOUNT",
        "tlm_shipment_joined_w_cal_filtered"."REC_STOP_COST" AS "REC_STOP_COST",
        "tlm_shipment_joined_w_cal_filtered"."LAST_SELECTOR_RUN_DTTM" AS "LAST_SELECTOR_RUN_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."LAST_CM_OPTION_GEN_DTTM" AS "LAST_CM_OPTION_GEN_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."IS_CM_OPTION_GEN_ACTIVE" AS "IS_CM_OPTION_GEN_ACTIVE",
        "tlm_shipment_joined_w_cal_filtered"."RS_CYCLE_REMAINING" AS "RS_CYCLE_REMAINING",
        "tlm_shipment_joined_w_cal_filtered"."IS_TIME_FEAS_ENABLED" AS "IS_TIME_FEAS_ENABLED",
        "tlm_shipment_joined_w_cal_filtered"."EXT_SYS_SHIPMENT_ID" AS "EXT_SYS_SHIPMENT_ID",
        "tlm_shipment_joined_w_cal_filtered"."EXTRACTION_DTTM" AS "EXTRACTION_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_BROKER_CARRIER_CODE" AS "ASSIGNED_BROKER_CARRIER_CODE",
        "tlm_shipment_joined_w_cal_filtered"."USE_BROKER_AS_CARRIER" AS "USE_BROKER_AS_CARRIER",
        "tlm_shipment_joined_w_cal_filtered"."BROKER_REF" AS "BROKER_REF",
        "tlm_shipment_joined_w_cal_filtered"."RATING_QUALIFIER" AS "RATING_QUALIFIER",
        "tlm_shipment_joined_w_cal_filtered"."STATUS_CHANGE_DTTM" AS "STATUS_CHANGE_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."BUDG_TOTAL_COST" AS "BUDG_TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."NORMALIZED_MARGIN" AS "NORMALIZED_MARGIN",
        "tlm_shipment_joined_w_cal_filtered"."NORMALIZED_TOTAL_COST" AS "NORMALIZED_TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."BUDG_NORMALIZED_TOTAL_COST" AS "BUDG_NORMALIZED_TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."REC_BUDG_LINEHAUL_COST" AS "REC_BUDG_LINEHAUL_COST",
        "tlm_shipment_joined_w_cal_filtered"."REC_BUDG_STOP_COST" AS "REC_BUDG_STOP_COST",
        "tlm_shipment_joined_w_cal_filtered"."REC_BUDG_CM_DISCOUNT" AS "REC_BUDG_CM_DISCOUNT",
        "tlm_shipment_joined_w_cal_filtered"."REC_BUDG_ACCESSORIAL_COST" AS "REC_BUDG_ACCESSORIAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."REC_BUDG_TOTAL_COST" AS "REC_BUDG_TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."REC_MARGIN" AS "REC_MARGIN",
        "tlm_shipment_joined_w_cal_filtered"."REC_NORMALIZED_MARGIN" AS "REC_NORMALIZED_MARGIN",
        "tlm_shipment_joined_w_cal_filtered"."REC_NORMALIZED_TOTAL_COST" AS "REC_NORMALIZED_TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."REC_BUDG_NORMALIZED_TOTAL_COST" AS "REC_BUDG_NORMALIZED_TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."BUDG_CURRENCY_CODE" AS "BUDG_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."SPOT_CHARGE_CURRENCY_CODE" AS "SPOT_CHARGE_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."REC_CURRENCY_CODE" AS "REC_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."REC_BUDG_CURRENCY_CODE" AS "REC_BUDG_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."REC_SPOT_CHARGE_CURRENCY_CODE" AS "REC_SPOT_CHARGE_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."RATING_LANE_ID" AS "RATING_LANE_ID",
        "tlm_shipment_joined_w_cal_filtered"."FRT_REV_RATING_LANE_ID" AS "FRT_REV_RATING_LANE_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_RATING_LANE_ID" AS "REC_RATING_LANE_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_BUDG_RATING_LANE_ID" AS "REC_BUDG_RATING_LANE_ID",
        "tlm_shipment_joined_w_cal_filtered"."RATING_LANE_DETAIL_ID" AS "RATING_LANE_DETAIL_ID",
        "tlm_shipment_joined_w_cal_filtered"."FRT_REV_RATING_LANE_DETAIL_ID" AS "FRT_REV_RATING_LANE_DETAIL_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_RATING_LANE_DETAIL_ID" AS "REC_RATING_LANE_DETAIL_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_BUDG_RATING_LANE_DETAIL_ID" AS "REC_BUDG_RATING_LANE_DETAIL_ID",
        "tlm_shipment_joined_w_cal_filtered"."BUDG_CM_DISCOUNT" AS "BUDG_CM_DISCOUNT",
        "tlm_shipment_joined_w_cal_filtered"."NORMALIZED_BASELINE_COST" AS "NORMALIZED_BASELINE_COST",
        "tlm_shipment_joined_w_cal_filtered"."BASELINE_COST_CURRENCY_CODE" AS "BASELINE_COST_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."REPORTED_COST" AS "REPORTED_COST",
        "tlm_shipment_joined_w_cal_filtered"."TRACTOR_NUMBER" AS "TRACTOR_NUMBER",
        "tlm_shipment_joined_w_cal_filtered"."IS_AUTO_DELIVERED" AS "IS_AUTO_DELIVERED",
        "tlm_shipment_joined_w_cal_filtered"."SHIPMENT_TYPE" AS "SHIPMENT_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."ORIG_BUDG_TOTAL_COST" AS "ORIG_BUDG_TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."ACCESSORIAL_COST_TO_CARRIER" AS "ACCESSORIAL_COST_TO_CARRIER",
        "tlm_shipment_joined_w_cal_filtered"."CARRIER_CHARGE" AS "CARRIER_CHARGE",
        "tlm_shipment_joined_w_cal_filtered"."ACTUAL_COST" AS "ACTUAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."EARNED_INCOME" AS "EARNED_INCOME",
        "tlm_shipment_joined_w_cal_filtered"."SENT_TO_PKMS" AS "SENT_TO_PKMS",
        "tlm_shipment_joined_w_cal_filtered"."IS_SHIPMENT_RECONCILED" AS "IS_SHIPMENT_RECONCILED",
        "tlm_shipment_joined_w_cal_filtered"."DELIVERY_REQ" AS "DELIVERY_REQ",
        "tlm_shipment_joined_w_cal_filtered"."DROPOFF_PICKUP" AS "DROPOFF_PICKUP",
        "tlm_shipment_joined_w_cal_filtered"."PACKAGING" AS "PACKAGING",
        "tlm_shipment_joined_w_cal_filtered"."SENT_TO_PKMS_DTTM" AS "SENT_TO_PKMS_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."WMS_STATUS_CODE" AS "WMS_STATUS_CODE",
        "tlm_shipment_joined_w_cal_filtered"."SPOT_CHARGE_AND_PAYEE_ACC" AS "SPOT_CHARGE_AND_PAYEE_ACC",
        "tlm_shipment_joined_w_cal_filtered"."SPOT_CHARGE_AND_PAYEE_ACC_CC" AS "SPOT_CHARGE_AND_PAYEE_ACC_CC",
        "tlm_shipment_joined_w_cal_filtered"."NORM_SPOT_CHARGE_AND_PAYEE_ACC" AS "NORM_SPOT_CHARGE_AND_PAYEE_ACC",
        "tlm_shipment_joined_w_cal_filtered"."FACILITY_SCHEDULE_ID" AS "FACILITY_SCHEDULE_ID",
        "tlm_shipment_joined_w_cal_filtered"."EARNED_INCOME_CURRENCY_CODE" AS "EARNED_INCOME_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."ACTUAL_COST_CURRENCY_CODE" AS "ACTUAL_COST_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."SHIPMENT_RECON_DTTM" AS "SHIPMENT_RECON_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."PLN_RATING_LANE_ID" AS "PLN_RATING_LANE_ID",
        "tlm_shipment_joined_w_cal_filtered"."PLN_RATING_LANE_DETAIL_ID" AS "PLN_RATING_LANE_DETAIL_ID",
        "tlm_shipment_joined_w_cal_filtered"."PLN_TOTAL_COST" AS "PLN_TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."PLN_LINEHAUL_COST" AS "PLN_LINEHAUL_COST",
        "tlm_shipment_joined_w_cal_filtered"."PLN_TOTAL_ACCESSORIAL_COST" AS "PLN_TOTAL_ACCESSORIAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."PLN_STOP_OFF_COST" AS "PLN_STOP_OFF_COST",
        "tlm_shipment_joined_w_cal_filtered"."PLN_NORMALIZED_TOTAL_COST" AS "PLN_NORMALIZED_TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."PLN_CURRENCY_CODE" AS "PLN_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."PLN_ACCESSORL_COST_TO_CARRIER" AS "PLN_ACCESSORL_COST_TO_CARRIER",
        "tlm_shipment_joined_w_cal_filtered"."PLN_CARRIER_CHARGE" AS "PLN_CARRIER_CHARGE",
        "tlm_shipment_joined_w_cal_filtered"."WAYPOINT_TOTAL_COST" AS "WAYPOINT_TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."WAYPOINT_HANDLING_COST" AS "WAYPOINT_HANDLING_COST",
        "tlm_shipment_joined_w_cal_filtered"."GRS_OPERATION" AS "GRS_OPERATION",
        "tlm_shipment_joined_w_cal_filtered"."IS_GRS_OPT_CYCLE_RUNNING" AS "IS_GRS_OPT_CYCLE_RUNNING",
        "tlm_shipment_joined_w_cal_filtered"."IS_MANUAL_ASSIGN" AS "IS_MANUAL_ASSIGN",
        "tlm_shipment_joined_w_cal_filtered"."LAST_RUN_GRS_DTTM" AS "LAST_RUN_GRS_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."GRS_MAX_SHIPMENT_STATUS" AS "GRS_MAX_SHIPMENT_STATUS",
        "tlm_shipment_joined_w_cal_filtered"."PRIORITY_TYPE" AS "PRIORITY_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."MV_CURRENCY_CODE" AS "MV_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."PROD_SCHED_REF_NUMBER" AS "PROD_SCHED_REF_NUMBER",
        "tlm_shipment_joined_w_cal_filtered"."COMMODITY_CODE_ID" AS "COMMODITY_CODE_ID",
        "tlm_shipment_joined_w_cal_filtered"."UN_NUMBER_ID" AS "UN_NUMBER_ID",
        "tlm_shipment_joined_w_cal_filtered"."CONTRACT_NUMBER" AS "CONTRACT_NUMBER",
        "tlm_shipment_joined_w_cal_filtered"."BOOKING_REF_SHIPPER" AS "BOOKING_REF_SHIPPER",
        "tlm_shipment_joined_w_cal_filtered"."BOOKING_REF_CARRIER" AS "BOOKING_REF_CARRIER",
        "tlm_shipment_joined_w_cal_filtered"."BK_RESOURCE_REF_EXTERNAL" AS "BK_RESOURCE_REF_EXTERNAL",
        "tlm_shipment_joined_w_cal_filtered"."BK_RESOURCE_NAME_EXTERNAL" AS "BK_RESOURCE_NAME_EXTERNAL",
        "tlm_shipment_joined_w_cal_filtered"."BK_O_FACILITY_ID" AS "BK_O_FACILITY_ID",
        "tlm_shipment_joined_w_cal_filtered"."BK_D_FACILITY_ID" AS "BK_D_FACILITY_ID",
        "tlm_shipment_joined_w_cal_filtered"."BK_MASTER_AIRWAY_BILL" AS "BK_MASTER_AIRWAY_BILL",
        "tlm_shipment_joined_w_cal_filtered"."BK_FORWARDER_AIRWAY_BILL" AS "BK_FORWARDER_AIRWAY_BILL",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_SCNDR_CARRIER_CODE" AS "ASSIGNED_SCNDR_CARRIER_CODE",
        "tlm_shipment_joined_w_cal_filtered"."CUSTOMER_CREDIT_LIMIT_ID" AS "CUSTOMER_CREDIT_LIMIT_ID",
        "tlm_shipment_joined_w_cal_filtered"."SHIPMENT_LEG_TYPE" AS "SHIPMENT_LEG_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."SHIPMENT_CLOSED_INDICATOR" AS "SHIPMENT_CLOSED_INDICATOR",
        "tlm_shipment_joined_w_cal_filtered"."OCEAN_ROUTING_STAGE" AS "OCEAN_ROUTING_STAGE",
        "tlm_shipment_joined_w_cal_filtered"."BK_DEPARTURE_DTTM" AS "BK_DEPARTURE_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."BK_DEPARTURE_TZ" AS "BK_DEPARTURE_TZ",
        "tlm_shipment_joined_w_cal_filtered"."BK_ARRIVAL_DTTM" AS "BK_ARRIVAL_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."BK_ARRIVAL_TZ" AS "BK_ARRIVAL_TZ",
        "tlm_shipment_joined_w_cal_filtered"."BK_PICKUP_DTTM" AS "BK_PICKUP_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."BK_PICKUP_TZ" AS "BK_PICKUP_TZ",
        "tlm_shipment_joined_w_cal_filtered"."BK_CUTOFF_DTTM" AS "BK_CUTOFF_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."BK_CUTOFF_TZ" AS "BK_CUTOFF_TZ",
        "tlm_shipment_joined_w_cal_filtered"."NUM_CHARGE_LAYOVERS" AS "NUM_CHARGE_LAYOVERS",
        "tlm_shipment_joined_w_cal_filtered"."RATE_TYPE" AS "RATE_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."RATE_UOM" AS "RATE_UOM",
        "tlm_shipment_joined_w_cal_filtered"."PICK_START_DTTM" AS "PICK_START_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."PAPERWORK_START_DTTM" AS "PAPERWORK_START_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."VEHICLE_CHECK_START_DTTM" AS "VEHICLE_CHECK_START_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."SHIPMENT_START_DTTM" AS "SHIPMENT_START_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."SHIPMENT_END_DTTM" AS "SHIPMENT_END_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."FEASIBLE_DRIVER_TYPE" AS "FEASIBLE_DRIVER_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."WAVE_ID" AS "WAVE_ID",
        "tlm_shipment_joined_w_cal_filtered"."ESTIMATED_DISPATCH_DTTM" AS "ESTIMATED_DISPATCH_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."TOTAL_TIME" AS "TOTAL_TIME",
        "tlm_shipment_joined_w_cal_filtered"."LOC_REFERENCE" AS "LOC_REFERENCE",
        "tlm_shipment_joined_w_cal_filtered"."BK_O_FACILITY_ALIAS_ID" AS "BK_O_FACILITY_ALIAS_ID",
        "tlm_shipment_joined_w_cal_filtered"."BK_D_FACILITY_ALIAS_ID" AS "BK_D_FACILITY_ALIAS_ID",
        "tlm_shipment_joined_w_cal_filtered"."EQUIP_UTIL_PER" AS "EQUIP_UTIL_PER",
        "tlm_shipment_joined_w_cal_filtered"."MOVE_TYPE" AS "MOVE_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."DRIVER_TYPE_ID" AS "DRIVER_TYPE_ID",
        "tlm_shipment_joined_w_cal_filtered"."EQUIPMENT_TYPE" AS "EQUIPMENT_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."RADIAL_DISTANCE" AS "RADIAL_DISTANCE",
        "tlm_shipment_joined_w_cal_filtered"."RADIAL_DISTANCE_UOM" AS "RADIAL_DISTANCE_UOM",
        "tlm_shipment_joined_w_cal_filtered"."DESIGNATED_TRACTOR_CODE" AS "DESIGNATED_TRACTOR_CODE",
        "tlm_shipment_joined_w_cal_filtered"."DESIGNATED_DRIVER_TYPE" AS "DESIGNATED_DRIVER_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."IS_WAVE_MAN_CHANGED" AS "IS_WAVE_MAN_CHANGED",
        "tlm_shipment_joined_w_cal_filtered"."RETAIN_CONSOLIDATOR_TIMES" AS "RETAIN_CONSOLIDATOR_TIMES",
        "tlm_shipment_joined_w_cal_filtered"."TARIFF" AS "TARIFF",
        "tlm_shipment_joined_w_cal_filtered"."MIN_RATE" AS "MIN_RATE",
        "tlm_shipment_joined_w_cal_filtered"."FIRST_UPDATE_SENT_TO_PKMS" AS "FIRST_UPDATE_SENT_TO_PKMS",
        "tlm_shipment_joined_w_cal_filtered"."EVENT_IND_TYPEID" AS "EVENT_IND_TYPEID",
        "tlm_shipment_joined_w_cal_filtered"."TANDEM_PATH_ID" AS "TANDEM_PATH_ID",
        "tlm_shipment_joined_w_cal_filtered"."O_TANDEM_FACILITY" AS "O_TANDEM_FACILITY",
        "tlm_shipment_joined_w_cal_filtered"."D_TANDEM_FACILITY" AS "D_TANDEM_FACILITY",
        "tlm_shipment_joined_w_cal_filtered"."O_TANDEM_FACILITY_ALIAS" AS "O_TANDEM_FACILITY_ALIAS",
        "tlm_shipment_joined_w_cal_filtered"."D_TANDEM_FACILITY_ALIAS" AS "D_TANDEM_FACILITY_ALIAS",
        "tlm_shipment_joined_w_cal_filtered"."DELAY_TYPE" AS "DELAY_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_CARRIER_ID" AS "ASSIGNED_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."DSG_CARRIER_ID" AS "DSG_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_CARRIER_ID" AS "REC_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."FEASIBLE_CARRIER_ID" AS "FEASIBLE_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."PAYEE_CARRIER_ID" AS "PAYEE_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."SCNDR_CARRIER_ID" AS "SCNDR_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."BROKER_CARRIER_ID" AS "BROKER_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_SCNDR_CARRIER_ID" AS "ASSIGNED_SCNDR_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."DSG_SCNDR_CARRIER_ID" AS "DSG_SCNDR_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_BROKER_CARRIER_ID" AS "ASSIGNED_BROKER_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."LH_PAYEE_CARRIER_ID" AS "LH_PAYEE_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_BROKER_CARRIER_ID" AS "REC_BROKER_CARRIER_ID",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_EQUIPMENT_ID" AS "ASSIGNED_EQUIPMENT_ID",
        "tlm_shipment_joined_w_cal_filtered"."DSG_EQUIPMENT_ID" AS "DSG_EQUIPMENT_ID",
        "tlm_shipment_joined_w_cal_filtered"."FEASIBLE_EQUIPMENT_ID" AS "FEASIBLE_EQUIPMENT_ID",
        "tlm_shipment_joined_w_cal_filtered"."FEASIBLE_EQUIPMENT2_ID" AS "FEASIBLE_EQUIPMENT2_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_EQUIPMENT_ID" AS "REC_EQUIPMENT_ID",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_MOT_ID" AS "ASSIGNED_MOT_ID",
        "tlm_shipment_joined_w_cal_filtered"."DSG_MOT_ID" AS "DSG_MOT_ID",
        "tlm_shipment_joined_w_cal_filtered"."FEASIBLE_MOT_ID" AS "FEASIBLE_MOT_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_MOT_ID" AS "REC_MOT_ID",
        "tlm_shipment_joined_w_cal_filtered"."PRODUCT_CLASS_ID" AS "PRODUCT_CLASS_ID",
        "tlm_shipment_joined_w_cal_filtered"."PROTECTION_LEVEL_ID" AS "PROTECTION_LEVEL_ID",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_SERVICE_LEVEL_ID" AS "ASSIGNED_SERVICE_LEVEL_ID",
        "tlm_shipment_joined_w_cal_filtered"."DSG_SERVICE_LEVEL_ID" AS "DSG_SERVICE_LEVEL_ID",
        "tlm_shipment_joined_w_cal_filtered"."FEASIBLE_SERVICE_LEVEL_ID" AS "FEASIBLE_SERVICE_LEVEL_ID",
        "tlm_shipment_joined_w_cal_filtered"."REC_SERVICE_LEVEL_ID" AS "REC_SERVICE_LEVEL_ID",
        "tlm_shipment_joined_w_cal_filtered"."HAS_EM_NOTIFY_FLAG" AS "HAS_EM_NOTIFY_FLAG",
        "tlm_shipment_joined_w_cal_filtered"."REGION_ID" AS "REGION_ID",
        "tlm_shipment_joined_w_cal_filtered"."INBOUND_REGION_ID" AS "INBOUND_REGION_ID",
        "tlm_shipment_joined_w_cal_filtered"."OUTBOUND_REGION_ID" AS "OUTBOUND_REGION_ID",
        "tlm_shipment_joined_w_cal_filtered"."FINANCIAL_WT" AS "FINANCIAL_WT",
        "tlm_shipment_joined_w_cal_filtered"."IS_BOOKING_REQUIRED" AS "IS_BOOKING_REQUIRED",
        "tlm_shipment_joined_w_cal_filtered"."TOTAL_COST_EXCL_TAX" AS "TOTAL_COST_EXCL_TAX",
        "tlm_shipment_joined_w_cal_filtered"."TOTAL_TAX_AMOUNT" AS "TOTAL_TAX_AMOUNT",
        "tlm_shipment_joined_w_cal_filtered"."IS_ASSOCIATED_TO_OUTBOUND" AS "IS_ASSOCIATED_TO_OUTBOUND",
        "tlm_shipment_joined_w_cal_filtered"."RECEIVED_DTTM" AS "RECEIVED_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."BOOKING_ID" AS "BOOKING_ID",
        "tlm_shipment_joined_w_cal_filtered"."IS_MISROUTED" AS "IS_MISROUTED",
        "tlm_shipment_joined_w_cal_filtered"."FEASIBLE_CARRIER_CODE" AS "FEASIBLE_CARRIER_CODE",
        "tlm_shipment_joined_w_cal_filtered"."SHIPMENT_WIN_ADJ_FLAG" AS "SHIPMENT_WIN_ADJ_FLAG",
        "tlm_shipment_joined_w_cal_filtered"."DT_PARAM_SET_ID" AS "DT_PARAM_SET_ID",
        "tlm_shipment_joined_w_cal_filtered"."MERCHANDIZING_DEPARTMENT_ID" AS "MERCHANDIZING_DEPARTMENT_ID",
        "tlm_shipment_joined_w_cal_filtered"."STATIC_ROUTE_ID" AS "STATIC_ROUTE_ID",
        "tlm_shipment_joined_w_cal_filtered"."IS_FILO" AS "IS_FILO",
        "tlm_shipment_joined_w_cal_filtered"."IS_COOLER_AT_NOSE" AS "IS_COOLER_AT_NOSE",
        "tlm_shipment_joined_w_cal_filtered"."AUTH_NBR" AS "AUTH_NBR",
        "tlm_shipment_joined_w_cal_filtered"."CONS_LOCN_ID" AS "CONS_LOCN_ID",
        "tlm_shipment_joined_w_cal_filtered"."RTE_TYPE" AS "RTE_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."TRLR_TYPE" AS "TRLR_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."TRLR_SIZE" AS "TRLR_SIZE",
        "tlm_shipment_joined_w_cal_filtered"."CONS_ADDR_CODE" AS "CONS_ADDR_CODE",
        "tlm_shipment_joined_w_cal_filtered"."HUB_ID" AS "HUB_ID",
        "tlm_shipment_joined_w_cal_filtered"."TRLR_GEN_CODE" AS "TRLR_GEN_CODE",
        "tlm_shipment_joined_w_cal_filtered"."MAX_NBR_OF_CTNS" AS "MAX_NBR_OF_CTNS",
        "tlm_shipment_joined_w_cal_filtered"."APPT_DOOR_SCHED_TYPE" AS "APPT_DOOR_SCHED_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."CREATED_SOURCE_TYPE" AS "CREATED_SOURCE_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."CREATED_SOURCE" AS "CREATED_SOURCE",
        "tlm_shipment_joined_w_cal_filtered"."CREATED_DTTM" AS "CREATED_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."LAST_UPDATED_SOURCE_TYPE" AS "LAST_UPDATED_SOURCE_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."LAST_UPDATED_SOURCE" AS "LAST_UPDATED_SOURCE",
        "tlm_shipment_joined_w_cal_filtered"."LAST_UPDATED_DTTM" AS "LAST_UPDATED_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."DSG_SCNDR_CARRIER_CODE" AS "DSG_SCNDR_CARRIER_CODE",
        "tlm_shipment_joined_w_cal_filtered"."LH_PAYEE_CARRIER_CODE" AS "LH_PAYEE_CARRIER_CODE",
        "tlm_shipment_joined_w_cal_filtered"."REC_BROKER_CARRIER_CODE" AS "REC_BROKER_CARRIER_CODE",
        "tlm_shipment_joined_w_cal_filtered"."REC_CARRIER_CODE" AS "REC_CARRIER_CODE",
        "tlm_shipment_joined_w_cal_filtered"."LPN_ASSIGNMENT_STOPPED" AS "LPN_ASSIGNMENT_STOPPED",
        "tlm_shipment_joined_w_cal_filtered"."SEAL_NUMBER" AS "SEAL_NUMBER",
        "tlm_shipment_joined_w_cal_filtered"."HIBERNATE_VERSION" AS "HIBERNATE_VERSION",
        "tlm_shipment_joined_w_cal_filtered"."SHIP_GROUP_ID" AS "SHIP_GROUP_ID",
        "tlm_shipment_joined_w_cal_filtered"."RATE" AS "RATE",
        "tlm_shipment_joined_w_cal_filtered"."MONETARY_VALUE" AS "MONETARY_VALUE",
        "tlm_shipment_joined_w_cal_filtered"."DOOR" AS "DOOR",
        "tlm_shipment_joined_w_cal_filtered"."RTE_TYPE_1" AS "RTE_TYPE_1",
        "tlm_shipment_joined_w_cal_filtered"."RTE_TYPE_2" AS "RTE_TYPE_2",
        "tlm_shipment_joined_w_cal_filtered"."SCHEDULED_PICKUP_DTTM" AS "SCHEDULED_PICKUP_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."MANIFEST_ID" AS "MANIFEST_ID",
        "tlm_shipment_joined_w_cal_filtered"."DAYS_TO_DELIVER" AS "DAYS_TO_DELIVER",
        "tlm_shipment_joined_w_cal_filtered"."SED_GENERATED_FLAG" AS "SED_GENERATED_FLAG",
        "tlm_shipment_joined_w_cal_filtered"."SERV_AREA_CODE" AS "SERV_AREA_CODE",
        "tlm_shipment_joined_w_cal_filtered"."TENDER_RESP_DEADLINE_DTTM" AS "TENDER_RESP_DEADLINE_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."PRINT_CONS_BOL" AS "PRINT_CONS_BOL",
        "tlm_shipment_joined_w_cal_filtered"."LEFT_WT" AS "LEFT_WT",
        "tlm_shipment_joined_w_cal_filtered"."RIGHT_WT" AS "RIGHT_WT",
        "tlm_shipment_joined_w_cal_filtered"."LANE_NAME" AS "LANE_NAME",
        "tlm_shipment_joined_w_cal_filtered"."DECLARED_VALUE" AS "DECLARED_VALUE",
        "tlm_shipment_joined_w_cal_filtered"."DV_CURRENCY_CODE" AS "DV_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."COD_AMOUNT" AS "COD_AMOUNT",
        "tlm_shipment_joined_w_cal_filtered"."CUSTOMER_ID" AS "CUSTOMER_ID",
        "tlm_shipment_joined_w_cal_filtered"."CUST_FRGT_CHARGE" AS "CUST_FRGT_CHARGE",
        "tlm_shipment_joined_w_cal_filtered"."COD_CURRENCY_CODE" AS "COD_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."PLANNED_WEIGHT" AS "PLANNED_WEIGHT",
        "tlm_shipment_joined_w_cal_filtered"."WEIGHT_UOM_ID_BASE" AS "WEIGHT_UOM_ID_BASE",
        "tlm_shipment_joined_w_cal_filtered"."PLANNED_VOLUME" AS "PLANNED_VOLUME",
        "tlm_shipment_joined_w_cal_filtered"."VOLUME_UOM_ID_BASE" AS "VOLUME_UOM_ID_BASE",
        "tlm_shipment_joined_w_cal_filtered"."SIZE1_VALUE" AS "SIZE1_VALUE",
        "tlm_shipment_joined_w_cal_filtered"."SIZE1_UOM_ID" AS "SIZE1_UOM_ID",
        "tlm_shipment_joined_w_cal_filtered"."SIZE2_VALUE" AS "SIZE2_VALUE",
        "tlm_shipment_joined_w_cal_filtered"."SIZE2_UOM_ID" AS "SIZE2_UOM_ID",
        "tlm_shipment_joined_w_cal_filtered"."ASSIGNED_SHIP_VIA" AS "ASSIGNED_SHIP_VIA",
        "tlm_shipment_joined_w_cal_filtered"."INSURANCE_STATUS" AS "INSURANCE_STATUS",
        "tlm_shipment_joined_w_cal_filtered"."RTE_SWC_NBR" AS "RTE_SWC_NBR",
        "tlm_shipment_joined_w_cal_filtered"."RTE_TO" AS "RTE_TO",
        "tlm_shipment_joined_w_cal_filtered"."BILL_OF_LADING_NUMBER" AS "BILL_OF_LADING_NUMBER",
        "tlm_shipment_joined_w_cal_filtered"."TRAILER_NUMBER" AS "TRAILER_NUMBER",
        "tlm_shipment_joined_w_cal_filtered"."TRANS_PLAN_OWNER" AS "TRANS_PLAN_OWNER",
        "tlm_shipment_joined_w_cal_filtered"."TOTAL_REVENUE_CURRENCY_CODE" AS "TOTAL_REVENUE_CURRENCY_CODE",
        "tlm_shipment_joined_w_cal_filtered"."TOTAL_REVENUE" AS "TOTAL_REVENUE",
        "tlm_shipment_joined_w_cal_filtered"."FRT_REV_SPOT_CHARGE_CURR_CODE" AS "FRT_REV_SPOT_CHARGE_CURR_CODE",
        "tlm_shipment_joined_w_cal_filtered"."NORMALIZED_TOTAL_REVENUE" AS "NORMALIZED_TOTAL_REVENUE",
        "tlm_shipment_joined_w_cal_filtered"."FRT_REV_SPOT_CHARGE" AS "FRT_REV_SPOT_CHARGE",
        "tlm_shipment_joined_w_cal_filtered"."DSG_VOYAGE_FLIGHT" AS "DSG_VOYAGE_FLIGHT",
        "tlm_shipment_joined_w_cal_filtered"."FEASIBLE_VOYAGE_FLIGHT" AS "FEASIBLE_VOYAGE_FLIGHT",
        "tlm_shipment_joined_w_cal_filtered"."CURRENCY_DTTM" AS "CURRENCY_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."FRT_REV_LINEHAUL_CHARGE" AS "FRT_REV_LINEHAUL_CHARGE",
        "tlm_shipment_joined_w_cal_filtered"."FRT_REV_STOP_CHARGE" AS "FRT_REV_STOP_CHARGE",
        "tlm_shipment_joined_w_cal_filtered"."FRT_REV_ACCESSORIAL_CHARGE" AS "FRT_REV_ACCESSORIAL_CHARGE",
        "tlm_shipment_joined_w_cal_filtered"."MARGIN" AS "MARGIN",
        "tlm_shipment_joined_w_cal_filtered"."TOTAL_COST" AS "TOTAL_COST",
        "tlm_shipment_joined_w_cal_filtered"."INCOTERM_ID" AS "INCOTERM_ID",
        "tlm_shipment_joined_w_cal_filtered"."ORDER_QTY" AS "ORDER_QTY",
        "tlm_shipment_joined_w_cal_filtered"."QTY_UOM_ID" AS "QTY_UOM_ID",
        "tlm_shipment_joined_w_cal_filtered"."REF_SHIPMENT_NBR" AS "REF_SHIPMENT_NBR",
        "tlm_shipment_joined_w_cal_filtered"."STAGING_LOCN_ID" AS "STAGING_LOCN_ID",
        "tlm_shipment_joined_w_cal_filtered"."LOADING_SEQ_ORD" AS "LOADING_SEQ_ORD",
        "tlm_shipment_joined_w_cal_filtered"."HAZMAT_CERT_CONTACT" AS "HAZMAT_CERT_CONTACT",
        "tlm_shipment_joined_w_cal_filtered"."HAZMAT_CERT_DECLARATION" AS "HAZMAT_CERT_DECLARATION",
        "tlm_shipment_joined_w_cal_filtered"."CDC_TIMESTAMP" AS "CDC_TIMESTAMP",
        "tlm_shipment_joined_w_cal_filtered"."OPERATION_TYPE" AS "OPERATION_TYPE",
        "tlm_shipment_joined_w_cal_filtered"."ARCHIVED_DTTM" AS "ARCHIVED_DTTM",
        "tlm_shipment_joined_w_cal_filtered"."ORIGIN" AS "ORIGIN",
        "tlm_shipment_joined_w_cal_filtered"."FINAL_DESTINATION" AS "FINAL_DESTINATION",
        "tlm_shipment_joined_w_cal_filtered"."actual_delivery_date_parsed" AS "actual_delivery_date_parsed",
        "tlm_shipment_joined_w_cal_filtered"."wood_pellet" AS "wood_pellet",
        "tlm_shipment_joined_w_cal_filtered"."act_del_MERCH_YEAR" AS "act_del_MERCH_YEAR",
        "tlm_shipment_joined_w_cal_filtered"."act_del_YEAR_WEEK" AS "act_del_YEAR_WEEK",
        "tlm_shipment_joined_w_cal_filtered"."act_del_YEAR_QUARTER" AS "act_del_YEAR_QUARTER",
        "tlm_shipment_joined_w_cal_filtered"."act_del_YEAR_PERIOD" AS "act_del_YEAR_PERIOD",
        "domestic_shipping_freight_w_cal_filtered_test_TC_Object_ID"."invoice_shipping_id" AS "invoice_shipping_id"
      FROM "TLM_SHIPMENT_W_CAl_FILTERED" "tlm_shipment_joined_w_cal_filtered"
      LEFT JOIN (
        SELECT 
             "TC_OBJECT_ID" AS "TC_OBJECT_ID",
            1 AS "invoice_shipping_id"
          FROM (
            SELECT *
              FROM "DOMESTIC_SHIPPING_FREIGHT_W_CAL_FILTERED_TEST_TC_OBJECT_ID" "domestic_shipping_freight_w_cal_filtered_test_TC_Object_ID"
            ) "withoutcomputedcols_query"
        ) "domestic_shipping_freight_w_cal_filtered_test_TC_Object_ID"
        ON "tlm_shipment_joined_w_cal_filtered"."TC_SHIPMENT_ID" = "domestic_shipping_freight_w_cal_filtered_test_TC_Object_ID"."TC_OBJECT_ID"
    ) "unfiltered_query"
  WHERE "invoice_shipping_id" != 1 OR "invoice_shipping_id" IS NULL AND 1 IS NOT NULL OR "invoice_shipping_id" IS NOT NULL AND 1 IS NULL
  )A
  WHERE "rownumber" =1;

<br>
--TLM_SHIPMENT_TRANSLOAD_BY_YEAR_PERIOD
</br>
CREATE OR REPLACE TEMPORARY TABLE "TLM_SHIPMENT_TRANSLOAD_BY_YEAR_PERIOD"
AS
    SELECT 
        "act_del_YEAR_PERIOD" AS "act_del_YEAR_PERIOD",
         SUM("TOTAL_COST") AS "TOTAL_COST"
    FROM 
    (
     SELECT     
    "ORIGIN" AS "ORIGIN",
    "act_del_YEAR_PERIOD" AS "act_del_YEAR_PERIOD",
    "TOTAL_COST" AS "TOTAL_COST",
    "org_Facility_Code" AS "org_Facility_Code",  
    "dest_Facility_Code" AS "dest_Facility_Code",
     CASE WHEN UPPER("org_Facility_Type") = 'VENDOR' THEN 'Inbound' ELSE 'Outbound' END AS "inbound_flag"
      FROM (
      SELECT 
        "tlm_shipment_joined_filter_shipping_windows"."ORIGIN" AS "ORIGIN",
        "tlm_shipment_joined_filter_shipping_windows"."act_del_YEAR_PERIOD" AS "act_del_YEAR_PERIOD",
        "tlm_shipment_joined_filter_shipping_windows"."TOTAL_COST" AS "TOTAL_COST",
        "TSC_facilities_final"."FACILITY_CODE" AS "org_Facility_Code",
        "TSC_facilities_final"."FACILITY_TYPE" AS "org_Facility_Type",
        "TSC_facilities_final_2"."FACILITY_CODE" AS "dest_Facility_Code"
       FROM "TLM_SHIPMENT_JOINED_FILTER_SHIPPING_WINDOWS" "tlm_shipment_joined_filter_shipping_windows"
       LEFT JOIN "TSC_FACILITIES_FINAL" "TSC_facilities_final"
       ON CAST("tlm_shipment_joined_filter_shipping_windows"."ORIGIN" AS NUMBER) = CAST("TSC_facilities_final"."FACILITY_CODE" AS NUMBER)
       LEFT JOIN "TSC_FACILITIES_FINAL" "TSC_facilities_final_2"
        ON  CAST("tlm_shipment_joined_filter_shipping_windows"."FINAL_DESTINATION" AS NUMBER) =  CAST("TSC_facilities_final_2"."FACILITY_CODE" AS 
        NUMBER)
    ) "withoutcomputedcols_query"
         WHERE ("inbound_flag" = 'Outbound') AND "org_Facility_Code" IS NOT NULL AND "dest_Facility_Code" IS NOT NULL
         AND (("ORIGIN" = 202864) OR ("ORIGIN" = 202880) OR ("ORIGIN" = 218749) OR ("ORIGIN" = 200065))
    )FINAL 
   GROUP BY  "act_del_YEAR_PERIOD";

<br>
   --DOMESTIC_SHIPPING_TRANSLOAD_BY_YEAR_PERIOD
</br>
   CREATE OR REPLACE TEMPORARY TABLE "DOMESTIC_SHIPPING_TRANSLOAD_BY_YEAR_PERIOD"
   AS
   WITH CTE AS 
   (
   SELECT 
        "domestic_shipping_freight_w_facilities"."ORIGIN" AS "ORIGIN",       
        "domestic_shipping_freight_w_facilities"."act_del_YEAR_PERIOD" AS "act_del_YEAR_PERIOD",
        "domestic_shipping_freight_w_facilities"."TOTAL_COST" AS "TOTAL_COST",
        "domestic_shipping_freight_w_facilities"."org_Facility_Code" AS "org_Facility_Code",
        "domestic_shipping_freight_w_facilities"."dest_Facility_Code" AS "dest_Facility_Code",
        "domestic_shipping_freight_w_facilities"."inbound_flag" AS "inbound_flag"
      FROM "DOMESTIC_SHIPPING_FREIGHT_W_FACILITIES" "domestic_shipping_freight_w_facilities"
      LEFT JOIN (
        SELECT 
            "VENDOR_ID" AS "VENDOR_ID",
            1 AS "wood_pellet"
          FROM (
            SELECT *
              FROM wood_pellet_vendors_w_number_by_vendor_id "TENANT149_DATA_wood_pellet_vendors_w_number_by_VENDOR_ID_prepared"
            ) "withoutcomputedcols_query"
        ) "TENANT149_DATA_wood_pellet_vendors_w_number_by_VENDOR_ID_prepared"
        ON "domestic_shipping_freight_w_facilities"."org_Facility_Code" = "TENANT149_DATA_wood_pellet_vendors_w_number_by_VENDOR_ID_prepared"."VENDOR_ID"
      LEFT JOIN (
        SELECT 
            "VENDOR_NAME" AS "VENDOR_NAME",
            1 AS "wood_pellet_2"
          FROM (
            SELECT *
              FROM "WOOD_PELLET_VENDORS_PREPARED_W_NAME" "wood_pellet_vendors_prepared_w_name"
            ) "withoutcomputedcols_query"
        ) "wood_pellet_vendors_prepared_w_name"
        ON "domestic_shipping_freight_w_facilities"."org_Facility_Name" = "wood_pellet_vendors_prepared_w_name"."VENDOR_NAME"
      LEFT JOIN (
        SELECT 
            "VENDOR_ID" AS "vendor_id",
            1 AS "wood_pellet_3"
          FROM (
            SELECT *
              FROM "WOOD_PELLET_VENDORS_W_IDS_PREPARED_BY_VENDOR_ID" "wood_pellet_vendors_w_ids_prepared_by_vendor_id"
            ) "withoutcomputedcols_query"
        ) "wood_pellet_vendors_w_ids_prepared_by_vendor_id"
        ON "domestic_shipping_freight_w_facilities"."ORIGIN" = "wood_pellet_vendors_w_ids_prepared_by_vendor_id"."vendor_id"
          WHERE  COALESCE("wood_pellet_vendors_w_ids_prepared_by_vendor_id"."wood_pellet_3","wood_pellet_vendors_prepared_w_name"."wood_pellet_2" , 
      "TENANT149_DATA_wood_pellet_vendors_w_number_by_VENDOR_ID_prepared"."wood_pellet", 0) = 0
       AND ( ("inbound_flag" = 'Outbound') AND "org_Facility_Code" IS NOT NULL AND "dest_Facility_Code" IS NOT NULL)
       AND ( ("ORIGIN" = 202864) OR ("ORIGIN" = 202880) OR ("ORIGIN" = 218749) OR ("ORIGIN" = 200065))
       )
       SELECT      
       "act_del_YEAR_PERIOD" AS "act_del_YEAR_PERIOD",
        SUM("TOTAL_COST") AS "TOTAL_COST"
       FROM CTE
       GROUP BY "act_del_YEAR_PERIOD"

<br>	   
	 --DO_TRANSLOAD_STACKED
</br>
   
CREATE OR REPLACE TEMPORARY TABLE "DO_TRANSLOAD_STACKED"
AS
SELECT 
    "act_del_YEAR_PERIOD" AS "YEAR_PERIOD",
    "TOTAL_COST" AS "TOTAL_COST"
  FROM "DOMESTIC_SHIPPING_TRANSLOAD_BY_YEAR_PERIOD"
UNION ALL
SELECT 
    "act_del_YEAR_PERIOD" AS "YEAR_PERIOD",
    "TOTAL_COST" AS "TOTAL_COST"
  FROM "TLM_SHIPMENT_TRANSLOAD_BY_YEAR_PERIOD";
 
<br>
 --DO_TRANSLOAD_STACKED_BY_YEAR_PERIOD
</br>
CREATE OR REPLACE TEMPORARY TABLE "DO_TRANSLOAD_STACKED_BY_YEAR_PERIOD"
AS
SELECT 
    "YEAR_PERIOD" AS "Year_Period",
    "TOTAL_COST_sum" AS "transload"
  FROM (
    SELECT 
        "YEAR_PERIOD" AS "YEAR_PERIOD",
        SUM("TOTAL_COST") AS "TOTAL_COST_sum"
      FROM (
        SELECT 
            "YEAR_PERIOD" AS "YEAR_PERIOD",
            "TOTAL_COST" AS "TOTAL_COST"
          FROM "DO_TRANSLOAD_STACKED"
        ) "dku__beforegrouping"
          GROUP BY "YEAR_PERIOD"
    ) "pristine_query";
<br>
--IMPORT_CHARGE_BY_YEAR_PERIOD
-- CREATE OR REPLACE TEMP TABLE LC_IMPORT_CHARGE_BY_YEAR_PERIOD(
-- "Year_Period" VARCHAR,
-- "Dray" VARCHAR,
-- "Expeditors"  VARCHAR,
-- "Storage" VARCHAR,
-- "Accessorial" VARCHAR,
-- tie_out VARCHAR,
-- total_charge VARCHAR
-- )
--6.OCEAN_FREIGHT_ALLOCATION_ARTICLE
--createing stages 
--IMPORT_CHARGE_BY_YEAR_PERIOD
</br>

CREATE OR REPLACE TEMPORARY TABLE "LC_IMPORT_CHARGE_BY_YEAR_PERIOD"
AS
WITH CTE AS 

(SELECT 
    "Year_Period" AS "Year_Period",
    "Dray" AS "Dray",
    "Expeditors" AS "Expeditors",
    "Storage" AS "Storage",
    "Accessorial" AS "Accessorial",
    "TIE_OUT" AS "tie_out",
    "TOTAL_CHARGE" AS "total_charge",
    NULL AS "transload"
  FROM "IMPORT_CHARGE_BY_YEAR_PERIOD"
UNION ALL
SELECT 
    "Year_Period" AS "Year_Period",
    NULL AS "Dray",
    NULL AS "Expeditors",
    NULL AS "Storage",
    NULL AS "Accessorial",
    NULL AS "tie_out",
    NULL AS "total_charge",
    "transload" AS "transload"
  FROM "DO_TRANSLOAD_STACKED_BY_YEAR_PERIOD"
  )
  SELECT 
      "import_charge_Year_Period"."Year_Period" AS "Year_Period",
    "import_charge_Year_Period"."Dray" AS "Dray",
    "import_charge_Year_Period"."Expeditors" AS "Expeditors",
    "import_charge_Year_Period"."Storage" AS "Storage",
    "import_charge_Year_Period"."Accessorial" AS "Accessorial",
    "import_charge_Year_Period"."tie_out" AS "tie_out",
    "import_charge_Year_Period"."transload" AS "transload",
    "import_charge_Year_Period"."total_charge" AS "total_charge",
    "Ocean_freight_containers_by_Year_Period"."Container #_" AS "_containers"
  FROM 
  (
  SELECT 
    "Year_Period" AS "Year_Period",
    "Dray_sum" AS "Dray",
    "Expeditors_sum" AS "Expeditors",
    "Storage_sum" AS "Storage",
    "Accessorial_sum" AS "Accessorial",
    "tie_out_sum" AS "tie_out",
    "transload_sum" AS "transload",
    "total_w_transload_sum" AS "total_charge"
  FROM (
    SELECT 
        "Year_Period" AS "Year_Period",
        SUM("Dray") AS "Dray_sum",
        SUM("Expeditors") AS "Expeditors_sum",
        SUM("Storage") AS "Storage_sum",
        SUM("Accessorial") AS "Accessorial_sum",
        SUM("tie_out") AS "tie_out_sum",
        SUM("transload") AS "transload_sum",
        SUM("total_w_transload") AS "total_w_transload_sum"
      FROM (
        SELECT 
            "Year_Period" AS "Year_Period",
            "Dray" AS "Dray",
            "Expeditors" AS "Expeditors",
            "Storage" AS "Storage",
            "Accessorial" AS "Accessorial",
            "tie_out" AS "tie_out",
            "total_charge" AS "total_charge",
            "transload" AS "transload",
            COALESCE("total_charge", 0) + COALESCE("transload", 0) AS "total_w_transload"
          FROM CTE
        ) "dku__beforegrouping"
      GROUP BY "Year_Period"
    ) "pristine_query"
)"import_charge_Year_Period"
 LEFT JOIN (
    SELECT 
    "Year_Period" AS "Year Period",
    COUNT( DISTINCT "Container_num") AS "Container #_"
    FROM lm_ocean_spot_contract_rates_prepared_filtered_stacked
    GROUP BY "Year Period")"Ocean_freight_containers_by_Year_Period"
    ON "import_charge_Year_Period"."Year_Period" = "Ocean_freight_containers_by_Year_Period"."Year Period";

<br>
 --OCEAN_FREIGHT_CONTRACT_SPOT_STACKED_PREPARED_W_DRAYAGE_PREPARED
</br>
CREATE OR REPLACE TEMPORARY TABLE "OCEAN_FREIGHT_CONTRACT_SPOT_STACKED_PREPARED_W_DRAYAGE_PREPARED"
AS
WITH CTE AS 
(
SELECT *
  FROM (
    SELECT 
        "Year_Period" AS "Year Period",
        "Year_Week" AS "Year Week",
        "B/L_Number" AS "B/L Number",
        "Steamship_Line" AS "Steamship Line",
        "Invoice_Date" AS "Invoice Date",
        "Cargo_Receipt Date" AS "Cargo Receipt Date",
        "Equipment" AS "Equipment",
        "BOL" AS "BOL",
        "Container_num" AS "Container #",
        "Ocean_Base_Rate" AS "Ocean Base Rate",
        "Bunker" AS "Bunker",
        "Misc_Fees" AS "Misc. Fees",
        "Additional_Fees" AS "Additional Fees",
        "Additional_Fees_1" AS "Additional Fees_1",
        "Total" AS "Total",
        "Facility" AS "Facility",
        "Origin" AS "Origin",
        "Destination" AS "Destination",
        "Dest_State" AS "Dest State",
        "Coast" AS "Coast",
        "Facility_2" AS "Facility 2",
        "Spot" AS "Spot",
        ROW_NUMBER() OVER (PARTITION BY "Container_num" ORDER BY "Total" ASC NULLS FIRST) AS "rownumber"
      FROM lm_ocean_spot_contract_rates_prepared_filtered_stacked
    ) "unfiltered_query"
  WHERE "rownumber" = 1
  )
  SELECT *,coalesce("Total",0)+coalesce("drayage_per_container",0)  AS "total_charge_w_drayage"
  FROM (
  SELECT 
    "Ocean_freight_Contract_spot_stacked_prepared_windows"."Year Period" AS "Year Period",
    "Ocean_freight_Contract_spot_stacked_prepared_windows"."Year Week" AS "Year Week",
    "Ocean_freight_Contract_spot_stacked_prepared_windows"."B/L Number" AS "B/L Number",
    "Ocean_freight_Contract_spot_stacked_prepared_windows"."Steamship Line" AS "Steamship Line",
    "Ocean_freight_Contract_spot_stacked_prepared_windows"."Invoice Date" AS "Invoice Date",
    "Ocean_freight_Contract_spot_stacked_prepared_windows"."Cargo Receipt Date" AS "Cargo Receipt Date",
    "Ocean_freight_Contract_spot_stacked_prepared_windows"."Equipment" AS "Equipment",
    "Ocean_freight_Contract_spot_stacked_prepared_windows"."BOL" AS "BOL",
    "Ocean_freight_Contract_spot_stacked_prepared_windows"."Container #" AS "Container #",
    "Ocean_freight_Contract_spot_stacked_prepared_windows"."Ocean Base Rate" AS "Ocean Base Rate",
    "Ocean_freight_Contract_spot_stacked_prepared_windows"."Bunker" AS "Bunker",
    "Ocean_freight_Contract_spot_stacked_prepared_windows"."Misc. Fees" AS "Misc. Fees",
    "Ocean_freight_Contract_spot_stacked_prepared_windows"."Additional Fees" AS "Additional Fees",
    "Ocean_freight_Contract_spot_stacked_prepared_windows"."Additional Fees_1" AS "Additional Fees_1",
    "Ocean_freight_Contract_spot_stacked_prepared_windows"."Total" AS "Total",
    "Ocean_freight_Contract_spot_stacked_prepared_windows"."Facility" AS "Facility",
    "Ocean_freight_Contract_spot_stacked_prepared_windows"."Origin" AS "Origin",
    "Ocean_freight_Contract_spot_stacked_prepared_windows"."Destination" AS "Destination",
    "Ocean_freight_Contract_spot_stacked_prepared_windows"."Dest State" AS "Dest State",
    "Ocean_freight_Contract_spot_stacked_prepared_windows"."Coast" AS "Coast",
    "Ocean_freight_Contract_spot_stacked_prepared_windows"."Facility 2" AS "Facility 2",
    "Ocean_freight_Contract_spot_stacked_prepared_windows"."Spot" AS "Spot",
    "Ocean_freight_Contract_spot_stacked_prepared_windows"."rownumber" AS "rownumber",
    CASE 
        WHEN "import_charge_by_Year_Period_prepared"."_containers" = 0 
             OR "import_charge_by_Year_Period_prepared"."_containers" IS NULL 
        THEN 0
        ELSE COALESCE("import_charge_by_Year_Period_prepared"."total_charge", 0) / "import_charge_by_Year_Period_prepared"."_containers"
    END  AS "drayage_per_container"
  FROM CTE "Ocean_freight_Contract_spot_stacked_prepared_windows"
  LEFT JOIN "LC_IMPORT_CHARGE_BY_YEAR_PERIOD" "import_charge_by_Year_Period_prepared"
    ON "Ocean_freight_Contract_spot_stacked_prepared_windows"."Year Period" = "import_charge_by_Year_Period_prepared"."Year_Period"
    )Ocean_freight_Contract_spot_stacked_prepared_w_drayage_prepared;

<br>	
--OCEAN_FREIGHT_W_CONTAINER
</br>
insert into "OCEAN_FREIGHT_W_CONTAINER"
WITH CTE AS 
(
SELECT 
    "Ocean_freight_Contract_spot_stacked_prepared_w_drayage_prepared"."Year Period" AS "Year Period",
    "Ocean_freight_Contract_spot_stacked_prepared_w_drayage_prepared"."Year Week" AS "Year Week",
    "Ocean_freight_Contract_spot_stacked_prepared_w_drayage_prepared"."B/L Number" AS "B/L Number",
    "Ocean_freight_Contract_spot_stacked_prepared_w_drayage_prepared"."Steamship Line" AS "Steamship Line",
    "Ocean_freight_Contract_spot_stacked_prepared_w_drayage_prepared"."Invoice Date" AS "Invoice Date",
    "Ocean_freight_Contract_spot_stacked_prepared_w_drayage_prepared"."Cargo Receipt Date" AS "Cargo Receipt Date",
    "Ocean_freight_Contract_spot_stacked_prepared_w_drayage_prepared"."Equipment" AS "Equipment",
    "Ocean_freight_Contract_spot_stacked_prepared_w_drayage_prepared"."BOL" AS "BOL",
    "Ocean_freight_Contract_spot_stacked_prepared_w_drayage_prepared"."Container #" AS "Container #",
    "Ocean_freight_Contract_spot_stacked_prepared_w_drayage_prepared"."Ocean Base Rate" AS "Ocean Base Rate",
    "Ocean_freight_Contract_spot_stacked_prepared_w_drayage_prepared"."Bunker" AS "Bunker",
    "Ocean_freight_Contract_spot_stacked_prepared_w_drayage_prepared"."Misc. Fees" AS "Misc. Fees",
    "Ocean_freight_Contract_spot_stacked_prepared_w_drayage_prepared"."Additional Fees" AS "Additional Fees",
    "Ocean_freight_Contract_spot_stacked_prepared_w_drayage_prepared"."Additional Fees_1" AS "Additional Fees_1",
    "Ocean_freight_Contract_spot_stacked_prepared_w_drayage_prepared"."Total" AS "Total",
    "Ocean_freight_Contract_spot_stacked_prepared_w_drayage_prepared"."Facility" AS "Facility",
    "Ocean_freight_Contract_spot_stacked_prepared_w_drayage_prepared"."Origin" AS "Origin",
    "Ocean_freight_Contract_spot_stacked_prepared_w_drayage_prepared"."Destination" AS "Destination",
    "Ocean_freight_Contract_spot_stacked_prepared_w_drayage_prepared"."Dest State" AS "Dest State",
    "Ocean_freight_Contract_spot_stacked_prepared_w_drayage_prepared"."Coast" AS "Coast",
    "Ocean_freight_Contract_spot_stacked_prepared_w_drayage_prepared"."Facility 2" AS "Facility 2",
    "Ocean_freight_Contract_spot_stacked_prepared_w_drayage_prepared"."Spot" AS "Spot",
    "Ocean_freight_Contract_spot_stacked_prepared_w_drayage_prepared"."drayage_per_container" AS "drayage_per_container",
    "Ocean_freight_Contract_spot_stacked_prepared_w_drayage_prepared"."total_charge_w_drayage" AS "total_charge_w_drayage",
    "Import_Dest_mapping_prep"."DESTINATION_CLEAN" AS "Destination_Clean",
    "Import_Origin_mapping_prep_stacked_windows_prepared"."ORIGIN_CLEAN" AS "Origin_Clean"
  FROM "OCEAN_FREIGHT_CONTRACT_SPOT_STACKED_PREPARED_W_DRAYAGE_PREPARED" "Ocean_freight_Contract_spot_stacked_prepared_w_drayage_prepared"
  LEFT JOIN import_dest_mapping_prep "Import_Dest_mapping_prep"
    ON "Ocean_freight_Contract_spot_stacked_prepared_w_drayage_prepared"."Facility" = "Import_Dest_mapping_prep"."FACILITY"
  LEFT JOIN IMPORT_ORIGIN_MAPPING_PREP_STACKED_WINDOWS_PREPARED "Import_Origin_mapping_prep_stacked_windows_prepared"
    ON "Ocean_freight_Contract_spot_stacked_prepared_w_drayage_prepared"."Origin" = "Import_Origin_mapping_prep_stacked_windows_prepared"."ORIGIN"
    )
  SELECT 
    "Ocean_freight_Contract_w_dest"."Year Period" AS "Year Period",
    "Ocean_freight_Contract_w_dest"."Year Week" AS "Year Week",
    "Ocean_freight_Contract_w_dest"."B/L Number" AS "B/L Number",
    "Ocean_freight_Contract_w_dest"."Steamship Line" AS "Steamship Line",
    "Ocean_freight_Contract_w_dest"."Invoice Date" AS "Invoice Date",
    "Ocean_freight_Contract_w_dest"."Cargo Receipt Date" AS "Cargo Receipt Date",
    "Ocean_freight_Contract_w_dest"."Equipment" AS "Equipment",
    "Ocean_freight_Contract_w_dest"."BOL" AS "BOL",
    "Ocean_freight_Contract_w_dest"."Container #" AS "Container #",
    "Ocean_freight_Contract_w_dest"."Ocean Base Rate" AS "Ocean Base Rate",
    "Ocean_freight_Contract_w_dest"."Bunker" AS "Bunker",
    "Ocean_freight_Contract_w_dest"."Misc. Fees" AS "Misc. Fees",
    "Ocean_freight_Contract_w_dest"."Additional Fees" AS "Additional Fees",
    "Ocean_freight_Contract_w_dest"."Additional Fees_1" AS "Additional Fees_1",
    "Ocean_freight_Contract_w_dest"."Total" AS "Total",
    "Ocean_freight_Contract_w_dest"."Facility" AS "Facility",
    "Ocean_freight_Contract_w_dest"."Origin" AS "Origin",
    "Ocean_freight_Contract_w_dest"."Destination" AS "Destination",
    "Ocean_freight_Contract_w_dest"."Dest State" AS "Dest State",
    "Ocean_freight_Contract_w_dest"."Coast" AS "Coast",
    "Ocean_freight_Contract_w_dest"."Facility 2" AS "Facility 2",
    "Ocean_freight_Contract_w_dest"."Spot" AS "Spot",
    "Ocean_freight_Contract_w_dest"."drayage_per_container" AS "drayage_per_container",
    "Ocean_freight_Contract_w_dest"."total_charge_w_drayage" AS "total_charge_w_drayage",
    "Ocean_freight_Contract_w_dest"."Destination_Clean" AS "Destination_Clean",
    "Ocean_freight_Contract_w_dest"."Origin_Clean" AS "Origin_Clean",
    "facilities_final_prepared"."FACILITY_NAME" AS "dest_Facility_Name",
    "facilities_final_prepared"."FACILITY_TYPE" AS "dest_Facility_Type",
    "Import_Manifest_Details_prep"."MASTERBILL" AS "po_Masterbill",
    "Import_Manifest_Details_prep"."MOVEMENT_ID" AS "po_Movement_ID",
    "Import_Manifest_Details_prep"."ORIGIN" AS "po_Origin",
    "Import_Manifest_Details_prep"."CONTAINER_NUMBER" AS "po_Container_Number",
    "Import_Manifest_Details_prep"."CONTAINER_SIZE" AS "po_Container_Size",
    "Import_Manifest_Details_prep"."CARRIER" AS "po_Carrier",
    "Import_Manifest_Details_prep"."PO" AS "po_PO",
    "Import_Manifest_Details_prep"."ITEM_NO" AS "po_Item_No",
    "Import_Manifest_Details_prep"."WEIGHT" AS "po_Weight",
    "Import_Manifest_Details_prep"."VOLUME" AS "po_Volume",
    "Import_Manifest_Details_prep"."MOVE_TYPE" AS "po_Move_Type",
    "Import_Manifest_Details_prep"."CARTON_COUNT" AS "po_Carton_Count",
    "Import_Manifest_Details_prep"."ITEM_QTY" AS "po_Item_Qty",
    "Import_Manifest_Details_prep"."VENDOR" AS "po_Vendor",
    "Import_Manifest_Details_prep"."DEST" AS "po_Dest",
    "Import_Manifest_Details_prep"."COB" AS "po_COB",
    "purchase_order_line_by_PO_NO_prep"."VENDOR_ID" AS "po_VENDOR_ID",
    TRY_TO_NUMBER("TSC_facilities_final"."FACILITY_CODE") AS "org_Facility_Code",
    "TSC_facilities_final"."FACILITY_NAME" AS "org_Facility_Name",
    "TSC_facilities_final"."FACILITY_TYPE" AS "org_Facility_Type",
    "article"."ARTICLE_LENGTH" AS "a_ARTICLE_LENGTH",
    "article"."ARTICLE_WIDTH" AS "a_ARTICLE_WIDTH",
    "article"."ARTICLE_HEIGHT" AS "a_ARTICLE_HEIGHT",
    "article"."ARTICLE_WEIGHT" AS "a_ARTICLE_WEIGHT",
    "article"."ARTICLE_SIZE" AS "a_ARTICLE_SIZE", 	
	  "container_size_prepared".max_weight AS "max_weight",
    "container_size_prepared".max_volumne AS "max_volumne"
  FROM CTE "Ocean_freight_Contract_w_dest"
  LEFT JOIN tsc_facilities_final "facilities_final_prepared"
    ON TRY_TO_NUMBER("Ocean_freight_Contract_w_dest"."Destination_Clean") = TRY_TO_NUMBER("facilities_final_prepared"."FACILITY_CODE")
  LEFT JOIN lm_import_manifest_prepared_stacked_distinct  "Import_Manifest_Details_prep"
    ON "Ocean_freight_Contract_w_dest"."Container #" = "Import_Manifest_Details_prep"."CONTAINER_NUMBER"
  LEFT JOIN (SELECT 
                "PO_NO" AS "PO_NO",
                "ARTICLE_NO" AS "ARTICLE_NO",
                "VENDOR_ID" AS "VENDOR_ID" 
             FROM PURCHASE_ORDER_LINE_W_CAL 
             GROUP BY "PO_NO", "ARTICLE_NO", "VENDOR_ID"
            ) "purchase_order_line_by_PO_NO_prep"
  ON ("Import_Manifest_Details_prep"."PO" = "purchase_order_line_by_PO_NO_prep"."PO_NO")
    AND ("Import_Manifest_Details_prep"."ITEM_NO" = "purchase_order_line_by_PO_NO_prep"."ARTICLE_NO")
  LEFT JOIN "TSC_FACILITIES_FINAL" "TSC_facilities_final"
    ON TRY_TO_NUMBER("purchase_order_line_by_PO_NO_prep"."VENDOR_ID") = TRY_TO_NUMBER("TSC_facilities_final"."FACILITY_CODE")
  LEFT JOIN ARTICLE_W_SHP_DIM_PREP "article" 
     ON   TRY_TO_NUMBER("Import_Manifest_Details_prep"."ITEM_NO") = TRY_TO_NUMBER("article"."ARTICLE_NO")
  LEFT JOIN "CONTAINER_SIZE_PREPARED" "container_size_prepared"
    ON "Ocean_freight_Contract_w_dest"."Equipment" = "container_size_prepared"."CONTAINER_TYPE";

<br>
--OCEAN_FREIGHT_ALLOCATION_ARTICLE	
</br>	
CREATE OR REPLACE TEMPORARY TABLE "OCEAN_FREIGHT_ALLOCATION_ARTICLE"
AS
  WITH CTE AS 
  (
  SELECT  *,SUM("item_volume") OVER (PARTITION BY "Container #") AS "item_volume_sum",
      SUM("item_weight") OVER (PARTITION BY "Container #") AS "item_weight_sum"
  FROM 
  (
  SELECT 
      "Year Period",
      "Year Week",
      "B/L Number",
      "Steamship Line",
      "Invoice Date",
      "Cargo Receipt Date",
      "Equipment",
      "BOL",
      "Container #",
      "Ocean Base Rate",
      "Bunker",
      "Misc. Fees",
      "Additional Fees",
      "Additional Fees_1",
      "Total",
      "Facility",
      "Origin",
      "Destination",
      "Dest State",
      "Coast",
      "Facility 2",
      "Spot",
      "drayage_per_container",
      "total_charge_w_drayage",
      "Destination_Clean",
      "Origin_Clean",
      "dest_Facility_Name",
      "dest_Facility_Type",
      "po_Masterbill",
      "po_Movement_ID",
      "po_Origin",
      "po_Container_Number",
      "po_Container_Size",
      "po_Carrier",
      "po_PO",
      "po_Item_No",
      "po_Weight",
      "po_Volume",
      "po_Move_Type",
      "po_Carton_Count",
      "po_Item_Qty",
      "po_Vendor",
      "po_Dest",
      "po_COB",
      "po_VENDOR_ID",
      "org_Facility_Code",
      "org_Facility_Name",
      "org_Facility_Type",
      "a_ARTICLE_LENGTH",
      "a_ARTICLE_WIDTH",
      "a_ARTICLE_HEIGHT",
      "a_ARTICLE_WEIGHT",
      "a_ARTICLE_SIZE",
      "max_weight",
      "max_volumne",
      ROUND(CAST(COALESCE("a_ARTICLE_LENGTH", 0) * COALESCE("a_ARTICLE_WIDTH", 0) * COALESCE("a_ARTICLE_HEIGHT", 0) * COALESCE("po_Item_Qty", 0) AS DOUBLE) / 1728, 0) AS "item_volume",
      ROUND(COALESCE("a_ARTICLE_WEIGHT", 0) * COALESCE("po_Item_Qty", 0), 0) AS "item_weight"
    FROM "OCEAN_FREIGHT_W_CONTAINER" "__input_table"
    )A
    )
    SELECT 
      "Year Period",
      "Year Week",
      "B/L Number",
      "Steamship Line",
      "Invoice Date",
      "Cargo Receipt Date",
      "Equipment",
      "BOL",
      "Container #",
      "Ocean Base Rate",
      "Bunker",
      "Misc. Fees",
      "Additional Fees",
      "Additional Fees_1",
      "Total",
      "Facility",
      "Origin",
      "Destination",
      "Dest State",
      "Coast",
      "Facility 2",
      "Spot",
      "drayage_per_container",
      "total_charge_w_drayage",
      "Destination_Clean",
      "Origin_Clean",
      "dest_Facility_Name",
      "dest_Facility_Type",
      "po_Masterbill",
      "po_Movement_ID",
      "po_Origin",
      "po_Container_Number",
      "po_Container_Size",
      "po_Carrier",
      "po_PO",
      "po_Item_No",
      "po_Weight",
      "po_Volume",
      "po_Move_Type",
      "po_Carton_Count",
      "po_Item_Qty",
      "po_Vendor",
      "po_Dest",
      "po_COB",
      "po_VENDOR_ID",
      "org_Facility_Code",
      "org_Facility_Name",
      "org_Facility_Type",
      "a_ARTICLE_LENGTH",
      "a_ARTICLE_WIDTH",
      "a_ARTICLE_HEIGHT",
      "item_volume",
      "a_ARTICLE_WEIGHT",
      "item_weight",
      "a_ARTICLE_SIZE",
      "max_weight",
      "max_volumne",
      "item_volume_sum",
      "item_weight_sum",
      "allocation_by_vol",
      "allocation_by_wgt",
      "weight_volume_flag",
      CASE WHEN "weight_volume_flag" = 'V' THEN "allocation_by_vol" ELSE "allocation_by_wgt" END AS "allocation_final"
    FROM (
      SELECT 
          "Year Period",
          "Year Week",
          "B/L Number",
          "Steamship Line",
          "Invoice Date",
          "Cargo Receipt Date",
          "Equipment",
          "BOL",
          "Container #",
          "Ocean Base Rate",
          "Bunker",
          "Misc. Fees",
          "Additional Fees",
          "Additional Fees_1",
          "Total",
          "Facility",
          "Origin",
          "Destination",
          "Dest State",
          "Coast",
          "Facility 2",
          "Spot",
          "drayage_per_container",
          "total_charge_w_drayage",
          "Destination_Clean",
          "Origin_Clean",
          "dest_Facility_Name",
          "dest_Facility_Type",
          "po_Masterbill",
          "po_Movement_ID",
          "po_Origin",
          "po_Container_Number",
          "po_Container_Size",
          "po_Carrier",
          "po_PO",
          "po_Item_No",
          "po_Weight",
          "po_Volume",
          "po_Move_Type",
          "po_Carton_Count",
          "po_Item_Qty",
          "po_Vendor",
          "po_Dest",
          "po_COB",
          "po_VENDOR_ID",
          "org_Facility_Code",
          "org_Facility_Name",
          "org_Facility_Type",
          "a_ARTICLE_LENGTH",
          "a_ARTICLE_WIDTH",
          "a_ARTICLE_HEIGHT",
          "item_volume",
          "a_ARTICLE_WEIGHT",
          "item_weight",
          "a_ARTICLE_SIZE",
          "max_weight",
          "max_volumne",
          "item_volume_sum",
          "item_weight_sum",
          (CAST("item_volume" AS DOUBLE) / NULLIF("item_volume_sum", 0)) * "total_charge_w_drayage" AS "allocation_by_vol",
          (CAST("item_weight" AS DOUBLE) / NULLIF("item_weight_sum", 0)) * "total_charge_w_drayage" AS "allocation_by_wgt",
          CASE WHEN CAST("item_volume_sum" AS DOUBLE) / NULLIF("max_volumne", 0) >= CAST("item_weight_sum" AS DOUBLE) / NULLIF("max_weight", 0) THEN 
          'V' ELSE 'W' END AS "weight_volume_flag"
        FROM CTE
      ) A;
	
	
<br>
  --DOMESTIC_SHIPPING_FREIGHT_ALL_ACT_BY_YEAR
</br>
  CREATE OR REPLACE TEMPORARY TABLE "DOMESTIC_SHIPPING_FREIGHT_ALL_ACT_BY_YEAR"
  AS

      SELECT      "act_del_YEAR_PERIOD" AS year_period,
                    "do_ITEM_NAME"        AS article_no,
                    "org_Facility_Code"   AS org_facility_code,
                    "org_Facility_Name"  AS org_facility_name,
                    "org_Facility_Type"   AS org_facility_type,
                    "dest_Facility_Code"  AS dest_facility_code,
                    "dest_Facility_Name"  AS dest_facility_name,
                    "dest_Facility_Type"  AS dest_facility_type,
                    Sum("do_ORDER_QTY")   AS order_qty
          FROM DOMESTIC_SHIPPING_FREIGHT_DO_ALLOCATION
          GROUP BY "act_del_YEAR_PERIOD",
                    "do_ITEM_NAME",
                    "org_Facility_Code",
                    "org_Facility_Name",
                    "org_Facility_Type",
                    "dest_Facility_Code",
                    "dest_Facility_Name",
                    "dest_Facility_Type";

<br>			  
	--INVOICE_DO_FLOW_PATH_BY_ARTICLE_NO_JOINED_JOINED_1
</br>	
CREATE OR REPLACE TEMPORARY TABLE "INVOICE_DO_FLOW_PATH_BY_ARTICLE_NO_JOINED_JOINED_1"
AS
SELECT          anj.article_no,
                anj.year_period,
                yp.match
      FROM     (SELECT      ds."do_ITEM_NAME" AS article_no,
                  tf."YEAR_PERIOD"
        FROM       DOMESTIC_SHIPPING_FREIGHT_DO_ALLOCATION ds
        CROSS JOIN TIME_DIMENSION_BY_YEAR_PERIOD_FILTERED tf
        WHERE      ds."do_ITEM_NAME" IS NOT NULL
        GROUP BY   ds."do_ITEM_NAME",  tf."YEAR_PERIOD") anj
        LEFT JOIN
                (
      SELECT    "act_del_YEAR_PERIOD" AS year_period,
              "do_ITEM_NAME"        AS article_no,
                1 AS match
      FROM     DOMESTIC_SHIPPING_FREIGHT_DO_ALLOCATION
      GROUP BY "act_del_YEAR_PERIOD",
              "do_ITEM_NAME"  )AS yp
      ON        yp.article_no=anj.article_no
      AND       anj.year_period=yp.year_period
      WHERE     match IS NULL;

<br>	
	--INVOICE_DO_JOINED
</br>
CREATE OR REPLACE TEMPORARY TABLE "INVOICE_DO_JOINED"
AS
SELECT   idfps.year_period,
        idfps.article_no,
        idfps.org_facility_code,
        idfps.org_facility_name,
        idfps.org_facility_type,
        idfps.dest_facility_code,
        idfps.dest_facility_name,
        idfps.dest_facility_type,
        idfps.order_qty,
        tpm."turn_period"
FROM      (
                 SELECT   year_period,
                         article_no,
                         org_facility_code,
                         org_facility_name,
                         org_facility_type,
                         dest_facility_code,
                         dest_facility_name,
                         dest_facility_type,
                         order_qty
                 FROM   DOMESTIC_SHIPPING_FREIGHT_ALL_ACT_BY_YEAR
                 UNION ALL
                 SELECT   year_period,
                        article_no,
                        NULL AS org_facility_code,
                        NULL AS org_facility_name,
                        NULL AS org_facility_type,
                        NULL AS dest_facility_code,
                        NULL AS dest_facility_name,
                        NULL AS dest_facility_type,
                        NULL AS order_qty
                 FROM   ( SELECT   article_no,
                  year_period
         FROM     INVOICE_DO_FLOW_PATH_BY_ARTICLE_NO_JOINED_JOINED_1
         GROUP BY article_no,
                  year_period))idfps
LEFT JOIN TURN_PERIOD_MASTER tpm
ON        idfps.article_no=tpm.article_no;

<br>
--SHIPPING_DO_FLOW_PATH
</br>		 
CREATE OR REPLACE TEMPORARY TABLE "SHIPPING_DO_FLOW_PATH"
AS
    SELECT    "act_del_YEAR_PERIOD" AS year_period,
              TRY_TO_NUMBER("do_ITEM_NAME")  AS article_no,
              "org_Facility_Code"   AS org_facility_code,
              "org_Facility_Name"   AS org_facility_name,
              "org_Facility_Type"   AS org_facility_type,
              "dest_Facility_Code"  AS dest_facility_code,
              "dest_Facility_Name"  AS dest_facility_name,
              "dest_Facility_Type"  AS dest_facility_type,
              Sum("do_ORDER_QTY")   AS order_qty
      FROM  "TLM_SHIPMENT_JOINED_DO_VOl_WGT_ALLOCATION"
      GROUP BY "act_del_YEAR_PERIOD"
              ,TRY_TO_NUMBER("do_ITEM_NAME")     
              ,"org_Facility_Code"  
              ,"org_Facility_Name"  
              ,"org_Facility_Type"  
              ,"dest_Facility_Code" 
              ,"dest_Facility_Name" 
              ,"dest_Facility_Type" ;

<br>			  
--SHIPPING_DO_FLOW_PATH_JOINED		
</br>
  CREATE OR REPLACE TEMPORARY TABLE "SHIPPING_DO_FLOW_PATH_JOINED"  
  AS
  WITH CTE AS  (
          SELECT    article_no,
                    year_period
          FROM     (  SELECT    
                    sdfpanj.article_no,
                    sdfpanj.year_period,
                    sdfpbyp.match
          FROM      (SELECT     
                      sdf.article_no ,
                      tdypf.year_period
            FROM    ( SELECT  article_no FROM SHIPPING_DO_FLOW_PATH 
                     GROUP BY  article_no ) sdf
            CROSS JOIN TIME_DIMENSION_BY_YEAR_PERIOD_FILTERED tdypf
            WHERE sdf.article_no IS NOT NULL
                    ) sdfpanj
            LEFT JOIN
                                   (
                            SELECT  year_period,
                                    article_no,
                                    1 AS match
                            FROM   (  SELECT    year_period,
                                                article_no
                                      FROM     SHIPPING_DO_FLOW_PATH
                                      WHERE    article_no IS NOT NULL
                                      GROUP BY year_period,
                                                article_no 
                                    ) 
                                    ) sdfpbyp
          ON        sdfpbyp.article_no=sdfpanj.article_no
          AND       sdfpbyp.year_period=sdfpanj.year_period
          WHERE     sdfpbyp.match IS NULL )
          GROUP BY article_no,
                  year_period )            
                  
      SELECT        idfps.year_period,
                    idfps.article_no,
                    idfps.org_facility_code,
                    idfps.org_facility_name,
                    idfps.org_facility_type,
                    idfps.dest_facility_code,
                    idfps.dest_facility_name,
                    idfps.dest_facility_type,
                    idfps.order_qty,
                    tpm."turn_period"
          FROM      (
                            
                            SELECT  year_period,
                                  article_no,
                                  org_facility_code,
                                  org_facility_name,
                                  org_facility_type,
                                  dest_facility_code,
                                  dest_facility_name,
                                  dest_facility_type,
                                  order_qty
                            FROM   SHIPPING_DO_FLOW_PATH
                            UNION ALL
                            SELECT  year_period,
                                  article_no,
                                  NULL AS org_facility_code,
                                  NULL AS org_facility_name,
                                  NULL AS org_facility_type,
                                  NULL AS dest_facility_code,
                                  NULL AS dest_facility_name,
                                  NULL AS dest_facility_type,
                                  NULL AS order_qty
                            FROM   CTE 
                            ) idfps
          LEFT JOIN turn_period_master tpm
          ON        idfps.article_no=tpm.article_no; 

<br>  
--OCEAN_FREIGHT_ALLOCATION_PO_WEIGHT_PREPARED
</br>   
CREATE OR REPLACE TEMPORARY TABLE "OCEAN_FREIGHT_ALLOCATION_PO_WEIGHT_PREPARED"
AS
WITH OCEAN_FREIGHT_ALLOCATION_PO_WEIGHT_PREPARED  AS
(
  SELECT  "Year Period",
        "dest_Facility_Name",
        "dest_Facility_Type",
        "Destination_Clean",
        "po_PO",
        TRY_CAST("po_PO" AS INT) AS po_int,
        "po_Item_No",
        "po_Item_Qty",
        "po_VENDOR_ID",
        "org_Facility_Code",
        "org_Facility_Name",
        "org_Facility_Type",
        SUM("item_weight") OVER (partition BY "po_PO") AS po_weight_sum
  FROM   "OCEAN_FREIGHT_ALLOCATION_ARTICLE" 
  )
SELECT  "Year Period",
      "dest_Facility_Name",
      "dest_Facility_Type",
      "Destination_Clean",
      "po_PO",
      "po_Item_No",
      "po_Item_Qty",
      "po_VENDOR_ID",
      "org_Facility_Code",
      "org_Facility_Name",
      "org_Facility_Type",
      CASE
              WHEN po_weight_sum < 150
              AND    try_to_number(po_int) >= 1010000000
              AND    try_to_number(po_int) <= 1049999999
              AND    NOT (
                            "po_VENDOR_ID" >= 570000
                    AND    "po_VENDOR_ID" <= 579999)
              AND     "po_Item_Qty" > 0 THEN 1
              ELSE 0
      END AS small_package_flag
FROM   OCEAN_FREIGHT_ALLOCATION_PO_WEIGHT_PREPARED ;
	   
<br>
--OCEAN_FREIGHT_FLOW_PATH
</br>
CREATE OR REPLACE TEMPORARY TABLE "OCEAN_FREIGHT_FLOW_PATH"
AS
WITH  ocean_freight_allocation_po_weight_prepared_windows AS
(
       SELECT  "Year Period",
              "dest_Facility_Name",
              "dest_Facility_Type",
              "Destination_Clean" AS  "dest_facility_code",
              "po_Item_No",
              "po_Item_Qty",
              "po_VENDOR_ID",
              "org_Facility_Code",
              "org_Facility_Name",
              "org_Facility_Type",
              MAX(small_package_flag) OVER (partition BY "po_PO") AS small_package_flag
       FROM   OCEAN_FREIGHT_ALLOCATION_PO_WEIGHT_PREPARED
)      
       
       SELECT      "Year Period",
                  "dest_Facility_Name",
                  "dest_Facility_Type",
                  "dest_facility_code",
                  "po_Item_No",
                  sum("po_Item_Qty") "po_Item_Qty",
                 "po_VENDOR_ID",
                  "org_Facility_Code",
                  "org_Facility_Name",
                  "org_Facility_Type",
                  small_package_flag
         FROM     ocean_freight_allocation_po_weight_prepared_windows
         GROUP BY  "Year Period",
                  "dest_Facility_Name",
                  "dest_Facility_Type",
                  "dest_facility_code",
                 "po_Item_No", 
                 "po_VENDOR_ID",
                  "org_Facility_Code",
                  "org_Facility_Name",
                  "org_Facility_Type",
                  small_package_flag;
				  
	
<br>
--OCEAN_FREIGHT_FLOW_PATH_JOINED
</br>
CREATE OR REPLACE TEMPORARY TABLE "OCEAN_FREIGHT_FLOW_PATH_JOINED"
AS
WITH  ocean_freight_flow_path_by_po_item_no_joined_joined_by_po_item_no AS 
(
          SELECT     offpij."po_Item_No",
                    offpij.year_period
          FROM       ( SELECT     ofpi."po_Item_No",
                      tdyp."YEAR_PERIOD"
           FROM       (
                               SELECT    ofp."po_Item_No"
                               FROM     OCEAN_FREIGHT_FLOW_PATH ofp
                               WHERE    ofp."po_Item_No" IS NOT NULL
                               GROUP BY  ofp."po_Item_No" ) ofpi
                               CROSS JOIN time_dimension_by_year_period_filtered tdyp) offpij
          LEFT JOIN
                    (
                           SELECT "Year Period" AS year_period,
                                  "po_Item_No" AS po_item_no,
                                  1 AS match
                           FROM   (
                                           SELECT     "Year Period",
                                                    "po_Item_No"
                                           FROM     OCEAN_FREIGHT_FLOW_PATH
                                           WHERE    "po_Item_No" IS NOT NULL
                                           GROUP BY "Year Period",
                                                    "po_Item_No" ) freight ) offpyp
          ON        offpij."po_Item_No" =offpyp.po_item_no
          AND       offpij.year_period=offpyp.year_period
          WHERE     offpyp.match IS NULL
          GROUP BY  offpij."po_Item_No",
                    offpij.year_period )
                    

          SELECT                  offps."Year Period",
                                 offps."po_Item_No",
                                 offps."po_VENDOR_ID",
                                 offps."org_Facility_Code",
                                 offps."org_Facility_Name",
                                 offps."org_Facility_Type",
                                 offps."dest_Facility_Name",
                                 offps."dest_Facility_Type",
                                 offps."dest_facility_code",
                                 offps.small_package_flag,
                                  "po_Item_Qty",
                                  tpm."turn_period"
          FROM      (
                           SELECT  "Year Period",
                                   "po_Item_No",
                                  "po_VENDOR_ID",
                                  "org_Facility_Code",
                                  "org_Facility_Name",
                                  "org_Facility_Type",
                                  "dest_Facility_Name",
                                  "dest_Facility_Type",
                                  "dest_facility_code",
                                  small_package_flag,
                                  "po_Item_Qty"

                           FROM "OCEAN_FREIGHT_FLOW_PATH"
                           UNION ALL
                           SELECT  year_period,
                                  "po_Item_No",
                                  NULL AS po_vendor_id,
                                  NULL AS org_facility_code,
                                  NULL AS org_facility_name,
                                  NULL AS org_facility_type,
                                  NULL AS dest_facility_name,
                                  NULL AS dest_facility_type,
                                  NULL AS dest_facility_code ,
                                  NULL AS small_package_flag,
                                  NULL AS po_item_qty
                           FROM   ocean_freight_flow_path_by_po_item_no_joined_joined_by_po_item_no
                           ) offps
          LEFT JOIN TURN_PERIOD_MASTER tpm
          ON        offps."po_Item_No"=tpm.article_no ;

<br>
--DOMESTIC_SHIPPING_FREIGHT_PO_WEIGHT_WINDOWS_PREPARED
</br>
CREATE OR REPLACE TEMPORARY TABLE "DOMESTIC_SHIPPING_FREIGHT_PO_WEIGHT_WINDOWS_PREPARED"
AS
       select                year_period,
                            "po_ARTICLE_NO" ,
                            "po_VENDOR_ID",
                            "org_Facility_Code",
                            "org_Facility_Name",
                            "org_Facility_Type",
                            "dest_Facility_Code",
                            "dest_Facility_Name",
                            "dest_Facility_Type",
							 "po_PO_NO",
                            "po_PO_LINE_ORDER_QTY",
              CASE
                     WHEN po_weight_sum < 150
                     AND    "po_PO_NO" >= 1010000000
                     AND   "po_PO_NO" <= 1049999999
                     AND    NOT (
                                    "po_VENDOR_ID" >= 570000
                            AND     "po_VENDOR_ID" <= 579999)
                     AND    "po_PO_LINE_ORDER_QTY" > 0
                     AND     "po_FREIGHT_TYPE_CODE" = 'FCT' THEN 1
                     ELSE 0
              END AS small_package_flag
       FROM   (
                     SELECT  "act_del_YEAR_PERIOD" AS year_period,
                            "po_ARTICLE_NO" ,
                            "po_VENDOR_ID",
                            "org_Facility_Code",
                            "org_Facility_Name",
                            "org_Facility_Type",
                            "dest_Facility_Code",
                            "dest_Facility_Name",
                            "dest_Facility_Type",
                            "po_PO_NO",
                            "po_PO_LINE_ORDER_QTY",
                            "po_FREIGHT_TYPE_CODE",
                            sum("item_weight") OVER (partition BY "po_PO_NO") AS po_weight_sum
                     FROM   "DOMESTIC_SHIPPING_FREIGHT_PO_ALLOCATION_ARTICLE" );

<br>				 
--INVOICE_PO_FLOW_PATH_STACKED_BY_YEAR_PERIOD
</br>
CREATE OR REPLACE TEMPORARY TABLE "INVOICE_PO_FLOW_PATH_STACKED_BY_YEAR_PERIOD"
AS
 WITH CTE AS 
 (
 SELECT 
 year_period, 
 "po_ARTICLE_NO" ,
 "po_VENDOR_ID", 
 "org_Facility_Code", 
 "org_Facility_Name",
 "org_Facility_Type", 
 "dest_Facility_Code", 
 "dest_Facility_Name",
 "dest_Facility_Type", 
 "po_PO_LINE_ORDER_QTY",
 max(small_package_flag) OVER (partition BY  "po_PO_NO") AS small_package_flag
 FROM "DOMESTIC_SHIPPING_FREIGHT_PO_WEIGHT_WINDOWS_PREPARED"
 )  
 
 SELECT           year_period,
                  article_no ,
                  vendor_id, 
                 "org_Facility_Code", 
                 "org_Facility_Name",
                 "org_Facility_Type", 
                 "dest_Facility_Code", 
                 "dest_Facility_Name",
                 "dest_Facility_Type", 
                  sum("order_qty")order_qty,
                  small_package_flag
         FROM     ( 
         
       SELECT  year_period, 
       "po_ARTICLE_NO" AS article_no ,
        "po_VENDOR_ID" AS vendor_id, 
        "org_Facility_Code" , 
        "org_Facility_Name",
         "org_Facility_Type",
        "dest_Facility_Code", 
        "dest_Facility_Name",
        "dest_Facility_Type", 
        sum("po_PO_LINE_ORDER_QTY") AS "order_qty", 
        small_package_flag 
       FROM CTE
       GROUP BY                  
              year_period, 
            "po_ARTICLE_NO",
              "po_VENDOR_ID" ,
              "org_Facility_Code", 
              "org_Facility_Name",
               "org_Facility_Type",
              "dest_Facility_Code", 
              "dest_Facility_Name",
              "dest_Facility_Type", 
               small_package_flag
 
         UNION ALL
          SELECT  
                  year_period,
                  article_no,
                  vendor_id,
                  "org_Facility_Code",
                  "org_Facility_Name",
                  "org_Facility_Type",
                  "dest_Facility_Code",
                  "dest_Facility_Name",
                  "dest_Facility_Type",
                  "order_qty",
                  "small_package_flag"
                  
         FROM      small_package_by_year_period_share
         )flow_path_stacked_by_year_period
        GROUP BY   year_period,
                  article_no ,
                  vendor_id, 
                 "org_Facility_Code", 
                 "org_Facility_Name",
                 "org_Facility_Type", 
                 "dest_Facility_Code", 
                 "dest_Facility_Name",
                 "dest_Facility_Type", 
                  small_package_flag;

<br>
--INVOICE_PO_FLOW_PATH_JOINED
</br>
CREATE OR REPLACE TEMPORARY TABLE "INVOICE_PO_FLOW_PATH_JOINED"
AS
WITH CTE AS 
(

         SELECT   article_no,
                  year_period
         FROM     (
                            SELECT     ifpaj.article_no,
                                      ifpaj.year_period,
                                      iyp1.match
                            FROM      (SELECT 
                                        A."ARTICLE_NO" AS "ARTICLE_NO",
                                        B."YEAR_PERIOD" AS "YEAR_PERIOD"
                                          FROM (           SELECT   inv.article_no
                                                           FROM     invoice_po_flow_path_stacked_by_year_period inv
                                                           WHERE    article_no IS NOT NULL
                                                           GROUP BY article_no) A
                                                          CROSS JOIN TIME_DIMENSION_BY_YEAR_PERIOD_FILTERED B) ifpaj
                            LEFT JOIN
                                      (
                                               SELECT    article_no,
                                                        year_period,
                                                        1 AS match
                                               FROM     invoice_po_flow_path_stacked_by_year_period
                                               WHERE    article_no IS NOT NULL
                                               GROUP BY year_period,
                                                        article_no) iyp1
                            ON        ifpaj.article_no= iyp1.article_no
                            AND       ifpaj.year_period=iyp1.year_period
                            WHERE     iyp1.match IS NULL )invoice_po_flow_path_by_article_no_joined_joined
         GROUP BY article_no,
                  year_period 
                  )

SELECT     ips.year_period,
          ips.article_no ,
          ips.vendor_id,
              "org_Facility_Code",
              "org_Facility_Name",
              "org_Facility_Type",
              "dest_Facility_Code",
              "dest_Facility_Name",
              "dest_Facility_Type",
              small_package_flag,
          ips.order_qty,
          tpm."turn_period"
FROM      (SELECT    year_period,
              article_no ,
              vendor_id,
              "org_Facility_Code",
              "org_Facility_Name",
              "org_Facility_Type",
              "dest_Facility_Code",
              "dest_Facility_Name",
              "dest_Facility_Type",
              small_package_flag,
              order_qty
       FROM   invoice_po_flow_path_stacked_by_year_period
       UNION ALL
       SELECT  year_period,
              article_no ,
              NULL AS vendor_id,
              NULL AS org_facility_code,
              NULL AS org_facility_name,
              NULL AS org_facility_type,
              NULL AS dest_facility_code,
              NULL AS dest_facility_name,
              NULL AS dest_facility_type,
              NULL AS small_package_flag,
              NULL AS order_qty
       FROM   CTE ) ips
LEFT JOIN turn_period_master tpm
ON        ips.article_no=tpm.article_no;

<br>
--TLM_SHIPMENT_PO_WEIGHT_WINDOWS_PREPARED
</br>   
CREATE OR REPLACE TEMPORARY TABLE "TLM_SHIPMENT_PO_WEIGHT_WINDOWS_PREPARED"
AS
WITH CTE AS 
(SELECT 
    "SHIPMENT_ID" AS "SHIPMENT_ID",
    "TC_COMPANY_ID" AS "TC_COMPANY_ID",
    "RS_AREA_ID" AS "RS_AREA_ID",
    "TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID",
    "PP_SHIPMENT_ID" AS "PP_SHIPMENT_ID",
    "SHIPMENT_STATUS" AS "SHIPMENT_STATUS",
    "UPDATE_SENT" AS "UPDATE_SENT",
    "BUSINESS_PROCESS" AS "BUSINESS_PROCESS",
    "CREATION_TYPE" AS "CREATION_TYPE",
    "CONS_RUN_ID" AS "CONS_RUN_ID",
    "IS_CANCELLED" AS "IS_CANCELLED",
    "RS_TYPE" AS "RS_TYPE",
    "RS_CONFIG_ID" AS "RS_CONFIG_ID",
    "RS_CONFIG_CYCLE_ID" AS "RS_CONFIG_CYCLE_ID",
    "CONFIG_CYCLE_SEQ" AS "CONFIG_CYCLE_SEQ",
    "CYCLE_DEADLINE_DTTM" AS "CYCLE_DEADLINE_DTTM",
    "CYCLE_EXECUTION_DTTM" AS "CYCLE_EXECUTION_DTTM",
    "LAST_RS_NOTIFICATION_DTTM" AS "LAST_RS_NOTIFICATION_DTTM",
    "CFMF_STATUS" AS "CFMF_STATUS",
    "AVAILABLE_DTTM" AS "AVAILABLE_DTTM",
    "CMID" AS "CMID",
    "CM_DISCOUNT" AS "CM_DISCOUNT",
    "O_FACILITY_NUMBER" AS "O_FACILITY_NUMBER",
    "O_FACILITY_ID" AS "O_FACILITY_ID",
    "O_ADDRESS" AS "O_ADDRESS",
    "O_CITY" AS "O_CITY",
    "O_STATE_PROV" AS "O_STATE_PROV",
    "O_POSTAL_CODE" AS "O_POSTAL_CODE",
    "O_COUNTY" AS "O_COUNTY",
    "O_COUNTRY_CODE" AS "O_COUNTRY_CODE",
    "D_FACILITY_NUMBER" AS "D_FACILITY_NUMBER",
    "D_FACILITY_ID" AS "D_FACILITY_ID",
    "D_ADDRESS" AS "D_ADDRESS",
    "D_CITY" AS "D_CITY",
    "D_STATE_PROV" AS "D_STATE_PROV",
    "D_POSTAL_CODE" AS "D_POSTAL_CODE",
    "D_COUNTY" AS "D_COUNTY",
    "D_COUNTRY_CODE" AS "D_COUNTRY_CODE",
    "DISTANCE" AS "DISTANCE",
    "DIRECT_DISTANCE" AS "DIRECT_DISTANCE",
    "OUT_OF_ROUTE_DISTANCE" AS "OUT_OF_ROUTE_DISTANCE",
    "DISTANCE_UOM" AS "DISTANCE_UOM",
    "BUSINESS_PARTNER_ID" AS "BUSINESS_PARTNER_ID",
    "COMMODITY_CLASS" AS "COMMODITY_CLASS",
    "IS_HAZMAT" AS "IS_HAZMAT",
    "IS_PERISHABLE" AS "IS_PERISHABLE",
    "BILLING_METHOD" AS "BILLING_METHOD",
    "DSG_CARRIER_CODE" AS "DSG_CARRIER_CODE",
    "REC_CMID" AS "REC_CMID",
    "REC_CM_SHIPMENT_ID" AS "REC_CM_SHIPMENT_ID",
    "ASSIGNED_CARRIER_CODE" AS "ASSIGNED_CARRIER_CODE",
    "SHIPMENT_REF_ID" AS "SHIPMENT_REF_ID",
    "BILL_TO_CODE" AS "BILL_TO_CODE",
    "BILL_TO_TITLE" AS "BILL_TO_TITLE",
    "BILL_TO_NAME" AS "BILL_TO_NAME",
    "BILL_TO_ADDRESS" AS "BILL_TO_ADDRESS",
    "BILL_TO_CITY" AS "BILL_TO_CITY",
    "BILL_TO_STATE_PROV" AS "BILL_TO_STATE_PROV",
    "BILL_TO_POSTAL_CODE" AS "BILL_TO_POSTAL_CODE",
    "BILL_TO_COUNTRY_CODE" AS "BILL_TO_COUNTRY_CODE",
    "BILL_TO_PHONE_NUMBER" AS "BILL_TO_PHONE_NUMBER",
    "PURCHASE_ORDER" AS "PURCHASE_ORDER",
    "PRO_NUMBER" AS "PRO_NUMBER",
    "TRANS_RESP_CODE" AS "TRANS_RESP_CODE",
    "BASELINE_COST" AS "BASELINE_COST",
    "ESTIMATED_COST" AS "ESTIMATED_COST",
    "LINEHAUL_COST" AS "LINEHAUL_COST",
    "ACCESSORIAL_COST" AS "ACCESSORIAL_COST",
    "STOP_COST" AS "STOP_COST",
    "ESTIMATED_SAVINGS" AS "ESTIMATED_SAVINGS",
    "SPOT_CHARGE" AS "SPOT_CHARGE",
    "CURRENCY_CODE" AS "CURRENCY_CODE",
    "PICKUP_START_DTTM" AS "PICKUP_START_DTTM",
    "PICKUP_END_DTTM" AS "PICKUP_END_DTTM",
    "DELIVERY_START_DTTM" AS "DELIVERY_START_DTTM",
    "DELIVERY_END_DTTM" AS "DELIVERY_END_DTTM",
    "NUM_STOPS" AS "NUM_STOPS",
    "NUM_DOCKS" AS "NUM_DOCKS",
    "ON_TIME_INDICATOR" AS "ON_TIME_INDICATOR",
    "HAS_NOTES" AS "HAS_NOTES",
    "HAS_ALERTS" AS "HAS_ALERTS",
    "HAS_IMPORT_ERROR" AS "HAS_IMPORT_ERROR",
    "HAS_SOFT_CHECK_ERROR" AS "HAS_SOFT_CHECK_ERROR",
    "HAS_TRACKING_MSG" AS "HAS_TRACKING_MSG",
    "TRACKING_MSG_PROBLEM" AS "TRACKING_MSG_PROBLEM",
    "REC_LINEHAUL_COST" AS "REC_LINEHAUL_COST",
    "REC_ACCESSORIAL_COST" AS "REC_ACCESSORIAL_COST",
    "REC_TOTAL_COST" AS "REC_TOTAL_COST",
    "CYCLE_RESP_DEADLINE_TZ" AS "CYCLE_RESP_DEADLINE_TZ",
    "TENDER_RESP_DEADLINE_TZ" AS "TENDER_RESP_DEADLINE_TZ",
    "PICKUP_TZ" AS "PICKUP_TZ",
    "DELIVERY_TZ" AS "DELIVERY_TZ",
    "ASSIGNED_LANE_ID" AS "ASSIGNED_LANE_ID",
    "ASSIGNED_LANE_DETAIL_ID" AS "ASSIGNED_LANE_DETAIL_ID",
    "REC_SPOT_CHARGE" AS "REC_SPOT_CHARGE",
    "REC_LANE_ID" AS "REC_LANE_ID",
    "REC_LANE_DETAIL_ID" AS "REC_LANE_DETAIL_ID",
    "TENDER_DTTM" AS "TENDER_DTTM",
    "O_STOP_LOCATION_NAME" AS "O_STOP_LOCATION_NAME",
    "D_STOP_LOCATION_NAME" AS "D_STOP_LOCATION_NAME",
    "ASSIGNED_CM_SHIPMENT_ID" AS "ASSIGNED_CM_SHIPMENT_ID",
    "REC_CM_DISCOUNT" AS "REC_CM_DISCOUNT",
    "REC_STOP_COST" AS "REC_STOP_COST",
    "LAST_SELECTOR_RUN_DTTM" AS "LAST_SELECTOR_RUN_DTTM",
    "LAST_CM_OPTION_GEN_DTTM" AS "LAST_CM_OPTION_GEN_DTTM",
    "IS_CM_OPTION_GEN_ACTIVE" AS "IS_CM_OPTION_GEN_ACTIVE",
    "RS_CYCLE_REMAINING" AS "RS_CYCLE_REMAINING",
    "IS_TIME_FEAS_ENABLED" AS "IS_TIME_FEAS_ENABLED",
    "EXT_SYS_SHIPMENT_ID" AS "EXT_SYS_SHIPMENT_ID",
    "EXTRACTION_DTTM" AS "EXTRACTION_DTTM",
    "ASSIGNED_BROKER_CARRIER_CODE" AS "ASSIGNED_BROKER_CARRIER_CODE",
    "USE_BROKER_AS_CARRIER" AS "USE_BROKER_AS_CARRIER",
    "BROKER_REF" AS "BROKER_REF",
    "RATING_QUALIFIER" AS "RATING_QUALIFIER",
    "STATUS_CHANGE_DTTM" AS "STATUS_CHANGE_DTTM",
    "BUDG_TOTAL_COST" AS "BUDG_TOTAL_COST",
    "NORMALIZED_MARGIN" AS "NORMALIZED_MARGIN",
    "NORMALIZED_TOTAL_COST" AS "NORMALIZED_TOTAL_COST",
    "BUDG_NORMALIZED_TOTAL_COST" AS "BUDG_NORMALIZED_TOTAL_COST",
    "REC_BUDG_LINEHAUL_COST" AS "REC_BUDG_LINEHAUL_COST",
    "REC_BUDG_STOP_COST" AS "REC_BUDG_STOP_COST",
    "REC_BUDG_CM_DISCOUNT" AS "REC_BUDG_CM_DISCOUNT",
    "REC_BUDG_ACCESSORIAL_COST" AS "REC_BUDG_ACCESSORIAL_COST",
    "REC_BUDG_TOTAL_COST" AS "REC_BUDG_TOTAL_COST",
    "REC_MARGIN" AS "REC_MARGIN",
    "REC_NORMALIZED_MARGIN" AS "REC_NORMALIZED_MARGIN",
    "REC_NORMALIZED_TOTAL_COST" AS "REC_NORMALIZED_TOTAL_COST",
    "REC_BUDG_NORMALIZED_TOTAL_COST" AS "REC_BUDG_NORMALIZED_TOTAL_COST",
    "BUDG_CURRENCY_CODE" AS "BUDG_CURRENCY_CODE",
    "SPOT_CHARGE_CURRENCY_CODE" AS "SPOT_CHARGE_CURRENCY_CODE",
    "REC_CURRENCY_CODE" AS "REC_CURRENCY_CODE",
    "REC_BUDG_CURRENCY_CODE" AS "REC_BUDG_CURRENCY_CODE",
    "REC_SPOT_CHARGE_CURRENCY_CODE" AS "REC_SPOT_CHARGE_CURRENCY_CODE",
    "RATING_LANE_ID" AS "RATING_LANE_ID",
    "FRT_REV_RATING_LANE_ID" AS "FRT_REV_RATING_LANE_ID",
    "REC_RATING_LANE_ID" AS "REC_RATING_LANE_ID",
    "REC_BUDG_RATING_LANE_ID" AS "REC_BUDG_RATING_LANE_ID",
    "RATING_LANE_DETAIL_ID" AS "RATING_LANE_DETAIL_ID",
    "FRT_REV_RATING_LANE_DETAIL_ID" AS "FRT_REV_RATING_LANE_DETAIL_ID",
    "REC_RATING_LANE_DETAIL_ID" AS "REC_RATING_LANE_DETAIL_ID",
    "REC_BUDG_RATING_LANE_DETAIL_ID" AS "REC_BUDG_RATING_LANE_DETAIL_ID",
    "BUDG_CM_DISCOUNT" AS "BUDG_CM_DISCOUNT",
    "NORMALIZED_BASELINE_COST" AS "NORMALIZED_BASELINE_COST",
    "BASELINE_COST_CURRENCY_CODE" AS "BASELINE_COST_CURRENCY_CODE",
    "REPORTED_COST" AS "REPORTED_COST",
    "TRACTOR_NUMBER" AS "TRACTOR_NUMBER",
    "IS_AUTO_DELIVERED" AS "IS_AUTO_DELIVERED",
    "SHIPMENT_TYPE" AS "SHIPMENT_TYPE",
    "ORIG_BUDG_TOTAL_COST" AS "ORIG_BUDG_TOTAL_COST",
    "ACCESSORIAL_COST_TO_CARRIER" AS "ACCESSORIAL_COST_TO_CARRIER",
    "CARRIER_CHARGE" AS "CARRIER_CHARGE",
    "ACTUAL_COST" AS "ACTUAL_COST",
    "EARNED_INCOME" AS "EARNED_INCOME",
    "SENT_TO_PKMS" AS "SENT_TO_PKMS",
    "IS_SHIPMENT_RECONCILED" AS "IS_SHIPMENT_RECONCILED",
    "DELIVERY_REQ" AS "DELIVERY_REQ",
    "DROPOFF_PICKUP" AS "DROPOFF_PICKUP",
    "PACKAGING" AS "PACKAGING",
    "SENT_TO_PKMS_DTTM" AS "SENT_TO_PKMS_DTTM",
    "WMS_STATUS_CODE" AS "WMS_STATUS_CODE",
    "SPOT_CHARGE_AND_PAYEE_ACC" AS "SPOT_CHARGE_AND_PAYEE_ACC",
    "SPOT_CHARGE_AND_PAYEE_ACC_CC" AS "SPOT_CHARGE_AND_PAYEE_ACC_CC",
    "NORM_SPOT_CHARGE_AND_PAYEE_ACC" AS "NORM_SPOT_CHARGE_AND_PAYEE_ACC",
    "FACILITY_SCHEDULE_ID" AS "FACILITY_SCHEDULE_ID",
    "EARNED_INCOME_CURRENCY_CODE" AS "EARNED_INCOME_CURRENCY_CODE",
    "ACTUAL_COST_CURRENCY_CODE" AS "ACTUAL_COST_CURRENCY_CODE",
    "SHIPMENT_RECON_DTTM" AS "SHIPMENT_RECON_DTTM",
    "PLN_RATING_LANE_ID" AS "PLN_RATING_LANE_ID",
    "PLN_RATING_LANE_DETAIL_ID" AS "PLN_RATING_LANE_DETAIL_ID",
    "PLN_TOTAL_COST" AS "PLN_TOTAL_COST",
    "PLN_LINEHAUL_COST" AS "PLN_LINEHAUL_COST",
    "PLN_TOTAL_ACCESSORIAL_COST" AS "PLN_TOTAL_ACCESSORIAL_COST",
    "PLN_STOP_OFF_COST" AS "PLN_STOP_OFF_COST",
    "PLN_NORMALIZED_TOTAL_COST" AS "PLN_NORMALIZED_TOTAL_COST",
    "PLN_CURRENCY_CODE" AS "PLN_CURRENCY_CODE",
    "PLN_ACCESSORL_COST_TO_CARRIER" AS "PLN_ACCESSORL_COST_TO_CARRIER",
    "PLN_CARRIER_CHARGE" AS "PLN_CARRIER_CHARGE",
    "WAYPOINT_TOTAL_COST" AS "WAYPOINT_TOTAL_COST",
    "WAYPOINT_HANDLING_COST" AS "WAYPOINT_HANDLING_COST",
    "GRS_OPERATION" AS "GRS_OPERATION",
    "IS_GRS_OPT_CYCLE_RUNNING" AS "IS_GRS_OPT_CYCLE_RUNNING",
    "IS_MANUAL_ASSIGN" AS "IS_MANUAL_ASSIGN",
    "LAST_RUN_GRS_DTTM" AS "LAST_RUN_GRS_DTTM",
    "GRS_MAX_SHIPMENT_STATUS" AS "GRS_MAX_SHIPMENT_STATUS",
    "PRIORITY_TYPE" AS "PRIORITY_TYPE",
    "MV_CURRENCY_CODE" AS "MV_CURRENCY_CODE",
    "PROD_SCHED_REF_NUMBER" AS "PROD_SCHED_REF_NUMBER",
    "COMMODITY_CODE_ID" AS "COMMODITY_CODE_ID",
    "UN_NUMBER_ID" AS "UN_NUMBER_ID",
    "CONTRACT_NUMBER" AS "CONTRACT_NUMBER",
    "BOOKING_REF_SHIPPER" AS "BOOKING_REF_SHIPPER",
    "BOOKING_REF_CARRIER" AS "BOOKING_REF_CARRIER",
    "BK_RESOURCE_REF_EXTERNAL" AS "BK_RESOURCE_REF_EXTERNAL",
    "BK_RESOURCE_NAME_EXTERNAL" AS "BK_RESOURCE_NAME_EXTERNAL",
    "BK_O_FACILITY_ID" AS "BK_O_FACILITY_ID",
    "BK_D_FACILITY_ID" AS "BK_D_FACILITY_ID",
    "BK_MASTER_AIRWAY_BILL" AS "BK_MASTER_AIRWAY_BILL",
    "BK_FORWARDER_AIRWAY_BILL" AS "BK_FORWARDER_AIRWAY_BILL",
    "ASSIGNED_SCNDR_CARRIER_CODE" AS "ASSIGNED_SCNDR_CARRIER_CODE",
    "CUSTOMER_CREDIT_LIMIT_ID" AS "CUSTOMER_CREDIT_LIMIT_ID",
    "SHIPMENT_LEG_TYPE" AS "SHIPMENT_LEG_TYPE",
    "SHIPMENT_CLOSED_INDICATOR" AS "SHIPMENT_CLOSED_INDICATOR",
    "OCEAN_ROUTING_STAGE" AS "OCEAN_ROUTING_STAGE",
    "BK_DEPARTURE_DTTM" AS "BK_DEPARTURE_DTTM",
    "BK_DEPARTURE_TZ" AS "BK_DEPARTURE_TZ",
    "BK_ARRIVAL_DTTM" AS "BK_ARRIVAL_DTTM",
    "BK_ARRIVAL_TZ" AS "BK_ARRIVAL_TZ",
    "BK_PICKUP_DTTM" AS "BK_PICKUP_DTTM",
    "BK_PICKUP_TZ" AS "BK_PICKUP_TZ",
    "BK_CUTOFF_DTTM" AS "BK_CUTOFF_DTTM",
    "BK_CUTOFF_TZ" AS "BK_CUTOFF_TZ",
    "NUM_CHARGE_LAYOVERS" AS "NUM_CHARGE_LAYOVERS",
    "RATE_TYPE" AS "RATE_TYPE",
    "RATE_UOM" AS "RATE_UOM",
    "PICK_START_DTTM" AS "PICK_START_DTTM",
    "PAPERWORK_START_DTTM" AS "PAPERWORK_START_DTTM",
    "VEHICLE_CHECK_START_DTTM" AS "VEHICLE_CHECK_START_DTTM",
    "SHIPMENT_START_DTTM" AS "SHIPMENT_START_DTTM",
    "SHIPMENT_END_DTTM" AS "SHIPMENT_END_DTTM",
    "FEASIBLE_DRIVER_TYPE" AS "FEASIBLE_DRIVER_TYPE",
    "WAVE_ID" AS "WAVE_ID",
    "ESTIMATED_DISPATCH_DTTM" AS "ESTIMATED_DISPATCH_DTTM",
    "TOTAL_TIME" AS "TOTAL_TIME",
    "LOC_REFERENCE" AS "LOC_REFERENCE",
    "BK_O_FACILITY_ALIAS_ID" AS "BK_O_FACILITY_ALIAS_ID",
    "BK_D_FACILITY_ALIAS_ID" AS "BK_D_FACILITY_ALIAS_ID",
    "EQUIP_UTIL_PER" AS "EQUIP_UTIL_PER",
    "MOVE_TYPE" AS "MOVE_TYPE",
    "DRIVER_TYPE_ID" AS "DRIVER_TYPE_ID",
    "EQUIPMENT_TYPE" AS "EQUIPMENT_TYPE",
    "RADIAL_DISTANCE" AS "RADIAL_DISTANCE",
    "RADIAL_DISTANCE_UOM" AS "RADIAL_DISTANCE_UOM",
    "DESIGNATED_TRACTOR_CODE" AS "DESIGNATED_TRACTOR_CODE",
    "DESIGNATED_DRIVER_TYPE" AS "DESIGNATED_DRIVER_TYPE",
    "IS_WAVE_MAN_CHANGED" AS "IS_WAVE_MAN_CHANGED",
    "RETAIN_CONSOLIDATOR_TIMES" AS "RETAIN_CONSOLIDATOR_TIMES",
    "TARIFF" AS "TARIFF",
    "MIN_RATE" AS "MIN_RATE",
    "FIRST_UPDATE_SENT_TO_PKMS" AS "FIRST_UPDATE_SENT_TO_PKMS",
    "EVENT_IND_TYPEID" AS "EVENT_IND_TYPEID",
    "TANDEM_PATH_ID" AS "TANDEM_PATH_ID",
    "O_TANDEM_FACILITY" AS "O_TANDEM_FACILITY",
    "D_TANDEM_FACILITY" AS "D_TANDEM_FACILITY",
    "O_TANDEM_FACILITY_ALIAS" AS "O_TANDEM_FACILITY_ALIAS",
    "D_TANDEM_FACILITY_ALIAS" AS "D_TANDEM_FACILITY_ALIAS",
    "DELAY_TYPE" AS "DELAY_TYPE",
    "ASSIGNED_CARRIER_ID" AS "ASSIGNED_CARRIER_ID",
    "DSG_CARRIER_ID" AS "DSG_CARRIER_ID",
    "REC_CARRIER_ID" AS "REC_CARRIER_ID",
    "FEASIBLE_CARRIER_ID" AS "FEASIBLE_CARRIER_ID",
    "PAYEE_CARRIER_ID" AS "PAYEE_CARRIER_ID",
    "SCNDR_CARRIER_ID" AS "SCNDR_CARRIER_ID",
    "BROKER_CARRIER_ID" AS "BROKER_CARRIER_ID",
    "ASSIGNED_SCNDR_CARRIER_ID" AS "ASSIGNED_SCNDR_CARRIER_ID",
    "DSG_SCNDR_CARRIER_ID" AS "DSG_SCNDR_CARRIER_ID",
    "ASSIGNED_BROKER_CARRIER_ID" AS "ASSIGNED_BROKER_CARRIER_ID",
    "LH_PAYEE_CARRIER_ID" AS "LH_PAYEE_CARRIER_ID",
    "REC_BROKER_CARRIER_ID" AS "REC_BROKER_CARRIER_ID",
    "ASSIGNED_EQUIPMENT_ID" AS "ASSIGNED_EQUIPMENT_ID",
    "DSG_EQUIPMENT_ID" AS "DSG_EQUIPMENT_ID",
    "FEASIBLE_EQUIPMENT_ID" AS "FEASIBLE_EQUIPMENT_ID",
    "FEASIBLE_EQUIPMENT2_ID" AS "FEASIBLE_EQUIPMENT2_ID",
    "REC_EQUIPMENT_ID" AS "REC_EQUIPMENT_ID",
    "ASSIGNED_MOT_ID" AS "ASSIGNED_MOT_ID",
    "DSG_MOT_ID" AS "DSG_MOT_ID",
    "FEASIBLE_MOT_ID" AS "FEASIBLE_MOT_ID",
    "REC_MOT_ID" AS "REC_MOT_ID",
    "PRODUCT_CLASS_ID" AS "PRODUCT_CLASS_ID",
    "PROTECTION_LEVEL_ID" AS "PROTECTION_LEVEL_ID",
    "ASSIGNED_SERVICE_LEVEL_ID" AS "ASSIGNED_SERVICE_LEVEL_ID",
    "DSG_SERVICE_LEVEL_ID" AS "DSG_SERVICE_LEVEL_ID",
    "FEASIBLE_SERVICE_LEVEL_ID" AS "FEASIBLE_SERVICE_LEVEL_ID",
    "REC_SERVICE_LEVEL_ID" AS "REC_SERVICE_LEVEL_ID",
    "HAS_EM_NOTIFY_FLAG" AS "HAS_EM_NOTIFY_FLAG",
    "REGION_ID" AS "REGION_ID",
    "INBOUND_REGION_ID" AS "INBOUND_REGION_ID",
    "OUTBOUND_REGION_ID" AS "OUTBOUND_REGION_ID",
    "FINANCIAL_WT" AS "FINANCIAL_WT",
    "IS_BOOKING_REQUIRED" AS "IS_BOOKING_REQUIRED",
    "TOTAL_COST_EXCL_TAX" AS "TOTAL_COST_EXCL_TAX",
    "TOTAL_TAX_AMOUNT" AS "TOTAL_TAX_AMOUNT",
    "IS_ASSOCIATED_TO_OUTBOUND" AS "IS_ASSOCIATED_TO_OUTBOUND",
    "RECEIVED_DTTM" AS "RECEIVED_DTTM",
    "BOOKING_ID" AS "BOOKING_ID",
    "IS_MISROUTED" AS "IS_MISROUTED",
    "FEASIBLE_CARRIER_CODE" AS "FEASIBLE_CARRIER_CODE",
    "SHIPMENT_WIN_ADJ_FLAG" AS "SHIPMENT_WIN_ADJ_FLAG",
    "DT_PARAM_SET_ID" AS "DT_PARAM_SET_ID",
    "MERCHANDIZING_DEPARTMENT_ID" AS "MERCHANDIZING_DEPARTMENT_ID",
    "STATIC_ROUTE_ID" AS "STATIC_ROUTE_ID",
    "IS_FILO" AS "IS_FILO",
    "IS_COOLER_AT_NOSE" AS "IS_COOLER_AT_NOSE",
    "AUTH_NBR" AS "AUTH_NBR",
    "CONS_LOCN_ID" AS "CONS_LOCN_ID",
    "RTE_TYPE" AS "RTE_TYPE",
    "TRLR_TYPE" AS "TRLR_TYPE",
    "TRLR_SIZE" AS "TRLR_SIZE",
    "CONS_ADDR_CODE" AS "CONS_ADDR_CODE",
    "HUB_ID" AS "HUB_ID",
    "TRLR_GEN_CODE" AS "TRLR_GEN_CODE",
    "MAX_NBR_OF_CTNS" AS "MAX_NBR_OF_CTNS",
    "APPT_DOOR_SCHED_TYPE" AS "APPT_DOOR_SCHED_TYPE",
    "CREATED_SOURCE_TYPE" AS "CREATED_SOURCE_TYPE",
    "CREATED_SOURCE" AS "CREATED_SOURCE",
    "CREATED_DTTM" AS "CREATED_DTTM",
    "LAST_UPDATED_SOURCE_TYPE" AS "LAST_UPDATED_SOURCE_TYPE",
    "LAST_UPDATED_SOURCE" AS "LAST_UPDATED_SOURCE",
    "LAST_UPDATED_DTTM" AS "LAST_UPDATED_DTTM",
    "DSG_SCNDR_CARRIER_CODE" AS "DSG_SCNDR_CARRIER_CODE",
    "LH_PAYEE_CARRIER_CODE" AS "LH_PAYEE_CARRIER_CODE",
    "REC_BROKER_CARRIER_CODE" AS "REC_BROKER_CARRIER_CODE",
    "REC_CARRIER_CODE" AS "REC_CARRIER_CODE",
    "LPN_ASSIGNMENT_STOPPED" AS "LPN_ASSIGNMENT_STOPPED",
    "SEAL_NUMBER" AS "SEAL_NUMBER",
    "HIBERNATE_VERSION" AS "HIBERNATE_VERSION",
    "SHIP_GROUP_ID" AS "SHIP_GROUP_ID",
    "RATE" AS "RATE",
    "MONETARY_VALUE" AS "MONETARY_VALUE",
    "DOOR" AS "DOOR",
    "RTE_TYPE_1" AS "RTE_TYPE_1",
    "RTE_TYPE_2" AS "RTE_TYPE_2",
    "SCHEDULED_PICKUP_DTTM" AS "SCHEDULED_PICKUP_DTTM",
    "MANIFEST_ID" AS "MANIFEST_ID",
    "DAYS_TO_DELIVER" AS "DAYS_TO_DELIVER",
    "SED_GENERATED_FLAG" AS "SED_GENERATED_FLAG",
    "SERV_AREA_CODE" AS "SERV_AREA_CODE",
    "TENDER_RESP_DEADLINE_DTTM" AS "TENDER_RESP_DEADLINE_DTTM",
    "PRINT_CONS_BOL" AS "PRINT_CONS_BOL",
    "LEFT_WT" AS "LEFT_WT",
    "RIGHT_WT" AS "RIGHT_WT",
    "LANE_NAME" AS "LANE_NAME",
    "DECLARED_VALUE" AS "DECLARED_VALUE",
    "DV_CURRENCY_CODE" AS "DV_CURRENCY_CODE",
    "COD_AMOUNT" AS "COD_AMOUNT",
    "CUSTOMER_ID" AS "CUSTOMER_ID",
    "CUST_FRGT_CHARGE" AS "CUST_FRGT_CHARGE",
    "COD_CURRENCY_CODE" AS "COD_CURRENCY_CODE",
    "PLANNED_WEIGHT" AS "PLANNED_WEIGHT",
    "WEIGHT_UOM_ID_BASE" AS "WEIGHT_UOM_ID_BASE",
    "PLANNED_VOLUME" AS "PLANNED_VOLUME",
    "VOLUME_UOM_ID_BASE" AS "VOLUME_UOM_ID_BASE",
    "SIZE1_VALUE" AS "SIZE1_VALUE",
    "SIZE1_UOM_ID" AS "SIZE1_UOM_ID",
    "SIZE2_VALUE" AS "SIZE2_VALUE",
    "SIZE2_UOM_ID" AS "SIZE2_UOM_ID",
    "ASSIGNED_SHIP_VIA" AS "ASSIGNED_SHIP_VIA",
    "INSURANCE_STATUS" AS "INSURANCE_STATUS",
    "RTE_SWC_NBR" AS "RTE_SWC_NBR",
    "RTE_TO" AS "RTE_TO",
    "BILL_OF_LADING_NUMBER" AS "BILL_OF_LADING_NUMBER",
    "TRAILER_NUMBER" AS "TRAILER_NUMBER",
    "TRANS_PLAN_OWNER" AS "TRANS_PLAN_OWNER",
    "TOTAL_REVENUE_CURRENCY_CODE" AS "TOTAL_REVENUE_CURRENCY_CODE",
    "TOTAL_REVENUE" AS "TOTAL_REVENUE",
    "FRT_REV_SPOT_CHARGE_CURR_CODE" AS "FRT_REV_SPOT_CHARGE_CURR_CODE",
    "NORMALIZED_TOTAL_REVENUE" AS "NORMALIZED_TOTAL_REVENUE",
    "FRT_REV_SPOT_CHARGE" AS "FRT_REV_SPOT_CHARGE",
    "DSG_VOYAGE_FLIGHT" AS "DSG_VOYAGE_FLIGHT",
    "FEASIBLE_VOYAGE_FLIGHT" AS "FEASIBLE_VOYAGE_FLIGHT",
    "CURRENCY_DTTM" AS "CURRENCY_DTTM",
    "FRT_REV_LINEHAUL_CHARGE" AS "FRT_REV_LINEHAUL_CHARGE",
    "FRT_REV_STOP_CHARGE" AS "FRT_REV_STOP_CHARGE",
    "FRT_REV_ACCESSORIAL_CHARGE" AS "FRT_REV_ACCESSORIAL_CHARGE",
    "MARGIN" AS "MARGIN",
    "TOTAL_COST" AS "TOTAL_COST",
    "INCOTERM_ID" AS "INCOTERM_ID",
    "ORDER_QTY" AS "ORDER_QTY",
    "QTY_UOM_ID" AS "QTY_UOM_ID",
    "REF_SHIPMENT_NBR" AS "REF_SHIPMENT_NBR",
    "STAGING_LOCN_ID" AS "STAGING_LOCN_ID",
    "LOADING_SEQ_ORD" AS "LOADING_SEQ_ORD",
    "HAZMAT_CERT_CONTACT" AS "HAZMAT_CERT_CONTACT",
    "HAZMAT_CERT_DECLARATION" AS "HAZMAT_CERT_DECLARATION",
    "CDC_TIMESTAMP" AS "CDC_TIMESTAMP",
    "OPERATION_TYPE" AS "OPERATION_TYPE",
    "ARCHIVED_DTTM" AS "ARCHIVED_DTTM",
    "ORIGIN" AS "ORIGIN",
    "FINAL_DESTINATION" AS "FINAL_DESTINATION",
    "actual_delivery_date_parsed" AS "actual_delivery_date_parsed",
    "wood_pellet" AS "wood_pellet",
    "act_del_MERCH_YEAR" AS "act_del_MERCH_YEAR",
    "act_del_YEAR_WEEK" AS "act_del_YEAR_WEEK",
    "act_del_YEAR_QUARTER" AS "act_del_YEAR_QUARTER",
    "act_del_YEAR_PERIOD" AS "act_del_YEAR_PERIOD",
    "invoice_shipping_id" AS "invoice_shipping_id",
    "org_Facility_Code" AS "org_Facility_Code",
    "org_Facility_Name" AS "org_Facility_Name",
    "org_Facility_Type" AS "org_Facility_Type",
    "dest_Facility_Code" AS "dest_Facility_Code",
    "dest_Facility_Name" AS "dest_Facility_Name",
    "dest_Facility_Type" AS "dest_Facility_Type",
    "inbound_flag" AS "inbound_flag",
    "order_id_po" AS "order_id_po",
    "order_id_po_int" AS "order_id_po_int",
    "po_STORE_NO" AS "po_STORE_NO",
    "po_CO_CODE" AS "po_CO_CODE",
    "po_ARTICLE_NO" AS "po_ARTICLE_NO",
    "po_PO_NO" AS "po_PO_NO",
    "po_PO_LINE_NO" AS "po_PO_LINE_NO",
    "po_PO_DATE" AS "po_PO_DATE",
    "po_po_date_parsed" AS "po_po_date_parsed",
    "po_DELIV_DATE" AS "po_DELIV_DATE",
    "po_deliv_date_parsed" AS "po_deliv_date_parsed",
    "po_PO_TYPE_CODE" AS "po_PO_TYPE_CODE",
    "po_VENDOR_ID" AS "po_VENDOR_ID",
    "po_VSR_CODE" AS "po_VSR_CODE",
    "po_PO_LINE_CANCELLED_FLAG" AS "po_PO_LINE_CANCELLED_FLAG",
    "po_PO_LINE_ORDER_QTY" AS "po_PO_LINE_ORDER_QTY",
    "po_PO_LINE_ISSUE_QTY" AS "po_PO_LINE_ISSUE_QTY",
    "po_PO_LINE_RCVD_QTY" AS "po_PO_LINE_RCVD_QTY",
    "po_PO_LINE_UNIT_PRICE" AS "po_PO_LINE_UNIT_PRICE",
    "po_DC_NO" AS "po_DC_NO",
    "po_PO_TRACKING_NO" AS "po_PO_TRACKING_NO",
    "po_PO_LINE_TRACKING_NO" AS "po_PO_LINE_TRACKING_NO",
    "po_CURRENT_REPL_TYPE_CODE" AS "po_CURRENT_REPL_TYPE_CODE",
    "po_FREIGHT_TYPE_CODE" AS "po_FREIGHT_TYPE_CODE",
    "po_SHIP_START_DATE" AS "po_SHIP_START_DATE",
    "po_SHIP_END_DATE" AS "po_SHIP_END_DATE",
    "po_DELIV_START_DATE" AS "po_DELIV_START_DATE",
    "po_DELIV_END_DATE" AS "po_DELIV_END_DATE",
    "po_PO_LINE_UNIT_FREIGHT_AMT" AS "po_PO_LINE_UNIT_FREIGHT_AMT",
    "po_PO_LINE_MANUFACTURER" AS "po_PO_LINE_MANUFACTURER",
    "po_PO_LINE_ORIGIN_COUNTRY_CODE" AS "po_PO_LINE_ORIGIN_COUNTRY_CODE",
    "po_PO_LINE_PORT_OF_ORIGIN" AS "po_PO_LINE_PORT_OF_ORIGIN",
    "po_PO_LINE_MIN_RCVD_DATE" AS "po_PO_LINE_MIN_RCVD_DATE",
    "po_PO_LINE_MAX_RCVD_DATE" AS "po_PO_LINE_MAX_RCVD_DATE",
    "po_PO_LINE_DELIVERED_FLAG" AS "po_PO_LINE_DELIVERED_FLAG",
    "po_PO_LINE_CONFIRMED_ON_BOARD_DATE" AS "po_PO_LINE_CONFIRMED_ON_BOARD_DATE",
    "po_PO_LINE_BOOKED_FOR_SHIPMENT_DATE" AS "po_PO_LINE_BOOKED_FOR_SHIPMENT_DATE",
    "po_PO_LINE_TRANSIT_RESN_CODE" AS "po_PO_LINE_TRANSIT_RESN_CODE",
    "po_PO_LINE_MOVE_TYPE_CODE" AS "po_PO_LINE_MOVE_TYPE_CODE",
    "po_PO_LINE_AGENT_COMMISSION_RATE" AS "po_PO_LINE_AGENT_COMMISSION_RATE",
    "po_PO_LINE_AGENT_COMMISSION_AMT" AS "po_PO_LINE_AGENT_COMMISSION_AMT",
    "po_PO_LINE_ADDL_ARTICLE_NO" AS "po_PO_LINE_ADDL_ARTICLE_NO",
    "po_PO_LINE_ADDL_ARTICLE_QTY" AS "po_PO_LINE_ADDL_ARTICLE_QTY",
    "po_PO_LINE_FACTORY_VENDOR_ID" AS "po_PO_LINE_FACTORY_VENDOR_ID",
    "po_PO_LINE_STUFFING_LOC_VENDOR_ID" AS "po_PO_LINE_STUFFING_LOC_VENDOR_ID",
    "po_PO_LINE_SOURCING_AGENT_VENDOR_ID" AS "po_PO_LINE_SOURCING_AGENT_VENDOR_ID",
    "po_PO_LINE_FREIGHT_FORWARDER_VENDOR_ID" AS "po_PO_LINE_FREIGHT_FORWARDER_VENDOR_ID",
    "po_PO_LINE_LETTER_OF_CREDIT_NO" AS "po_PO_LINE_LETTER_OF_CREDIT_NO",
    "po_PO_LINE_OPEN_ACCT_NO" AS "po_PO_LINE_OPEN_ACCT_NO",
    "po_PO_LINE_ARTICLE_LENGTH" AS "po_PO_LINE_ARTICLE_LENGTH",
    "po_PO_LINE_ARTICLE_WIDTH" AS "po_PO_LINE_ARTICLE_WIDTH",
    "po_PO_LINE_ARTICLE_HEIGHT" AS "po_PO_LINE_ARTICLE_HEIGHT",
    "po_PO_LINE_ARTICLE_DIMENSIONS_UOM" AS "po_PO_LINE_ARTICLE_DIMENSIONS_UOM",
    "po_PO_LINE_ARTICLE_WEIGHT" AS "po_PO_LINE_ARTICLE_WEIGHT",
    "po_PO_LINE_ARTICLE_WEIGHT_UOM" AS "po_PO_LINE_ARTICLE_WEIGHT_UOM",
    "po_PO_TOTAL_WEIGHT" AS "po_PO_TOTAL_WEIGHT",
    "po_PO_LINE_ARTICLE_VOLUME" AS "po_PO_LINE_ARTICLE_VOLUME",
    "po_PO_LINE_ARTICLE_VOLUME_UOM" AS "po_PO_LINE_ARTICLE_VOLUME_UOM",
    "po_PO_TOTAL_VOLUME" AS "po_PO_TOTAL_VOLUME",
    "po_HTS_CODE" AS "po_HTS_CODE",
    "po_PO_LINE_DUTY_RATE" AS "po_PO_LINE_DUTY_RATE",
    "po_PO_LINE_DUTY_AMT" AS "po_PO_LINE_DUTY_AMT",
    "po_PO_LINE_ADDL_HTS_CODE_1" AS "po_PO_LINE_ADDL_HTS_CODE_1",
    "po_PO_LINE_ADDL_DUTY_RATE_1" AS "po_PO_LINE_ADDL_DUTY_RATE_1",
    "po_PO_LINE_ADDL_DUTY_AMT_1" AS "po_PO_LINE_ADDL_DUTY_AMT_1",
    "po_PO_LINE_ADDL_HTS_CODE_2" AS "po_PO_LINE_ADDL_HTS_CODE_2",
    "po_PO_LINE_ADDL_DUTY_RATE_2" AS "po_PO_LINE_ADDL_DUTY_RATE_2",
    "po_PO_LINE_ADDL_DUTY_AMT_2" AS "po_PO_LINE_ADDL_DUTY_AMT_2",
    "po_PO_HELD_FLAG" AS "po_PO_HELD_FLAG",
    "po_PO_VENDOR_DOC_DATE" AS "po_PO_VENDOR_DOC_DATE",
    "po_cal_MERCH_YEAR" AS "po_cal_MERCH_YEAR",
    "po_cal_YEAR_WEEK" AS "po_cal_YEAR_WEEK",
    "po_cal_YEAR_QUARTER" AS "po_cal_YEAR_QUARTER",
    "po_cal_YEAR_PERIOD" AS "po_cal_YEAR_PERIOD",
    "a_ARTICLE_LENGTH" AS "a_ARTICLE_LENGTH",
    "a_ARTICLE_WIDTH" AS "a_ARTICLE_WIDTH",
    "a_ARTICLE_HEIGHT" AS "a_ARTICLE_HEIGHT",
    "item_volume" AS "item_volume",
    "a_ARTICLE_WEIGHT" AS "a_ARTICLE_WEIGHT",
    "item_weight" AS "item_weight",
    "a_ARTICLE_SIZE" AS "a_ARTICLE_SIZE",
    "a_ARTICLE_40HC_QTY" AS "a_ARTICLE_40HC_QTY",
    "a_ARTICLE_40GP_QTY" AS "a_ARTICLE_40GP_QTY",
    "item_volume_sum" AS "item_volume_sum",
    "allocation_by_vol" AS "allocation_by_vol",
    "item_weight_total" AS "item_weight_total",
    "allocation_by_wgt" AS "allocation_by_wgt",
    "max_volume" AS "max_volume",
    "max_weight" AS "max_weight",
    "weight_volume_flag" AS "weight_volume_flag",
    "allocation_final" AS "allocation_final",
    "item_weight_sum" AS "po_weight_sum"
  FROM (
    SELECT 
        "SHIPMENT_ID" AS "SHIPMENT_ID",
        "TC_COMPANY_ID" AS "TC_COMPANY_ID",
        "RS_AREA_ID" AS "RS_AREA_ID",
        "TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID",
        "PP_SHIPMENT_ID" AS "PP_SHIPMENT_ID",
        "SHIPMENT_STATUS" AS "SHIPMENT_STATUS",
        "UPDATE_SENT" AS "UPDATE_SENT",
        "BUSINESS_PROCESS" AS "BUSINESS_PROCESS",
        "CREATION_TYPE" AS "CREATION_TYPE",
        "CONS_RUN_ID" AS "CONS_RUN_ID",
        "IS_CANCELLED" AS "IS_CANCELLED",
        "RS_TYPE" AS "RS_TYPE",
        "RS_CONFIG_ID" AS "RS_CONFIG_ID",
        "RS_CONFIG_CYCLE_ID" AS "RS_CONFIG_CYCLE_ID",
        "CONFIG_CYCLE_SEQ" AS "CONFIG_CYCLE_SEQ",
        "CYCLE_DEADLINE_DTTM" AS "CYCLE_DEADLINE_DTTM",
        "CYCLE_EXECUTION_DTTM" AS "CYCLE_EXECUTION_DTTM",
        "LAST_RS_NOTIFICATION_DTTM" AS "LAST_RS_NOTIFICATION_DTTM",
        "CFMF_STATUS" AS "CFMF_STATUS",
        "AVAILABLE_DTTM" AS "AVAILABLE_DTTM",
        "CMID" AS "CMID",
        "CM_DISCOUNT" AS "CM_DISCOUNT",
        "O_FACILITY_NUMBER" AS "O_FACILITY_NUMBER",
        "O_FACILITY_ID" AS "O_FACILITY_ID",
        "O_ADDRESS" AS "O_ADDRESS",
        "O_CITY" AS "O_CITY",
        "O_STATE_PROV" AS "O_STATE_PROV",
        "O_POSTAL_CODE" AS "O_POSTAL_CODE",
        "O_COUNTY" AS "O_COUNTY",
        "O_COUNTRY_CODE" AS "O_COUNTRY_CODE",
        "D_FACILITY_NUMBER" AS "D_FACILITY_NUMBER",
        "D_FACILITY_ID" AS "D_FACILITY_ID",
        "D_ADDRESS" AS "D_ADDRESS",
        "D_CITY" AS "D_CITY",
        "D_STATE_PROV" AS "D_STATE_PROV",
        "D_POSTAL_CODE" AS "D_POSTAL_CODE",
        "D_COUNTY" AS "D_COUNTY",
        "D_COUNTRY_CODE" AS "D_COUNTRY_CODE",
        "DISTANCE" AS "DISTANCE",
        "DIRECT_DISTANCE" AS "DIRECT_DISTANCE",
        "OUT_OF_ROUTE_DISTANCE" AS "OUT_OF_ROUTE_DISTANCE",
        "DISTANCE_UOM" AS "DISTANCE_UOM",
        "BUSINESS_PARTNER_ID" AS "BUSINESS_PARTNER_ID",
        "COMMODITY_CLASS" AS "COMMODITY_CLASS",
        "IS_HAZMAT" AS "IS_HAZMAT",
        "IS_PERISHABLE" AS "IS_PERISHABLE",
        "BILLING_METHOD" AS "BILLING_METHOD",
        "DSG_CARRIER_CODE" AS "DSG_CARRIER_CODE",
        "REC_CMID" AS "REC_CMID",
        "REC_CM_SHIPMENT_ID" AS "REC_CM_SHIPMENT_ID",
        "ASSIGNED_CARRIER_CODE" AS "ASSIGNED_CARRIER_CODE",
        "SHIPMENT_REF_ID" AS "SHIPMENT_REF_ID",
        "BILL_TO_CODE" AS "BILL_TO_CODE",
        "BILL_TO_TITLE" AS "BILL_TO_TITLE",
        "BILL_TO_NAME" AS "BILL_TO_NAME",
        "BILL_TO_ADDRESS" AS "BILL_TO_ADDRESS",
        "BILL_TO_CITY" AS "BILL_TO_CITY",
        "BILL_TO_STATE_PROV" AS "BILL_TO_STATE_PROV",
        "BILL_TO_POSTAL_CODE" AS "BILL_TO_POSTAL_CODE",
        "BILL_TO_COUNTRY_CODE" AS "BILL_TO_COUNTRY_CODE",
        "BILL_TO_PHONE_NUMBER" AS "BILL_TO_PHONE_NUMBER",
        "PURCHASE_ORDER" AS "PURCHASE_ORDER",
        "PRO_NUMBER" AS "PRO_NUMBER",
        "TRANS_RESP_CODE" AS "TRANS_RESP_CODE",
        "BASELINE_COST" AS "BASELINE_COST",
        "ESTIMATED_COST" AS "ESTIMATED_COST",
        "LINEHAUL_COST" AS "LINEHAUL_COST",
        "ACCESSORIAL_COST" AS "ACCESSORIAL_COST",
        "STOP_COST" AS "STOP_COST",
        "ESTIMATED_SAVINGS" AS "ESTIMATED_SAVINGS",
        "SPOT_CHARGE" AS "SPOT_CHARGE",
        "CURRENCY_CODE" AS "CURRENCY_CODE",
        "PICKUP_START_DTTM" AS "PICKUP_START_DTTM",
        "PICKUP_END_DTTM" AS "PICKUP_END_DTTM",
        "DELIVERY_START_DTTM" AS "DELIVERY_START_DTTM",
        "DELIVERY_END_DTTM" AS "DELIVERY_END_DTTM",
        "NUM_STOPS" AS "NUM_STOPS",
        "NUM_DOCKS" AS "NUM_DOCKS",
        "ON_TIME_INDICATOR" AS "ON_TIME_INDICATOR",
        "HAS_NOTES" AS "HAS_NOTES",
        "HAS_ALERTS" AS "HAS_ALERTS",
        "HAS_IMPORT_ERROR" AS "HAS_IMPORT_ERROR",
        "HAS_SOFT_CHECK_ERROR" AS "HAS_SOFT_CHECK_ERROR",
        "HAS_TRACKING_MSG" AS "HAS_TRACKING_MSG",
        "TRACKING_MSG_PROBLEM" AS "TRACKING_MSG_PROBLEM",
        "REC_LINEHAUL_COST" AS "REC_LINEHAUL_COST",
        "REC_ACCESSORIAL_COST" AS "REC_ACCESSORIAL_COST",
        "REC_TOTAL_COST" AS "REC_TOTAL_COST",
        "CYCLE_RESP_DEADLINE_TZ" AS "CYCLE_RESP_DEADLINE_TZ",
        "TENDER_RESP_DEADLINE_TZ" AS "TENDER_RESP_DEADLINE_TZ",
        "PICKUP_TZ" AS "PICKUP_TZ",
        "DELIVERY_TZ" AS "DELIVERY_TZ",
        "ASSIGNED_LANE_ID" AS "ASSIGNED_LANE_ID",
        "ASSIGNED_LANE_DETAIL_ID" AS "ASSIGNED_LANE_DETAIL_ID",
        "REC_SPOT_CHARGE" AS "REC_SPOT_CHARGE",
        "REC_LANE_ID" AS "REC_LANE_ID",
        "REC_LANE_DETAIL_ID" AS "REC_LANE_DETAIL_ID",
        "TENDER_DTTM" AS "TENDER_DTTM",
        "O_STOP_LOCATION_NAME" AS "O_STOP_LOCATION_NAME",
        "D_STOP_LOCATION_NAME" AS "D_STOP_LOCATION_NAME",
        "ASSIGNED_CM_SHIPMENT_ID" AS "ASSIGNED_CM_SHIPMENT_ID",
        "REC_CM_DISCOUNT" AS "REC_CM_DISCOUNT",
        "REC_STOP_COST" AS "REC_STOP_COST",
        "LAST_SELECTOR_RUN_DTTM" AS "LAST_SELECTOR_RUN_DTTM",
        "LAST_CM_OPTION_GEN_DTTM" AS "LAST_CM_OPTION_GEN_DTTM",
        "IS_CM_OPTION_GEN_ACTIVE" AS "IS_CM_OPTION_GEN_ACTIVE",
        "RS_CYCLE_REMAINING" AS "RS_CYCLE_REMAINING",
        "IS_TIME_FEAS_ENABLED" AS "IS_TIME_FEAS_ENABLED",
        "EXT_SYS_SHIPMENT_ID" AS "EXT_SYS_SHIPMENT_ID",
        "EXTRACTION_DTTM" AS "EXTRACTION_DTTM",
        "ASSIGNED_BROKER_CARRIER_CODE" AS "ASSIGNED_BROKER_CARRIER_CODE",
        "USE_BROKER_AS_CARRIER" AS "USE_BROKER_AS_CARRIER",
        "BROKER_REF" AS "BROKER_REF",
        "RATING_QUALIFIER" AS "RATING_QUALIFIER",
        "STATUS_CHANGE_DTTM" AS "STATUS_CHANGE_DTTM",
        "BUDG_TOTAL_COST" AS "BUDG_TOTAL_COST",
        "NORMALIZED_MARGIN" AS "NORMALIZED_MARGIN",
        "NORMALIZED_TOTAL_COST" AS "NORMALIZED_TOTAL_COST",
        "BUDG_NORMALIZED_TOTAL_COST" AS "BUDG_NORMALIZED_TOTAL_COST",
        "REC_BUDG_LINEHAUL_COST" AS "REC_BUDG_LINEHAUL_COST",
        "REC_BUDG_STOP_COST" AS "REC_BUDG_STOP_COST",
        "REC_BUDG_CM_DISCOUNT" AS "REC_BUDG_CM_DISCOUNT",
        "REC_BUDG_ACCESSORIAL_COST" AS "REC_BUDG_ACCESSORIAL_COST",
        "REC_BUDG_TOTAL_COST" AS "REC_BUDG_TOTAL_COST",
        "REC_MARGIN" AS "REC_MARGIN",
        "REC_NORMALIZED_MARGIN" AS "REC_NORMALIZED_MARGIN",
        "REC_NORMALIZED_TOTAL_COST" AS "REC_NORMALIZED_TOTAL_COST",
        "REC_BUDG_NORMALIZED_TOTAL_COST" AS "REC_BUDG_NORMALIZED_TOTAL_COST",
        "BUDG_CURRENCY_CODE" AS "BUDG_CURRENCY_CODE",
        "SPOT_CHARGE_CURRENCY_CODE" AS "SPOT_CHARGE_CURRENCY_CODE",
        "REC_CURRENCY_CODE" AS "REC_CURRENCY_CODE",
        "REC_BUDG_CURRENCY_CODE" AS "REC_BUDG_CURRENCY_CODE",
        "REC_SPOT_CHARGE_CURRENCY_CODE" AS "REC_SPOT_CHARGE_CURRENCY_CODE",
        "RATING_LANE_ID" AS "RATING_LANE_ID",
        "FRT_REV_RATING_LANE_ID" AS "FRT_REV_RATING_LANE_ID",
        "REC_RATING_LANE_ID" AS "REC_RATING_LANE_ID",
        "REC_BUDG_RATING_LANE_ID" AS "REC_BUDG_RATING_LANE_ID",
        "RATING_LANE_DETAIL_ID" AS "RATING_LANE_DETAIL_ID",
        "FRT_REV_RATING_LANE_DETAIL_ID" AS "FRT_REV_RATING_LANE_DETAIL_ID",
        "REC_RATING_LANE_DETAIL_ID" AS "REC_RATING_LANE_DETAIL_ID",
        "REC_BUDG_RATING_LANE_DETAIL_ID" AS "REC_BUDG_RATING_LANE_DETAIL_ID",
        "BUDG_CM_DISCOUNT" AS "BUDG_CM_DISCOUNT",
        "NORMALIZED_BASELINE_COST" AS "NORMALIZED_BASELINE_COST",
        "BASELINE_COST_CURRENCY_CODE" AS "BASELINE_COST_CURRENCY_CODE",
        "REPORTED_COST" AS "REPORTED_COST",
        "TRACTOR_NUMBER" AS "TRACTOR_NUMBER",
        "IS_AUTO_DELIVERED" AS "IS_AUTO_DELIVERED",
        "SHIPMENT_TYPE" AS "SHIPMENT_TYPE",
        "ORIG_BUDG_TOTAL_COST" AS "ORIG_BUDG_TOTAL_COST",
        "ACCESSORIAL_COST_TO_CARRIER" AS "ACCESSORIAL_COST_TO_CARRIER",
        "CARRIER_CHARGE" AS "CARRIER_CHARGE",
        "ACTUAL_COST" AS "ACTUAL_COST",
        "EARNED_INCOME" AS "EARNED_INCOME",
        "SENT_TO_PKMS" AS "SENT_TO_PKMS",
        "IS_SHIPMENT_RECONCILED" AS "IS_SHIPMENT_RECONCILED",
        "DELIVERY_REQ" AS "DELIVERY_REQ",
        "DROPOFF_PICKUP" AS "DROPOFF_PICKUP",
        "PACKAGING" AS "PACKAGING",
        "SENT_TO_PKMS_DTTM" AS "SENT_TO_PKMS_DTTM",
        "WMS_STATUS_CODE" AS "WMS_STATUS_CODE",
        "SPOT_CHARGE_AND_PAYEE_ACC" AS "SPOT_CHARGE_AND_PAYEE_ACC",
        "SPOT_CHARGE_AND_PAYEE_ACC_CC" AS "SPOT_CHARGE_AND_PAYEE_ACC_CC",
        "NORM_SPOT_CHARGE_AND_PAYEE_ACC" AS "NORM_SPOT_CHARGE_AND_PAYEE_ACC",
        "FACILITY_SCHEDULE_ID" AS "FACILITY_SCHEDULE_ID",
        "EARNED_INCOME_CURRENCY_CODE" AS "EARNED_INCOME_CURRENCY_CODE",
        "ACTUAL_COST_CURRENCY_CODE" AS "ACTUAL_COST_CURRENCY_CODE",
        "SHIPMENT_RECON_DTTM" AS "SHIPMENT_RECON_DTTM",
        "PLN_RATING_LANE_ID" AS "PLN_RATING_LANE_ID",
        "PLN_RATING_LANE_DETAIL_ID" AS "PLN_RATING_LANE_DETAIL_ID",
        "PLN_TOTAL_COST" AS "PLN_TOTAL_COST",
        "PLN_LINEHAUL_COST" AS "PLN_LINEHAUL_COST",
        "PLN_TOTAL_ACCESSORIAL_COST" AS "PLN_TOTAL_ACCESSORIAL_COST",
        "PLN_STOP_OFF_COST" AS "PLN_STOP_OFF_COST",
        "PLN_NORMALIZED_TOTAL_COST" AS "PLN_NORMALIZED_TOTAL_COST",
        "PLN_CURRENCY_CODE" AS "PLN_CURRENCY_CODE",
        "PLN_ACCESSORL_COST_TO_CARRIER" AS "PLN_ACCESSORL_COST_TO_CARRIER",
        "PLN_CARRIER_CHARGE" AS "PLN_CARRIER_CHARGE",
        "WAYPOINT_TOTAL_COST" AS "WAYPOINT_TOTAL_COST",
        "WAYPOINT_HANDLING_COST" AS "WAYPOINT_HANDLING_COST",
        "GRS_OPERATION" AS "GRS_OPERATION",
        "IS_GRS_OPT_CYCLE_RUNNING" AS "IS_GRS_OPT_CYCLE_RUNNING",
        "IS_MANUAL_ASSIGN" AS "IS_MANUAL_ASSIGN",
        "LAST_RUN_GRS_DTTM" AS "LAST_RUN_GRS_DTTM",
        "GRS_MAX_SHIPMENT_STATUS" AS "GRS_MAX_SHIPMENT_STATUS",
        "PRIORITY_TYPE" AS "PRIORITY_TYPE",
        "MV_CURRENCY_CODE" AS "MV_CURRENCY_CODE",
        "PROD_SCHED_REF_NUMBER" AS "PROD_SCHED_REF_NUMBER",
        "COMMODITY_CODE_ID" AS "COMMODITY_CODE_ID",
        "UN_NUMBER_ID" AS "UN_NUMBER_ID",
        "CONTRACT_NUMBER" AS "CONTRACT_NUMBER",
        "BOOKING_REF_SHIPPER" AS "BOOKING_REF_SHIPPER",
        "BOOKING_REF_CARRIER" AS "BOOKING_REF_CARRIER",
        "BK_RESOURCE_REF_EXTERNAL" AS "BK_RESOURCE_REF_EXTERNAL",
        "BK_RESOURCE_NAME_EXTERNAL" AS "BK_RESOURCE_NAME_EXTERNAL",
        "BK_O_FACILITY_ID" AS "BK_O_FACILITY_ID",
        "BK_D_FACILITY_ID" AS "BK_D_FACILITY_ID",
        "BK_MASTER_AIRWAY_BILL" AS "BK_MASTER_AIRWAY_BILL",
        "BK_FORWARDER_AIRWAY_BILL" AS "BK_FORWARDER_AIRWAY_BILL",
        "ASSIGNED_SCNDR_CARRIER_CODE" AS "ASSIGNED_SCNDR_CARRIER_CODE",
        "CUSTOMER_CREDIT_LIMIT_ID" AS "CUSTOMER_CREDIT_LIMIT_ID",
        "SHIPMENT_LEG_TYPE" AS "SHIPMENT_LEG_TYPE",
        "SHIPMENT_CLOSED_INDICATOR" AS "SHIPMENT_CLOSED_INDICATOR",
        "OCEAN_ROUTING_STAGE" AS "OCEAN_ROUTING_STAGE",
        "BK_DEPARTURE_DTTM" AS "BK_DEPARTURE_DTTM",
        "BK_DEPARTURE_TZ" AS "BK_DEPARTURE_TZ",
        "BK_ARRIVAL_DTTM" AS "BK_ARRIVAL_DTTM",
        "BK_ARRIVAL_TZ" AS "BK_ARRIVAL_TZ",
        "BK_PICKUP_DTTM" AS "BK_PICKUP_DTTM",
        "BK_PICKUP_TZ" AS "BK_PICKUP_TZ",
        "BK_CUTOFF_DTTM" AS "BK_CUTOFF_DTTM",
        "BK_CUTOFF_TZ" AS "BK_CUTOFF_TZ",
        "NUM_CHARGE_LAYOVERS" AS "NUM_CHARGE_LAYOVERS",
        "RATE_TYPE" AS "RATE_TYPE",
        "RATE_UOM" AS "RATE_UOM",
        "PICK_START_DTTM" AS "PICK_START_DTTM",
        "PAPERWORK_START_DTTM" AS "PAPERWORK_START_DTTM",
        "VEHICLE_CHECK_START_DTTM" AS "VEHICLE_CHECK_START_DTTM",
        "SHIPMENT_START_DTTM" AS "SHIPMENT_START_DTTM",
        "SHIPMENT_END_DTTM" AS "SHIPMENT_END_DTTM",
        "FEASIBLE_DRIVER_TYPE" AS "FEASIBLE_DRIVER_TYPE",
        "WAVE_ID" AS "WAVE_ID",
        "ESTIMATED_DISPATCH_DTTM" AS "ESTIMATED_DISPATCH_DTTM",
        "TOTAL_TIME" AS "TOTAL_TIME",
        "LOC_REFERENCE" AS "LOC_REFERENCE",
        "BK_O_FACILITY_ALIAS_ID" AS "BK_O_FACILITY_ALIAS_ID",
        "BK_D_FACILITY_ALIAS_ID" AS "BK_D_FACILITY_ALIAS_ID",
        "EQUIP_UTIL_PER" AS "EQUIP_UTIL_PER",
        "MOVE_TYPE" AS "MOVE_TYPE",
        "DRIVER_TYPE_ID" AS "DRIVER_TYPE_ID",
        "EQUIPMENT_TYPE" AS "EQUIPMENT_TYPE",
        "RADIAL_DISTANCE" AS "RADIAL_DISTANCE",
        "RADIAL_DISTANCE_UOM" AS "RADIAL_DISTANCE_UOM",
        "DESIGNATED_TRACTOR_CODE" AS "DESIGNATED_TRACTOR_CODE",
        "DESIGNATED_DRIVER_TYPE" AS "DESIGNATED_DRIVER_TYPE",
        "IS_WAVE_MAN_CHANGED" AS "IS_WAVE_MAN_CHANGED",
        "RETAIN_CONSOLIDATOR_TIMES" AS "RETAIN_CONSOLIDATOR_TIMES",
        "TARIFF" AS "TARIFF",
        "MIN_RATE" AS "MIN_RATE",
        "FIRST_UPDATE_SENT_TO_PKMS" AS "FIRST_UPDATE_SENT_TO_PKMS",
        "EVENT_IND_TYPEID" AS "EVENT_IND_TYPEID",
        "TANDEM_PATH_ID" AS "TANDEM_PATH_ID",
        "O_TANDEM_FACILITY" AS "O_TANDEM_FACILITY",
        "D_TANDEM_FACILITY" AS "D_TANDEM_FACILITY",
        "O_TANDEM_FACILITY_ALIAS" AS "O_TANDEM_FACILITY_ALIAS",
        "D_TANDEM_FACILITY_ALIAS" AS "D_TANDEM_FACILITY_ALIAS",
        "DELAY_TYPE" AS "DELAY_TYPE",
        "ASSIGNED_CARRIER_ID" AS "ASSIGNED_CARRIER_ID",
        "DSG_CARRIER_ID" AS "DSG_CARRIER_ID",
        "REC_CARRIER_ID" AS "REC_CARRIER_ID",
        "FEASIBLE_CARRIER_ID" AS "FEASIBLE_CARRIER_ID",
        "PAYEE_CARRIER_ID" AS "PAYEE_CARRIER_ID",
        "SCNDR_CARRIER_ID" AS "SCNDR_CARRIER_ID",
        "BROKER_CARRIER_ID" AS "BROKER_CARRIER_ID",
        "ASSIGNED_SCNDR_CARRIER_ID" AS "ASSIGNED_SCNDR_CARRIER_ID",
        "DSG_SCNDR_CARRIER_ID" AS "DSG_SCNDR_CARRIER_ID",
        "ASSIGNED_BROKER_CARRIER_ID" AS "ASSIGNED_BROKER_CARRIER_ID",
        "LH_PAYEE_CARRIER_ID" AS "LH_PAYEE_CARRIER_ID",
        "REC_BROKER_CARRIER_ID" AS "REC_BROKER_CARRIER_ID",
        "ASSIGNED_EQUIPMENT_ID" AS "ASSIGNED_EQUIPMENT_ID",
        "DSG_EQUIPMENT_ID" AS "DSG_EQUIPMENT_ID",
        "FEASIBLE_EQUIPMENT_ID" AS "FEASIBLE_EQUIPMENT_ID",
        "FEASIBLE_EQUIPMENT2_ID" AS "FEASIBLE_EQUIPMENT2_ID",
        "REC_EQUIPMENT_ID" AS "REC_EQUIPMENT_ID",
        "ASSIGNED_MOT_ID" AS "ASSIGNED_MOT_ID",
        "DSG_MOT_ID" AS "DSG_MOT_ID",
        "FEASIBLE_MOT_ID" AS "FEASIBLE_MOT_ID",
        "REC_MOT_ID" AS "REC_MOT_ID",
        "PRODUCT_CLASS_ID" AS "PRODUCT_CLASS_ID",
        "PROTECTION_LEVEL_ID" AS "PROTECTION_LEVEL_ID",
        "ASSIGNED_SERVICE_LEVEL_ID" AS "ASSIGNED_SERVICE_LEVEL_ID",
        "DSG_SERVICE_LEVEL_ID" AS "DSG_SERVICE_LEVEL_ID",
        "FEASIBLE_SERVICE_LEVEL_ID" AS "FEASIBLE_SERVICE_LEVEL_ID",
        "REC_SERVICE_LEVEL_ID" AS "REC_SERVICE_LEVEL_ID",
        "HAS_EM_NOTIFY_FLAG" AS "HAS_EM_NOTIFY_FLAG",
        "REGION_ID" AS "REGION_ID",
        "INBOUND_REGION_ID" AS "INBOUND_REGION_ID",
        "OUTBOUND_REGION_ID" AS "OUTBOUND_REGION_ID",
        "FINANCIAL_WT" AS "FINANCIAL_WT",
        "IS_BOOKING_REQUIRED" AS "IS_BOOKING_REQUIRED",
        "TOTAL_COST_EXCL_TAX" AS "TOTAL_COST_EXCL_TAX",
        "TOTAL_TAX_AMOUNT" AS "TOTAL_TAX_AMOUNT",
        "IS_ASSOCIATED_TO_OUTBOUND" AS "IS_ASSOCIATED_TO_OUTBOUND",
        "RECEIVED_DTTM" AS "RECEIVED_DTTM",
        "BOOKING_ID" AS "BOOKING_ID",
        "IS_MISROUTED" AS "IS_MISROUTED",
        "FEASIBLE_CARRIER_CODE" AS "FEASIBLE_CARRIER_CODE",
        "SHIPMENT_WIN_ADJ_FLAG" AS "SHIPMENT_WIN_ADJ_FLAG",
        "DT_PARAM_SET_ID" AS "DT_PARAM_SET_ID",
        "MERCHANDIZING_DEPARTMENT_ID" AS "MERCHANDIZING_DEPARTMENT_ID",
        "STATIC_ROUTE_ID" AS "STATIC_ROUTE_ID",
        "IS_FILO" AS "IS_FILO",
        "IS_COOLER_AT_NOSE" AS "IS_COOLER_AT_NOSE",
        "AUTH_NBR" AS "AUTH_NBR",
        "CONS_LOCN_ID" AS "CONS_LOCN_ID",
        "RTE_TYPE" AS "RTE_TYPE",
        "TRLR_TYPE" AS "TRLR_TYPE",
        "TRLR_SIZE" AS "TRLR_SIZE",
        "CONS_ADDR_CODE" AS "CONS_ADDR_CODE",
        "HUB_ID" AS "HUB_ID",
        "TRLR_GEN_CODE" AS "TRLR_GEN_CODE",
        "MAX_NBR_OF_CTNS" AS "MAX_NBR_OF_CTNS",
        "APPT_DOOR_SCHED_TYPE" AS "APPT_DOOR_SCHED_TYPE",
        "CREATED_SOURCE_TYPE" AS "CREATED_SOURCE_TYPE",
        "CREATED_SOURCE" AS "CREATED_SOURCE",
        "CREATED_DTTM" AS "CREATED_DTTM",
        "LAST_UPDATED_SOURCE_TYPE" AS "LAST_UPDATED_SOURCE_TYPE",
        "LAST_UPDATED_SOURCE" AS "LAST_UPDATED_SOURCE",
        "LAST_UPDATED_DTTM" AS "LAST_UPDATED_DTTM",
        "DSG_SCNDR_CARRIER_CODE" AS "DSG_SCNDR_CARRIER_CODE",
        "LH_PAYEE_CARRIER_CODE" AS "LH_PAYEE_CARRIER_CODE",
        "REC_BROKER_CARRIER_CODE" AS "REC_BROKER_CARRIER_CODE",
        "REC_CARRIER_CODE" AS "REC_CARRIER_CODE",
        "LPN_ASSIGNMENT_STOPPED" AS "LPN_ASSIGNMENT_STOPPED",
        "SEAL_NUMBER" AS "SEAL_NUMBER",
        "HIBERNATE_VERSION" AS "HIBERNATE_VERSION",
        "SHIP_GROUP_ID" AS "SHIP_GROUP_ID",
        "RATE" AS "RATE",
        "MONETARY_VALUE" AS "MONETARY_VALUE",
        "DOOR" AS "DOOR",
        "RTE_TYPE_1" AS "RTE_TYPE_1",
        "RTE_TYPE_2" AS "RTE_TYPE_2",
        "SCHEDULED_PICKUP_DTTM" AS "SCHEDULED_PICKUP_DTTM",
        "MANIFEST_ID" AS "MANIFEST_ID",
        "DAYS_TO_DELIVER" AS "DAYS_TO_DELIVER",
        "SED_GENERATED_FLAG" AS "SED_GENERATED_FLAG",
        "SERV_AREA_CODE" AS "SERV_AREA_CODE",
        "TENDER_RESP_DEADLINE_DTTM" AS "TENDER_RESP_DEADLINE_DTTM",
        "PRINT_CONS_BOL" AS "PRINT_CONS_BOL",
        "LEFT_WT" AS "LEFT_WT",
        "RIGHT_WT" AS "RIGHT_WT",
        "LANE_NAME" AS "LANE_NAME",
        "DECLARED_VALUE" AS "DECLARED_VALUE",
        "DV_CURRENCY_CODE" AS "DV_CURRENCY_CODE",
        "COD_AMOUNT" AS "COD_AMOUNT",
        "CUSTOMER_ID" AS "CUSTOMER_ID",
        "CUST_FRGT_CHARGE" AS "CUST_FRGT_CHARGE",
        "COD_CURRENCY_CODE" AS "COD_CURRENCY_CODE",
        "PLANNED_WEIGHT" AS "PLANNED_WEIGHT",
        "WEIGHT_UOM_ID_BASE" AS "WEIGHT_UOM_ID_BASE",
        "PLANNED_VOLUME" AS "PLANNED_VOLUME",
        "VOLUME_UOM_ID_BASE" AS "VOLUME_UOM_ID_BASE",
        "SIZE1_VALUE" AS "SIZE1_VALUE",
        "SIZE1_UOM_ID" AS "SIZE1_UOM_ID",
        "SIZE2_VALUE" AS "SIZE2_VALUE",
        "SIZE2_UOM_ID" AS "SIZE2_UOM_ID",
        "ASSIGNED_SHIP_VIA" AS "ASSIGNED_SHIP_VIA",
        "INSURANCE_STATUS" AS "INSURANCE_STATUS",
        "RTE_SWC_NBR" AS "RTE_SWC_NBR",
        "RTE_TO" AS "RTE_TO",
        "BILL_OF_LADING_NUMBER" AS "BILL_OF_LADING_NUMBER",
        "TRAILER_NUMBER" AS "TRAILER_NUMBER",
        "TRANS_PLAN_OWNER" AS "TRANS_PLAN_OWNER",
        "TOTAL_REVENUE_CURRENCY_CODE" AS "TOTAL_REVENUE_CURRENCY_CODE",
        "TOTAL_REVENUE" AS "TOTAL_REVENUE",
        "FRT_REV_SPOT_CHARGE_CURR_CODE" AS "FRT_REV_SPOT_CHARGE_CURR_CODE",
        "NORMALIZED_TOTAL_REVENUE" AS "NORMALIZED_TOTAL_REVENUE",
        "FRT_REV_SPOT_CHARGE" AS "FRT_REV_SPOT_CHARGE",
        "DSG_VOYAGE_FLIGHT" AS "DSG_VOYAGE_FLIGHT",
        "FEASIBLE_VOYAGE_FLIGHT" AS "FEASIBLE_VOYAGE_FLIGHT",
        "CURRENCY_DTTM" AS "CURRENCY_DTTM",
        "FRT_REV_LINEHAUL_CHARGE" AS "FRT_REV_LINEHAUL_CHARGE",
        "FRT_REV_STOP_CHARGE" AS "FRT_REV_STOP_CHARGE",
        "FRT_REV_ACCESSORIAL_CHARGE" AS "FRT_REV_ACCESSORIAL_CHARGE",
        "MARGIN" AS "MARGIN",
        "TOTAL_COST" AS "TOTAL_COST",
        "INCOTERM_ID" AS "INCOTERM_ID",
        "ORDER_QTY" AS "ORDER_QTY",
        "QTY_UOM_ID" AS "QTY_UOM_ID",
        "REF_SHIPMENT_NBR" AS "REF_SHIPMENT_NBR",
        "STAGING_LOCN_ID" AS "STAGING_LOCN_ID",
        "LOADING_SEQ_ORD" AS "LOADING_SEQ_ORD",
        "HAZMAT_CERT_CONTACT" AS "HAZMAT_CERT_CONTACT",
        "HAZMAT_CERT_DECLARATION" AS "HAZMAT_CERT_DECLARATION",
        "CDC_TIMESTAMP" AS "CDC_TIMESTAMP",
        "OPERATION_TYPE" AS "OPERATION_TYPE",
        "ARCHIVED_DTTM" AS "ARCHIVED_DTTM",
        "ORIGIN" AS "ORIGIN",
        "FINAL_DESTINATION" AS "FINAL_DESTINATION",
        "actual_delivery_date_parsed" AS "actual_delivery_date_parsed",
        "wood_pellet" AS "wood_pellet",
        "act_del_MERCH_YEAR" AS "act_del_MERCH_YEAR",
        "act_del_YEAR_WEEK" AS "act_del_YEAR_WEEK",
        "act_del_YEAR_QUARTER" AS "act_del_YEAR_QUARTER",
        "act_del_YEAR_PERIOD" AS "act_del_YEAR_PERIOD",
        "invoice_shipping_id" AS "invoice_shipping_id",
        "org_Facility_Code" AS "org_Facility_Code",
        "org_Facility_Name" AS "org_Facility_Name",
        "org_Facility_Type" AS "org_Facility_Type",
        "dest_Facility_Code" AS "dest_Facility_Code",
        "dest_Facility_Name" AS "dest_Facility_Name",
        "dest_Facility_Type" AS "dest_Facility_Type",
        "inbound_flag" AS "inbound_flag",
        "order_id_po" AS "order_id_po",
        "order_id_po_int" AS "order_id_po_int",
        "po_STORE_NO" AS "po_STORE_NO",
        "po_CO_CODE" AS "po_CO_CODE",
        "po_ARTICLE_NO" AS "po_ARTICLE_NO",
        "po_PO_NO" AS "po_PO_NO",
        "po_PO_LINE_NO" AS "po_PO_LINE_NO",
        "po_PO_DATE" AS "po_PO_DATE",
        "po_po_date_parsed" AS "po_po_date_parsed",
        "po_DELIV_DATE" AS "po_DELIV_DATE",
        "po_deliv_date_parsed" AS "po_deliv_date_parsed",
        "po_PO_TYPE_CODE" AS "po_PO_TYPE_CODE",
        "po_VENDOR_ID" AS "po_VENDOR_ID",
        "po_VSR_CODE" AS "po_VSR_CODE",
        "po_PO_LINE_CANCELLED_FLAG" AS "po_PO_LINE_CANCELLED_FLAG",
        "po_PO_LINE_ORDER_QTY" AS "po_PO_LINE_ORDER_QTY",
        "po_PO_LINE_ISSUE_QTY" AS "po_PO_LINE_ISSUE_QTY",
        "po_PO_LINE_RCVD_QTY" AS "po_PO_LINE_RCVD_QTY",
        "po_PO_LINE_UNIT_PRICE" AS "po_PO_LINE_UNIT_PRICE",
        "po_DC_NO" AS "po_DC_NO",
        "po_PO_TRACKING_NO" AS "po_PO_TRACKING_NO",
        "po_PO_LINE_TRACKING_NO" AS "po_PO_LINE_TRACKING_NO",
        "po_CURRENT_REPL_TYPE_CODE" AS "po_CURRENT_REPL_TYPE_CODE",
        "po_FREIGHT_TYPE_CODE" AS "po_FREIGHT_TYPE_CODE",
        "po_SHIP_START_DATE" AS "po_SHIP_START_DATE",
        "po_SHIP_END_DATE" AS "po_SHIP_END_DATE",
        "po_DELIV_START_DATE" AS "po_DELIV_START_DATE",
        "po_DELIV_END_DATE" AS "po_DELIV_END_DATE",
        "po_PO_LINE_UNIT_FREIGHT_AMT" AS "po_PO_LINE_UNIT_FREIGHT_AMT",
        "po_PO_LINE_MANUFACTURER" AS "po_PO_LINE_MANUFACTURER",
        "po_PO_LINE_ORIGIN_COUNTRY_CODE" AS "po_PO_LINE_ORIGIN_COUNTRY_CODE",
        "po_PO_LINE_PORT_OF_ORIGIN" AS "po_PO_LINE_PORT_OF_ORIGIN",
        "po_PO_LINE_MIN_RCVD_DATE" AS "po_PO_LINE_MIN_RCVD_DATE",
        "po_PO_LINE_MAX_RCVD_DATE" AS "po_PO_LINE_MAX_RCVD_DATE",
        "po_PO_LINE_DELIVERED_FLAG" AS "po_PO_LINE_DELIVERED_FLAG",
        "po_PO_LINE_CONFIRMED_ON_BOARD_DATE" AS "po_PO_LINE_CONFIRMED_ON_BOARD_DATE",
        "po_PO_LINE_BOOKED_FOR_SHIPMENT_DATE" AS "po_PO_LINE_BOOKED_FOR_SHIPMENT_DATE",
        "po_PO_LINE_TRANSIT_RESN_CODE" AS "po_PO_LINE_TRANSIT_RESN_CODE",
        "po_PO_LINE_MOVE_TYPE_CODE" AS "po_PO_LINE_MOVE_TYPE_CODE",
        "po_PO_LINE_AGENT_COMMISSION_RATE" AS "po_PO_LINE_AGENT_COMMISSION_RATE",
        "po_PO_LINE_AGENT_COMMISSION_AMT" AS "po_PO_LINE_AGENT_COMMISSION_AMT",
        "po_PO_LINE_ADDL_ARTICLE_NO" AS "po_PO_LINE_ADDL_ARTICLE_NO",
        "po_PO_LINE_ADDL_ARTICLE_QTY" AS "po_PO_LINE_ADDL_ARTICLE_QTY",
        "po_PO_LINE_FACTORY_VENDOR_ID" AS "po_PO_LINE_FACTORY_VENDOR_ID",
        "po_PO_LINE_STUFFING_LOC_VENDOR_ID" AS "po_PO_LINE_STUFFING_LOC_VENDOR_ID",
        "po_PO_LINE_SOURCING_AGENT_VENDOR_ID" AS "po_PO_LINE_SOURCING_AGENT_VENDOR_ID",
        "po_PO_LINE_FREIGHT_FORWARDER_VENDOR_ID" AS "po_PO_LINE_FREIGHT_FORWARDER_VENDOR_ID",
        "po_PO_LINE_LETTER_OF_CREDIT_NO" AS "po_PO_LINE_LETTER_OF_CREDIT_NO",
        "po_PO_LINE_OPEN_ACCT_NO" AS "po_PO_LINE_OPEN_ACCT_NO",
        "po_PO_LINE_ARTICLE_LENGTH" AS "po_PO_LINE_ARTICLE_LENGTH",
        "po_PO_LINE_ARTICLE_WIDTH" AS "po_PO_LINE_ARTICLE_WIDTH",
        "po_PO_LINE_ARTICLE_HEIGHT" AS "po_PO_LINE_ARTICLE_HEIGHT",
        "po_PO_LINE_ARTICLE_DIMENSIONS_UOM" AS "po_PO_LINE_ARTICLE_DIMENSIONS_UOM",
        "po_PO_LINE_ARTICLE_WEIGHT" AS "po_PO_LINE_ARTICLE_WEIGHT",
        "po_PO_LINE_ARTICLE_WEIGHT_UOM" AS "po_PO_LINE_ARTICLE_WEIGHT_UOM",
        "po_PO_TOTAL_WEIGHT" AS "po_PO_TOTAL_WEIGHT",
        "po_PO_LINE_ARTICLE_VOLUME" AS "po_PO_LINE_ARTICLE_VOLUME",
        "po_PO_LINE_ARTICLE_VOLUME_UOM" AS "po_PO_LINE_ARTICLE_VOLUME_UOM",
        "po_PO_TOTAL_VOLUME" AS "po_PO_TOTAL_VOLUME",
        "po_HTS_CODE" AS "po_HTS_CODE",
        "po_PO_LINE_DUTY_RATE" AS "po_PO_LINE_DUTY_RATE",
        "po_PO_LINE_DUTY_AMT" AS "po_PO_LINE_DUTY_AMT",
        "po_PO_LINE_ADDL_HTS_CODE_1" AS "po_PO_LINE_ADDL_HTS_CODE_1",
        "po_PO_LINE_ADDL_DUTY_RATE_1" AS "po_PO_LINE_ADDL_DUTY_RATE_1",
        "po_PO_LINE_ADDL_DUTY_AMT_1" AS "po_PO_LINE_ADDL_DUTY_AMT_1",
        "po_PO_LINE_ADDL_HTS_CODE_2" AS "po_PO_LINE_ADDL_HTS_CODE_2",
        "po_PO_LINE_ADDL_DUTY_RATE_2" AS "po_PO_LINE_ADDL_DUTY_RATE_2",
        "po_PO_LINE_ADDL_DUTY_AMT_2" AS "po_PO_LINE_ADDL_DUTY_AMT_2",
        "po_PO_HELD_FLAG" AS "po_PO_HELD_FLAG",
        "po_PO_VENDOR_DOC_DATE" AS "po_PO_VENDOR_DOC_DATE",
        "po_cal_MERCH_YEAR" AS "po_cal_MERCH_YEAR",
        "po_cal_YEAR_WEEK" AS "po_cal_YEAR_WEEK",
        "po_cal_YEAR_QUARTER" AS "po_cal_YEAR_QUARTER",
        "po_cal_YEAR_PERIOD" AS "po_cal_YEAR_PERIOD",
        "a_ARTICLE_LENGTH" AS "a_ARTICLE_LENGTH",
        "a_ARTICLE_WIDTH" AS "a_ARTICLE_WIDTH",
        "a_ARTICLE_HEIGHT" AS "a_ARTICLE_HEIGHT",
        "item_volume" AS "item_volume",
        "a_ARTICLE_WEIGHT" AS "a_ARTICLE_WEIGHT",
        "item_weight" AS "item_weight",
        "a_ARTICLE_SIZE" AS "a_ARTICLE_SIZE",
        "a_ARTICLE_40HC_QTY" AS "a_ARTICLE_40HC_QTY",
        "a_ARTICLE_40GP_QTY" AS "a_ARTICLE_40GP_QTY",
        "item_volume_sum" AS "item_volume_sum",
        "allocation_by_vol" AS "allocation_by_vol",
        "item_weight_sum" AS "item_weight_total",
        "allocation_by_wgt" AS "allocation_by_wgt",
        "max_volume" AS "max_volume",
        "max_weight" AS "max_weight",
        "weight_volume_flag" AS "weight_volume_flag",
        "allocation_final" AS "allocation_final",
        SUM("item_weight") OVER (PARTITION BY "po_PO_NO") AS "item_weight_sum"
      FROM "TLM_SHIPMENT_JOINED_PO_ALLOCATION"
    )"dku")
    SELECT 
    "SHIPMENT_ID",
    "TC_COMPANY_ID",
    "RS_AREA_ID",
    "TC_SHIPMENT_ID",
    "PP_SHIPMENT_ID",
    "SHIPMENT_STATUS",
    "UPDATE_SENT",
    "BUSINESS_PROCESS",
    "CREATION_TYPE",
    "CONS_RUN_ID",
    "IS_CANCELLED",
    "RS_TYPE",
    "RS_CONFIG_ID",
    "RS_CONFIG_CYCLE_ID",
    "CONFIG_CYCLE_SEQ",
    "CYCLE_DEADLINE_DTTM",
    "CYCLE_EXECUTION_DTTM",
    "LAST_RS_NOTIFICATION_DTTM",
    "CFMF_STATUS",
    "AVAILABLE_DTTM",
    "CMID",
    "CM_DISCOUNT",
    "O_FACILITY_NUMBER",
    "O_FACILITY_ID",
    "O_ADDRESS",
    "O_CITY",
    "O_STATE_PROV",
    "O_POSTAL_CODE",
    "O_COUNTY",
    "O_COUNTRY_CODE",
    "D_FACILITY_NUMBER",
    "D_FACILITY_ID",
    "D_ADDRESS",
    "D_CITY",
    "D_STATE_PROV",
    "D_POSTAL_CODE",
    "D_COUNTY",
    "D_COUNTRY_CODE",
    "DISTANCE",
    "DIRECT_DISTANCE",
    "OUT_OF_ROUTE_DISTANCE",
    "DISTANCE_UOM",
    "BUSINESS_PARTNER_ID",
    "COMMODITY_CLASS",
    "IS_HAZMAT",
    "IS_PERISHABLE",
    "BILLING_METHOD",
    "DSG_CARRIER_CODE",
    "REC_CMID",
    "REC_CM_SHIPMENT_ID",
    "ASSIGNED_CARRIER_CODE",
    "SHIPMENT_REF_ID",
    "BILL_TO_CODE",
    "BILL_TO_TITLE",
    "BILL_TO_NAME",
    "BILL_TO_ADDRESS",
    "BILL_TO_CITY",
    "BILL_TO_STATE_PROV",
    "BILL_TO_POSTAL_CODE",
    "BILL_TO_COUNTRY_CODE",
    "BILL_TO_PHONE_NUMBER",
    "PURCHASE_ORDER",
    "PRO_NUMBER",
    "TRANS_RESP_CODE",
    "BASELINE_COST",
    "ESTIMATED_COST",
    "LINEHAUL_COST",
    "ACCESSORIAL_COST",
    "STOP_COST",
    "ESTIMATED_SAVINGS",
    "SPOT_CHARGE",
    "CURRENCY_CODE",
    "PICKUP_START_DTTM",
    "PICKUP_END_DTTM",
    "DELIVERY_START_DTTM",
    "DELIVERY_END_DTTM",
    "NUM_STOPS",
    "NUM_DOCKS",
    "ON_TIME_INDICATOR",
    "HAS_NOTES",
    "HAS_ALERTS",
    "HAS_IMPORT_ERROR",
    "HAS_SOFT_CHECK_ERROR",
    "HAS_TRACKING_MSG",
    "TRACKING_MSG_PROBLEM",
    "REC_LINEHAUL_COST",
    "REC_ACCESSORIAL_COST",
    "REC_TOTAL_COST",
    "CYCLE_RESP_DEADLINE_TZ",
    "TENDER_RESP_DEADLINE_TZ",
    "PICKUP_TZ",
    "DELIVERY_TZ",
    "ASSIGNED_LANE_ID",
    "ASSIGNED_LANE_DETAIL_ID",
    "REC_SPOT_CHARGE",
    "REC_LANE_ID",
    "REC_LANE_DETAIL_ID",
    "TENDER_DTTM",
    "O_STOP_LOCATION_NAME",
    "D_STOP_LOCATION_NAME",
    "ASSIGNED_CM_SHIPMENT_ID",
    "REC_CM_DISCOUNT",
    "REC_STOP_COST",
    "LAST_SELECTOR_RUN_DTTM",
    "LAST_CM_OPTION_GEN_DTTM",
    "IS_CM_OPTION_GEN_ACTIVE",
    "RS_CYCLE_REMAINING",
    "IS_TIME_FEAS_ENABLED",
    "EXT_SYS_SHIPMENT_ID",
    "EXTRACTION_DTTM",
    "ASSIGNED_BROKER_CARRIER_CODE",
    "USE_BROKER_AS_CARRIER",
    "BROKER_REF",
    "RATING_QUALIFIER",
    "STATUS_CHANGE_DTTM",
    "BUDG_TOTAL_COST",
    "NORMALIZED_MARGIN",
    "NORMALIZED_TOTAL_COST",
    "BUDG_NORMALIZED_TOTAL_COST",
    "REC_BUDG_LINEHAUL_COST",
    "REC_BUDG_STOP_COST",
    "REC_BUDG_CM_DISCOUNT",
    "REC_BUDG_ACCESSORIAL_COST",
    "REC_BUDG_TOTAL_COST",
    "REC_MARGIN",
    "REC_NORMALIZED_MARGIN",
    "REC_NORMALIZED_TOTAL_COST",
    "REC_BUDG_NORMALIZED_TOTAL_COST",
    "BUDG_CURRENCY_CODE",
    "SPOT_CHARGE_CURRENCY_CODE",
    "REC_CURRENCY_CODE",
    "REC_BUDG_CURRENCY_CODE",
    "REC_SPOT_CHARGE_CURRENCY_CODE",
    "RATING_LANE_ID",
    "FRT_REV_RATING_LANE_ID",
    "REC_RATING_LANE_ID",
    "REC_BUDG_RATING_LANE_ID",
    "RATING_LANE_DETAIL_ID",
    "FRT_REV_RATING_LANE_DETAIL_ID",
    "REC_RATING_LANE_DETAIL_ID",
    "REC_BUDG_RATING_LANE_DETAIL_ID",
    "BUDG_CM_DISCOUNT",
    "NORMALIZED_BASELINE_COST",
    "BASELINE_COST_CURRENCY_CODE",
    "REPORTED_COST",
    "TRACTOR_NUMBER",
    "IS_AUTO_DELIVERED",
    "SHIPMENT_TYPE",
    "ORIG_BUDG_TOTAL_COST",
    "ACCESSORIAL_COST_TO_CARRIER",
    "CARRIER_CHARGE",
    "ACTUAL_COST",
    "EARNED_INCOME",
    "SENT_TO_PKMS",
    "IS_SHIPMENT_RECONCILED",
    "DELIVERY_REQ",
    "DROPOFF_PICKUP",
    "PACKAGING",
    "SENT_TO_PKMS_DTTM",
    "WMS_STATUS_CODE",
    "SPOT_CHARGE_AND_PAYEE_ACC",
    "SPOT_CHARGE_AND_PAYEE_ACC_CC",
    "NORM_SPOT_CHARGE_AND_PAYEE_ACC",
    "FACILITY_SCHEDULE_ID",
    "EARNED_INCOME_CURRENCY_CODE",
    "ACTUAL_COST_CURRENCY_CODE",
    "SHIPMENT_RECON_DTTM",
    "PLN_RATING_LANE_ID",
    "PLN_RATING_LANE_DETAIL_ID",
    "PLN_TOTAL_COST",
    "PLN_LINEHAUL_COST",
    "PLN_TOTAL_ACCESSORIAL_COST",
    "PLN_STOP_OFF_COST",
    "PLN_NORMALIZED_TOTAL_COST",
    "PLN_CURRENCY_CODE",
    "PLN_ACCESSORL_COST_TO_CARRIER",
    "PLN_CARRIER_CHARGE",
    "WAYPOINT_TOTAL_COST",
    "WAYPOINT_HANDLING_COST",
    "GRS_OPERATION",
    "IS_GRS_OPT_CYCLE_RUNNING",
    "IS_MANUAL_ASSIGN",
    "LAST_RUN_GRS_DTTM",
    "GRS_MAX_SHIPMENT_STATUS",
    "PRIORITY_TYPE",
    "MV_CURRENCY_CODE",
    "PROD_SCHED_REF_NUMBER",
    "COMMODITY_CODE_ID",
    "UN_NUMBER_ID",
    "CONTRACT_NUMBER",
    "BOOKING_REF_SHIPPER",
    "BOOKING_REF_CARRIER",
    "BK_RESOURCE_REF_EXTERNAL",
    "BK_RESOURCE_NAME_EXTERNAL",
    "BK_O_FACILITY_ID",
    "BK_D_FACILITY_ID",
    "BK_MASTER_AIRWAY_BILL",
    "BK_FORWARDER_AIRWAY_BILL",
    "ASSIGNED_SCNDR_CARRIER_CODE",
    "CUSTOMER_CREDIT_LIMIT_ID",
    "SHIPMENT_LEG_TYPE",
    "SHIPMENT_CLOSED_INDICATOR",
    "OCEAN_ROUTING_STAGE",
    "BK_DEPARTURE_DTTM",
    "BK_DEPARTURE_TZ",
    "BK_ARRIVAL_DTTM",
    "BK_ARRIVAL_TZ",
    "BK_PICKUP_DTTM",
    "BK_PICKUP_TZ",
    "BK_CUTOFF_DTTM",
    "BK_CUTOFF_TZ",
    "NUM_CHARGE_LAYOVERS",
    "RATE_TYPE",
    "RATE_UOM",
    "PICK_START_DTTM",
    "PAPERWORK_START_DTTM",
    "VEHICLE_CHECK_START_DTTM",
    "SHIPMENT_START_DTTM",
    "SHIPMENT_END_DTTM",
    "FEASIBLE_DRIVER_TYPE",
    "WAVE_ID",
    "ESTIMATED_DISPATCH_DTTM",
    "TOTAL_TIME",
    "LOC_REFERENCE",
    "BK_O_FACILITY_ALIAS_ID",
    "BK_D_FACILITY_ALIAS_ID",
    "EQUIP_UTIL_PER",
    "MOVE_TYPE",
    "DRIVER_TYPE_ID",
    "EQUIPMENT_TYPE",
    "RADIAL_DISTANCE",
    "RADIAL_DISTANCE_UOM",
    "DESIGNATED_TRACTOR_CODE",
    "DESIGNATED_DRIVER_TYPE",
    "IS_WAVE_MAN_CHANGED",
    "RETAIN_CONSOLIDATOR_TIMES",
    "TARIFF",
    "MIN_RATE",
    "FIRST_UPDATE_SENT_TO_PKMS",
    "EVENT_IND_TYPEID",
    "TANDEM_PATH_ID",
    "O_TANDEM_FACILITY",
    "D_TANDEM_FACILITY",
    "O_TANDEM_FACILITY_ALIAS",
    "D_TANDEM_FACILITY_ALIAS",
    "DELAY_TYPE",
    "ASSIGNED_CARRIER_ID",
    "DSG_CARRIER_ID",
    "REC_CARRIER_ID",
    "FEASIBLE_CARRIER_ID",
    "PAYEE_CARRIER_ID",
    "SCNDR_CARRIER_ID",
    "BROKER_CARRIER_ID",
    "ASSIGNED_SCNDR_CARRIER_ID",
    "DSG_SCNDR_CARRIER_ID",
    "ASSIGNED_BROKER_CARRIER_ID",
    "LH_PAYEE_CARRIER_ID",
    "REC_BROKER_CARRIER_ID",
    "ASSIGNED_EQUIPMENT_ID",
    "DSG_EQUIPMENT_ID",
    "FEASIBLE_EQUIPMENT_ID",
    "FEASIBLE_EQUIPMENT2_ID",
    "REC_EQUIPMENT_ID",
    "ASSIGNED_MOT_ID",
    "DSG_MOT_ID",
    "FEASIBLE_MOT_ID",
    "REC_MOT_ID",
    "PRODUCT_CLASS_ID",
    "PROTECTION_LEVEL_ID",
    "ASSIGNED_SERVICE_LEVEL_ID",
    "DSG_SERVICE_LEVEL_ID",
    "FEASIBLE_SERVICE_LEVEL_ID",
    "REC_SERVICE_LEVEL_ID",
    "HAS_EM_NOTIFY_FLAG",
    "REGION_ID",
    "INBOUND_REGION_ID",
    "OUTBOUND_REGION_ID",
    "FINANCIAL_WT",
    "IS_BOOKING_REQUIRED",
    "TOTAL_COST_EXCL_TAX",
    "TOTAL_TAX_AMOUNT",
    "IS_ASSOCIATED_TO_OUTBOUND",
    "RECEIVED_DTTM",
    "BOOKING_ID",
    "IS_MISROUTED",
    "FEASIBLE_CARRIER_CODE",
    "SHIPMENT_WIN_ADJ_FLAG",
    "DT_PARAM_SET_ID",
    "MERCHANDIZING_DEPARTMENT_ID",
    "STATIC_ROUTE_ID",
    "IS_FILO",
    "IS_COOLER_AT_NOSE",
    "AUTH_NBR",
    "CONS_LOCN_ID",
    "RTE_TYPE",
    "TRLR_TYPE",
    "TRLR_SIZE",
    "CONS_ADDR_CODE",
    "HUB_ID",
    "TRLR_GEN_CODE",
    "MAX_NBR_OF_CTNS",
    "APPT_DOOR_SCHED_TYPE",
    "CREATED_SOURCE_TYPE",
    "CREATED_SOURCE",
    "CREATED_DTTM",
    "LAST_UPDATED_SOURCE_TYPE",
    "LAST_UPDATED_SOURCE",
    "LAST_UPDATED_DTTM",
    "DSG_SCNDR_CARRIER_CODE",
    "LH_PAYEE_CARRIER_CODE",
    "REC_BROKER_CARRIER_CODE",
    "REC_CARRIER_CODE",
    "LPN_ASSIGNMENT_STOPPED",
    "SEAL_NUMBER",
    "HIBERNATE_VERSION",
    "SHIP_GROUP_ID",
    "RATE",
    "MONETARY_VALUE",
    "DOOR",
    "RTE_TYPE_1",
    "RTE_TYPE_2",
    "SCHEDULED_PICKUP_DTTM",
    "MANIFEST_ID",
    "DAYS_TO_DELIVER",
    "SED_GENERATED_FLAG",
    "SERV_AREA_CODE",
    "TENDER_RESP_DEADLINE_DTTM",
    "PRINT_CONS_BOL",
    "LEFT_WT",
    "RIGHT_WT",
    "LANE_NAME",
    "DECLARED_VALUE",
    "DV_CURRENCY_CODE",
    "COD_AMOUNT",
    "CUSTOMER_ID",
    "CUST_FRGT_CHARGE",
    "COD_CURRENCY_CODE",
    "PLANNED_WEIGHT",
    "WEIGHT_UOM_ID_BASE",
    "PLANNED_VOLUME",
    "VOLUME_UOM_ID_BASE",
    "SIZE1_VALUE",
    "SIZE1_UOM_ID",
    "SIZE2_VALUE",
    "SIZE2_UOM_ID",
    "ASSIGNED_SHIP_VIA",
    "INSURANCE_STATUS",
    "RTE_SWC_NBR",
    "RTE_TO",
    "BILL_OF_LADING_NUMBER",
    "TRAILER_NUMBER",
    "TRANS_PLAN_OWNER",
    "TOTAL_REVENUE_CURRENCY_CODE",
    "TOTAL_REVENUE",
    "FRT_REV_SPOT_CHARGE_CURR_CODE",
    "NORMALIZED_TOTAL_REVENUE",
    "FRT_REV_SPOT_CHARGE",
    "DSG_VOYAGE_FLIGHT",
    "FEASIBLE_VOYAGE_FLIGHT",
    "CURRENCY_DTTM",
    "FRT_REV_LINEHAUL_CHARGE",
    "FRT_REV_STOP_CHARGE",
    "FRT_REV_ACCESSORIAL_CHARGE",
    "MARGIN",
    "TOTAL_COST",
    "INCOTERM_ID",
    "ORDER_QTY",
    "QTY_UOM_ID",
    "REF_SHIPMENT_NBR",
    "STAGING_LOCN_ID",
    "LOADING_SEQ_ORD",
    "HAZMAT_CERT_CONTACT",
    "HAZMAT_CERT_DECLARATION",
    "CDC_TIMESTAMP",
    "OPERATION_TYPE",
    "ARCHIVED_DTTM",
    "ORIGIN",
    "FINAL_DESTINATION",
    "actual_delivery_date_parsed",
    "wood_pellet",
    "act_del_MERCH_YEAR",
    "act_del_YEAR_WEEK",
    "act_del_YEAR_QUARTER",
    "act_del_YEAR_PERIOD",
    "invoice_shipping_id",
    "org_Facility_Code",
    "org_Facility_Name",
    "org_Facility_Type",
    "dest_Facility_Code",
    "dest_Facility_Name",
    "dest_Facility_Type",
    "inbound_flag",
    "order_id_po",
    "order_id_po_int",
    "po_STORE_NO",
    "po_CO_CODE",
    "po_ARTICLE_NO",
    "po_PO_NO",
    "po_PO_LINE_NO",
    "po_PO_DATE",
    "po_po_date_parsed",
    "po_DELIV_DATE",
    "po_deliv_date_parsed",
    "po_PO_TYPE_CODE",
    "po_VENDOR_ID",
    "po_VSR_CODE",
    "po_PO_LINE_CANCELLED_FLAG",
    "po_PO_LINE_ORDER_QTY",
    "po_PO_LINE_ISSUE_QTY",
    "po_PO_LINE_RCVD_QTY",
    "po_PO_LINE_UNIT_PRICE",
    "po_DC_NO",
    "po_PO_TRACKING_NO",
    "po_PO_LINE_TRACKING_NO",
    "po_CURRENT_REPL_TYPE_CODE",
    "po_FREIGHT_TYPE_CODE",
    "po_SHIP_START_DATE",
    "po_SHIP_END_DATE",
    "po_DELIV_START_DATE",
    "po_DELIV_END_DATE",
    "po_PO_LINE_UNIT_FREIGHT_AMT",
    "po_PO_LINE_MANUFACTURER",
    "po_PO_LINE_ORIGIN_COUNTRY_CODE",
    "po_PO_LINE_PORT_OF_ORIGIN",
    "po_PO_LINE_MIN_RCVD_DATE",
    "po_PO_LINE_MAX_RCVD_DATE",
    "po_PO_LINE_DELIVERED_FLAG",
    "po_PO_LINE_CONFIRMED_ON_BOARD_DATE",
    "po_PO_LINE_BOOKED_FOR_SHIPMENT_DATE",
    "po_PO_LINE_TRANSIT_RESN_CODE",
    "po_PO_LINE_MOVE_TYPE_CODE",
    "po_PO_LINE_AGENT_COMMISSION_RATE",
    "po_PO_LINE_AGENT_COMMISSION_AMT",
    "po_PO_LINE_ADDL_ARTICLE_NO",
    "po_PO_LINE_ADDL_ARTICLE_QTY",
    "po_PO_LINE_FACTORY_VENDOR_ID",
    "po_PO_LINE_STUFFING_LOC_VENDOR_ID",
    "po_PO_LINE_SOURCING_AGENT_VENDOR_ID",
    "po_PO_LINE_FREIGHT_FORWARDER_VENDOR_ID",
    "po_PO_LINE_LETTER_OF_CREDIT_NO",
    "po_PO_LINE_OPEN_ACCT_NO",
    "po_PO_LINE_ARTICLE_LENGTH",
    "po_PO_LINE_ARTICLE_WIDTH",
    "po_PO_LINE_ARTICLE_HEIGHT",
    "po_PO_LINE_ARTICLE_DIMENSIONS_UOM",
    "po_PO_LINE_ARTICLE_WEIGHT",
    "po_PO_LINE_ARTICLE_WEIGHT_UOM",
    "po_PO_TOTAL_WEIGHT",
    "po_PO_LINE_ARTICLE_VOLUME",
    "po_PO_LINE_ARTICLE_VOLUME_UOM",
    "po_PO_TOTAL_VOLUME",
    "po_HTS_CODE",
    "po_PO_LINE_DUTY_RATE",
    "po_PO_LINE_DUTY_AMT",
    "po_PO_LINE_ADDL_HTS_CODE_1",
    "po_PO_LINE_ADDL_DUTY_RATE_1",
    "po_PO_LINE_ADDL_DUTY_AMT_1",
    "po_PO_LINE_ADDL_HTS_CODE_2",
    "po_PO_LINE_ADDL_DUTY_RATE_2",
    "po_PO_LINE_ADDL_DUTY_AMT_2",
    "po_PO_HELD_FLAG",
    "po_PO_VENDOR_DOC_DATE",
    "po_cal_MERCH_YEAR",
    "po_cal_YEAR_WEEK",
    "po_cal_YEAR_QUARTER",
    "po_cal_YEAR_PERIOD",
    "a_ARTICLE_LENGTH",
    "a_ARTICLE_WIDTH",
    "a_ARTICLE_HEIGHT",
    "item_volume",
    "a_ARTICLE_WEIGHT",
    "item_weight",
    "a_ARTICLE_SIZE",
    "a_ARTICLE_40HC_QTY",
    "a_ARTICLE_40GP_QTY",
    "item_volume_sum",
    "allocation_by_vol",
    "item_weight_total",
    "allocation_by_wgt",
    "max_volume",
    "max_weight",
    "weight_volume_flag",
    "allocation_final",
    "po_weight_sum",
    CASE WHEN "po_weight_sum" < 150 AND "po_PO_NO" >= 1010000000 AND "po_PO_NO" <= 1049999999 AND (NOT ("po_VENDOR_ID" >= 570000 AND "po_VENDOR_ID" <= 579999) OR (("po_VENDOR_ID" >= 570000 AND "po_VENDOR_ID" <= 579999) IS NULL)) AND "po_PO_LINE_ORDER_QTY" > 0 AND ("po_FREIGHT_TYPE_CODE" = 'FCT') THEN 1 ELSE 0 END AS "small_package_flag"
  FROM CTE;

<br>               
--TLM_SHIPMENT_JOINED_PO_ALLOCATION_BY_ACT_DEL_YEAR_PERIOD
</br>
CREATE OR REPLACE TEMPORARY TABLE "TLM_SHIPMENT_JOINED_PO_ALLOCATION_BY_ACT_DEL_YEAR_PERIOD"
AS
WITH CTE AS (
    SELECT 
        "SHIPMENT_ID" AS "SHIPMENT_ID",
        "TC_COMPANY_ID" AS "TC_COMPANY_ID",
        "RS_AREA_ID" AS "RS_AREA_ID",
        "TC_SHIPMENT_ID" AS "TC_SHIPMENT_ID",
        "PP_SHIPMENT_ID" AS "PP_SHIPMENT_ID",
        "SHIPMENT_STATUS" AS "SHIPMENT_STATUS",
        "UPDATE_SENT" AS "UPDATE_SENT",
        "BUSINESS_PROCESS" AS "BUSINESS_PROCESS",
        "CREATION_TYPE" AS "CREATION_TYPE",
        "CONS_RUN_ID" AS "CONS_RUN_ID",
        "IS_CANCELLED" AS "IS_CANCELLED",
        "RS_TYPE" AS "RS_TYPE",
        "RS_CONFIG_ID" AS "RS_CONFIG_ID",
        "RS_CONFIG_CYCLE_ID" AS "RS_CONFIG_CYCLE_ID",
        "CONFIG_CYCLE_SEQ" AS "CONFIG_CYCLE_SEQ",
        "CYCLE_DEADLINE_DTTM" AS "CYCLE_DEADLINE_DTTM",
        "CYCLE_EXECUTION_DTTM" AS "CYCLE_EXECUTION_DTTM",
        "LAST_RS_NOTIFICATION_DTTM" AS "LAST_RS_NOTIFICATION_DTTM",
        "CFMF_STATUS" AS "CFMF_STATUS",
        "AVAILABLE_DTTM" AS "AVAILABLE_DTTM",
        "CMID" AS "CMID",
        "CM_DISCOUNT" AS "CM_DISCOUNT",
        "O_FACILITY_NUMBER" AS "O_FACILITY_NUMBER",
        "O_FACILITY_ID" AS "O_FACILITY_ID",
        "O_ADDRESS" AS "O_ADDRESS",
        "O_CITY" AS "O_CITY",
        "O_STATE_PROV" AS "O_STATE_PROV",
        "O_POSTAL_CODE" AS "O_POSTAL_CODE",
        "O_COUNTY" AS "O_COUNTY",
        "O_COUNTRY_CODE" AS "O_COUNTRY_CODE",
        "D_FACILITY_NUMBER" AS "D_FACILITY_NUMBER",
        "D_FACILITY_ID" AS "D_FACILITY_ID",
        "D_ADDRESS" AS "D_ADDRESS",
        "D_CITY" AS "D_CITY",
        "D_STATE_PROV" AS "D_STATE_PROV",
        "D_POSTAL_CODE" AS "D_POSTAL_CODE",
        "D_COUNTY" AS "D_COUNTY",
        "D_COUNTRY_CODE" AS "D_COUNTRY_CODE",
        "DISTANCE" AS "DISTANCE",
        "DIRECT_DISTANCE" AS "DIRECT_DISTANCE",
        "OUT_OF_ROUTE_DISTANCE" AS "OUT_OF_ROUTE_DISTANCE",
        "DISTANCE_UOM" AS "DISTANCE_UOM",
        "BUSINESS_PARTNER_ID" AS "BUSINESS_PARTNER_ID",
        "COMMODITY_CLASS" AS "COMMODITY_CLASS",
        "IS_HAZMAT" AS "IS_HAZMAT",
        "IS_PERISHABLE" AS "IS_PERISHABLE",
        "BILLING_METHOD" AS "BILLING_METHOD",
        "DSG_CARRIER_CODE" AS "DSG_CARRIER_CODE",
        "REC_CMID" AS "REC_CMID",
        "REC_CM_SHIPMENT_ID" AS "REC_CM_SHIPMENT_ID",
        "ASSIGNED_CARRIER_CODE" AS "ASSIGNED_CARRIER_CODE",
        "SHIPMENT_REF_ID" AS "SHIPMENT_REF_ID",
        "BILL_TO_CODE" AS "BILL_TO_CODE",
        "BILL_TO_TITLE" AS "BILL_TO_TITLE",
        "BILL_TO_NAME" AS "BILL_TO_NAME",
        "BILL_TO_ADDRESS" AS "BILL_TO_ADDRESS",
        "BILL_TO_CITY" AS "BILL_TO_CITY",
        "BILL_TO_STATE_PROV" AS "BILL_TO_STATE_PROV",
        "BILL_TO_POSTAL_CODE" AS "BILL_TO_POSTAL_CODE",
        "BILL_TO_COUNTRY_CODE" AS "BILL_TO_COUNTRY_CODE",
        "BILL_TO_PHONE_NUMBER" AS "BILL_TO_PHONE_NUMBER",
        "PURCHASE_ORDER" AS "PURCHASE_ORDER",
        "PRO_NUMBER" AS "PRO_NUMBER",
        "TRANS_RESP_CODE" AS "TRANS_RESP_CODE",
        "BASELINE_COST" AS "BASELINE_COST",
        "ESTIMATED_COST" AS "ESTIMATED_COST",
        "LINEHAUL_COST" AS "LINEHAUL_COST",
        "ACCESSORIAL_COST" AS "ACCESSORIAL_COST",
        "STOP_COST" AS "STOP_COST",
        "ESTIMATED_SAVINGS" AS "ESTIMATED_SAVINGS",
        "SPOT_CHARGE" AS "SPOT_CHARGE",
        "CURRENCY_CODE" AS "CURRENCY_CODE",
        "PICKUP_START_DTTM" AS "PICKUP_START_DTTM",
        "PICKUP_END_DTTM" AS "PICKUP_END_DTTM",
        "DELIVERY_START_DTTM" AS "DELIVERY_START_DTTM",
        "DELIVERY_END_DTTM" AS "DELIVERY_END_DTTM",
        "NUM_STOPS" AS "NUM_STOPS",
        "NUM_DOCKS" AS "NUM_DOCKS",
        "ON_TIME_INDICATOR" AS "ON_TIME_INDICATOR",
        "HAS_NOTES" AS "HAS_NOTES",
        "HAS_ALERTS" AS "HAS_ALERTS",
        "HAS_IMPORT_ERROR" AS "HAS_IMPORT_ERROR",
        "HAS_SOFT_CHECK_ERROR" AS "HAS_SOFT_CHECK_ERROR",
        "HAS_TRACKING_MSG" AS "HAS_TRACKING_MSG",
        "TRACKING_MSG_PROBLEM" AS "TRACKING_MSG_PROBLEM",
        "REC_LINEHAUL_COST" AS "REC_LINEHAUL_COST",
        "REC_ACCESSORIAL_COST" AS "REC_ACCESSORIAL_COST",
        "REC_TOTAL_COST" AS "REC_TOTAL_COST",
        "CYCLE_RESP_DEADLINE_TZ" AS "CYCLE_RESP_DEADLINE_TZ",
        "TENDER_RESP_DEADLINE_TZ" AS "TENDER_RESP_DEADLINE_TZ",
        "PICKUP_TZ" AS "PICKUP_TZ",
        "DELIVERY_TZ" AS "DELIVERY_TZ",
        "ASSIGNED_LANE_ID" AS "ASSIGNED_LANE_ID",
        "ASSIGNED_LANE_DETAIL_ID" AS "ASSIGNED_LANE_DETAIL_ID",
        "REC_SPOT_CHARGE" AS "REC_SPOT_CHARGE",
        "REC_LANE_ID" AS "REC_LANE_ID",
        "REC_LANE_DETAIL_ID" AS "REC_LANE_DETAIL_ID",
        "TENDER_DTTM" AS "TENDER_DTTM",
        "O_STOP_LOCATION_NAME" AS "O_STOP_LOCATION_NAME",
        "D_STOP_LOCATION_NAME" AS "D_STOP_LOCATION_NAME",
        "ASSIGNED_CM_SHIPMENT_ID" AS "ASSIGNED_CM_SHIPMENT_ID",
        "REC_CM_DISCOUNT" AS "REC_CM_DISCOUNT",
        "REC_STOP_COST" AS "REC_STOP_COST",
        "LAST_SELECTOR_RUN_DTTM" AS "LAST_SELECTOR_RUN_DTTM",
        "LAST_CM_OPTION_GEN_DTTM" AS "LAST_CM_OPTION_GEN_DTTM",
        "IS_CM_OPTION_GEN_ACTIVE" AS "IS_CM_OPTION_GEN_ACTIVE",
        "RS_CYCLE_REMAINING" AS "RS_CYCLE_REMAINING",
        "IS_TIME_FEAS_ENABLED" AS "IS_TIME_FEAS_ENABLED",
        "EXT_SYS_SHIPMENT_ID" AS "EXT_SYS_SHIPMENT_ID",
        "EXTRACTION_DTTM" AS "EXTRACTION_DTTM",
        "ASSIGNED_BROKER_CARRIER_CODE" AS "ASSIGNED_BROKER_CARRIER_CODE",
        "USE_BROKER_AS_CARRIER" AS "USE_BROKER_AS_CARRIER",
        "BROKER_REF" AS "BROKER_REF",
        "RATING_QUALIFIER" AS "RATING_QUALIFIER",
        "STATUS_CHANGE_DTTM" AS "STATUS_CHANGE_DTTM",
        "BUDG_TOTAL_COST" AS "BUDG_TOTAL_COST",
        "NORMALIZED_MARGIN" AS "NORMALIZED_MARGIN",
        "NORMALIZED_TOTAL_COST" AS "NORMALIZED_TOTAL_COST",
        "BUDG_NORMALIZED_TOTAL_COST" AS "BUDG_NORMALIZED_TOTAL_COST",
        "REC_BUDG_LINEHAUL_COST" AS "REC_BUDG_LINEHAUL_COST",
        "REC_BUDG_STOP_COST" AS "REC_BUDG_STOP_COST",
        "REC_BUDG_CM_DISCOUNT" AS "REC_BUDG_CM_DISCOUNT",
        "REC_BUDG_ACCESSORIAL_COST" AS "REC_BUDG_ACCESSORIAL_COST",
        "REC_BUDG_TOTAL_COST" AS "REC_BUDG_TOTAL_COST",
        "REC_MARGIN" AS "REC_MARGIN",
        "REC_NORMALIZED_MARGIN" AS "REC_NORMALIZED_MARGIN",
        "REC_NORMALIZED_TOTAL_COST" AS "REC_NORMALIZED_TOTAL_COST",
        "REC_BUDG_NORMALIZED_TOTAL_COST" AS "REC_BUDG_NORMALIZED_TOTAL_COST",
        "BUDG_CURRENCY_CODE" AS "BUDG_CURRENCY_CODE",
        "SPOT_CHARGE_CURRENCY_CODE" AS "SPOT_CHARGE_CURRENCY_CODE",
        "REC_CURRENCY_CODE" AS "REC_CURRENCY_CODE",
        "REC_BUDG_CURRENCY_CODE" AS "REC_BUDG_CURRENCY_CODE",
        "REC_SPOT_CHARGE_CURRENCY_CODE" AS "REC_SPOT_CHARGE_CURRENCY_CODE",
        "RATING_LANE_ID" AS "RATING_LANE_ID",
        "FRT_REV_RATING_LANE_ID" AS "FRT_REV_RATING_LANE_ID",
        "REC_RATING_LANE_ID" AS "REC_RATING_LANE_ID",
        "REC_BUDG_RATING_LANE_ID" AS "REC_BUDG_RATING_LANE_ID",
        "RATING_LANE_DETAIL_ID" AS "RATING_LANE_DETAIL_ID",
        "FRT_REV_RATING_LANE_DETAIL_ID" AS "FRT_REV_RATING_LANE_DETAIL_ID",
        "REC_RATING_LANE_DETAIL_ID" AS "REC_RATING_LANE_DETAIL_ID",
        "REC_BUDG_RATING_LANE_DETAIL_ID" AS "REC_BUDG_RATING_LANE_DETAIL_ID",
        "BUDG_CM_DISCOUNT" AS "BUDG_CM_DISCOUNT",
        "NORMALIZED_BASELINE_COST" AS "NORMALIZED_BASELINE_COST",
        "BASELINE_COST_CURRENCY_CODE" AS "BASELINE_COST_CURRENCY_CODE",
        "REPORTED_COST" AS "REPORTED_COST",
        "TRACTOR_NUMBER" AS "TRACTOR_NUMBER",
        "IS_AUTO_DELIVERED" AS "IS_AUTO_DELIVERED",
        "SHIPMENT_TYPE" AS "SHIPMENT_TYPE",
        "ORIG_BUDG_TOTAL_COST" AS "ORIG_BUDG_TOTAL_COST",
        "ACCESSORIAL_COST_TO_CARRIER" AS "ACCESSORIAL_COST_TO_CARRIER",
        "CARRIER_CHARGE" AS "CARRIER_CHARGE",
        "ACTUAL_COST" AS "ACTUAL_COST",
        "EARNED_INCOME" AS "EARNED_INCOME",
        "SENT_TO_PKMS" AS "SENT_TO_PKMS",
        "IS_SHIPMENT_RECONCILED" AS "IS_SHIPMENT_RECONCILED",
        "DELIVERY_REQ" AS "DELIVERY_REQ",
        "DROPOFF_PICKUP" AS "DROPOFF_PICKUP",
        "PACKAGING" AS "PACKAGING",
        "SENT_TO_PKMS_DTTM" AS "SENT_TO_PKMS_DTTM",
        "WMS_STATUS_CODE" AS "WMS_STATUS_CODE",
        "SPOT_CHARGE_AND_PAYEE_ACC" AS "SPOT_CHARGE_AND_PAYEE_ACC",
        "SPOT_CHARGE_AND_PAYEE_ACC_CC" AS "SPOT_CHARGE_AND_PAYEE_ACC_CC",
        "NORM_SPOT_CHARGE_AND_PAYEE_ACC" AS "NORM_SPOT_CHARGE_AND_PAYEE_ACC",
        "FACILITY_SCHEDULE_ID" AS "FACILITY_SCHEDULE_ID",
        "EARNED_INCOME_CURRENCY_CODE" AS "EARNED_INCOME_CURRENCY_CODE",
        "ACTUAL_COST_CURRENCY_CODE" AS "ACTUAL_COST_CURRENCY_CODE",
        "SHIPMENT_RECON_DTTM" AS "SHIPMENT_RECON_DTTM",
        "PLN_RATING_LANE_ID" AS "PLN_RATING_LANE_ID",
        "PLN_RATING_LANE_DETAIL_ID" AS "PLN_RATING_LANE_DETAIL_ID",
        "PLN_TOTAL_COST" AS "PLN_TOTAL_COST",
        "PLN_LINEHAUL_COST" AS "PLN_LINEHAUL_COST",
        "PLN_TOTAL_ACCESSORIAL_COST" AS "PLN_TOTAL_ACCESSORIAL_COST",
        "PLN_STOP_OFF_COST" AS "PLN_STOP_OFF_COST",
        "PLN_NORMALIZED_TOTAL_COST" AS "PLN_NORMALIZED_TOTAL_COST",
        "PLN_CURRENCY_CODE" AS "PLN_CURRENCY_CODE",
        "PLN_ACCESSORL_COST_TO_CARRIER" AS "PLN_ACCESSORL_COST_TO_CARRIER",
        "PLN_CARRIER_CHARGE" AS "PLN_CARRIER_CHARGE",
        "WAYPOINT_TOTAL_COST" AS "WAYPOINT_TOTAL_COST",
        "WAYPOINT_HANDLING_COST" AS "WAYPOINT_HANDLING_COST",
        "GRS_OPERATION" AS "GRS_OPERATION",
        "IS_GRS_OPT_CYCLE_RUNNING" AS "IS_GRS_OPT_CYCLE_RUNNING",
        "IS_MANUAL_ASSIGN" AS "IS_MANUAL_ASSIGN",
        "LAST_RUN_GRS_DTTM" AS "LAST_RUN_GRS_DTTM",
        "GRS_MAX_SHIPMENT_STATUS" AS "GRS_MAX_SHIPMENT_STATUS",
        "PRIORITY_TYPE" AS "PRIORITY_TYPE",
        "MV_CURRENCY_CODE" AS "MV_CURRENCY_CODE",
        "PROD_SCHED_REF_NUMBER" AS "PROD_SCHED_REF_NUMBER",
        "COMMODITY_CODE_ID" AS "COMMODITY_CODE_ID",
        "UN_NUMBER_ID" AS "UN_NUMBER_ID",
        "CONTRACT_NUMBER" AS "CONTRACT_NUMBER",
        "BOOKING_REF_SHIPPER" AS "BOOKING_REF_SHIPPER",
        "BOOKING_REF_CARRIER" AS "BOOKING_REF_CARRIER",
        "BK_RESOURCE_REF_EXTERNAL" AS "BK_RESOURCE_REF_EXTERNAL",
        "BK_RESOURCE_NAME_EXTERNAL" AS "BK_RESOURCE_NAME_EXTERNAL",
        "BK_O_FACILITY_ID" AS "BK_O_FACILITY_ID",
        "BK_D_FACILITY_ID" AS "BK_D_FACILITY_ID",
        "BK_MASTER_AIRWAY_BILL" AS "BK_MASTER_AIRWAY_BILL",
        "BK_FORWARDER_AIRWAY_BILL" AS "BK_FORWARDER_AIRWAY_BILL",
        "ASSIGNED_SCNDR_CARRIER_CODE" AS "ASSIGNED_SCNDR_CARRIER_CODE",
        "CUSTOMER_CREDIT_LIMIT_ID" AS "CUSTOMER_CREDIT_LIMIT_ID",
        "SHIPMENT_LEG_TYPE" AS "SHIPMENT_LEG_TYPE",
        "SHIPMENT_CLOSED_INDICATOR" AS "SHIPMENT_CLOSED_INDICATOR",
        "OCEAN_ROUTING_STAGE" AS "OCEAN_ROUTING_STAGE",
        "BK_DEPARTURE_DTTM" AS "BK_DEPARTURE_DTTM",
        "BK_DEPARTURE_TZ" AS "BK_DEPARTURE_TZ",
        "BK_ARRIVAL_DTTM" AS "BK_ARRIVAL_DTTM",
        "BK_ARRIVAL_TZ" AS "BK_ARRIVAL_TZ",
        "BK_PICKUP_DTTM" AS "BK_PICKUP_DTTM",
        "BK_PICKUP_TZ" AS "BK_PICKUP_TZ",
        "BK_CUTOFF_DTTM" AS "BK_CUTOFF_DTTM",
        "BK_CUTOFF_TZ" AS "BK_CUTOFF_TZ",
        "NUM_CHARGE_LAYOVERS" AS "NUM_CHARGE_LAYOVERS",
        "RATE_TYPE" AS "RATE_TYPE",
        "RATE_UOM" AS "RATE_UOM",
        "PICK_START_DTTM" AS "PICK_START_DTTM",
        "PAPERWORK_START_DTTM" AS "PAPERWORK_START_DTTM",
        "VEHICLE_CHECK_START_DTTM" AS "VEHICLE_CHECK_START_DTTM",
        "SHIPMENT_START_DTTM" AS "SHIPMENT_START_DTTM",
        "SHIPMENT_END_DTTM" AS "SHIPMENT_END_DTTM",
        "FEASIBLE_DRIVER_TYPE" AS "FEASIBLE_DRIVER_TYPE",
        "WAVE_ID" AS "WAVE_ID",
        "ESTIMATED_DISPATCH_DTTM" AS "ESTIMATED_DISPATCH_DTTM",
        "TOTAL_TIME" AS "TOTAL_TIME",
        "LOC_REFERENCE" AS "LOC_REFERENCE",
        "BK_O_FACILITY_ALIAS_ID" AS "BK_O_FACILITY_ALIAS_ID",
        "BK_D_FACILITY_ALIAS_ID" AS "BK_D_FACILITY_ALIAS_ID",
        "EQUIP_UTIL_PER" AS "EQUIP_UTIL_PER",
        "MOVE_TYPE" AS "MOVE_TYPE",
        "DRIVER_TYPE_ID" AS "DRIVER_TYPE_ID",
        "EQUIPMENT_TYPE" AS "EQUIPMENT_TYPE",
        "RADIAL_DISTANCE" AS "RADIAL_DISTANCE",
        "RADIAL_DISTANCE_UOM" AS "RADIAL_DISTANCE_UOM",
        "DESIGNATED_TRACTOR_CODE" AS "DESIGNATED_TRACTOR_CODE",
        "DESIGNATED_DRIVER_TYPE" AS "DESIGNATED_DRIVER_TYPE",
        "IS_WAVE_MAN_CHANGED" AS "IS_WAVE_MAN_CHANGED",
        "RETAIN_CONSOLIDATOR_TIMES" AS "RETAIN_CONSOLIDATOR_TIMES",
        "TARIFF" AS "TARIFF",
        "MIN_RATE" AS "MIN_RATE",
        "FIRST_UPDATE_SENT_TO_PKMS" AS "FIRST_UPDATE_SENT_TO_PKMS",
        "EVENT_IND_TYPEID" AS "EVENT_IND_TYPEID",
        "TANDEM_PATH_ID" AS "TANDEM_PATH_ID",
        "O_TANDEM_FACILITY" AS "O_TANDEM_FACILITY",
        "D_TANDEM_FACILITY" AS "D_TANDEM_FACILITY",
        "O_TANDEM_FACILITY_ALIAS" AS "O_TANDEM_FACILITY_ALIAS",
        "D_TANDEM_FACILITY_ALIAS" AS "D_TANDEM_FACILITY_ALIAS",
        "DELAY_TYPE" AS "DELAY_TYPE",
        "ASSIGNED_CARRIER_ID" AS "ASSIGNED_CARRIER_ID",
        "DSG_CARRIER_ID" AS "DSG_CARRIER_ID",
        "REC_CARRIER_ID" AS "REC_CARRIER_ID",
        "FEASIBLE_CARRIER_ID" AS "FEASIBLE_CARRIER_ID",
        "PAYEE_CARRIER_ID" AS "PAYEE_CARRIER_ID",
        "SCNDR_CARRIER_ID" AS "SCNDR_CARRIER_ID",
        "BROKER_CARRIER_ID" AS "BROKER_CARRIER_ID",
        "ASSIGNED_SCNDR_CARRIER_ID" AS "ASSIGNED_SCNDR_CARRIER_ID",
        "DSG_SCNDR_CARRIER_ID" AS "DSG_SCNDR_CARRIER_ID",
        "ASSIGNED_BROKER_CARRIER_ID" AS "ASSIGNED_BROKER_CARRIER_ID",
        "LH_PAYEE_CARRIER_ID" AS "LH_PAYEE_CARRIER_ID",
        "REC_BROKER_CARRIER_ID" AS "REC_BROKER_CARRIER_ID",
        "ASSIGNED_EQUIPMENT_ID" AS "ASSIGNED_EQUIPMENT_ID",
        "DSG_EQUIPMENT_ID" AS "DSG_EQUIPMENT_ID",
        "FEASIBLE_EQUIPMENT_ID" AS "FEASIBLE_EQUIPMENT_ID",
        "FEASIBLE_EQUIPMENT2_ID" AS "FEASIBLE_EQUIPMENT2_ID",
        "REC_EQUIPMENT_ID" AS "REC_EQUIPMENT_ID",
        "ASSIGNED_MOT_ID" AS "ASSIGNED_MOT_ID",
        "DSG_MOT_ID" AS "DSG_MOT_ID",
        "FEASIBLE_MOT_ID" AS "FEASIBLE_MOT_ID",
        "REC_MOT_ID" AS "REC_MOT_ID",
        "PRODUCT_CLASS_ID" AS "PRODUCT_CLASS_ID",
        "PROTECTION_LEVEL_ID" AS "PROTECTION_LEVEL_ID",
        "ASSIGNED_SERVICE_LEVEL_ID" AS "ASSIGNED_SERVICE_LEVEL_ID",
        "DSG_SERVICE_LEVEL_ID" AS "DSG_SERVICE_LEVEL_ID",
        "FEASIBLE_SERVICE_LEVEL_ID" AS "FEASIBLE_SERVICE_LEVEL_ID",
        "REC_SERVICE_LEVEL_ID" AS "REC_SERVICE_LEVEL_ID",
        "HAS_EM_NOTIFY_FLAG" AS "HAS_EM_NOTIFY_FLAG",
        "REGION_ID" AS "REGION_ID",
        "INBOUND_REGION_ID" AS "INBOUND_REGION_ID",
        "OUTBOUND_REGION_ID" AS "OUTBOUND_REGION_ID",
        "FINANCIAL_WT" AS "FINANCIAL_WT",
        "IS_BOOKING_REQUIRED" AS "IS_BOOKING_REQUIRED",
        "TOTAL_COST_EXCL_TAX" AS "TOTAL_COST_EXCL_TAX",
        "TOTAL_TAX_AMOUNT" AS "TOTAL_TAX_AMOUNT",
        "IS_ASSOCIATED_TO_OUTBOUND" AS "IS_ASSOCIATED_TO_OUTBOUND",
        "RECEIVED_DTTM" AS "RECEIVED_DTTM",
        "BOOKING_ID" AS "BOOKING_ID",
        "IS_MISROUTED" AS "IS_MISROUTED",
        "FEASIBLE_CARRIER_CODE" AS "FEASIBLE_CARRIER_CODE",
        "SHIPMENT_WIN_ADJ_FLAG" AS "SHIPMENT_WIN_ADJ_FLAG",
        "DT_PARAM_SET_ID" AS "DT_PARAM_SET_ID",
        "MERCHANDIZING_DEPARTMENT_ID" AS "MERCHANDIZING_DEPARTMENT_ID",
        "STATIC_ROUTE_ID" AS "STATIC_ROUTE_ID",
        "IS_FILO" AS "IS_FILO",
        "IS_COOLER_AT_NOSE" AS "IS_COOLER_AT_NOSE",
        "AUTH_NBR" AS "AUTH_NBR",
        "CONS_LOCN_ID" AS "CONS_LOCN_ID",
        "RTE_TYPE" AS "RTE_TYPE",
        "TRLR_TYPE" AS "TRLR_TYPE",
        "TRLR_SIZE" AS "TRLR_SIZE",
        "CONS_ADDR_CODE" AS "CONS_ADDR_CODE",
        "HUB_ID" AS "HUB_ID",
        "TRLR_GEN_CODE" AS "TRLR_GEN_CODE",
        "MAX_NBR_OF_CTNS" AS "MAX_NBR_OF_CTNS",
        "APPT_DOOR_SCHED_TYPE" AS "APPT_DOOR_SCHED_TYPE",
        "CREATED_SOURCE_TYPE" AS "CREATED_SOURCE_TYPE",
        "CREATED_SOURCE" AS "CREATED_SOURCE",
        "CREATED_DTTM" AS "CREATED_DTTM",
        "LAST_UPDATED_SOURCE_TYPE" AS "LAST_UPDATED_SOURCE_TYPE",
        "LAST_UPDATED_SOURCE" AS "LAST_UPDATED_SOURCE",
        "LAST_UPDATED_DTTM" AS "LAST_UPDATED_DTTM",
        "DSG_SCNDR_CARRIER_CODE" AS "DSG_SCNDR_CARRIER_CODE",
        "LH_PAYEE_CARRIER_CODE" AS "LH_PAYEE_CARRIER_CODE",
        "REC_BROKER_CARRIER_CODE" AS "REC_BROKER_CARRIER_CODE",
        "REC_CARRIER_CODE" AS "REC_CARRIER_CODE",
        "LPN_ASSIGNMENT_STOPPED" AS "LPN_ASSIGNMENT_STOPPED",
        "SEAL_NUMBER" AS "SEAL_NUMBER",
        "HIBERNATE_VERSION" AS "HIBERNATE_VERSION",
        "SHIP_GROUP_ID" AS "SHIP_GROUP_ID",
        "RATE" AS "RATE",
        "MONETARY_VALUE" AS "MONETARY_VALUE",
        "DOOR" AS "DOOR",
        "RTE_TYPE_1" AS "RTE_TYPE_1",
        "RTE_TYPE_2" AS "RTE_TYPE_2",
        "SCHEDULED_PICKUP_DTTM" AS "SCHEDULED_PICKUP_DTTM",
        "MANIFEST_ID" AS "MANIFEST_ID",
        "DAYS_TO_DELIVER" AS "DAYS_TO_DELIVER",
        "SED_GENERATED_FLAG" AS "SED_GENERATED_FLAG",
        "SERV_AREA_CODE" AS "SERV_AREA_CODE",
        "TENDER_RESP_DEADLINE_DTTM" AS "TENDER_RESP_DEADLINE_DTTM",
        "PRINT_CONS_BOL" AS "PRINT_CONS_BOL",
        "LEFT_WT" AS "LEFT_WT",
        "RIGHT_WT" AS "RIGHT_WT",
        "LANE_NAME" AS "LANE_NAME",
        "DECLARED_VALUE" AS "DECLARED_VALUE",
        "DV_CURRENCY_CODE" AS "DV_CURRENCY_CODE",
        "COD_AMOUNT" AS "COD_AMOUNT",
        "CUSTOMER_ID" AS "CUSTOMER_ID",
        "CUST_FRGT_CHARGE" AS "CUST_FRGT_CHARGE",
        "COD_CURRENCY_CODE" AS "COD_CURRENCY_CODE",
        "PLANNED_WEIGHT" AS "PLANNED_WEIGHT",
        "WEIGHT_UOM_ID_BASE" AS "WEIGHT_UOM_ID_BASE",
        "PLANNED_VOLUME" AS "PLANNED_VOLUME",
        "VOLUME_UOM_ID_BASE" AS "VOLUME_UOM_ID_BASE",
        "SIZE1_VALUE" AS "SIZE1_VALUE",
        "SIZE1_UOM_ID" AS "SIZE1_UOM_ID",
        "SIZE2_VALUE" AS "SIZE2_VALUE",
        "SIZE2_UOM_ID" AS "SIZE2_UOM_ID",
        "ASSIGNED_SHIP_VIA" AS "ASSIGNED_SHIP_VIA",
        "INSURANCE_STATUS" AS "INSURANCE_STATUS",
        "RTE_SWC_NBR" AS "RTE_SWC_NBR",
        "RTE_TO" AS "RTE_TO",
        "BILL_OF_LADING_NUMBER" AS "BILL_OF_LADING_NUMBER",
        "TRAILER_NUMBER" AS "TRAILER_NUMBER",
        "TRANS_PLAN_OWNER" AS "TRANS_PLAN_OWNER",
        "TOTAL_REVENUE_CURRENCY_CODE" AS "TOTAL_REVENUE_CURRENCY_CODE",
        "TOTAL_REVENUE" AS "TOTAL_REVENUE",
        "FRT_REV_SPOT_CHARGE_CURR_CODE" AS "FRT_REV_SPOT_CHARGE_CURR_CODE",
        "NORMALIZED_TOTAL_REVENUE" AS "NORMALIZED_TOTAL_REVENUE",
        "FRT_REV_SPOT_CHARGE" AS "FRT_REV_SPOT_CHARGE",
        "DSG_VOYAGE_FLIGHT" AS "DSG_VOYAGE_FLIGHT",
        "FEASIBLE_VOYAGE_FLIGHT" AS "FEASIBLE_VOYAGE_FLIGHT",
        "CURRENCY_DTTM" AS "CURRENCY_DTTM",
        "FRT_REV_LINEHAUL_CHARGE" AS "FRT_REV_LINEHAUL_CHARGE",
        "FRT_REV_STOP_CHARGE" AS "FRT_REV_STOP_CHARGE",
        "FRT_REV_ACCESSORIAL_CHARGE" AS "FRT_REV_ACCESSORIAL_CHARGE",
        "MARGIN" AS "MARGIN",
        "TOTAL_COST" AS "TOTAL_COST",
        "INCOTERM_ID" AS "INCOTERM_ID",
        "ORDER_QTY" AS "ORDER_QTY",
        "QTY_UOM_ID" AS "QTY_UOM_ID",
        "REF_SHIPMENT_NBR" AS "REF_SHIPMENT_NBR",
        "STAGING_LOCN_ID" AS "STAGING_LOCN_ID",
        "LOADING_SEQ_ORD" AS "LOADING_SEQ_ORD",
        "HAZMAT_CERT_CONTACT" AS "HAZMAT_CERT_CONTACT",
        "HAZMAT_CERT_DECLARATION" AS "HAZMAT_CERT_DECLARATION",
        "CDC_TIMESTAMP" AS "CDC_TIMESTAMP",
        "OPERATION_TYPE" AS "OPERATION_TYPE",
        "ARCHIVED_DTTM" AS "ARCHIVED_DTTM",
        "ORIGIN" AS "ORIGIN",
        "FINAL_DESTINATION" AS "FINAL_DESTINATION",
        "actual_delivery_date_parsed" AS "actual_delivery_date_parsed",
        "wood_pellet" AS "wood_pellet",
        "act_del_MERCH_YEAR" AS "act_del_MERCH_YEAR",
        "act_del_YEAR_WEEK" AS "act_del_YEAR_WEEK",
        "act_del_YEAR_QUARTER" AS "act_del_YEAR_QUARTER",
        "act_del_YEAR_PERIOD" AS "act_del_YEAR_PERIOD",
        "invoice_shipping_id" AS "invoice_shipping_id",
        "org_Facility_Code" AS "org_Facility_Code",
        "org_Facility_Name" AS "org_Facility_Name",
        "org_Facility_Type" AS "org_Facility_Type",
        "dest_Facility_Code" AS "dest_Facility_Code",
        "dest_Facility_Name" AS "dest_Facility_Name",
        "dest_Facility_Type" AS "dest_Facility_Type",
        "inbound_flag" AS "inbound_flag",
        "order_id_po" AS "order_id_po",
        "order_id_po_int" AS "order_id_po_int",
        "po_STORE_NO" AS "po_STORE_NO",
        "po_CO_CODE" AS "po_CO_CODE",
        "po_ARTICLE_NO" AS "po_ARTICLE_NO",
        "po_PO_NO" AS "po_PO_NO",
        "po_PO_LINE_NO" AS "po_PO_LINE_NO",
        "po_PO_DATE" AS "po_PO_DATE",
        "po_po_date_parsed" AS "po_po_date_parsed",
        "po_DELIV_DATE" AS "po_DELIV_DATE",
        "po_deliv_date_parsed" AS "po_deliv_date_parsed",
        "po_PO_TYPE_CODE" AS "po_PO_TYPE_CODE",
        "po_VENDOR_ID" AS "po_VENDOR_ID",
        "po_VSR_CODE" AS "po_VSR_CODE",
        "po_PO_LINE_CANCELLED_FLAG" AS "po_PO_LINE_CANCELLED_FLAG",
        "po_PO_LINE_ORDER_QTY" AS "po_PO_LINE_ORDER_QTY",
        "po_PO_LINE_ISSUE_QTY" AS "po_PO_LINE_ISSUE_QTY",
        "po_PO_LINE_RCVD_QTY" AS "po_PO_LINE_RCVD_QTY",
        "po_PO_LINE_UNIT_PRICE" AS "po_PO_LINE_UNIT_PRICE",
        "po_DC_NO" AS "po_DC_NO",
        "po_PO_TRACKING_NO" AS "po_PO_TRACKING_NO",
        "po_PO_LINE_TRACKING_NO" AS "po_PO_LINE_TRACKING_NO",
        "po_CURRENT_REPL_TYPE_CODE" AS "po_CURRENT_REPL_TYPE_CODE",
        "po_FREIGHT_TYPE_CODE" AS "po_FREIGHT_TYPE_CODE",
        "po_SHIP_START_DATE" AS "po_SHIP_START_DATE",
        "po_SHIP_END_DATE" AS "po_SHIP_END_DATE",
        "po_DELIV_START_DATE" AS "po_DELIV_START_DATE",
        "po_DELIV_END_DATE" AS "po_DELIV_END_DATE",
        "po_PO_LINE_UNIT_FREIGHT_AMT" AS "po_PO_LINE_UNIT_FREIGHT_AMT",
        "po_PO_LINE_MANUFACTURER" AS "po_PO_LINE_MANUFACTURER",
        "po_PO_LINE_ORIGIN_COUNTRY_CODE" AS "po_PO_LINE_ORIGIN_COUNTRY_CODE",
        "po_PO_LINE_PORT_OF_ORIGIN" AS "po_PO_LINE_PORT_OF_ORIGIN",
        "po_PO_LINE_MIN_RCVD_DATE" AS "po_PO_LINE_MIN_RCVD_DATE",
        "po_PO_LINE_MAX_RCVD_DATE" AS "po_PO_LINE_MAX_RCVD_DATE",
        "po_PO_LINE_DELIVERED_FLAG" AS "po_PO_LINE_DELIVERED_FLAG",
        "po_PO_LINE_CONFIRMED_ON_BOARD_DATE" AS "po_PO_LINE_CONFIRMED_ON_BOARD_DATE",
        "po_PO_LINE_BOOKED_FOR_SHIPMENT_DATE" AS "po_PO_LINE_BOOKED_FOR_SHIPMENT_DATE",
        "po_PO_LINE_TRANSIT_RESN_CODE" AS "po_PO_LINE_TRANSIT_RESN_CODE",
        "po_PO_LINE_MOVE_TYPE_CODE" AS "po_PO_LINE_MOVE_TYPE_CODE",
        "po_PO_LINE_AGENT_COMMISSION_RATE" AS "po_PO_LINE_AGENT_COMMISSION_RATE",
        "po_PO_LINE_AGENT_COMMISSION_AMT" AS "po_PO_LINE_AGENT_COMMISSION_AMT",
        "po_PO_LINE_ADDL_ARTICLE_NO" AS "po_PO_LINE_ADDL_ARTICLE_NO",
        "po_PO_LINE_ADDL_ARTICLE_QTY" AS "po_PO_LINE_ADDL_ARTICLE_QTY",
        "po_PO_LINE_FACTORY_VENDOR_ID" AS "po_PO_LINE_FACTORY_VENDOR_ID",
        "po_PO_LINE_STUFFING_LOC_VENDOR_ID" AS "po_PO_LINE_STUFFING_LOC_VENDOR_ID",
        "po_PO_LINE_SOURCING_AGENT_VENDOR_ID" AS "po_PO_LINE_SOURCING_AGENT_VENDOR_ID",
        "po_PO_LINE_FREIGHT_FORWARDER_VENDOR_ID" AS "po_PO_LINE_FREIGHT_FORWARDER_VENDOR_ID",
        "po_PO_LINE_LETTER_OF_CREDIT_NO" AS "po_PO_LINE_LETTER_OF_CREDIT_NO",
        "po_PO_LINE_OPEN_ACCT_NO" AS "po_PO_LINE_OPEN_ACCT_NO",
        "po_PO_LINE_ARTICLE_LENGTH" AS "po_PO_LINE_ARTICLE_LENGTH",
        "po_PO_LINE_ARTICLE_WIDTH" AS "po_PO_LINE_ARTICLE_WIDTH",
        "po_PO_LINE_ARTICLE_HEIGHT" AS "po_PO_LINE_ARTICLE_HEIGHT",
        "po_PO_LINE_ARTICLE_DIMENSIONS_UOM" AS "po_PO_LINE_ARTICLE_DIMENSIONS_UOM",
        "po_PO_LINE_ARTICLE_WEIGHT" AS "po_PO_LINE_ARTICLE_WEIGHT",
        "po_PO_LINE_ARTICLE_WEIGHT_UOM" AS "po_PO_LINE_ARTICLE_WEIGHT_UOM",
        "po_PO_TOTAL_WEIGHT" AS "po_PO_TOTAL_WEIGHT",
        "po_PO_LINE_ARTICLE_VOLUME" AS "po_PO_LINE_ARTICLE_VOLUME",
        "po_PO_LINE_ARTICLE_VOLUME_UOM" AS "po_PO_LINE_ARTICLE_VOLUME_UOM",
        "po_PO_TOTAL_VOLUME" AS "po_PO_TOTAL_VOLUME",
        "po_HTS_CODE" AS "po_HTS_CODE",
        "po_PO_LINE_DUTY_RATE" AS "po_PO_LINE_DUTY_RATE",
        "po_PO_LINE_DUTY_AMT" AS "po_PO_LINE_DUTY_AMT",
        "po_PO_LINE_ADDL_HTS_CODE_1" AS "po_PO_LINE_ADDL_HTS_CODE_1",
        "po_PO_LINE_ADDL_DUTY_RATE_1" AS "po_PO_LINE_ADDL_DUTY_RATE_1",
        "po_PO_LINE_ADDL_DUTY_AMT_1" AS "po_PO_LINE_ADDL_DUTY_AMT_1",
        "po_PO_LINE_ADDL_HTS_CODE_2" AS "po_PO_LINE_ADDL_HTS_CODE_2",
        "po_PO_LINE_ADDL_DUTY_RATE_2" AS "po_PO_LINE_ADDL_DUTY_RATE_2",
        "po_PO_LINE_ADDL_DUTY_AMT_2" AS "po_PO_LINE_ADDL_DUTY_AMT_2",
        "po_PO_HELD_FLAG" AS "po_PO_HELD_FLAG",
        "po_PO_VENDOR_DOC_DATE" AS "po_PO_VENDOR_DOC_DATE",
        "po_cal_MERCH_YEAR" AS "po_cal_MERCH_YEAR",
        "po_cal_YEAR_WEEK" AS "po_cal_YEAR_WEEK",
        "po_cal_YEAR_QUARTER" AS "po_cal_YEAR_QUARTER",
        "po_cal_YEAR_PERIOD" AS "po_cal_YEAR_PERIOD",
        "a_ARTICLE_LENGTH" AS "a_ARTICLE_LENGTH",
        "a_ARTICLE_WIDTH" AS "a_ARTICLE_WIDTH",
        "a_ARTICLE_HEIGHT" AS "a_ARTICLE_HEIGHT",
        "item_volume" AS "item_volume",
        "a_ARTICLE_WEIGHT" AS "a_ARTICLE_WEIGHT",
        "item_weight" AS "item_weight",
        "a_ARTICLE_SIZE" AS "a_ARTICLE_SIZE",
        "a_ARTICLE_40HC_QTY" AS "a_ARTICLE_40HC_QTY",
        "a_ARTICLE_40GP_QTY" AS "a_ARTICLE_40GP_QTY",
        "item_volume_sum" AS "item_volume_sum",
        "allocation_by_vol" AS "allocation_by_vol",
        "item_weight_total" AS "item_weight_total",
        "allocation_by_wgt" AS "allocation_by_wgt",
        "max_volume" AS "max_volume",
        "max_weight" AS "max_weight",
        "weight_volume_flag" AS "weight_volume_flag",
        "allocation_final" AS "allocation_final",
        "po_weight_sum" AS "po_weight_sum",
        MAX("small_package_flag") OVER (PARTITION BY "po_PO_NO") AS "small_package_flag"
      FROM "TLM_SHIPMENT_PO_WEIGHT_WINDOWS_PREPARED"
      )
      SELECT   "act_del_YEAR_PERIOD" AS "act_del_YEAR_PERIOD",
        "po_ARTICLE_NO" AS "po_ARTICLE_NO",
        "po_VENDOR_ID" AS "po_VENDOR_ID",
        "org_Facility_Code" AS "org_Facility_Code",
        "org_Facility_Name" AS "org_Facility_Name",
        "org_Facility_Type" AS "org_Facility_Type",
        "dest_Facility_Code" AS "dest_Facility_Code",
        "dest_Facility_Name" AS "dest_Facility_Name",
        "dest_Facility_Type" AS "dest_Facility_Type",
        "small_package_flag" AS "small_package_flag",
        SUM( DISTINCT "po_PO_LINE_ORDER_QTY") AS "order_qty"
     FROM CTE 
      GROUP BY "act_del_YEAR_PERIOD", "po_ARTICLE_NO", "po_VENDOR_ID", "org_Facility_Code", "org_Facility_Name", "org_Facility_Type", 
               "dest_Facility_Code", "dest_Facility_Name", "dest_Facility_Type", "small_package_flag";


<br>
--SHIPMENT_PO_JOINED
</br>	
CREATE OR REPLACE TEMPORARY TABLE "SHIPMENT_PO_JOINED"
AS
WITH shipping_po_flow_path_by_ARTICLE_NO_joined_joined_1_1 AS
(
SELECT  A."ARTICLE_NO" AS "ARTICLE_NO",
        A."YEAR_PERIOD" AS "YEAR_PERIOD",
        B."match" AS "match"
 FROM 
(SELECT 
    "shipping_po_flow_path_by_ARTICLE_NO_1_1"."ARTICLE_NO" AS "ARTICLE_NO",
    "time_dimension_by_YEAR_PERIOD_filtered"."YEAR_PERIOD" AS "YEAR_PERIOD"
  FROM (SELECT "po_ARTICLE_NO" AS "ARTICLE_NO"
   FROM "TLM_SHIPMENT_JOINED_PO_ALLOCATION_BY_ACT_DEL_YEAR_PERIOD"
   GROUP BY "po_ARTICLE_NO") "shipping_po_flow_path_by_ARTICLE_NO_1_1"
  CROSS JOIN TIME_DIMENSION_BY_YEAR_PERIOD_FILTERED "time_dimension_by_YEAR_PERIOD_filtered"
  )A LEFT JOIN 
  (
  SELECT 
        "act_del_YEAR_PERIOD" AS "YEAR_PERIOD",
        "po_ARTICLE_NO" AS "ARTICLE_NO",
         1 AS "match"
  FROM  "TLM_SHIPMENT_JOINED_PO_ALLOCATION_BY_ACT_DEL_YEAR_PERIOD"
  WHERE  "po_ARTICLE_NO" IS NOT NULL
  GROUP BY "YEAR_PERIOD","ARTICLE_NO" 
  ) B   ON (A."ARTICLE_NO" = B."ARTICLE_NO")
          AND (A."YEAR_PERIOD" = B."YEAR_PERIOD")
  WHERE "match" IS NULL
  )

SELECT 
    A."YEAR_PERIOD" AS "YEAR_PERIOD",
    A."ARTICLE_NO" AS "ARTICLE_NO",
    A."VENDOR_ID" AS "VENDOR_ID",
    A."org_Facility_Code" AS "org_Facility_Code",
    A."org_Facility_Name" AS "org_Facility_Name",
    A."org_Facility_Type" AS "org_Facility_Type",
    A."dest_Facility_Code" AS "dest_Facility_Code",
    A."dest_Facility_Name" AS "dest_Facility_Name",
    A."dest_Facility_Type" AS "dest_Facility_Type",
    A."small_package_flag" AS "small_package_flag",
    A."order_qty" AS "order_qty",
    "turn_period_master"."turn_period" AS "turn_period"

FROM 
(SELECT 
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "ARTICLE_NO" AS "ARTICLE_NO",
      NULL AS "VENDOR_ID",
      NULL AS "org_Facility_Code",
      NULL AS "org_Facility_Name",
      NULL AS "org_Facility_Type",
      NULL AS "dest_Facility_Code",
      NULL AS "dest_Facility_Name",
      NULL AS "dest_Facility_Type",
      NULL AS "small_package_flag",
      NULL AS "order_qty"
  FROM shipping_po_flow_path_by_ARTICLE_NO_joined_joined_1_1
    GROUP BY "YEAR_PERIOD", "ARTICLE_NO"
    UNION ALL 
    SELECT 
    "act_del_YEAR_PERIOD" AS "YEAR_PERIOD",
    "po_ARTICLE_NO" AS "ARTICLE_NO",
    "po_VENDOR_ID" AS "VENDOR_ID",
    "org_Facility_Code" AS "org_Facility_Code",
    "org_Facility_Name" AS "org_Facility_Name",
    "org_Facility_Type" AS "org_Facility_Type",
    "dest_Facility_Code" AS "dest_Facility_Code",
    "dest_Facility_Name" AS "dest_Facility_Name",
    "dest_Facility_Type" AS "dest_Facility_Type",
    "small_package_flag" AS "small_package_flag",
    "order_qty" AS "order_qty"
 FROM "TLM_SHIPMENT_JOINED_PO_ALLOCATION_BY_ACT_DEL_YEAR_PERIOD"
 )A
 LEFT JOIN "TURN_PERIOD_MASTER" "turn_period_master"
    ON A."ARTICLE_NO" = "turn_period_master"."ARTICLE_NO";

<br>
--D--CREATE OR REPLACE TEMPORARY TABLE "DO_FLOW_PATH" AS
</br>

INSERT INTO "DO_FLOW_PATH"
(
"YEAR_PERIOD",
"ARTICLE_NO" ,
"org_Facility_Code",
"org_Facility_Name",
"org_Facility_Type",
"dest_Facility_Code",
"dest_Facility_Name",
"dest_Facility_Type",
"turn_period"  ,
"order_qty_agg"
)
WITH CTE AS 
(
SELECT  "YEAR_PERIOD",
  "ARTICLE_NO",
  "org_Facility_Code",
  "org_Facility_Name",
  "org_Facility_Type",
  "dest_Facility_Code",
  "dest_Facility_Name",
  "dest_Facility_Type",
    "order_qty",
    "turn_period"
 FROM 
( SELECT 
    "YEAR_PERIOD"      AS "YEAR_PERIOD",
    "ARTICLE_NO"       AS "ARTICLE_NO",
     org_Facility_Code AS "org_Facility_Code",
     org_Facility_Name AS "org_Facility_Name",
     org_Facility_Type AS "org_Facility_Type",
     dest_Facility_Code AS "dest_Facility_Code",
     dest_Facility_Name AS "dest_Facility_Name",
     dest_Facility_Type AS "dest_Facility_Type",
     order_qty AS "order_qty",
    "turn_period" AS "turn_period"
  FROM "INVOICE_DO_JOINED"
UNION ALL
SELECT 
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "ARTICLE_NO" AS "ARTICLE_NO",
    "ORG_FACILITY_CODE" AS "org_Facility_Code",
    "ORG_FACILITY_NAME" AS "org_Facility_Name",
    "ORG_FACILITY_TYPE" AS "org_Facility_Type",
    "DEST_FACILITY_CODE" AS "dest_Facility_Code",
    "DEST_FACILITY_NAME" AS "dest_Facility_Name",
    "DEST_FACILITY_TYPE" AS "dest_Facility_Type",
    "ORDER_QTY" AS "order_qty",
    "turn_period" AS "turn_period"
 FROM "SHIPPING_DO_FLOW_PATH_JOINED"
 )GRP
 GROUP BY "YEAR_PERIOD",
  "ARTICLE_NO",
  "org_Facility_Code",
  "org_Facility_Name",
  "org_Facility_Type",
  "dest_Facility_Code",
  "dest_Facility_Name",
  "dest_Facility_Type",
    "order_qty",
    "turn_period"
  )
  SELECT  
      Base.Year_Period
    , Base.Article_no
    , A."org_Facility_Code"	
    , A."org_Facility_Name"	
    , A."org_Facility_Type"	
    , A."dest_Facility_Code"
    , A."dest_Facility_Name"	
    , A."dest_Facility_Type"
    , Base."turn_period"    
    , Sum(A."order_qty") as "order_qty_agg"
FROM
    (SELECT 
       DISTINCT  try_to_date( concat( LEFT( cast(b.year_period AS varchar) , 4 ) , '-' , RIGHT( cast(b.year_period AS varchar) , 2 ) , '-01' ) ) AS 
                                period ,
                                b.year_period ,
                                b.article_no ,
                                b."turn_period" ,
                                ( b."turn_period" * -1 ) AS negativeturn_period
     FROM            CTE b    )Base 
    LEFT OUTER JOIN CTE A ON 
        Base.Article_no = A.Article_no
        AND TRY_TO_DATE(  CONCAT(  LEFT( cast(A.Year_Period AS VARCHAR) , 4 ) , '-' , RIGHT( cast(A.Year_Period AS VARCHAR) , 2 ) , '-01'  ) )
            BETWEEN  DateAdd( Month, negativeturn_period + 1 , Base.Period  ) AND Base.Period
GROUP BY 
      Base.Year_Period
    , Base.Article_no
    , A."org_Facility_Code"	
    , A."org_Facility_Name"	
    , A."org_Facility_Type"	
    , A."dest_Facility_Code"
    , A."dest_Facility_Name"	
    , A."dest_Facility_Type"
    , Base."turn_period" ;

<br>
--OCEAN_FREIGHT_FLOWPATH_W_TURN_PREPARED
</br>

CREATE OR REPLACE TEMPORARY TABLE "OCEAN_FREIGHT_FLOWPATH_W_TURN_PREPARED"
AS
WITH CTE AS (
                SELECT DISTINCT try_to_date( concat( LEFT( cast(b."Year Period" AS varchar) , 4 ) , '-' , RIGHT( cast(b."Year Period" AS varchar) , 2                                 ) , '-01' ) ) AS period ,
                                b."Year Period" ,
                                b."po_Item_No" ,
                                b."turn_period" ,
                                b.small_package_flag,
                                ( b."turn_period" * -1 ) AS negativeturn_period
                FROM           OCEAN_FREIGHT_FLOW_PATH_JOINED b 
                
           )          
                
                SELECT          Base."Year Period" AS "YEAR_PERIOD"
                             , Base."po_Item_No" AS "ARTICLE_NO"
                             , A."po_VENDOR_ID" AS "VENDOR_ID"	
                             , A."org_Facility_Code"	
                             , A."org_Facility_Name"	
                             , A."org_Facility_Type"	
                             , A."dest_Facility_Name"	
                             , A."dest_Facility_Type"	
                             , A."dest_facility_code"
                             , Base."turn_period"    
                             , Sum(A."po_Item_Qty") as "order_qty_agg"
                             , A.small_package_flag
                FROM            CTE base
                LEFT OUTER JOIN ocean_freight_flow_path_joined a
                ON              base."po_Item_No" = a."po_Item_No" 
                WHERE            TRY_TO_DATE(  CONCAT(  LEFT( cast(A."Year Period" AS VARCHAR) , 4 ) , '-' , RIGHT( 
                                 cast(A."Year Period" AS VARCHAR) , 2 ) , '-01'  ) )BETWEEN  DateAdd( Month, negativeturn_period + 1 , Base.Period  )                                    AND Base.Period             
                GROUP BY        base."Year Period" ,
                                base."po_Item_No" ,
                                a."po_VENDOR_ID" ,
                                a."org_Facility_Code" ,
                                a."org_Facility_Name" ,
                                a."org_Facility_Type" ,
                                a."dest_Facility_Name" ,
                                a."dest_Facility_Type" ,
                                a."dest_facility_code" ,
                                base."turn_period" ,
                                a.small_package_flag;

<br>								
--PO_FLOWPATH
</br>	
CREATE OR REPLACE TEMP TABLE "PO_FLOWPATH"
 AS  
       SELECT * FROM 
       (      SELECT  "YEAR_PERIOD",
              "ARTICLE_NO",
              "VENDOR_ID",
              "org_Facility_Code",
              "org_Facility_Name",
              "org_Facility_Type",
              "dest_Facility_Code",
              "dest_Facility_Name",
              "dest_Facility_Type",
              small_package_flag,
              order_qty,
              "turn_period"
       FROM   INVOICE_PO_FLOW_PATH_JOINED
       UNION ALL
       SELECT  year_period,
              article_no,
              vendor_id,
              "org_Facility_Code",
              "org_Facility_Name",
              "org_Facility_Type",
              "dest_Facility_Code",
              "dest_Facility_Name",
              "dest_Facility_Type",
              "small_package_flag",
              "order_qty",
              "turn_period"
       FROM   SHIPMENT_PO_JOINED  )A

<br>								
--PO_FLOWPATH_TURN
</br>	

CREATE OR REPLACE TEMPORARY TABLE "PO_FLOWPATH_TURN"
AS
 WITH CTE AS (
 SELECT      DISTINCT      try_to_date( concat( LEFT( cast(b.year_period AS varchar) , 4 ) , '-' , RIGHT( cast(b.year_period AS varchar) , 2 ) , '-01' ) 
                             ) AS  period ,
                                b.year_period ,
                                b.article_no ,
                                b."turn_period" ,
                                ( b."turn_period" * -1 ) AS negativeturn_period
                FROM    "PO_FLOWPATH" b
   
            )

        SELECT                  base.year_period ,
                                base.article_no ,
                                a."VENDOR_ID",
                                a."org_Facility_Code",
                                a."org_Facility_Name",
                                a."org_Facility_Type",
                                a."dest_Facility_Code",
                                a."dest_Facility_Name",
                                a."dest_Facility_Type",
                                base."turn_period" ,
                                sum(a.order_qty) AS order_qty_agg ,
                                a.small_package_flag
                FROM            CTE base
                LEFT OUTER JOIN  "PO_FLOWPATH" a            
                ON              base.article_no = a.article_no
                AND             to_date( concat( LEFT( cast(a.year_period AS varchar) , 4 ) , '-' , RIGHT( cast(a.year_period AS varchar) , 2 ) , '-01' ) )
                                BETWEEN dateadd( month, negativeturn_period + 1 , base.period ) AND base.period
                GROUP BY        base.year_period ,
                                base.article_no ,
                                a.vendor_id ,
                               a."org_Facility_Code",
                                a."org_Facility_Name",
                                a."org_Facility_Type",
                                a."dest_Facility_Code",
                                a."dest_Facility_Name",
                                a."dest_Facility_Type",
                                small_package_flag,
                                base."turn_period";

<br>							
--FLOW_PATH_STACKED							
</br>
CREATE OR REPLACE TEMPORARY TABLE "FLOW_PATH_STACKED"
AS
SELECT  year_period ,
       article_no ,
       vendor_id ,
       "org_Facility_Code" ,
       "org_Facility_Name" ,
       TRIM("org_Facility_Type") AS "org_Facility_Type" ,
       "dest_Facility_Code" ,
      CAST("dest_Facility_Name" AS VARCHAR) "dest_Facility_Name"  ,
       TRIM("dest_Facility_Type") AS "dest_Facility_Type" ,
       "turn_period" ,
       order_qty_agg ,
       small_package_flag
FROM   PO_FLOWPATH_TURN
UNION ALL
SELECT  year_period ,
       article_no ,
       vendor_id ,
       "org_Facility_Code" ,
       "org_Facility_Name" ,
       TRIM("org_Facility_Type") AS "org_Facility_Type" ,
       "dest_facility_code" ,
       CAST("dest_Facility_Name" AS VARCHAR) "dest_Facility_Name"  ,
       TRIM("dest_Facility_Type") AS "dest_Facility_Type" ,
       "turn_period" ,
       "order_qty_agg" ,
       small_package_flag
FROM   OCEAN_FREIGHT_FLOWPATH_W_TURN_PREPARED
UNION ALL
SELECT  year_period ,
       article_no ,
       NULL AS vendor_id ,
       "org_Facility_Code" ,
       "org_Facility_Name" ,
       "org_Facility_Type" ,
       "dest_Facility_Code" ,
       "dest_Facility_Name" ,
       "dest_Facility_Type" ,
       "turn_period" ,
       "order_qty_agg" ,
       NULL AS small_package_flag
FROM   DO_FLOW_PATH;

<br>
--FLOW_PATH_STACKED_PREPARED
</br>
CREATE OR REPLACE TEMPORARY TABLE "FLOW_PATH_STACKED_PREPARED"
AS
WITH CTE AS 
(
SELECT 
    "flow_path_stacked"."YEAR_PERIOD" AS "YEAR_PERIOD",
    "flow_path_stacked"."ARTICLE_NO" AS "ARTICLE_NO",
    "flow_path_stacked"."VENDOR_ID" AS "VENDOR_ID",
    "flow_path_stacked"."org_Facility_Code" AS "org_Facility_Code",
    "flow_path_stacked"."org_Facility_Name" AS "org_Facility_Name",
    TRIM("flow_path_stacked"."org_Facility_Type") AS "org_Facility_Type",
    "flow_path_stacked"."dest_Facility_Name" AS "dest_Facility_Name",
    TRIM("flow_path_stacked"."dest_Facility_Type") AS "dest_Facility_Type",
    "flow_path_stacked"."dest_Facility_Code" AS "dest_Facility_Code",
    "flow_path_stacked"."turn_period" AS "turn_period",
    "flow_path_stacked".order_qty_agg AS "order_qty_agg",
    "flow_path_stacked".small_package_flag AS "small_package_flag",
    TRIM("vendor_by_freight_term_windows"."FREIGHT_TERMS_CODE") AS "FREIGHT_TERMS_CODE"
  FROM "FLOW_PATH_STACKED" "flow_path_stacked"
  LEFT JOIN "VENDOR_BY_FREIGHT_TERM_WINDOWS" "vendor_by_freight_term_windows"
    ON "flow_path_stacked"."VENDOR_ID" = "vendor_by_freight_term_windows"."VENDOR_ID"
    )
    SELECT 
    "YEAR_PERIOD",
    "ARTICLE_NO",
    "VENDOR_ID",
    "org_Facility_Code",
    "org_Facility_Name",
    "org_Facility_Type",
    "dest_Facility_Name",
    "dest_Facility_Type",
    "dest_Facility_Code",
    "turn_period",
    "order_qty_agg",
    "small_package_flag",
    "FREIGHT_TERMS_CODE",
    "generic_leg",
    "org_Facility_vendor_type",
    TRIM(CONCAT(IFNULL(TO_VARCHAR("org_Facility_vendor_type"), ''), ' to ', IFNULL(TO_VARCHAR("dest_Facility_Type"), ''))) AS "leg"
  FROM (
    SELECT 
        "YEAR_PERIOD",
        "ARTICLE_NO",
        "VENDOR_ID",
        "org_Facility_Code",
        "org_Facility_Name",
        "org_Facility_Type",
        "dest_Facility_Name",
        "dest_Facility_Type",
        "dest_Facility_Code",
        "turn_period",
        "order_qty_agg",
        "small_package_flag",
        "FREIGHT_TERMS_CODE",
        TRIM(CONCAT(IFNULL(TO_VARCHAR("org_Facility_Type"),''), ' to ', IFNULL(TO_VARCHAR("dest_Facility_Type"),''))) AS "generic_leg",
              CASE WHEN UPPER("org_Facility_Type" )= 'VENDOR' THEN CASE WHEN UPPER("FREIGHT_TERMS_CODE") = 'FOB' THEN 'Import Vendor' 
              ELSE  CASE WHEN UPPER("FREIGHT_TERMS_CODE") = 'FPV' THEN 'Prepaid Vendor' 
              ELSE  CASE WHEN ("small_package_flag" = 1) AND ( UPPER("FREIGHT_TERMS_CODE") = 'FCT') THEN 'Small Package Vendor' 
              ELSE  CASE WHEN UPPER("FREIGHT_TERMS_CODE") = 'FCT' THEN 'Collect Vendor'  
                    ELSE "org_Facility_Type" 
                    END 
                    END 
                    END 
                    END   
                    ELSE "org_Facility_Type" 
                END AS "org_Facility_vendor_type"
      FROM CTE
    ) "__dku_before_xxx";

<br>
--FLOW_PATH_STACKED_OUTBOUND_BY_YEAR_PERIOD
</br>
CREATE OR REPLACE TEMPORARY TABLE "FLOW_PATH_STACKED_OUTBOUND_BY_YEAR_PERIOD"
AS
 SELECT 
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "ARTICLE_NO" AS "ARTICLE_NO",
    "leg" AS "leg"
    FROM
    (
     SELECT 
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "ARTICLE_NO" AS "ARTICLE_NO",
    "VENDOR_ID" AS "VENDOR_ID",
    "org_Facility_Code" AS "org_Facility_Code",
    "org_Facility_Name" AS "org_Facility_Name",
    "org_Facility_Type" AS "org_Facility_Type",
    "dest_Facility_Code" AS "dest_Facility_Code",
    "dest_Facility_Name" AS "dest_Facility_Name",
    "dest_Facility_Type" AS "dest_Facility_Type",
    "generic_leg" AS "generic_leg",
    "turn_period" AS "turn_period",
    "order_qty_agg" AS "order_qty_agg",
    "small_package_flag" AS "small_package_flag",
    "FREIGHT_TERMS_CODE" AS "FREIGHT_TERMS_CODE",
    "org_Facility_vendor_type" AS "org_Facility_vendor_type",
    "leg" AS "leg"
  FROM "FLOW_PATH_STACKED_PREPARED"
  WHERE UPPER("org_Facility_Type") != 'VENDOR' OR UPPER("org_Facility_Type") IS NULL AND 'VENDOR' IS NOT NULL OR UPPER("org_Facility_Type") IS NOT NULL AND 'VENDOR' IS NULL
  ) A GROUP BY "YEAR_PERIOD", "ARTICLE_NO", "leg";

<br>
  --FLOW_PATH_STACKED_PREPARED_JOINED
</br>
CREATE OR REPLACE TEMPORARY TABLE "FLOW_PATH_STACKED_PREPARED_JOINED"
AS
WITH CTE AS 
(
SELECT 
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "ARTICLE_NO" AS "ARTICLE_NO",
    "VENDOR_ID" AS "VENDOR_ID",
    "org_Facility_Code" AS "org_Facility_Code",
    "org_Facility_Name" AS "org_Facility_Name",
    "org_Facility_Type" AS "org_Facility_Type",
    "dest_Facility_Code" AS "dest_Facility_Code",
    "dest_Facility_Name" AS "dest_Facility_Name",
    "dest_Facility_Type" AS "dest_Facility_Type",
    "generic_leg" AS "generic_leg",
    "turn_period" AS "turn_period",
    "order_qty_agg" AS "order_qty_agg",
    "small_package_flag" AS "small_package_flag",
    "FREIGHT_TERMS_CODE" AS "FREIGHT_TERMS_CODE",
    "org_Facility_vendor_type" AS "org_Facility_vendor_type",
    "leg" AS "leg"
  FROM "FLOW_PATH_STACKED_PREPARED"
  WHERE UPPER("org_Facility_Type") = 'VENDOR'
  )
  SELECT 
    "flow_path_stacked_inbound"."YEAR_PERIOD" AS "YEAR_PERIOD",
    "flow_path_stacked_inbound"."ARTICLE_NO" AS "ARTICLE_NO",
    "flow_path_stacked_inbound"."VENDOR_ID" AS "VENDOR_ID",
    "flow_path_stacked_inbound"."org_Facility_Code" AS "org_Facility_Code",
    "flow_path_stacked_inbound"."org_Facility_Name" AS "org_Facility_Name",
    "flow_path_stacked_inbound"."org_Facility_Type" AS "org_Facility_Type",
    "flow_path_stacked_inbound"."dest_Facility_Code" AS "dest_Facility_Code",
    "flow_path_stacked_inbound"."dest_Facility_Name" AS "dest_Facility_Name",
    "flow_path_stacked_inbound"."dest_Facility_Type" AS "dest_Facility_Type",
    "flow_path_stacked_inbound"."generic_leg" AS "generic_leg",
    "flow_path_stacked_inbound"."turn_period" AS "turn_period",
    "flow_path_stacked_inbound"."order_qty_agg" AS "order_qty_agg",
    "flow_path_stacked_inbound"."small_package_flag" AS "small_package_flag",
    "flow_path_stacked_inbound"."FREIGHT_TERMS_CODE" AS "FREIGHT_TERMS_CODE",
    "flow_path_stacked_inbound"."org_Facility_vendor_type" AS "org_Facility_vendor_type",
    "flow_path_stacked_inbound"."leg" AS "leg",
    "flow_path_mapping_inbound"."flow_path" AS "flow_path",
    TRIM("flow_path_mapping_inbound"."leg_name") AS "leg_name"
  FROM CTE "flow_path_stacked_inbound"
  LEFT JOIN (
             SELECT 
             "flow_path" AS "flow_path",
             "leg_name" AS "leg_name",
             "leg_no" AS "leg_no",
             "total_legs" AS "total_legs"
             FROM "FLOW_PATH_MAPPING_PREPARED"
             WHERE "leg_no" = 1) "flow_path_mapping_inbound"
    ON UPPER(TRIM("flow_path_stacked_inbound"."leg"))= UPPER(TRIM("flow_path_mapping_inbound"."leg_name"));

<br>
--FLOW_PATH_STACKED_COMPLEX_PATHS_JOINED_JOINED
</br>
CREATE OR REPLACE  TEMPORARY TABLE "FLOW_PATH_STACKED_COMPLEX_PATHS_JOINED_JOINED"
AS
WITH flow_path_stacked_complex_paths_joined AS (
SELECT 
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "ARTICLE_NO" AS "ARTICLE_NO",
    "VENDOR_ID" AS "VENDOR_ID",
    "leg" AS "leg",
    "flow_path" AS "flow_path",
    "generic_leg" AS "generic_leg",
    SUM("order_qty_agg") AS "order_qty_agg_sum"
  FROM (
    SELECT 
        "YEAR_PERIOD",
        "ARTICLE_NO",
        "VENDOR_ID",
        "org_Facility_Code",
        "org_Facility_Name",
        "org_Facility_Type",
        "dest_Facility_Code",
        "dest_Facility_Name",
        "dest_Facility_Type",
        "generic_leg",
        "turn_period",
        "order_qty_agg",
        "small_package_flag",
        "FREIGHT_TERMS_CODE",
        "org_Facility_vendor_type",
        "leg",
        "flow_path",
        "leg_name"
      FROM "FLOW_PATH_STACKED_PREPARED_JOINED"
      WHERE (UPPER("flow_path") = 'A4') OR ( UPPER("flow_path") = 'A5') OR ( UPPER("flow_path")= 'D3') OR ( UPPER("flow_path") = 'D4')
    ) "dku__beforegrouping"
  GROUP BY "YEAR_PERIOD", "ARTICLE_NO", "VENDOR_ID", "leg", "flow_path", "generic_leg"
  )
  SELECT 
    "flow_path_stacked_complex_paths"."YEAR_PERIOD" AS "YEAR_PERIOD",
    "flow_path_stacked_complex_paths"."ARTICLE_NO" AS "ARTICLE_NO",
    "flow_path_stacked_complex_paths"."VENDOR_ID" AS "VENDOR_ID",
    "flow_path_stacked_complex_paths"."leg" AS "leg",
    "flow_path_stacked_complex_paths"."flow_path" AS "flow_path",
    "flow_path_stacked_complex_paths"."generic_leg" AS "generic_leg",
    "flow_path_stacked_complex_paths"."order_qty_agg_sum" AS "order_qty_agg_sum",
    "flow_path_stacked_outbound_by_YEAR_PERIOD"."leg" AS "leg_2",
     "flow_path_leg_2"."leg_name" AS "leg_2_name"
  FROM flow_path_stacked_complex_paths_joined "flow_path_stacked_complex_paths"
  LEFT JOIN "FLOW_PATH_STACKED_OUTBOUND_BY_YEAR_PERIOD" "flow_path_stacked_outbound_by_YEAR_PERIOD"
    ON ("flow_path_stacked_complex_paths"."YEAR_PERIOD" = "flow_path_stacked_outbound_by_YEAR_PERIOD"."YEAR_PERIOD")
      AND ("flow_path_stacked_complex_paths"."ARTICLE_NO" = "flow_path_stacked_outbound_by_YEAR_PERIOD"."ARTICLE_NO")
   INNER JOIN ( SELECT 
                "flow_path" AS "flow_path",
                "leg_name" AS "leg_name",
                "leg_no" AS "leg_no",
                "total_legs" AS "total_legs"
                FROM "FLOW_PATH_MAPPING_PREPARED"
                WHERE ("leg_no" = 2) AND (("flow_path" = 'A4') OR ("flow_path" = 'A5') OR  ("flow_path" = 'D3') OR ("flow_path" = 'D4'))) 
                 "flow_path_leg_2"
    ON ( UPPER( TRIM("flow_path_stacked_outbound_by_YEAR_PERIOD"."leg")) = UPPER(TRIM("flow_path_leg_2"."leg_name")))
      AND (UPPER("flow_path_stacked_complex_paths"."flow_path") = UPPER("flow_path_leg_2"."flow_path"))  ;

<br>  
--FLOW_PATH_SELECTED	  
</br>
CREATE OR REPLACE TEMPORARY TABLE "FLOW_PATH_SELECTED"
AS
WITH CTE AS 
(SELECT 
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "ARTICLE_NO" AS "ARTICLE_NO",
    "VENDOR_ID" AS "VENDOR_ID",
    "leg" AS "leg",
    "flow_path" AS "flow_path",
    "generic_leg" AS "generic_leg",
    SUM("order_qty_agg") AS "order_qty_agg_sum"
  FROM (
    SELECT 
        "YEAR_PERIOD",
        "ARTICLE_NO",
        "VENDOR_ID",
        "org_Facility_Code",
        "org_Facility_Name",
        "org_Facility_Type",
        "dest_Facility_Code",
        "dest_Facility_Name",
        "dest_Facility_Type",
        "generic_leg",
        "turn_period",
        "order_qty_agg",
        "small_package_flag",
        "FREIGHT_TERMS_CODE",
        "org_Facility_vendor_type",
        "leg",
        "flow_path",
        "leg_name"
      FROM "FLOW_PATH_STACKED_PREPARED_JOINED"
      WHERE ( UPPER("flow_path") != 'A4' OR "flow_path" IS NULL AND 'A4' IS NOT NULL OR "flow_path" IS NOT NULL AND 'A4' IS NULL) AND ( UPPER("flow_path") != 'A5' OR "flow_path" IS NULL AND 'A5' IS NOT NULL OR "flow_path" IS NOT NULL AND 'A5' IS NULL) AND ( UPPER("flow_path") != 'D3' OR UPPER("flow_path") IS NULL AND 'D3' IS NOT NULL OR "flow_path" IS NOT NULL AND 'D3' IS NULL) AND (UPPER("flow_path") != 'D4' OR "flow_path" IS NULL AND 'D4' IS NOT NULL OR "flow_path" IS NOT NULL AND 'D4' IS NULL)
    ) "dku__beforegrouping"
  GROUP BY "YEAR_PERIOD", "ARTICLE_NO", "VENDOR_ID", "leg", "flow_path", "generic_leg"
  )

  SELECT 
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "ARTICLE_NO" AS "ARTICLE_NO",
    "VENDOR_ID" AS "VENDOR_ID",
    "leg" AS "leg",
    "flow_path" AS "flow_path",
    "generic_leg" AS "generic_leg",
    "order_qty_agg_sum" AS "order_qty_agg_sum"
  FROM CTE
UNION ALL
SELECT 
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "ARTICLE_NO" AS "ARTICLE_NO",
    "VENDOR_ID" AS "VENDOR_ID",
    "leg" AS "leg",
    "flow_path" AS "flow_path",
    "generic_leg" AS "generic_leg",
    "order_qty_agg_sum" AS "order_qty_agg_sum"
  FROM 
  (
  SELECT 
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "ARTICLE_NO" AS "ARTICLE_NO",
    "VENDOR_ID" AS "VENDOR_ID",
    "leg" AS "leg",
    "flow_path" AS "flow_path",
    "generic_leg" AS "generic_leg",
    "order_qty_agg_sum_sum" AS "order_qty_agg_sum"
  FROM (
        SELECT 
        "YEAR_PERIOD" AS "YEAR_PERIOD",
        "ARTICLE_NO" AS "ARTICLE_NO",
        "VENDOR_ID" AS "VENDOR_ID",
        "leg" AS "leg",
        "flow_path" AS "flow_path",
        "generic_leg" AS "generic_leg",
        SUM("order_qty_agg_sum") AS "order_qty_agg_sum_sum"
         FROM (
        SELECT 
            "YEAR_PERIOD" AS "YEAR_PERIOD",
            "ARTICLE_NO" AS "ARTICLE_NO",
            "VENDOR_ID" AS "VENDOR_ID",
            "leg" AS "leg",
            "flow_path" AS "flow_path",
            "generic_leg" AS "generic_leg",
            "order_qty_agg_sum" AS "order_qty_agg_sum",
            "leg_2" AS "leg_2",
            "leg_2_name" AS "leg_2_name"
          FROM "FLOW_PATH_STACKED_COMPLEX_PATHS_JOINED_JOINED"
        ) "dku__beforegrouping"
        GROUP BY "YEAR_PERIOD", "ARTICLE_NO", "VENDOR_ID", "leg", "flow_path", "generic_leg"
        ) "pristine_query"
  
      );

<br>
  --FINAL QUERY FOR FLOW_PATH_AGG_LEG_2
</br>
CREATE OR REPLACE TEMPORARY TABLE "FLOW_PATH_AGG_LEG_2"
AS
WITH CTE AS 
(
  
  SELECT 
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "ARTICLE_NO" AS "ARTICLE_NO",
    "VENDOR_ID" AS "VENDOR_ID",
    "leg" AS "leg",
    "flow_path" AS "flow_path",
    "import_flag" AS "import_flag",
    "generic_leg" AS "generic_leg",
    "order_qty" AS "order_qty",
    "order_qty_sum" AS "order_qty_sum",
    "share" AS "share",
    SUM("share") OVER (PARTITION BY "YEAR_PERIOD", "ARTICLE_NO") AS "share_sum"
    FROM (
SELECT *,
    "order_qty" / NULLIF("order_qty_sum", 0) AS "share",
    CASE WHEN ( UPPER("flow_path")= 'B1') OR ( UPPER("flow_path") = 'B2') OR ( UPPER("flow_path") = 'B3') THEN 1 ELSE 0 END AS "import_flag"
FROM (
  
  SELECT 
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "ARTICLE_NO" AS "ARTICLE_NO",
    "VENDOR_ID" AS "VENDOR_ID",
    "leg" AS "leg",
    "flow_path" AS "flow_path",
    "generic_leg" AS "generic_leg",
    "order_qty" AS "order_qty",
    SUM("order_qty") OVER (PARTITION BY "YEAR_PERIOD", "ARTICLE_NO") AS "order_qty_sum"
    FROM
        (  SELECT 
            "YEAR_PERIOD" AS "YEAR_PERIOD",
            "ARTICLE_NO" AS "ARTICLE_NO",
            "VENDOR_ID" AS "VENDOR_ID",
            "leg" AS "leg",
            "flow_path" AS "flow_path",
            "generic_leg" AS "generic_leg",
            SUM("order_qty_agg_sum") AS "order_qty"
          FROM "FLOW_PATH_SELECTED"
        GROUP BY "YEAR_PERIOD", "ARTICLE_NO", "VENDOR_ID", "leg", "flow_path", "generic_leg"
        )
        )A )flow_path_selected_agg_windows_prepared_windows 
)
SELECT 
    "flow_path_selected_agg_windows_prepared_windows"."YEAR_PERIOD" AS "YEAR_PERIOD",
    "flow_path_selected_agg_windows_prepared_windows"."ARTICLE_NO" AS "ARTICLE_NO",
    "flow_path_selected_agg_windows_prepared_windows"."VENDOR_ID" AS "VENDOR_ID",
    "flow_path_selected_agg_windows_prepared_windows"."leg" AS "leg",
    "flow_path_selected_agg_windows_prepared_windows"."flow_path" AS "flow_path",
    "flow_path_selected_agg_windows_prepared_windows"."import_flag" AS "import_flag",
    "flow_path_selected_agg_windows_prepared_windows"."generic_leg" AS "leg_1",
    "flow_path_selected_agg_windows_prepared_windows"."order_qty" AS "order_qty",
    "flow_path_selected_agg_windows_prepared_windows"."order_qty_sum" AS "order_qty_sum",
    "flow_path_selected_agg_windows_prepared_windows"."share" AS "share",
    "flow_path_selected_agg_windows_prepared_windows"."share_sum" AS "share_sum",
    "flow_path_leg_2_all"."leg_name" AS "leg_2",
    "flow_path_leg_3"."leg_name" AS "leg_3"
  FROM CTE "flow_path_selected_agg_windows_prepared_windows"
  LEFT JOIN 
           (SELECT 
                  "flow_path" AS "flow_path",
                  "leg_name" AS "leg_name",
                  "leg_no" AS "leg_no",
                  "total_legs" AS "total_legs"
            FROM "FLOW_PATH_MAPPING_PREPARED"
            WHERE "leg_no" = 2) "flow_path_leg_2_all"
  ON UPPER("flow_path_selected_agg_windows_prepared_windows"."flow_path")= UPPER("flow_path_leg_2_all"."flow_path")
  LEFT JOIN (
             SELECT 
             "flow_path" AS "flow_path",
             "leg_name" AS "leg_name",
             "leg_no" AS "leg_no",
             "total_legs" AS "total_legs"
            FROM "FLOW_PATH_MAPPING_PREPARED"
            WHERE "leg_no" = 3) "flow_path_leg_3"
  ON UPPER("flow_path_selected_agg_windows_prepared_windows"."flow_path") =UPPER("flow_path_leg_3"."flow_path");

<br>
/*FLOW_PATH_STACKED_PREPAID_ALL_LEGS*/
--FLOW_PATH_STACKED_OUTBOUND_JOINED
</br>
CREATE OR REPLACE TEMPORARY TABLE  "FLOW_PATH_STACKED_OUTBOUND_JOINED"
AS
WITH CTE AS 
(
SELECT 
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "ARTICLE_NO" AS "ARTICLE_NO",
    "VENDOR_ID" AS "VENDOR_ID",
    "org_Facility_Code" AS "org_Facility_Code",
    "org_Facility_Name" AS "org_Facility_Name",
    "org_Facility_Type" AS "org_Facility_Type",
    "dest_Facility_Code" AS "dest_Facility_Code",
    "dest_Facility_Name" AS "dest_Facility_Name",
    "dest_Facility_Type" AS "dest_Facility_Type",
    "generic_leg" AS "generic_leg",
    "turn_period" AS "turn_period",
    "order_qty_agg" AS "order_qty_agg",
    "small_package_flag" AS "small_package_flag",
    "FREIGHT_TERMS_CODE" AS "FREIGHT_TERMS_CODE",
    "org_Facility_vendor_type" AS "org_Facility_vendor_type",
    "leg" AS "leg"
  FROM "FLOW_PATH_STACKED_PREPARED"
  WHERE UPPER("org_Facility_Type") != 'VENDOR' OR UPPER("org_Facility_Type") IS NULL AND 'VENDOR' IS NOT NULL OR UPPER("org_Facility_Type") IS NOT NULL AND 'VENDOR' IS NULL
  )
SELECT 
    "flow_path_stacked_outbound"."YEAR_PERIOD" AS "YEAR_PERIOD",
    "flow_path_stacked_outbound"."ARTICLE_NO" AS "ARTICLE_NO",
    "flow_path_stacked_outbound"."VENDOR_ID" AS "VENDOR_ID",
    "flow_path_stacked_outbound"."org_Facility_Code" AS "org_Facility_Code",
    "flow_path_stacked_outbound"."org_Facility_Name" AS "org_Facility_Name",
    "flow_path_stacked_outbound"."org_Facility_Type" AS "org_Facility_Type",
    "flow_path_stacked_outbound"."dest_Facility_Code" AS "dest_Facility_Code",
    "flow_path_stacked_outbound"."dest_Facility_Name" AS "dest_Facility_Name",
    "flow_path_stacked_outbound"."dest_Facility_Type" AS "dest_Facility_Type",
    "flow_path_stacked_outbound"."generic_leg" AS "generic_leg",
    "flow_path_stacked_outbound"."turn_period" AS "turn_period",
    "flow_path_stacked_outbound"."order_qty_agg" AS "order_qty_agg",
    "flow_path_stacked_outbound"."small_package_flag" AS "small_package_flag",
    "flow_path_stacked_outbound"."FREIGHT_TERMS_CODE" AS "FREIGHT_TERMS_CODE",
    "flow_path_stacked_outbound"."org_Facility_vendor_type" AS "org_Facility_vendor_type",
    "flow_path_stacked_outbound"."leg" AS "leg",
    "flow_path_mapping_prepaid_leg_2"."flow_path" AS "flow_path",
    "flow_path_mapping_prepaid_leg_2"."leg_name" AS "leg_2"
  FROM CTE "flow_path_stacked_outbound"
  LEFT JOIN ( 
             SELECT 
                  "flow_path" AS "flow_path",
                  "leg_name" AS "leg_name",
                  "leg_no" AS "leg_no",
                  "total_legs" AS "total_legs"
             FROM (SELECT 
                   "flow_path" AS "flow_path",
                   "leg_name" AS "leg_name",
                   "leg_no" AS "leg_no",
                   "total_legs" AS "total_legs"
  FROM "FLOW_PATH_MAPPING_PREPARED"
  WHERE (UPPER("flow_path") = 'D1') OR (UPPER("flow_path") = 'D2') OR (UPPER("flow_path") = 'D3') OR (UPPER("flow_path")= 'D4') OR (UPPER("flow_path") = 'D5')) WHERE "leg_no" = 2) "flow_path_mapping_prepaid_leg_2"
  ON UPPER( TRIM("flow_path_stacked_outbound"."generic_leg")) = UPPER( TRIM("flow_path_mapping_prepaid_leg_2"."leg_name"));


<br>
--FINAL QUERY FOR FLOW_PATH_STACKED_PREPAID_ALL_LEGS
</br>

CREATE OR REPLACE TEMPORARY TABLE "FLOW_PATH_STACKED_PREPAID_ALL_LEGS"
 AS
  WITH CTE AS 
  (
    SELECT 
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "ARTICLE_NO" AS "ARTICLE_NO",
    "flow_path" AS "flow_path",
    "leg_2" AS "leg_2",
    "order_qty" AS "order_qty",
    SUM("order_qty") OVER (PARTITION BY "YEAR_PERIOD", "ARTICLE_NO") AS "order_qty_sum"
    FROM (
    SELECT 
        "YEAR_PERIOD" AS "YEAR_PERIOD",
        "ARTICLE_NO" AS "ARTICLE_NO",
        "flow_path" AS "flow_path",
        "leg_2" AS "leg_2",
        SUM("order_qty_agg") AS "order_qty"
      FROM (
        SELECT 
            "YEAR_PERIOD",
            "ARTICLE_NO",
            "VENDOR_ID",
            "org_Facility_Code",
            "org_Facility_Name",
            "org_Facility_Type",
            "dest_Facility_Code",
            "dest_Facility_Name",
            "dest_Facility_Type",
            "generic_leg",
            "turn_period",
            "order_qty_agg",
            "small_package_flag",
            "FREIGHT_TERMS_CODE",
            "org_Facility_vendor_type",
            "leg",
            "flow_path",
            "leg_2"
          FROM "FLOW_PATH_STACKED_OUTBOUND_JOINED"
          WHERE (CAST("flow_path" AS VARCHAR) != '' OR CAST("flow_path" AS VARCHAR) IS NULL AND '' IS NOT NULL OR CAST("flow_path" AS VARCHAR) IS NOT NULL AND '' IS NULL) AND "flow_path" IS NOT NULL
        ) "dku__beforegrouping"
      GROUP BY "YEAR_PERIOD", "ARTICLE_NO", "flow_path", "leg_2"
    ) 
    )
    SELECT 
    "flow_path_stacked_outbound_prep"."YEAR_PERIOD" AS "YEAR_PERIOD",
    "flow_path_stacked_outbound_prep"."ARTICLE_NO" AS "ARTICLE_NO",
    "flow_path_stacked_outbound_prep"."flow_path" AS "flow_path",
    "flow_path_stacked_outbound_prep"."leg_2" AS "leg_2",
    "flow_path_stacked_outbound_prep"."order_qty" AS "order_qty",
    "flow_path_stacked_outbound_prep"."order_qty_sum" AS "order_qty_sum",
    "flow_path_stacked_outbound_prep"."share" AS "share",
    "flow_path_mapping_leg_3"."leg_name" AS "leg_3"
  FROM (SELECT  *,"order_qty" / NULLIF("order_qty_sum", 0) AS "share"
    FROM CTE ) "flow_path_stacked_outbound_prep"
  LEFT JOIN ( 
     SELECT 
             "flow_path" AS "flow_path",
             "leg_name" AS "leg_name",
             "leg_no" AS "leg_no",
             "total_legs" AS "total_legs"
     FROM (SELECT 
              "flow_path" AS "flow_path",
              "leg_name" AS "leg_name",
              "leg_no" AS "leg_no",
               "total_legs" AS "total_legs"
    FROM "FLOW_PATH_MAPPING_PREPARED"
  WHERE (UPPER("flow_path")= 'D1') OR ( UPPER("flow_path") = 'D2') OR (UPPER("flow_path") = 'D3') OR (UPPER("flow_path") = 'D4') OR (UPPER("flow_path") = 'D5')) WHERE "leg_no" = 3) "flow_path_mapping_leg_3"
  ON UPPER("flow_path_stacked_outbound_prep"."flow_path") = UPPER("flow_path_mapping_leg_3"."flow_path");

<br>
--Sudheer's

	--FACILITY_OUTBOUND_DC_ONLY_QTY
</br>
	
CREATE OR REPLACE TEMPORARY TABLE FACILITY_OUTBOUND_DC_ONLY_QTY AS
SELECT  
    CAST("YEAR_PERIOD" AS NUMBER) AS "YEAR_PERIOD",
    "VENDOR_ID" AS "VENDOR_ID",
    "ARTICLE_NO" AS "ARTICLE_NO",
    "STORE_NO" AS "STORE_NO",
    SUM("VENDOR_RCPT_UNIT_QTY") AS "VENDOR_RCPT_UNIT_QTY_sum"
  FROM 
(
SELECT  
    facility_outbound_prepared.ACCT_YEAR AS ACCT_YEAR,
    facility_outbound_prepared.PERIOD AS PERIOD,
    facility_outbound_prepared.YEAR_PERIOD AS YEAR_PERIOD,
    facility_outbound_prepared.WEEK_IN_YEAR AS WEEK_IN_YEAR,
    facility_outbound_prepared.ARTICLE_NO AS ARTICLE_NO,
    facility_outbound_prepared.ARTICLE_CAT_FULL AS ARTICLE_CAT_FULL,
    facility_outbound_prepared.ARTICLE_CAT_CODE AS ARTICLE_CAT_CODE,
    facility_outbound_prepared.VENDOR_ID AS VENDOR_ID,
    facility_outbound_prepared.DEPT_FULL AS DEPT_FULL,
    facility_outbound_prepared.STORE_NO AS STORE_NO,
    facility_outbound_prepared.ADDR_LINE_1 AS ADDR_LINE_1,
    facility_outbound_prepared.CITY AS CITY,
    facility_outbound_prepared.STATE_POSTAL AS STATE_POSTAL,
    facility_outbound_prepared.STATE_NAME AS STATE_NAME,
    facility_outbound_prepared.POSTAL_CODE AS POSTAL_CODE,
    facility_outbound_prepared.VENDOR_RCPT_UNIT_QTY AS VENDOR_RCPT_UNIT_QTY,
    facility_outbound_prepared.VENDOR_RCPT_COST_AMT AS VENDOR_RCPT_COST_AMT,
    "DC_3PL" AS "DC_3PL"
  FROM  (SELECT   FACILITY_OUTBOUND_20TO22.*,
           CASE WHEN period <= '9' THEN   CONCAT(ACCT_YEAR,CONCAT('0' ,period)) 
           ELSE  CONCAT(ACCT_YEAR, period::VARCHAR) END AS   YEAR_PERIOD,
         SUBSTR(ARTICLE_CAT_FULL,1,REGEXP_INSTR(ARTICLE_CAT_FULL,1,'-')-1) ARTICLE_CAT_CODE
         from  FACILITY_OUTBOUND_20TO22)  facility_outbound_prepared
         INNER JOIN DC_3PL_LOCATION_MAPPING_PREPARED
         ON CAST(facility_outbound_prepared."STORE_NO" AS NUMBER)= CAST(DC_3PL_LOCATION_MAPPING_PREPARED."FACILITY_CODE"  AS NUMBER)
         WHERE "DC_3PL" = 'DC'
	)
	GROUP BY "YEAR_PERIOD", "VENDOR_ID", "ARTICLE_NO", "STORE_NO";

<br>
------------------------------
</br>
CREATE OR REPLACE TEMPORARY TABLE SHRINK_R12_PERIOD
AS
     SELECT  
    *,
    CONCAT(LAST_R12_YEAR, LAST_R12_PERIOD) AS LAST_R12_YEARPERIOD
FROM (
    SELECT 
        *,
        CASE
            WHEN "Month" = 12 THEN '01'
            ELSE TO_NUMBER("Month" + 1)
        END AS LAST_R12_PERIOD,
        CASE
            WHEN "Month" = 12 THEN YEAR
            ELSE YEAR - 1
        END AS LAST_R12_YEAR,
        CONCAT(SUBSTRING(YEAR_PERIOD, 0, 4),'-', SUBSTRING(YEAR_PERIOD, 5, 2),'-', '01', 'T00:00:00.000Z')AS YEAR_PERIOD_PARSED
    FROM SHRINK_THEFT_INVENTORY_ACTUAL_SHRINK
) AS DKU_BEFORCONCAT;



<br>
---------------------------
</br>
CREATE or REPLACE TEMPORARY TABLE FINANCIAL_INVENTORY_YP_PREP_JOINED_PREPARED AS
SELECT 
    *,
    CASE 
        WHEN (ITEM_VOLUME IS NULL) THEN ITEM_VOLUME_ARTICLE
        ELSE COALESCE(ITEM_VOLUME,0)
    END AS ITEM_VOLUME_COMBINE
FROM (
    SELECT 
        "CO_CODE" AS "CO_CODE",
        "STORE_NO" AS "STORE_NO",
        "ARTICLE_NO" AS "ARTICLE_NO",
        "TIME_DIM_KEY" AS "TIME_DIM_KEY",
        "FIN_INV_YEAR_PERIOD" AS "FIN_INV_YEAR_PERIOD",
        "SUM_TYPE_CODE" AS "SUM_TYPE_CODE",
        "VENDOR_ID" AS "VENDOR_ID",
        "DC_NO" AS "DC_NO",
        "REPL_TYPE_CODE" AS "REPL_TYPE_CODE",
        "CURRENT_VENDOR_ID" AS "CURRENT_VENDOR_ID",
        "CURRENT_DC_NO" AS "CURRENT_DC_NO",
        "CURRENT_REPL_TYPE_CODE" AS "CURRENT_REPL_TYPE_CODE",
        "FIN_INV_QTY" AS "FIN_INV_QTY",
        "FIN_INV_AMT" AS "FIN_INV_AMT",
        "OB_FIN_INV_QTY" AS "OB_FIN_INV_QTY",
        "OB_FIN_INV_AMT" AS "OB_FIN_INV_AMT",
        "FIN_INV_13_AMT" AS "FIN_INV_13_AMT",
        "CALC_RCPT_QTY" AS "CALC_RCPT_QTY",
        "CALC_RCPT_AMT" AS "CALC_RCPT_AMT",
        "AVG_FIN_INV_QTY" AS "AVG_FIN_INV_QTY",
        "AVG_FIN_INV_AMT" AS "AVG_FIN_INV_AMT",
        "FACILITY_CODE" AS "FACILITY_CODE",
        "FACILITY" AS "FACILITY",
        "DC_HIERCHY" AS "DC_HIERCHY",
        "DC_3PL" AS "DC_3PL",
        "OMS_ITEM_HEIGHT" AS "OMS_ITEM_HEIGHT",
        "OMS_ITEM_LENGTH" AS "OMS_ITEM_LENGTH",
        "OMS_ITEM_WIDTH" AS "OMS_ITEM_WIDTH",
        "ITEM_VOLUME" AS "ITEM_VOLUME",
        "ARTICLE_LENGTH" AS "ARTICLE_LENGTH",
        "ARTICLE_WIDTH" AS "ARTICLE_WIDTH",
        "ARTICLE_HEIGHT" AS "ARTICLE_HEIGHT",
        ("ARTICLE_LENGTH" * "ARTICLE_WIDTH" * "ARTICLE_HEIGHT") AS "ITEM_VOLUME_ARTICLE"
    FROM (
        SELECT 
            "FINANCIAL_P"."CO_CODE" AS "CO_CODE",
            "FINANCIAL_P"."STORE_NO" AS "STORE_NO",
            "FINANCIAL_P"."ARTICLE_NO" AS "ARTICLE_NO",
            "FINANCIAL_P"."TIME_DIM_KEY" AS "TIME_DIM_KEY",
            "FINANCIAL_P"."FIN_INV_YEAR_PERIOD" AS "FIN_INV_YEAR_PERIOD",
            "FINANCIAL_P"."SUM_TYPE_CODE" AS "SUM_TYPE_CODE",
            "FINANCIAL_P"."VENDOR_ID" AS "VENDOR_ID",
            "FINANCIAL_P"."DC_NO" AS "DC_NO",
            "FINANCIAL_P"."REPL_TYPE_CODE" AS "REPL_TYPE_CODE",
            "FINANCIAL_P"."CURRENT_VENDOR_ID" AS "CURRENT_VENDOR_ID",
            "FINANCIAL_P"."CURRENT_DC_NO" AS "CURRENT_DC_NO",
            "FINANCIAL_P"."CURRENT_REPL_TYPE_CODE" AS "CURRENT_REPL_TYPE_CODE",
            "FINANCIAL_P"."FIN_INV_QTY" AS "FIN_INV_QTY",
            "FINANCIAL_P"."FIN_INV_AMT" AS "FIN_INV_AMT",
            "FINANCIAL_P"."OB_FIN_INV_QTY" AS "OB_FIN_INV_QTY",
            "FINANCIAL_P"."OB_FIN_INV_AMT" AS "OB_FIN_INV_AMT",
            "FINANCIAL_P"."FIN_INV_13_AMT" AS "FIN_INV_13_AMT",
            "FINANCIAL_P"."CALC_RCPT_QTY" AS "CALC_RCPT_QTY",
            "FINANCIAL_P"."CALC_RCPT_AMT" AS "CALC_RCPT_AMT",
            "FINANCIAL_P"."AVG_FIN_INV_QTY" AS "AVG_FIN_INV_QTY",
            "FINANCIAL_P"."AVG_FIN_INV_AMT" AS "AVG_FIN_INV_AMT",
            "FINANCIAL_P"."FACILITY_CODE" AS "FACILITY_CODE",
            "FINANCIAL_P"."FACILITY" AS "FACILITY",
            "FINANCIAL_P"."DC_HIERCHY" AS "DC_HIERCHY",
            "FINANCIAL_P"."DC_3PL" AS "DC_3PL",
            "FINANCIAL_P"."OMS_ITEM_HEIGHT" AS "OMS_ITEM_HEIGHT",
            "FINANCIAL_P"."OMS_ITEM_LENGTH" AS "OMS_ITEM_LENGTH",
            "FINANCIAL_P"."OMS_ITEM_WIDTH" AS "OMS_ITEM_WIDTH",
            "FINANCIAL_P"."ITEM_VOLUME" AS "ITEM_VOLUME",
            "ARTICLE"."ARTICLE_LENGTH" AS "ARTICLE_LENGTH",
            "ARTICLE"."ARTICLE_WIDTH" AS "ARTICLE_WIDTH",
            "ARTICLE"."ARTICLE_HEIGHT" AS "ARTICLE_HEIGHT"
        FROM (       
            SELECT 
                "CO_CODE" AS "CO_CODE",
                "STORE_NO" AS "STORE_NO",
                "ARTICLE_NO" AS "ARTICLE_NO",
                "TIME_DIM_KEY" AS "TIME_DIM_KEY",
                "FIN_INV_YEAR_PERIOD" AS "FIN_INV_YEAR_PERIOD",
                "SUM_TYPE_CODE" AS "SUM_TYPE_CODE",
                "VENDOR_ID" AS "VENDOR_ID",
                "DC_NO" AS "DC_NO",
                "REPL_TYPE_CODE" AS "REPL_TYPE_CODE",
                "CURRENT_VENDOR_ID" AS "CURRENT_VENDOR_ID",
                "CURRENT_DC_NO" AS "CURRENT_DC_NO",
                "CURRENT_REPL_TYPE_CODE" AS "CURRENT_REPL_TYPE_CODE",
                "FIN_INV_QTY" AS "FIN_INV_QTY",
                "FIN_INV_AMT" AS "FIN_INV_AMT",
                "OB_FIN_INV_QTY" AS "OB_FIN_INV_QTY",
                "OB_FIN_INV_AMT" AS "OB_FIN_INV_AMT",
                "FIN_INV_13_AMT" AS "FIN_INV_13_AMT",
                "CALC_RCPT_QTY" AS "CALC_RCPT_QTY",
                "CALC_RCPT_AMT" AS "CALC_RCPT_AMT",
                "AVG_FIN_INV_QTY" AS "AVG_FIN_INV_QTY",
                "AVG_FIN_INV_AMT" AS "AVG_FIN_INV_AMT",
                "FACILITY_CODE" AS "FACILITY_CODE",
                "FACILITY" AS "FACILITY",
                "DC_HIERCHY" AS "DC_HIERCHY",
                "DC_3PL" AS "DC_3PL",
                "OMS_ITEM_HEIGHT" AS "OMS_ITEM_HEIGHT",
                "OMS_ITEM_LENGTH" AS "OMS_ITEM_LENGTH",
                "OMS_ITEM_WIDTH" AS "OMS_ITEM_WIDTH",
                ("OMS_ITEM_HEIGHT" * "OMS_ITEM_LENGTH" * "OMS_ITEM_WIDTH") AS "ITEM_VOLUME"
            FROM (
                SELECT 
                    "FINANCIAL"."CO_CODE" AS "CO_CODE",
                    "FINANCIAL"."STORE_NO" AS "STORE_NO",
                    "FINANCIAL"."ARTICLE_NO" AS "ARTICLE_NO",
                    "FINANCIAL"."TIME_DIM_KEY" AS "TIME_DIM_KEY",
                    "FINANCIAL"."FIN_INV_YEAR_PERIOD" AS "FIN_INV_YEAR_PERIOD",
                    "FINANCIAL"."SUM_TYPE_CODE" AS "SUM_TYPE_CODE",
                    "FINANCIAL"."VENDOR_ID" AS "VENDOR_ID",
                    "FINANCIAL"."DC_NO" AS "DC_NO",
                    "FINANCIAL"."REPL_TYPE_CODE" AS "REPL_TYPE_CODE",
                    "FINANCIAL"."CURRENT_VENDOR_ID" AS "CURRENT_VENDOR_ID",
                    "FINANCIAL"."CURRENT_DC_NO" AS "CURRENT_DC_NO",
                    "FINANCIAL"."CURRENT_REPL_TYPE_CODE" AS "CURRENT_REPL_TYPE_CODE",
                    "FINANCIAL"."FIN_INV_QTY" AS "FIN_INV_QTY",
                    "FINANCIAL"."FIN_INV_AMT" AS "FIN_INV_AMT",
                    "FINANCIAL"."OB_FIN_INV_QTY" AS "OB_FIN_INV_QTY",
                    "FINANCIAL"."OB_FIN_INV_AMT" AS "OB_FIN_INV_AMT",
                    "FINANCIAL"."FIN_INV_13_AMT" AS "FIN_INV_13_AMT",
                    "FINANCIAL"."CALC_RCPT_QTY" AS "CALC_RCPT_QTY",
                    "FINANCIAL"."CALC_RCPT_AMT" AS "CALC_RCPT_AMT",
                    "FINANCIAL"."AVG_FIN_INV_QTY" AS "AVG_FIN_INV_QTY",
                    "FINANCIAL"."AVG_FIN_INV_AMT" AS "AVG_FIN_INV_AMT",
                    "FINANCIAL"."FACILITY_CODE" AS "FACILITY_CODE",
                    "FINANCIAL"."FACILITY" AS "FACILITY",
                    "FINANCIAL"."DC_HIERCHY" AS "DC_HIERCHY",
                    "FINANCIAL"."DC_3PL" AS "DC_3PL",
                    "TIME_DIM"."OMS_ITEM_HEIGHT" AS "OMS_ITEM_HEIGHT",
                    "TIME_DIM"."OMS_ITEM_LENGTH" AS "OMS_ITEM_LENGTH",
                    "TIME_DIM"."OMS_ITEM_WIDTH" AS "OMS_ITEM_WIDTH"
                FROM  FINANCIAL_INVENTORY_YP_PREPARED_FILTERED_JOINED "FINANCIAL"
                LEFT JOIN (SELECT  *
                    FROM ITEM_SHIPPING_DIMENSION_BY_ARTICLE_NO_DIM 
                    WHERE "ARTICLE_NO" IS NOT NULL AND "OMS_ITEM_HEIGHT" IS NOT NULL AND "OMS_ITEM_LENGTH" IS NOT NULL AND "OMS_ITEM_WIDTH" IS NOT NULL AND "OMS_ITEM_WEIGHT" IS NOT NULL
                     
                ) "TIME_DIM"
                ON "FINANCIAL"."ARTICLE_NO" = "TIME_DIM"."ARTICLE_NO"
                ) "WITHOUTCOMPUTEDCOLS_QUERY"
        ) "FINANCIAL_P"
        LEFT JOIN "EDW"."VW_ARTICLE" "ARTICLE"
        ON "FINANCIAL_P"."ARTICLE_NO" = "ARTICLE"."ARTICLE_NO"
        ) "WITHOUTCOMPUTEDCOLS_QUERY"
)"DKU3";

<br>
--D5--TENANT149_DATA_time_dimension_by_YEAR_PERIOD_bigint
--1
</br>
insert into TENANT149_DATA_TIME_DIMENSION_BY_YEAR_PERIOD_PREPARED 
SELECT 
    "YEAR_PERIOD",
    "MERCH_YEAR",
    "YEAR_QUARTER"
FROM "EDW"."TIME_DIMENSION"
GROUP BY "YEAR_PERIOD", "MERCH_YEAR", "YEAR_QUARTER";

<br>
--2
</br>
insert into TENANT149_DATA_TIME_DIMENSION_BY_YEAR_PERIOD_BIGINT 
SELECT 
    "YEAR_PERIOD",
    "MERCH_YEAR"
FROM "TENANT149_DATA_TIME_DIMENSION_BY_YEAR_PERIOD_PREPARED";

<br>
----------------------------------
</br>	
CREATE OR REPLACE TEMPORARY TABLE TENANT149_DATA_FINANCIAL_INVENTORY_YP_PREP_JOINED
AS 
SELECT 
 FINANCIAL_INVENTORY_YP_PREP_GROUPED_PREPARED.YEAR_PERIOD AS YEAR_PERIOD,
    FINANCIAL_INVENTORY_YP_PREP_GROUPED_PREPARED.ARTICLE_NO AS ARTICLE_NO,
    FINANCIAL_INVENTORY_YP_PREP_GROUPED_PREPARED.STORE_NO AS STORE_NO,
    FINANCIAL_INVENTORY_YP_PREP_GROUPED_PREPARED.VENDOR_ID AS VENDOR_ID,
    FINANCIAL_INVENTORY_YP_PREP_GROUPED_PREPARED.VOLUME AS VOLUME,
    TENANT149_DATA_TIME_DIMENSION_BY_YEAR_PERIOD_PREPARED.MERCH_YEAR AS MERCH_YEAR
    FROM 
(
SELECT 
    FIN_INV_YEAR_PERIOD AS YEAR_PERIOD,
    ARTICLE_NO AS ARTICLE_NO,
    STORE_NO AS STORE_NO,
    VENDOR_ID AS VENDOR_ID,
    TOTAL_ITEM_VOLUME_SUM AS VOLUME
  FROM (
    SELECT 
        FIN_INV_YEAR_PERIOD AS FIN_INV_YEAR_PERIOD,
        ARTICLE_NO AS ARTICLE_NO,
        STORE_NO AS STORE_NO,
        VENDOR_ID AS VENDOR_ID,
        SUM(TOTAL_ITEM_VOLUME) AS TOTAL_ITEM_VOLUME_SUM
      FROM (
        SELECT 
            CO_CODE AS CO_CODE,
            STORE_NO AS STORE_NO,
            ARTICLE_NO AS ARTICLE_NO,
            TIME_DIM_KEY AS TIME_DIM_KEY,
            FIN_INV_YEAR_PERIOD AS FIN_INV_YEAR_PERIOD,
            SUM_TYPE_CODE AS SUM_TYPE_CODE,
            VENDOR_ID AS VENDOR_ID,
            DC_NO AS DC_NO,
            REPL_TYPE_CODE AS REPL_TYPE_CODE,
            CURRENT_VENDOR_ID AS CURRENT_VENDOR_ID,
            CURRENT_DC_NO AS CURRENT_DC_NO,
            CURRENT_REPL_TYPE_CODE AS CURRENT_REPL_TYPE_CODE,
            FIN_INV_QTY AS FIN_INV_QTY,
            FIN_INV_AMT AS FIN_INV_AMT,
            OB_FIN_INV_QTY AS OB_FIN_INV_QTY,
            OB_FIN_INV_AMT AS OB_FIN_INV_AMT,
            FIN_INV_13_AMT AS FIN_INV_13_AMT,
            CALC_RCPT_QTY AS CALC_RCPT_QTY,
            CALC_RCPT_AMT AS CALC_RCPT_AMT,
            AVG_FIN_INV_QTY AS AVG_FIN_INV_QTY,
            AVG_FIN_INV_AMT AS AVG_FIN_INV_AMT,
            FACILITY_CODE AS FACILITY_CODE,
            FACILITY AS FACILITY,
            DC_HIERCHY AS DC_HIERCHY,
            DC_3PL AS DC_3PL,
            OMS_ITEM_HEIGHT AS OMS_ITEM_HEIGHT,
            OMS_ITEM_LENGTH AS OMS_ITEM_LENGTH,
            OMS_ITEM_WIDTH AS OMS_ITEM_WIDTH,
            ITEM_VOLUME AS ITEM_VOLUME,
            ARTICLE_LENGTH AS ARTICLE_LENGTH,
            ARTICLE_WIDTH AS ARTICLE_WIDTH,
            ARTICLE_HEIGHT AS ARTICLE_HEIGHT,
            ITEM_VOLUME_ARTICLE AS ITEM_VOLUME_ARTICLE,
            ITEM_VOLUME_COMBINE AS ITEM_VOLUME_COMBINE,
            COALESCE(round(ITEM_VOLUME_COMBINE), 0) * COALESCE(round(FIN_INV_QTY), 0) AS TOTAL_ITEM_VOLUME
          FROM FINANCIAL_INVENTORY_YP_PREP_JOINED_PREPARED
        ) DKU__BEFOREGROUPING
      GROUP BY FIN_INV_YEAR_PERIOD, ARTICLE_NO, STORE_NO, VENDOR_ID
    ) PRISTINE_QUERY
    ) FINANCIAL_INVENTORY_YP_PREP_GROUPED_PREPARED
    LEFT JOIN TENANT149_DATA_TIME_DIMENSION_BY_YEAR_PERIOD_PREPARED
    ON (FINANCIAL_INVENTORY_YP_PREP_GROUPED_PREPARED.YEAR_PERIOD = TENANT149_DATA_TIME_DIMENSION_BY_YEAR_PERIOD_PREPARED.YEAR_PERIOD);

<br>
--3
</br>
INSERT INTO PURCHASE_ORDER_LINE_PREPAID 
SELECT 
    "cal_YEAR_PERIOD" AS "YEAR_PERIOD",
    "ARTICLE_NO" AS "ARTICLE_NO",
    "FREIGHT_TYPE_CODE" AS "FREIGHT_TYPE_CODE",
    SUM("PO_LINE_ORDER_QTY") AS "PO_ORDER_QTY",
    SUM("receipt") AS "RECEIPT"
FROM (
    SELECT 
        "STORE_NO" AS "STORE_NO",
        "CO_CODE" AS "CO_CODE",
        "ARTICLE_NO" AS "ARTICLE_NO",
        "PO_NO" AS "PO_NO",
        "PO_LINE_NO" AS "PO_LINE_NO",
        "PO_DATE" AS "PO_DATE",
        "po_date_parsed" AS "po_date_parsed",
        "DELIV_DATE" AS "DELIV_DATE",
        "deliv_date_parsed" AS "deliv_date_parsed",
        "PO_TYPE_CODE" AS "PO_TYPE_CODE",
        "VENDOR_ID" AS "VENDOR_ID",
        "VSR_CODE" AS "VSR_CODE",
        "PO_LINE_CANCELLED_FLAG" AS "PO_LINE_CANCELLED_FLAG",
        "PO_LINE_ORDER_QTY" AS "PO_LINE_ORDER_QTY",
        "PO_LINE_ISSUE_QTY" AS "PO_LINE_ISSUE_QTY",
        "PO_LINE_RCVD_QTY" AS "PO_LINE_RCVD_QTY",
        "PO_LINE_UNIT_PRICE" AS "PO_LINE_UNIT_PRICE",
        "DC_NO" AS "DC_NO",
        "PO_TRACKING_NO" AS "PO_TRACKING_NO",
        "PO_LINE_TRACKING_NO" AS "PO_LINE_TRACKING_NO",
        "CURRENT_REPL_TYPE_CODE" AS "CURRENT_REPL_TYPE_CODE",
        "FREIGHT_TYPE_CODE" AS "FREIGHT_TYPE_CODE",
        "SHIP_START_DATE" AS "SHIP_START_DATE",
        "SHIP_END_DATE" AS "SHIP_END_DATE",
        "DELIV_START_DATE" AS "DELIV_START_DATE",
        "DELIV_END_DATE" AS "DELIV_END_DATE",
        "PO_LINE_UNIT_FREIGHT_AMT" AS "PO_LINE_UNIT_FREIGHT_AMT",
        "PO_LINE_MANUFACTURER" AS "PO_LINE_MANUFACTURER",
        "PO_LINE_ORIGIN_COUNTRY_CODE" AS "PO_LINE_ORIGIN_COUNTRY_CODE",
        "PO_LINE_PORT_OF_ORIGIN" AS "PO_LINE_PORT_OF_ORIGIN",
        "PO_LINE_MIN_RCVD_DATE" AS "PO_LINE_MIN_RCVD_DATE",
        "PO_LINE_MAX_RCVD_DATE" AS "PO_LINE_MAX_RCVD_DATE",
        "PO_LINE_DELIVERED_FLAG" AS "PO_LINE_DELIVERED_FLAG",
        "PO_LINE_CONFIRMED_ON_BOARD_DATE" AS "PO_LINE_CONFIRMED_ON_BOARD_DATE",
        "PO_LINE_BOOKED_FOR_SHIPMENT_DATE" AS "PO_LINE_BOOKED_FOR_SHIPMENT_DATE",
        "PO_LINE_TRANSIT_RESN_CODE" AS "PO_LINE_TRANSIT_RESN_CODE",
        "PO_LINE_MOVE_TYPE_CODE" AS "PO_LINE_MOVE_TYPE_CODE",
        "PO_LINE_AGENT_COMMISSION_RATE" AS "PO_LINE_AGENT_COMMISSION_RATE",
        "PO_LINE_AGENT_COMMISSION_AMT" AS "PO_LINE_AGENT_COMMISSION_AMT",
        "PO_LINE_ADDL_ARTICLE_NO" AS "PO_LINE_ADDL_ARTICLE_NO",
        "PO_LINE_ADDL_ARTICLE_QTY" AS "PO_LINE_ADDL_ARTICLE_QTY",
        "PO_LINE_FACTORY_VENDOR_ID" AS "PO_LINE_FACTORY_VENDOR_ID",
        "PO_LINE_STUFFING_LOC_VENDOR_ID" AS "PO_LINE_STUFFING_LOC_VENDOR_ID",
        "PO_LINE_SOURCING_AGENT_VENDOR_ID" AS "PO_LINE_SOURCING_AGENT_VENDOR_ID",
        "PO_LINE_FREIGHT_FORWARDER_VENDOR_ID" AS "PO_LINE_FREIGHT_FORWARDER_VENDOR_ID",
        "PO_LINE_LETTER_OF_CREDIT_NO" AS "PO_LINE_LETTER_OF_CREDIT_NO",
        "PO_LINE_OPEN_ACCT_NO" AS "PO_LINE_OPEN_ACCT_NO",
        "PO_LINE_ARTICLE_LENGTH" AS "PO_LINE_ARTICLE_LENGTH",
        "PO_LINE_ARTICLE_WIDTH" AS "PO_LINE_ARTICLE_WIDTH",
        "PO_LINE_ARTICLE_HEIGHT" AS "PO_LINE_ARTICLE_HEIGHT",
        "PO_LINE_ARTICLE_DIMENSIONS_UOM" AS "PO_LINE_ARTICLE_DIMENSIONS_UOM",
        "PO_LINE_ARTICLE_WEIGHT" AS "PO_LINE_ARTICLE_WEIGHT",
        "PO_LINE_ARTICLE_WEIGHT_UOM" AS "PO_LINE_ARTICLE_WEIGHT_UOM",
        "PO_TOTAL_WEIGHT" AS "PO_TOTAL_WEIGHT",
        "PO_LINE_ARTICLE_VOLUME" AS "PO_LINE_ARTICLE_VOLUME",
        "PO_LINE_ARTICLE_VOLUME_UOM" AS "PO_LINE_ARTICLE_VOLUME_UOM",
        "PO_TOTAL_VOLUME" AS "PO_TOTAL_VOLUME",
        "HTS_CODE" AS "HTS_CODE",
        "PO_LINE_DUTY_RATE" AS "PO_LINE_DUTY_RATE",
        "PO_LINE_DUTY_AMT" AS "PO_LINE_DUTY_AMT",
        "PO_LINE_ADDL_HTS_CODE_1" AS "PO_LINE_ADDL_HTS_CODE_1",
        "PO_LINE_ADDL_DUTY_RATE_1" AS "PO_LINE_ADDL_DUTY_RATE_1",
        "PO_LINE_ADDL_DUTY_AMT_1" AS "PO_LINE_ADDL_DUTY_AMT_1",
        "PO_LINE_ADDL_HTS_CODE_2" AS "PO_LINE_ADDL_HTS_CODE_2",
        "PO_LINE_ADDL_DUTY_RATE_2" AS "PO_LINE_ADDL_DUTY_RATE_2",
        "PO_LINE_ADDL_DUTY_AMT_2" AS "PO_LINE_ADDL_DUTY_AMT_2",
        "PO_HELD_FLAG" AS "PO_HELD_FLAG",
        "PO_VENDOR_DOC_DATE" AS "PO_VENDOR_DOC_DATE",
        "cal_MERCH_YEAR" AS "cal_MERCH_YEAR",
        "cal_YEAR_WEEK" AS "cal_YEAR_WEEK",
        "cal_YEAR_QUARTER" AS "cal_YEAR_QUARTER",
        "cal_YEAR_PERIOD" AS "cal_YEAR_PERIOD",
        COALESCE("PO_LINE_ORDER_QTY", 0) * COALESCE("PO_LINE_UNIT_PRICE", 0) AS "receipt"
    FROM (
        SELECT 
            "STORE_NO",
            "CO_CODE",
            "ARTICLE_NO",
            "PO_NO",
            "PO_LINE_NO",
            "PO_DATE",
            "po_date_parsed",
            "DELIV_DATE",
            "deliv_date_parsed",
            "PO_TYPE_CODE",
            "VENDOR_ID",
            "VSR_CODE",
            "PO_LINE_CANCELLED_FLAG",
            "PO_LINE_ORDER_QTY",
            "PO_LINE_ISSUE_QTY",
            "PO_LINE_RCVD_QTY",
            "PO_LINE_UNIT_PRICE",
            "DC_NO",
            "PO_TRACKING_NO",
            "PO_LINE_TRACKING_NO",
            "CURRENT_REPL_TYPE_CODE",
            "FREIGHT_TYPE_CODE",
            "SHIP_START_DATE",
            "SHIP_END_DATE",
            "DELIV_START_DATE",
            "DELIV_END_DATE",
            "PO_LINE_UNIT_FREIGHT_AMT",
            "PO_LINE_MANUFACTURER",
            "PO_LINE_ORIGIN_COUNTRY_CODE",
            "PO_LINE_PORT_OF_ORIGIN",
            "PO_LINE_MIN_RCVD_DATE",
            "PO_LINE_MAX_RCVD_DATE",
            "PO_LINE_DELIVERED_FLAG",
            "PO_LINE_CONFIRMED_ON_BOARD_DATE",
            "PO_LINE_BOOKED_FOR_SHIPMENT_DATE",
            "PO_LINE_TRANSIT_RESN_CODE",
            "PO_LINE_MOVE_TYPE_CODE",
            "PO_LINE_AGENT_COMMISSION_RATE",
            "PO_LINE_AGENT_COMMISSION_AMT",
            "PO_LINE_ADDL_ARTICLE_NO",
            "PO_LINE_ADDL_ARTICLE_QTY",
            "PO_LINE_FACTORY_VENDOR_ID",
            "PO_LINE_STUFFING_LOC_VENDOR_ID",
            "PO_LINE_SOURCING_AGENT_VENDOR_ID",
            "PO_LINE_FREIGHT_FORWARDER_VENDOR_ID",
            "PO_LINE_LETTER_OF_CREDIT_NO",
            "PO_LINE_OPEN_ACCT_NO",
            "PO_LINE_ARTICLE_LENGTH",
            "PO_LINE_ARTICLE_WIDTH",
            "PO_LINE_ARTICLE_HEIGHT",
            "PO_LINE_ARTICLE_DIMENSIONS_UOM",
            "PO_LINE_ARTICLE_WEIGHT",
            "PO_LINE_ARTICLE_WEIGHT_UOM",
            "PO_TOTAL_WEIGHT",
            "PO_LINE_ARTICLE_VOLUME",
            "PO_LINE_ARTICLE_VOLUME_UOM",
            "PO_TOTAL_VOLUME",
            "HTS_CODE",
            "PO_LINE_DUTY_RATE",
            "PO_LINE_DUTY_AMT",
            "PO_LINE_ADDL_HTS_CODE_1",
            "PO_LINE_ADDL_DUTY_RATE_1",
            "PO_LINE_ADDL_DUTY_AMT_1",
            "PO_LINE_ADDL_HTS_CODE_2",
            "PO_LINE_ADDL_DUTY_RATE_2",
            "PO_LINE_ADDL_DUTY_AMT_2",
            "PO_HELD_FLAG",
            "PO_VENDOR_DOC_DATE",
            "cal_MERCH_YEAR",
            "cal_YEAR_WEEK",
            "cal_YEAR_QUARTER",
            "cal_YEAR_PERIOD"
        FROM "PURCHASE_ORDER_LINE_W_CAL"
        WHERE "CO_CODE" = 'TSC'
        ) "withoutcomputedcols_query"
    ) "dku__beforegrouping"
GROUP BY "cal_YEAR_PERIOD", "ARTICLE_NO", "FREIGHT_TYPE_CODE";

<br>
----------------------------------
</br>	

CREATE OR REPLACE TEMPORARY TABLE PURCHASE_ORDER_LINE_PREPAID_SHARE AS
WITH Base AS
(
    SELECT  
          B.YEAR_PERIOD	
        , B.ARTICLE_NO	
        , B.turn_period	
        , B.total_receipt	
        , B.prepaid_receipt
        , ifnull(  ( B.turn_period  ) *-1, -1  ) as negativeturn_period
        , TO_DATE(  CONCAT(  LEFT( cast(B.YEAR_PERIOD AS VARCHAR) , 4 ) , '-' , RIGHT( cast(B.YEAR_PERIOD AS VARCHAR) , 2 ) , '-01'  ) ) as Period
    FROM
        (SELECT 
    YEAR_PERIOD AS YEAR_PERIOD,
    ARTICLE_NO AS ARTICLE_NO,
    turn_period AS turn_period,
    receipt_sum AS total_receipt,
    prepaid_receipt_sum AS prepaid_receipt
  FROM (
    SELECT 
        YEAR_PERIOD AS YEAR_PERIOD,
        ARTICLE_NO AS ARTICLE_NO,
        turn_period AS turn_period,
        SUM(receipt) AS receipt_sum,
        SUM(prepaid_receipt) AS prepaid_receipt_sum
      FROM (
        SELECT 
            YEAR_PERIOD AS YEAR_PERIOD,
            ARTICLE_NO AS ARTICLE_NO,
            prepaid_flag AS prepaid_flag,
            receipt AS receipt,
            turn_period AS turn_period,
            CASE WHEN prepaid_flag = 'Prepaid' THEN receipt ELSE 0 END AS prepaid_receipt
          FROM 
          (SELECT 
    purchase_order_line_prepaid_by_YEAR_PERIOD.YEAR_PERIOD AS YEAR_PERIOD,
    purchase_order_line_prepaid_by_YEAR_PERIOD.ARTICLE_NO AS ARTICLE_NO,
    purchase_order_line_prepaid_by_YEAR_PERIOD.prepaid_flag AS prepaid_flag,
    purchase_order_line_prepaid_by_YEAR_PERIOD.receipt AS receipt,
    turn_period_master."turn_period" AS turn_period
  FROM 
  (SELECT 
    YEAR_PERIOD AS YEAR_PERIOD,
    ARTICLE_NO AS ARTICLE_NO,
    prepaid_flag AS prepaid_flag,
    receipt_sum AS receipt
  FROM (
    SELECT 
        YEAR_PERIOD AS YEAR_PERIOD,
        ARTICLE_NO AS ARTICLE_NO,
        prepaid_flag AS prepaid_flag,
        SUM(receipt) AS receipt_sum
      FROM (
        SELECT 
            YEAR_PERIOD AS YEAR_PERIOD,
            ARTICLE_NO AS ARTICLE_NO,
            FREIGHT_TYPE_CODE AS FREIGHT_TYPE_CODE,
            po_order_qty AS po_order_qty,
            receipt AS receipt,
            CASE WHEN FREIGHT_TYPE_CODE = 'FPV' THEN 'Prepaid' ELSE 'Other' END AS prepaid_flag
          FROM PURCHASE_ORDER_LINE_PREPAID
        ) dku__beforegrouping
      GROUP BY YEAR_PERIOD, ARTICLE_NO, prepaid_flag
    )) purchase_order_line_prepaid_by_YEAR_PERIOD
  LEFT JOIN TURN_PERIOD_MASTER turn_period_master
    ON purchase_order_line_prepaid_by_YEAR_PERIOD.ARTICLE_NO = turn_period_master.ARTICLE_NO
	)
        ) dku__beforegrouping
      GROUP BY YEAR_PERIOD, ARTICLE_NO, turn_period
    ) pristine_query) B
)
select YEAR_PERIOD,
    ARTICLE_NO,
    turn_period,
    total_receipt,
    prepaid_receipt,
    total_receipt_cummulated,
    prepaid_receipt_cummulated,
    CASE WHEN total_receipt_cummulated IS NULL OR (ROUND(COALESCE(total_receipt_cummulated, 0), 0) = 0) THEN 0 ELSE CAST(COALESCE(prepaid_receipt_cummulated, 0) AS DOUBLE) / NULLIF(COALESCE(total_receipt_cummulated, 0), 0) END AS prepaid_share
    from (
SELECT 
      Base.YEAR_PERIOD	
    , Base.ARTICLE_NO	
    , Base.turn_period	
    , Base.total_receipt	
    , Base.prepaid_receipt
    , SUM ( Agg.total_receipt	 )     as total_receipt_cummulated
    , SUM ( Agg.prepaid_receipt	 ) as prepaid_receipt_cummulated
FROM 
    Base 
    LEFT OUTER JOIN Base Agg on ifnull( Base.ARTICLE_NO ,-9999 ) = ifnull( Agg.ARTICLE_NO ,-9999 )
        AND Agg.Period between DateAdd( month, Base.negativeturn_period + 1 , Base.Period ) and Base.Period
GROUP BY 
      Base.YEAR_PERIOD	
    , Base.ARTICLE_NO	
    , Base.turn_period	
    , Base.total_receipt	
    , Base.prepaid_receipt);


<br>
--DCshrink_rate
--------------
</br>
insert into DCSHRINK_RATE
select 
   Article
  ,cal_MERCH_YEAR
  ,cal_YEAR_PERIOD
  ,allocation_value
  ,SALES_AMT
  ,CASE WHEN SALES_AMT = 0 OR SALES_AMT IS NULL 
  THEN 0 ELSE CAST(COALESCE(allocation_value, 0) AS DOUBLE) / NULLIF(COALESCE(SALES_AMT, 0), 0) 
  END AS shrink_rate
FROM ( 
  select A.*, sales.SALES_AMT from(
      SELECT 
          shrnk."Article" AS Article  
          ,tmdm.MERCH_YEAR AS cal_MERCH_YEAR
          ,tmdm.YEAR_PERIOD AS cal_YEAR_PERIOD
          ,SUM(COALESCE(shrnk."Amount_in_LC", 0) * mvcp.multiplier) AS allocation_value
        FROM DC_SHRINK_PREPARED_STACKED shrnk
        LEFT JOIN MOVEMENT_CODES_PREPARED_STG mvcp
          ON shrnk."Movement_type" = mvcp.Movement_codes
        LEFT JOIN EDW.TIME_DIMENSION tmdm
          ON shrnk."Posting_date" = tmdm.time_dim_key
        WHERE CAST(shrnk."Movement_type" AS NUMBER) in (712, 711, 812, 811, 998, 999)
        GROUP BY 1,2,3
          )A
LEFT JOIN SALES_FOR_SHRINK sales
    ON A.Article =sales.ARTICLE_NO and A.cal_YEAR_PERIOD=sales.YEAR_PERIOD
    )"dku";

<br>
-- DCSHRINK_RATE_BACKUP CLONE DCSHRINK_RATE;
--DEFECTIVE_Prep_Joined_prepared_1
--------------------
</br>
CREATE OR REPLACE TEMPORARY TABLE DEFECTIVE_Prep_Joined_prepared_1
AS
SELECT  
  cast("Article" as number) as "Article",
  CAL_MERCH_YEAR,
  CAL_YEAR_PERIOD,
  "Amount_in_LC" *  "MULTIPLIER"  AS Allocation_VALUE
FROM 
    (
SELECT 
    "defpr"."Article" ,
    "TMDMPR"."MERCH_YEAR" AS cal_MERCH_YEAR,
    "TMDMPR"."YEAR_PERIOD" AS cal_YEAR_PERIOD,
     COALESCE("defpr"."Amount_in_LC", 0)  AS "Amount_in_LC",
	 COALESCE("MVCPR"."MULTIPLIER",0)  AS "MULTIPLIER" ,
	 CAST("defpr"."Movement_type" AS NUMBER) AS "Movement_type"
FROM "SHRINK_DEFECTIVE_2020" "defpr"
LEFT JOIN "MOVEMENT_CODES_PREPARED_STG" "MVCPR"
ON CAST("defpr"."Movement_type" AS NUMBER) = CAST("MVCPR"."MOVEMENT_CODES" AS NUMBER)
LEFT JOIN "EDW"."TIME_DIMENSION" "TMDMPR"
ON "defpr"."Posting_date" = "TMDMPR"."TIME_DIM_KEY"
   ) as dku
WHERE  "Movement_type" IN (991,891,980,880,982,882,995,895);

<br>
-- DEFECTIVE_Prep_Joined_prepared_BY_ARTICLE_1
</br>
CREATE OR REPLACE TEMP TABLE DEFECTIVE_Prep_Joined_prepared_BY_ARTICLE_1
  AS
  SELECT 
  "Article",
  CAL_MERCH_YEAR,
  CAL_YEAR_PERIOD,
  SUM(Allocation_VALUE) AS Allocation_VALUE
  FROM DEFECTIVE_Prep_Joined_prepared_1
  GROUP BY   "Article",CAL_MERCH_YEAR,CAL_YEAR_PERIOD;

<br>
-- DEFECTIVE_RATE_1
</br>
CREATE OR REPLACE TEMP TABLE DEFECTIVE_RATE_1
AS
SELECT 
        "Article",
		CAL_MERCH_YEAR,
		CAL_YEAR_PERIOD,
		Allocation_VALUE,
		SALES_AMT,
  CASE WHEN ("SALES_AMT" = 0) OR "SALES_AMT" IS NULL THEN 0 ELSE  COALESCE(Allocation_VALUE, 0) / COALESCE("SALES_AMT", 0) END AS shrink_rate
  FROM 
(
  SELECT 
	def."Article",
	def.CAL_MERCH_YEAR,
	def.CAL_YEAR_PERIOD,
	def.Allocation_VALUE,
	"sales"."SALES_AMT"
  FROM DEFECTIVE_Prep_Joined_prepared_BY_ARTICLE_1 def
  LEFT JOIN "SALES_FOR_SHRINK" "sales" 
  ON def."Article"="sales"."ARTICLE_NO" and def.CAL_YEAR_PERIOD="sales"."YEAR_PERIOD" );

<br>
--duty_rate_latest
-----------------
</br>
CREATE OR REPLACE TEMPORARY TABLE DUTY_BY_ARTICLE_PERIOD_JOINED_STG AS
SELECT 
    "dtyart"."YEAR_PERIOD",
    "dtyart"."ARTICLE_NO",
    "dtyart"."VENDOR_ID",
    AVG("dtyart"."DUTY_RATE_AVG") AS duty_rate,
    "trnprd"."turn_period"
  FROM 
  (SELECT 
    "YEAR_PERIOD",
    "ITEM_INT" AS "ARTICLE_NO",
    "VENDOR_ID",
    AVG("AVG_EFFECTIVE_DUTY_RATE") AS duty_rate_avg
FROM "DUTY_PREPARED_PREPARED_1_FILTERED_STACKED"
GROUP BY "YEAR_PERIOD", "ITEM_INT", "VENDOR_ID"
UNION All
SELECT 
    "tmdmyr"."YEAR_PERIOD",
    "prart"."ITEM_INT" AS "ARTICLE_NO",
    "prart"."VENDOR_ID",
    NULL AS duty_rate_avg
FROM "DUTY_PREPARED_PREPARED_1_FILTERED_STACKED" "prart"
CROSS JOIN (select DISTINCT year_period from EDW.TIME_DIMENSION 
                WHERE YEAR_PERIOD >= 202001 AND YEAR_PERIOD <= (TRIM(REPLACE(LEFT(ADD_MONTHS(GETDATE(),-1),7),'-','')))) "tmdmyr") "dtyart"
LEFT JOIN TURN_PERIOD_MASTER "trnprd"
    ON "dtyart"."ARTICLE_NO" = "trnprd"."ARTICLE_NO"
GROUP BY 
    "dtyart"."YEAR_PERIOD",
    "dtyart"."ARTICLE_NO",
    "dtyart"."VENDOR_ID",
    "trnprd"."turn_period";

<br>
---------
</br>
CREATE OR REPLACE TEMPORARY TABLE DUTY_BY_ARTICLE_AVG_RATE_STG AS
WITH Base AS
(
    SELECT  
          B.Article_no	   
        , B.Vendor_ID 
        , B.Year_Period
        , B."DUTY_RATE"
        , B."turn_period"
        , ifnull(  ( B."turn_period"  ) *-1, -1  ) as negativeturn_period
        , TO_DATE(  CONCAT(  LEFT( cast(B.Year_Period AS VARCHAR) , 4 ) , '-' , RIGHT( cast(B.Year_Period AS VARCHAR) , 2 ) , '-01'  ) ) as Period
    FROM
        DUTY_BY_ARTICLE_PERIOD_JOINED_STG B
)
SELECT 
    Base.Article_no	   
  , Base.Vendor_ID   
  , Base.Year_Period
  , Base."DUTY_RATE"
  , Base."turn_period"        
  , AVG ( Agg."DUTY_RATE"	 ) as "avg_per"
    
FROM 
    Base 
    LEFT OUTER JOIN Base Agg on Base.Article_no = Agg.Article_no
        AND Base.Vendor_ID = Agg.Vendor_ID
        AND Agg.Period between DateAdd( month, Base.negativeturn_period  + 1 , Base.Period ) and Base.Period
GROUP BY 
    Base.Article_no	  
  , Base.Vendor_ID    
  , Base.Year_Period
  , Base."DUTY_RATE"
  , Base."turn_period";

<br>
--The above query loads into DUTY_BY_ARTICLE_AVG_RATE_STG 
</br>
CREATE OR REPLACE TEMPORARY TABLE DUTY_RATE_LATEST AS
SELECT   
          R.ARTICLE_NO	
        , R.VENDOR_ID	
        , R.YEAR_PERIOD	
        , R."DUTY_RATE"	
        , R."turn_period"	
        , R."avg_per"                        
        , R.value_partition
        , first_Value(R."avg_per")over (partition by R.ARTICLE_NO, R.VENDOR_ID, R.value_partition order by R.YEAR_PERIOD ASC)  as "lastest_avg_per"
        , 1 AS import_flag
FROM
    (
  
      SELECT   
            I.ARTICLE_NO	
          , I.VENDOR_ID	
          , I.YEAR_PERIOD	
          , I."DUTY_RATE"	
          , I."turn_period"	
          , I."avg_per"              
          , sum(case when ifnull( I."avg_per" ,0) = 0 then 0 else 1 end) over (Partition By I.ARTICLE_NO, I.VENDOR_ID order by I.YEAR_PERIOD ) as value_partition
      FROM 
          DUTY_BY_ARTICLE_AVG_RATE_STG I
      ORDER BY 
          I.ARTICLE_NO, 
          I.VENDOR_ID, 
          I.YEAR_PERIOD 
) as R    
ORDER BY 
      R.ARTICLE_NO
    , R.VENDOR_ID
    , R.YEAR_PERIOD  
    , import_flag;

<br>
--facility_location_3PL_Mixing_vol_wei_stacked_prepared
-------------------------------------------------------
</br>
insert into FACILITY_LOCATION_3PL_MIXING_VOL_WEI_STACKED_PREPARED 
SELECT 
  YEAR_PERIOD,
  ARTICLE_NO,
  VENDOR_ID,
  STORE_NO,
  'Store' AS channel,
  outbound_item_variable_cost_sum,
  inbound_item_variable_cost_sum,
  COALESCE(outbound_item_variable_cost_sum, 0) + COALESCE(inbound_item_variable_cost_sum, 0) AS PL_variable_cost_combined
FROM (
SELECT 
    "unidata"."YEAR_PERIOD",
    "unidata"."ARTICLE_NO",
    "unidata"."VENDOR_ID",
    "unidata"."STORE_NO",
    SUM("unidata".outbound_item_variable_cost) AS outbound_item_variable_cost_sum,
    SUM("unidata".inbound_item_variable_cost) AS inbound_item_variable_cost_sum
    
FROM (
SELECT 
   CASE WHEN "outbnd".PERIOD <= '9' THEN   CONCAT("outbnd".ACCT_YEAR,CONCAT('0' ,"outbnd".PERIOD)) 
        ELSE  CONCAT("outbnd".ACCT_YEAR, "outbnd".PERIOD::VARCHAR) END  AS "YEAR_PERIOD",
    "outbnd"."ARTICLE_NO" ,
    "outbnd"."VENDOR_ID" ,
    "outbnd"."STORE_NO" ,
    CASE WHEN COALESCE(("shipdim".OMS_ITEM_HEIGHT * "shipdim".OMS_ITEM_LENGTH * "shipdim".OMS_ITEM_WIDTH), 0) = 0 
            THEN COALESCE((art.ARTICLE_LENGTH * art.ARTICLE_WIDTH * art.ARTICLE_HEIGHT), 0) 
            ELSE COALESCE(("shipdim".OMS_ITEM_HEIGHT * "shipdim".OMS_ITEM_LENGTH * "shipdim".OMS_ITEM_WIDTH), 0) 
        END AS cubic_volume,
    CASE WHEN "shipdim".OMS_ITEM_WEIGHT IS NULL 
        THEN COALESCE(art.ARTICLE_WEIGHT, 0) 
        ELSE "shipdim".OMS_ITEM_WEIGHT END AS item_weight,
    CAST(107520 AS DOUBLE) / NULLIF(cubic_volume, 0) AS cube_max,
    CAST(2000 AS DOUBLE) / NULLIF(item_weight, 0) AS weight_max,
    LEAST(cube_max, weight_max) AS pallet_qty,
    COALESCE(pallet_qty, 0) * COALESCE("outbnd".VENDOR_RCPT_UNIT_QTY, 0) AS Total_Palletized_Qty,
    COALESCE(pallprd."variable_cost_per_pallet", 0) * COALESCE(Total_Palletized_Qty,0) AS outbound_item_variable_cost,
    NULL as inbound_item_variable_cost,
    'outbound' AS original_dataset
  FROM facility_outbound_20to22 "outbnd"
  INNER JOIN DC_3PL_LOCATION_MAPPING_PREPARED mpnprd
    ON "outbnd"."STORE_NO" = mpnprd.Facility_Code
  INNER JOIN LC_3PL_VARIABLE_COST_PER_PALLET_11212022_PREPARED pallprd
    ON "outbnd"."STORE_NO" = pallprd."Facility_Code"
LEFT JOIN item_shipping_dimension_by_article_no_dim "shipdim"
ON "outbnd"."ARTICLE_NO"="shipdim"."ARTICLE_NO"
LEFT JOIN "EDW"."VW_ARTICLE" art ON "outbnd"."ARTICLE_NO"=art."ARTICLE_NO"
WHERE "shipdim".OMS_ITEM_HEIGHT IS NOT NULL 
  AND "shipdim".OMS_ITEM_LENGTH IS NOT NULL 
  AND "shipdim".OMS_ITEM_WIDTH IS NOT NULL 
  AND "shipdim".OMS_ITEM_WEIGHT IS NOT NULL
UNION ALL 
SELECT 
    CASE WHEN inbnd.PERIOD <= '9' THEN   CONCAT(inbnd.ACCT_YEAR,CONCAT('0' ,inbnd.PERIOD)) 
         ELSE  CONCAT(inbnd.ACCT_YEAR, inbnd.PERIOD::VARCHAR) END  AS "YEAR_PERIOD",
    inbnd."ARTICLE_NO",
    inbnd."VENDOR_ID",
    inbnd."STORE_NO",
    CASE WHEN COALESCE(("shipdim".OMS_ITEM_HEIGHT * "shipdim".OMS_ITEM_LENGTH * "shipdim".OMS_ITEM_WIDTH), 0) = 0 
            THEN COALESCE((art.ARTICLE_LENGTH * art.ARTICLE_WIDTH * art.ARTICLE_HEIGHT), 0) 
            ELSE COALESCE(("shipdim".OMS_ITEM_HEIGHT * "shipdim".OMS_ITEM_LENGTH * "shipdim".OMS_ITEM_WIDTH), 0) 
        END AS cubic_volume,
    CASE WHEN "shipdim".OMS_ITEM_WEIGHT IS NULL 
        THEN COALESCE(art.ARTICLE_WEIGHT, 0) 
        ELSE "shipdim".OMS_ITEM_WEIGHT END AS item_weight,
    CAST(107520 AS DOUBLE) / NULLIF(cubic_volume, 0) AS cube_max,
    CAST(2000 AS DOUBLE) / NULLIF(item_weight, 0) AS weight_max,
    LEAST(cube_max, weight_max) AS pallet_qty,
    COALESCE(pallet_qty, 0) * COALESCE(inbnd.VENDOR_RCPT_UNIT_QTY, 0) AS Total_Palletized_Qty,
    NULL as outbound_item_variable_cost,
    COALESCE(pallprd."variable_cost_per_pallet", 0) * COALESCE(Total_Palletized_Qty,0) AS inbound_item_variable_cost,
    'inbound' AS original_dataset
  FROM  facility_inbound_20to22 inbnd
    INNER JOIN DC_3PL_LOCATION_MAPPING_PREPARED mpnprd
    ON inbnd."STORE_NO" = mpnprd.Facility_Code
  INNER JOIN LC_3PL_VARIABLE_COST_PER_PALLET_11212022_PREPARED pallprd
    ON inbnd."STORE_NO" = pallprd."Facility_Code"
LEFT JOIN item_shipping_dimension_by_article_no_dim "shipdim"
ON inbnd."ARTICLE_NO"="shipdim"."ARTICLE_NO"
LEFT JOIN "EDW"."VW_ARTICLE" art ON inbnd."ARTICLE_NO"=art."ARTICLE_NO"
WHERE "shipdim".OMS_ITEM_HEIGHT IS NOT NULL 
  AND "shipdim".OMS_ITEM_LENGTH IS NOT NULL 
  AND "shipdim".OMS_ITEM_WIDTH IS NOT NULL 
  AND "shipdim".OMS_ITEM_WEIGHT IS NOT NULL
) "unidata"
GROUP BY     1,2,3,4)"DKU";
 

<br>
-----------------------------------------new query for OCEAN_FREIGHT_ARTICLE_BY_PERIOD_JOINED
--OCEAN_FREIGHT_ARTICLE_BY_PERIOD
</br>
Create or replace temp table OCEAN_FREIGHT_ARTICLE_BY_PERIOD as
SELECT 
        "Year Period" ,
        "po_Item_No" ,
        "po_VENDOR_ID" ,
        "org_Facility_Type" ,
        "dest_Facility_Type" ,
        SUM("po_Item_Qty") as po_Item_Qty,
        SUM("allocation_final") as allocation_final
      FROM OCEAN_FREIGHT_ALLOCATION_ARTICLE
      GROUP BY "Year Period","po_Item_No","po_VENDOR_ID","org_Facility_Type","dest_Facility_Type";

<br>
--OCEAN_FREIGHT_ARTICLE_BY_PERIOD_JOINED_BY_YEAR_PERIOD
</br>
Create or replace temp table  OCEAN_FREIGHT_ARTICLE_BY_PERIOD_JOINED_BY_YEAR_PERIOD as
SELECT 
    "po_Item_No" AS "po_Item_No",
    "po_VENDOR_ID" AS "po_VENDOR_ID",
    "org_Facility_Type" AS "org_Facility_Type",
    "dest_Facility_Type" AS "dest_Facility_Type"
  FROM (
    SELECT 
        "Year Period" AS "Year Period",
        "po_Item_No" AS "po_Item_No",
        "po_VENDOR_ID" AS "po_VENDOR_ID",
        "org_Facility_Type" AS "org_Facility_Type",
        "dest_Facility_Type" AS "dest_Facility_Type",
        po_Item_Qty AS po_Item_Qty,
        allocation_final AS allocation_final
      FROM OCEAN_FREIGHT_ARTICLE_BY_PERIOD
    ) "dku__beforegrouping"
  GROUP BY "po_Item_No", "po_VENDOR_ID", "org_Facility_Type", "dest_Facility_Type";

<br>
--OCEAN_FREIGHT_ARTICLE_BY_PERIOD_JOINED_BY_YEAR_PERIOD_JOINED
</br>
Create or replace temp table OCEAN_FREIGHT_ARTICLE_BY_PERIOD_JOINED_BY_YEAR_PERIOD_JOINED as
SELECT 
    "ocean"."po_Item_No" AS "po_Item_No",
    "ocean"."po_VENDOR_ID" AS "po_VENDOR_ID",
    "ocean"."org_Facility_Type" AS "org_Facility_Type",
    "ocean"."dest_Facility_Type" AS "dest_Facility_Type",
    "ocean"."po_Item_Qty_sum" AS "po_Item_Qty_sum",
    "ocean"."allocation_final_sum" AS "allocation_final_sum",
    "time_dim"."YEAR_PERIOD" AS "Year Period"
  FROM (
    SELECT 
        "po_Item_No" AS "po_Item_No",
        "po_VENDOR_ID" AS "po_VENDOR_ID",
        "org_Facility_Type" AS "org_Facility_Type",
        "dest_Facility_Type" AS "dest_Facility_Type",
        0 AS "po_Item_Qty_sum",
        0 AS "allocation_final_sum"
      FROM (
        SELECT *
          FROM OCEAN_FREIGHT_ARTICLE_BY_PERIOD_JOINED_BY_YEAR_PERIOD "ocean"
        ) "withoutcomputedcols_query"
    ) "ocean"
  CROSS JOIN TIME_DIMENSION_BY_YEAR_PERIOD_FILTERED "time_dim";

<br>
--OCEAN_FREIGHT_ARTICLE_BY_PERIOD_DUMMY_STACKED
</br>
create or replace temp table OCEAN_FREIGHT_ARTICLE_BY_PERIOD_DUMMY_STACKED as
SELECT 
    "Year Period" AS "Year Period",
    "po_Item_No" AS "po_Item_No",
    "po_VENDOR_ID" AS "po_VENDOR_ID",
    "org_Facility_Type" AS "org_Facility_Type",
    "dest_Facility_Type" AS "dest_Facility_Type",
    po_Item_Qty AS "po_Item_Qty_sum",
    allocation_final AS "allocation_final_sum"
  FROM OCEAN_FREIGHT_ARTICLE_BY_PERIOD
UNION ALL
SELECT 
    "Year Period" AS "Year Period",
    "po_Item_No" AS "po_Item_No",
    "po_VENDOR_ID" AS "po_VENDOR_ID",
    "org_Facility_Type" AS "org_Facility_Type",
    "dest_Facility_Type" AS "dest_Facility_Type",
    "po_Item_Qty_sum" AS "po_Item_Qty_sum",
    "allocation_final_sum" AS "allocation_final_sum"
  FROM OCEAN_FREIGHT_ARTICLE_BY_PERIOD_JOINED_BY_YEAR_PERIOD_JOINED;

<br>
--OCEAN_FREIGHT_ARTICLE_BY_PERIOD_STACKED
</br>
create or replace temp table OCEAN_FREIGHT_ARTICLE_BY_PERIOD_STACKED as
SELECT 
      "Year Period" AS "Year Period",
      "po_Item_No" AS "po_Item_No",
      "po_VENDOR_ID" AS "po_VENDOR_ID",
      "org_Facility_Type" AS "org_Facility_Type",
      "dest_Facility_Type" AS "dest_Facility_Type",
      SUM("po_Item_Qty_sum") AS "po_Item_Qty_sum",
      SUM("allocation_final_sum") AS "allocation_final_sum"
    FROM OCEAN_FREIGHT_ARTICLE_BY_PERIOD_DUMMY_STACKED
GROUP BY "Year Period", "po_Item_No", "po_VENDOR_ID", "org_Facility_Type", "dest_Facility_Type";

<br>
--OCEAN_FREIGHT_ARTICLE_BY_PERIOD_JOINED
</br>
create or replace temp table OCEAN_FREIGHT_ARTICLE_BY_PERIOD_JOINED as
SELECT 
    "ocean"."Year Period" AS "Year Period",
    "ocean"."po_Item_No" AS "po_Item_No",
    "ocean"."po_VENDOR_ID" AS "po_VENDOR_ID",
    "ocean"."org_Facility_Type" AS "org_Facility_Type",
    "ocean"."dest_Facility_Type" AS "dest_Facility_Type",
    "ocean"."po_Item_Qty_sum" AS "po_Item_Qty_sum",
    "ocean"."allocation_final_sum" AS "allocation_final_sum",
    "turn_period_master"."turn_period" AS "turn_period"
  FROM OCEAN_FREIGHT_ARTICLE_BY_PERIOD_STACKED "ocean"
  LEFT JOIN TURN_PERIOD_MASTER "turn_period_master"
    ON "ocean"."po_Item_No" = "turn_period_master"."ARTICLE_NO";

<br>
--2 OCEAN_FREIGHT_TURN_PERIOD_CUMMU_PREPARED
</br>

CREATE OR REPLACE TEMPORARY TABLE OCEAN_FREIGHT_TURN_PERIOD_CUMMU_PREPARED AS
WITH Base AS
(
    SELECT  
          B."Year Period"	      
        , B."po_Item_No"	
        , B."po_Item_Qty_sum"	
        , B."allocation_final_sum"
        , B."turn_period"
        , B."po_VENDOR_ID"
        , B."org_Facility_Type"
        , B."dest_Facility_Type"
        , ifnull(  ( B."turn_period"  ) *-1, -1  ) as negativeturn_period
        , TO_DATE(  CONCAT(  LEFT( cast(B."Year Period" AS VARCHAR) , 4 ) , '-' , RIGHT( cast(B."Year Period" AS VARCHAR) , 2 ) , '-01'  ) ) as Period
    FROM
        OCEAN_FREIGHT_ARTICLE_BY_PERIOD_JOINED B
)
SELECT c.*,    
CASE WHEN ("po_item_qty_sum_cummulated" = 0) OR "po_item_qty_sum_cummulated" IS NULL THEN 0 ELSE CAST(COALESCE("allocation_final_sum_cummulated", 0) AS DOUBLE) / NULLIF(COALESCE("po_item_qty_sum_cummulated", 0), 0) END AS "ocean_freight_per_unit"
FROM 
(SELECT 
      Base."Year Period"	      
    , Base."po_Item_No"	
    , Base."po_Item_Qty_sum"	
    , Base."allocation_final_sum"
    , Base."turn_period"
    , Base."po_VENDOR_ID"
    , Base."org_Facility_Type"
    , Base."dest_Facility_Type"    
    , SUM ( Agg."po_Item_Qty_sum"	 )     as "po_item_qty_sum_cummulated"
    , SUM ( Agg."allocation_final_sum"	 ) as "allocation_final_sum_cummulated"
FROM 
    Base 
    LEFT OUTER JOIN Base Agg on ifnull( Base."po_Item_No" ,-9999 ) = ifnull( Agg."po_Item_No" ,-9999 )
        AND ifnull( Base."po_VENDOR_ID" , -9999 ) = ifnull( Agg."po_VENDOR_ID" ,-9999 )
        AND ifnull( Base."org_Facility_Type" ,'' ) = ifnull( Agg."org_Facility_Type" ,'' )
        AND ifnull( Base."dest_Facility_Type" ,'' ) = ifnull( Agg."dest_Facility_Type" ,'' )
        AND Agg.Period between DateAdd( month, Base.negativeturn_period + 1  , Base.Period ) and  Base.Period
GROUP BY 
      Base."Year Period"	
    , Base."po_Item_No"	
    , Base."po_Item_Qty_sum"	
    , Base."allocation_final_sum"
    , Base."turn_period"  
    , Base."po_VENDOR_ID"
    , Base."org_Facility_Type"
    , Base."dest_Facility_Type") C;

<br>
---------------------------------------------NEW QUERY FOR PO_INVENTORY_TURN
--SMALL_PACKAGE_BY_YEAR_PERIOD_SHARE_BY_YEAR_PERIOD
</br>

create or replace temp table SMALL_PACKAGE_BY_YEAR_PERIOD_SHARE_BY_YEAR_PERIOD as
SELECT 
    "YEAR_PERIOD" AS "YEAR_PERIOD", 
    "ARTICLE_NO" AS "ARTICLE_NO", 
    "VENDOR_ID" AS "VENDOR_ID", 
    "org_Facility_Type" AS "org_Facility_Type", 
    "dest_Facility_Type" AS "dest_Facility_Type", 
    SUM("order_qty") AS "ORDER_QTY", 
    SUM("allocation_final") AS "allocation_final" 
FROM 
    SMALL_PACKAGE_BY_YEAR_PERIOD_SHARE 
GROUP BY YEAR_PERIOD, ARTICLE_NO, VENDOR_ID, "org_Facility_Type", "dest_Facility_Type" ;

<br>
--SMALL_PACKAGE_BY_YEAR_PERIOD_SHARE_BY_YEAR_PERIOD_BY_ARTICLE_NO
</br>
create or replace temp table SMALL_PACKAGE_BY_YEAR_PERIOD_SHARE_BY_YEAR_PERIOD_BY_ARTICLE_NO as 
SELECT 
    "ARTICLE_NO" AS "ARTICLE_NO",
    "VENDOR_ID" AS "VENDOR_ID",
    "org_Facility_Type" AS "org_Facility_Type",
    "dest_Facility_Type" AS "dest_Facility_Type"
  FROM (
    SELECT 
        "YEAR_PERIOD" AS "YEAR_PERIOD",
        "ARTICLE_NO" AS "ARTICLE_NO",
        "VENDOR_ID" AS "VENDOR_ID",
        "org_Facility_Type" AS "org_Facility_Type",
        "dest_Facility_Type" AS "dest_Facility_Type",
        "ORDER_QTY" AS "ORDER_QTY",
        "allocation_final" AS "allocation_final"
      FROM SMALL_PACKAGE_BY_YEAR_PERIOD_SHARE_BY_YEAR_PERIOD
    ) "dku__beforegrouping"
  GROUP BY "ARTICLE_NO", "VENDOR_ID", "org_Facility_Type", "dest_Facility_Type";

<br>
--SMALL_PACKAGE_BY_YEAR_PERIOD_SHARE_BY_YEAR_PERIOD_BY_ARTICLE_NO_JOINED
</br>
create or replace temp table SMALL_PACKAGE_BY_YEAR_PERIOD_SHARE_BY_YEAR_PERIOD_BY_ARTICLE_NO_JOINED as
SELECT 
    "small_package"."ARTICLE_NO" AS "ARTICLE_NO",
    "small_package"."VENDOR_ID" AS "VENDOR_ID",
    "small_package"."org_Facility_Type" AS "org_Facility_Type",
    "small_package"."dest_Facility_Type" AS "dest_Facility_Type",
    "small_package"."ORDER_QTY" AS "ORDER_QTY",
    "small_package"."allocation_final" AS "allocation_final",
    "time_dimention"."YEAR_PERIOD" AS "YEAR_PERIOD"
  FROM (
    SELECT 
        "ARTICLE_NO" AS "ARTICLE_NO",
        "VENDOR_ID" AS "VENDOR_ID",
        "org_Facility_Type" AS "org_Facility_Type",
        "dest_Facility_Type" AS "dest_Facility_Type",
        0 AS "ORDER_QTY",
        0 AS "allocation_final"
      FROM (
        SELECT *
          FROM SMALL_PACKAGE_BY_YEAR_PERIOD_SHARE_BY_YEAR_PERIOD_BY_ARTICLE_NO "small_package"
        ) "withoutcomputedcols_query"
    ) "small_package"
  CROSS JOIN TIME_DIMENSION_BY_YEAR_PERIOD_FILTERED "time_dimention";

<br>
--SMALL_PACKAGE_BY_ARTICLE_PERIOD_STACKED
</br>
create or replace temp table SMALL_PACKAGE_BY_ARTICLE_PERIOD_STACKED as
SELECT 
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "ARTICLE_NO" AS "ARTICLE_NO",
    "VENDOR_ID" AS "VENDOR_ID",
    "org_Facility_Type" AS "org_Facility_Type",
    "dest_Facility_Type" AS "dest_Facility_Type",
    "ORDER_QTY" AS "ORDER_QTY",
    "allocation_final" AS "allocation_final"
  FROM SMALL_PACKAGE_BY_YEAR_PERIOD_SHARE_BY_YEAR_PERIOD
UNION ALL
SELECT 
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "ARTICLE_NO" AS "ARTICLE_NO",
    "VENDOR_ID" AS "VENDOR_ID",
    "org_Facility_Type" AS "org_Facility_Type",
    "dest_Facility_Type" AS "dest_Facility_Type",
    "ORDER_QTY" AS "ORDER_QTY",
    "allocation_final" AS "allocation_final"
  FROM SMALL_PACKAGE_BY_YEAR_PERIOD_SHARE_BY_YEAR_PERIOD_BY_ARTICLE_NO_JOINED;
    
<br>
--SMALL_PACKAGE_BY_ARTICLE_PERIOD_STACKED_BY_YEAR_PERIOD
</br>
create or replace temp table SMALL_PACKAGE_BY_ARTICLE_PERIOD_STACKED_BY_YEAR_PERIOD as
SELECT 
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "ARTICLE_NO" AS "ARTICLE_NO",
    "VENDOR_ID" AS "VENDOR_ID",
    "org_Facility_Type" AS "org_Facility_Type",
    "dest_Facility_Type" AS "dest_Facility_Type",
    "ORDER_QTY_sum" AS "ORDER_QTY",
    "allocation_final_sum" AS "allocation_final"
  FROM (
    SELECT 
        "YEAR_PERIOD" AS "YEAR_PERIOD",
        "ARTICLE_NO" AS "ARTICLE_NO",
        "VENDOR_ID" AS "VENDOR_ID",
        "org_Facility_Type" AS "org_Facility_Type",
        "dest_Facility_Type" AS "dest_Facility_Type",
        SUM("ORDER_QTY") AS "ORDER_QTY_sum",
        SUM("allocation_final") AS "allocation_final_sum"
      FROM (
        SELECT 
            "YEAR_PERIOD" AS "YEAR_PERIOD",
            "ARTICLE_NO" AS "ARTICLE_NO",
            "VENDOR_ID" AS "VENDOR_ID",
            "org_Facility_Type" AS "org_Facility_Type",
            "dest_Facility_Type" AS "dest_Facility_Type",
            "ORDER_QTY" AS "ORDER_QTY",
            "allocation_final" AS "allocation_final"
          FROM SMALL_PACKAGE_BY_ARTICLE_PERIOD_STACKED
        ) "dku__beforegrouping"
      GROUP BY "YEAR_PERIOD", "ARTICLE_NO", "VENDOR_ID", "org_Facility_Type", "dest_Facility_Type"
    ) "pristine_query";



<br>
--SMALL_PACKAGE_BY_ARTICLE_PERIOD_STACKED_BY_YEAR_PERIOD_JOINED
</br>
create or replace temp table SMALL_PACKAGE_BY_ARTICLE_PERIOD_STACKED_BY_YEAR_PERIOD_JOINED as 
SELECT 
    "small_package"."YEAR_PERIOD" AS "YEAR_PERIOD",
    "small_package"."ARTICLE_NO" AS "ARTICLE_NO",
    "small_package"."VENDOR_ID" AS "VENDOR_ID",
    "small_package"."org_Facility_Type" AS "org_Facility_Type",
    "small_package"."dest_Facility_Type" AS "dest_Facility_Type",
    "small_package"."ORDER_QTY" AS "ORDER_QTY",
    "small_package"."allocation_final" AS "allocation_final",
    "turn_period_master"."turn_period" AS "turn_period"
  FROM SMALL_PACKAGE_BY_ARTICLE_PERIOD_STACKED_BY_YEAR_PERIOD "small_package"
  LEFT JOIN TURN_PERIOD_MASTER "turn_period_master"
    ON "small_package"."ARTICLE_NO" = "turn_period_master"."ARTICLE_NO";

<br>
--SHIPMENT_PO_ALLOCATION
</br>
CREATE OR REPLACE TEMP TABLE SHIPMENT_PO_ALLOCATION AS
SELECT 
    "act_del_YEAR_PERIOD" AS "YEAR_PERIOD",
    "po_ARTICLE_NO" AS "ARTICLE_NO",
    "po_VENDOR_ID" AS "VENDOR_ID",
    "org_Facility_Type" AS "org_Facility_Type",
    "dest_Facility_Type" AS "dest_Facility_Type",
    SUM("po_PO_LINE_ORDER_QTY") AS "ORDER_QTY",
    SUM("allocation_final") AS "allocation_final"
    FROM TLM_SHIPMENT_JOINED_PO_ALLOCATION
GROUP BY "act_del_YEAR_PERIOD", "po_ARTICLE_NO", "po_VENDOR_ID", "org_Facility_Type", "dest_Facility_Type";

<br>
--SHIPPING_PO_BY_ARTICLE_NO
</br>
CREATE OR REPLACE TEMP TABLE SHIPPING_PO_BY_ARTICLE_NO AS 
SELECT 
    "ARTICLE_NO" AS "ARTICLE_NO",
    "VENDOR_ID" AS "VENDOR_ID",
    "org_Facility_Type" AS "org_Facility_Type",
    "dest_Facility_Type" AS "dest_Facility_Type"
  FROM (
    SELECT 
        "YEAR_PERIOD" AS "YEAR_PERIOD",
        "ARTICLE_NO" AS "ARTICLE_NO",
        "VENDOR_ID" AS "VENDOR_ID",
        "org_Facility_Type" AS "org_Facility_Type",
        "dest_Facility_Type" AS "dest_Facility_Type",
        "ORDER_QTY" AS "ORDER_QTY",
        "allocation_final" AS "allocation_final"
      FROM SHIPMENT_PO_ALLOCATION
    ) "dku__beforegrouping"
  GROUP BY "ARTICLE_NO", "VENDOR_ID", "org_Facility_Type", "dest_Facility_Type";

<br>
--SHIPPING_PO_BY_ARTICLE_NO_JOINED
</br>
CREATE OR REPLACE TEMP TABLE SHIPPING_PO_BY_ARTICLE_NO_JOINED AS
SELECT 
    "shipping_po_by_ARTICLE_NO"."ARTICLE_NO" AS "ARTICLE_NO",
    "shipping_po_by_ARTICLE_NO"."VENDOR_ID" AS "VENDOR_ID",
    "shipping_po_by_ARTICLE_NO"."org_Facility_Type" AS "org_Facility_Type",
    "shipping_po_by_ARTICLE_NO"."dest_Facility_Type" AS "dest_Facility_Type",
    "shipping_po_by_ARTICLE_NO"."ORDER_QTY" AS "ORDER_QTY",
    "shipping_po_by_ARTICLE_NO"."allocation_final" AS "allocation_final",
    "time_dimension_by_YEAR_PERIOD_filtered"."YEAR_PERIOD" AS "YEAR_PERIOD"
  FROM (
    SELECT 
        "ARTICLE_NO" AS "ARTICLE_NO",
        "VENDOR_ID" AS "VENDOR_ID",
        "org_Facility_Type" AS "org_Facility_Type",
        "dest_Facility_Type" AS "dest_Facility_Type",
        0 AS "ORDER_QTY",
        0 AS "allocation_final"
      FROM (
        SELECT *
          FROM SHIPPING_PO_BY_ARTICLE_NO "shipping_po_by_ARTICLE_NO"
        ) "withoutcomputedcols_query"
    ) "shipping_po_by_ARTICLE_NO"
  CROSS JOIN TIME_DIMENSION_BY_YEAR_PERIOD_FILTERED "time_dimension_by_YEAR_PERIOD_filtered";

<br>
--SHIPPING_PO_ALLOCATION_STACKED
</br>
CREATE OR REPLACE TEMP TABLE  SHIPPING_PO_ALLOCATION_STACKED AS
SELECT 
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "ARTICLE_NO" AS "ARTICLE_NO",
    "VENDOR_ID" AS "VENDOR_ID",
    "org_Facility_Type" AS "org_Facility_Type",
    "dest_Facility_Type" AS "dest_Facility_Type",
    "ORDER_QTY" AS "ORDER_QTY",
    "allocation_final" AS "allocation_final"
  FROM SHIPMENT_PO_ALLOCATION
UNION ALL
SELECT 
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "ARTICLE_NO" AS "ARTICLE_NO",
    "VENDOR_ID" AS "VENDOR_ID",
    "org_Facility_Type" AS "org_Facility_Type",
    "dest_Facility_Type" AS "dest_Facility_Type",
    "ORDER_QTY" AS "ORDER_QTY",
    "allocation_final" AS "allocation_final"
  FROM SHIPPING_PO_BY_ARTICLE_NO_JOINED
<br>
--SHIPPING_PO_ALLOCATION_ROLLUP
</br>
CREATE OR REPLACE TEMP TABLE SHIPPING_PO_ALLOCATION_ROLLUP AS
SELECT 
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "ARTICLE_NO" AS "ARTICLE_NO",
    "VENDOR_ID" AS "VENDOR_ID",
    "org_Facility_Type" AS "org_Facility_Type",
    "dest_Facility_Type" AS "dest_Facility_Type",
    SUM("ORDER_QTY") AS "ORDER_QTY",
    SUM("allocation_final") AS "allocation_final"
    FROM SHIPPING_PO_ALLOCATION_STACKED
GROUP BY "YEAR_PERIOD", "ARTICLE_NO", "VENDOR_ID", "org_Facility_Type", "dest_Facility_Type"
<br>
--SHIPPING_PO_TURN_PERIOD
</br>
CREATE OR REPLACE TEMP TABLE SHIPPING_PO_TURN_PERIOD as
SELECT 
    "shipping_po_allocation_rollup"."YEAR_PERIOD" AS "YEAR_PERIOD",
    "shipping_po_allocation_rollup"."ARTICLE_NO" AS "ARTICLE_NO",
    "shipping_po_allocation_rollup"."VENDOR_ID" AS "VENDOR_ID",
    "shipping_po_allocation_rollup"."org_Facility_Type" AS "org_Facility_Type",
    "shipping_po_allocation_rollup"."dest_Facility_Type" AS "dest_Facility_Type",
    "shipping_po_allocation_rollup"."ORDER_QTY" AS "ORDER_QTY",
    "shipping_po_allocation_rollup"."allocation_final" AS "allocation_final",
    "turn_period_master"."turn_period" AS "turn_period"
  FROM SHIPPING_PO_ALLOCATION_ROLLUP "shipping_po_allocation_rollup"
  LEFT JOIN TURN_PERIOD_MASTER "turn_period_master"
    ON "shipping_po_allocation_rollup"."ARTICLE_NO" = "turn_period_master"."ARTICLE_NO"
<br>
--INVOICE_PO_ALLOCATION
</br>
CREATE OR REPLACE TEMP TABLE INVOICE_PO_ALLOCATION AS
SELECT 
        "act_del_YEAR_PERIOD" AS "YEAR_PERIOD",
        "po_ARTICLE_NO" AS "ARTICLE_NO",
        "po_VENDOR_ID" AS "VENDOR_ID",
        "org_Facility_Type" AS "org_Facility_Type",
        "dest_Facility_Type" AS "dest_Facility_Type",
        SUM("po_PO_LINE_ORDER_QTY") AS "ORDER_QTY",
        SUM("allocation_final") AS "allocation_final"
        from DOMESTIC_SHIPPING_FREIGHT_PO_ALLOCATION_ARTICLE
    GROUP BY "act_del_YEAR_PERIOD", "po_ARTICLE_NO", "po_VENDOR_ID", "org_Facility_Type", "dest_Facility_Type";
<br>
--INVOICE_PO_BY_ARTICLE_NO
</br>
CREATE OR REPLACE TEMP TABLE INVOICE_PO_BY_ARTICLE_NO AS
SELECT 
    "ARTICLE_NO" AS "ARTICLE_NO",
    "VENDOR_ID" AS "VENDOR_ID",
    "org_Facility_Type" AS "org_Facility_Type",
    "dest_Facility_Type" AS "dest_Facility_Type"
  FROM (
    SELECT 
        "YEAR_PERIOD" AS "YEAR_PERIOD",
        "ARTICLE_NO" AS "ARTICLE_NO",
        "VENDOR_ID" AS "VENDOR_ID",
        "org_Facility_Type" AS "org_Facility_Type",
        "dest_Facility_Type" AS "dest_Facility_Type",
        "ORDER_QTY" AS "ORDER_QTY",
        "allocation_final" AS "allocation_final"
      FROM INVOICE_PO_ALLOCATION
    ) "dku__beforegrouping"
  GROUP BY "ARTICLE_NO", "VENDOR_ID", "org_Facility_Type", "dest_Facility_Type";

<br>
--INVOICE_PO_BY_ARTICLE_NO_JOINED
</br>
CREATE OR REPLACE TEMP TABLE  INVOICE_PO_BY_ARTICLE_NO_JOINED as
SELECT 
    "invoice_po_by_ARTICLE_NO"."ARTICLE_NO" AS "ARTICLE_NO",
    "invoice_po_by_ARTICLE_NO"."VENDOR_ID" AS "VENDOR_ID",
    "invoice_po_by_ARTICLE_NO"."org_Facility_Type" AS "org_Facility_Type",
    "invoice_po_by_ARTICLE_NO"."dest_Facility_Type" AS "dest_Facility_Type",
    "invoice_po_by_ARTICLE_NO"."ORDER_QTY" AS "ORDER_QTY",
    "invoice_po_by_ARTICLE_NO"."allocation_final" AS "allocation_final",
    "time_dim"."YEAR_PERIOD" AS "YEAR_PERIOD"
  FROM (
    SELECT 
        "ARTICLE_NO" AS "ARTICLE_NO",
        "VENDOR_ID" AS "VENDOR_ID",
        "org_Facility_Type" AS "org_Facility_Type",
        "dest_Facility_Type" AS "dest_Facility_Type",
        0 AS "ORDER_QTY",
        0 AS "allocation_final"
      FROM (
        SELECT *
          FROM INVOICE_PO_BY_ARTICLE_NO "invoice_po_by_ARTICLE_NO"
        ) "withoutcomputedcols_query"
    ) "invoice_po_by_ARTICLE_NO"
  CROSS JOIN TIME_DIMENSION_BY_YEAR_PERIOD_FILTERED "time_dim";

<br>
--INVOICE_PO_ALLOCATION_STACKED
</br>
CREATE OR REPLACE TEMP TABLE INVOICE_PO_ALLOCATION_STACKED as
SELECT 
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "ARTICLE_NO" AS "ARTICLE_NO",
    "VENDOR_ID" AS "VENDOR_ID",
    "org_Facility_Type" AS "org_Facility_Type",
    "dest_Facility_Type" AS "dest_Facility_Type",
    "ORDER_QTY" AS "ORDER_QTY",
    "allocation_final" AS "allocation_final"
  FROM INVOICE_PO_ALLOCATION
UNION ALL
SELECT 
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "ARTICLE_NO" AS "ARTICLE_NO",
    "VENDOR_ID" AS "VENDOR_ID",
    "org_Facility_Type" AS "org_Facility_Type",
    "dest_Facility_Type" AS "dest_Facility_Type",
    "ORDER_QTY" AS "ORDER_QTY",
    "allocation_final" AS "allocation_final"
  FROM INVOICE_PO_BY_ARTICLE_NO_JOINED;

<br>
--INVOICE_PO_ALLOCATION_ROLLUP
</br>
CREATE OR REPLACE TEMP TABLE INVOICE_PO_ALLOCATION_ROLLUP as
SELECT 
        "YEAR_PERIOD" AS "YEAR_PERIOD",
    "ARTICLE_NO" AS "ARTICLE_NO",
    "VENDOR_ID" AS "VENDOR_ID",
    "org_Facility_Type" AS "org_Facility_Type",
    "dest_Facility_Type" AS "dest_Facility_Type",
    SUM("ORDER_QTY") AS "ORDER_QTY",
    SUM("allocation_final") AS "allocation_final"
FROM INVOICE_PO_ALLOCATION_STACKED
GROUP BY "YEAR_PERIOD", "ARTICLE_NO", "VENDOR_ID", "org_Facility_Type", "dest_Facility_Type";
<br>
--INVOICE_PO_TURN_PERIOD
</br>
CREATE OR REPLACE TEMP TABLE INVOICE_PO_TURN_PERIOD as
SELECT 
    "invoice_po_allocation_rollup"."YEAR_PERIOD" AS "YEAR_PERIOD",
    "invoice_po_allocation_rollup"."ARTICLE_NO" AS "ARTICLE_NO",
    "invoice_po_allocation_rollup"."VENDOR_ID" AS "VENDOR_ID",
    "invoice_po_allocation_rollup"."org_Facility_Type" AS "org_Facility_Type",
    "invoice_po_allocation_rollup"."dest_Facility_Type" AS "dest_Facility_Type",
    "invoice_po_allocation_rollup"."ORDER_QTY" AS "ORDER_QTY",
    "invoice_po_allocation_rollup"."allocation_final" AS "allocation_final",
    "turn_period_master"."turn_period" AS "turn_period"
  FROM INVOICE_PO_ALLOCATION_ROLLUP "invoice_po_allocation_rollup"
  LEFT JOIN TURN_PERIOD_MASTER "turn_period_master"
    ON "invoice_po_allocation_rollup"."ARTICLE_NO" = "turn_period_master"."ARTICLE_NO";

<br>
--PO_TURN_PERIOD_STACKED
</br>
CREATE OR REPLACE TEMP TABLE PO_TURN_PERIOD_STACKED as
SELECT 
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "ARTICLE_NO" AS "ARTICLE_NO",
    "VENDOR_ID" AS "VENDOR_ID",
    "org_Facility_Type" AS "org_Facility_Type",
    "dest_Facility_Type" AS "dest_Facility_Type",
    "ORDER_QTY" AS "ORDER_QTY",
    "allocation_final" AS "allocation_final",
    "turn_period" AS "turn_period"
  FROM INVOICE_PO_TURN_PERIOD
UNION ALL
SELECT 
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "ARTICLE_NO" AS "ARTICLE_NO",
    "VENDOR_ID" AS "VENDOR_ID",
    "org_Facility_Type" AS "org_Facility_Type",
    "dest_Facility_Type" AS "dest_Facility_Type",
    "ORDER_QTY" AS "ORDER_QTY",
    "allocation_final" AS "allocation_final",
    "turn_period" AS "turn_period"
  FROM SHIPPING_PO_TURN_PERIOD
UNION ALL
SELECT 
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "ARTICLE_NO" AS "ARTICLE_NO",
    "VENDOR_ID" AS "VENDOR_ID",
    "org_Facility_Type" AS "org_Facility_Type",
    "dest_Facility_Type" AS "dest_Facility_Type",
    "ORDER_QTY" AS "ORDER_QTY",
    "allocation_final" AS "allocation_final",
    "turn_period" AS "turn_period"
  FROM SMALL_PACKAGE_BY_ARTICLE_PERIOD_STACKED_BY_YEAR_PERIOD_JOINED

<br>
--PO_TURN_PERIOD_STACKED_BY_YEAR_PERIOD
</br>
CREATE OR REPLACE TEMP TABLE PO_TURN_PERIOD_STACKED_BY_YEAR_PERIOD as
SELECT 
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "ARTICLE_NO" AS "ARTICLE_NO",
    "VENDOR_ID" AS "VENDOR_ID",
    "org_Facility_Type" AS "org_Facility_Type",
    "dest_Facility_Type" AS "dest_Facility_Type",
    "turn_period" AS "turn_period",
    SUM("ORDER_QTY") AS "ORDER_QTY",
    SUM("allocation_final") AS "allocation_final"
FROM PO_TURN_PERIOD_STACKED
GROUP BY "YEAR_PERIOD", "ARTICLE_NO", "VENDOR_ID", "org_Facility_Type", "dest_Facility_Type", "turn_period";

<br>
--PO_INVENTORY_TURN
</br>
CREATE OR REPLACE TEMPORARY TABLE PO_INVENTORY_TURN AS
  WITH Base AS
(
    SELECT  
          B."YEAR_PERIOD"	      
        , B."ARTICLE_NO"	
        , B."ORDER_QTY"	
        , B."allocation_final"
        , B."turn_period"
        , B.Vendor_ID
        , B."org_Facility_Type"
        , B."dest_Facility_Type"    
        , ifnull(  ( B."turn_period"  ) *-1, -1  ) as negativeturn_period
        , TO_DATE(  CONCAT(  LEFT( cast(B."YEAR_PERIOD" AS VARCHAR) , 4 ) , '-' , RIGHT( cast(B."YEAR_PERIOD" AS VARCHAR) , 2 ) , '-01'  ) ) as Period
    FROM
        PO_TURN_PERIOD_STACKED_BY_YEAR_PERIOD B
)
SELECT 
      Base."YEAR_PERIOD"	      
    , Base."ARTICLE_NO"	
    , Base."ORDER_QTY"	
    , Base."allocation_final"
    , Base."turn_period"
    , Base.Vendor_ID
    , Base."org_Facility_Type"
    , Base."dest_Facility_Type"        
    , SUM ( Agg."ORDER_QTY"	 )     as "order_qty_cummulated"
    , SUM ( Agg."allocation_final"	 ) as "allocation_final_cummulated"
FROM 
    Base 
    LEFT OUTER JOIN Base Agg on ifnull( Base."ARTICLE_NO" ,-9999 ) = ifnull( Agg."ARTICLE_NO" ,-9999 )
        and ifnull( Base.Vendor_ID ,-9999 )        = ifnull( Agg.Vendor_ID ,-9999 )
        and ifnull( Base."org_Facility_Type",'' )  = ifnull( Agg."org_Facility_Type",'' )
        and ifnull( Base."dest_Facility_Type",'' ) = ifnull( Agg."dest_Facility_Type",'' )    
        AND Agg.Period between DateAdd( month, Base.negativeturn_period + 1 , Base.Period ) and Base.Period
GROUP BY 
      Base."YEAR_PERIOD"	
    , Base."ARTICLE_NO"	
    , Base."ORDER_QTY"	
    , Base."allocation_final"
    , Base."turn_period"  
    , Base.Vendor_ID
    , Base."org_Facility_Type"
    , Base."dest_Facility_Type"        

<br>
---------------------------------------------NEW QUERY FOR DO_TURN_PERIOD_STACKED_GRP
--INVOICE_DO_ALLOCATION
</br>
	 
CREATE OR REPLACE TEMP TABLE INVOICE_DO_ALLOCATION 
AS 
SELECT "act_del_YEAR_PERIOD" AS "YEAR_PERIOD",
          TRY_TO_NUMBER("do_ITEM_NAME") AS "ARTICLE_NO",
          "org_Facility_Type" AS "org_Facility_Type",
          "dest_Facility_Type" AS "dest_Facility_Type",
          SUM( "do_ORDER_QTY") AS "ORDER_QTY",
          SUM( "allocation_final") AS "allocation_final"
  FROM DOMESTIC_SHIPPING_FREIGHT_DO_ALLOCATION	  
  GROUP BY "act_del_YEAR_PERIOD","do_ITEM_NAME","org_Facility_Type","dest_Facility_Type" ;

<br>
--INVOICE_DO_BY_ARTICLE_NO
</br>  
	  
CREATE OR REPLACE TEMP TABLE INVOICE_DO_BY_ARTICLE_NO AS	  
SELECT "ARTICLE_NO",
        "org_Facility_Type",
    "dest_Facility_Type"
FROM INVOICE_DO_ALLOCATION 
GROUP BY "ARTICLE_NO","org_Facility_Type","dest_Facility_Type";

<br>
--INVOICE_DO_BY_ARTICLE_NO_JOINED
</br>    
CREATE OR REPLACE TEMP TABLE INVOICE_DO_BY_ARTICLE_NO_JOINED
AS
SELECT 
        "invoice_do_by_ARTICLE_NO"."ARTICLE_NO",
        "invoice_do_by_ARTICLE_NO"."org_Facility_Type",
    "invoice_do_by_ARTICLE_NO"."dest_Facility_Type",
    "invoice_do_by_ARTICLE_NO"."ORDER_QTY",
    "invoice_do_by_ARTICLE_NO"."allocation_final",
    "time_dimension_by_YEAR_PERIOD_filtered"."YEAR_PERIOD"
FROM 
(

SELECT 
        "ARTICLE_NO",
        "org_Facility_Type",
    "dest_Facility_Type",
    0 AS "ORDER_QTY",
        0 AS "allocation_final"
    
  FROM INVOICE_DO_BY_ARTICLE_NO
) "invoice_do_by_ARTICLE_NO" 
CROSS JOIN 
  ( 
  SELECT DISTINCT "YEAR_PERIOD"
      FROM "EDW"."TIME_DIMENSION"
      WHERE "YEAR_PERIOD" >= 202001
      AND "YEAR_PERIOD" <= (TRIM(REPLACE(LEFT(ADD_MONTHS(GETDATE(),-1),7),'-','')))
  )"time_dimension_by_YEAR_PERIOD_filtered"	 ; 

<br>
--INVOICE_DO_ALLOCATION_STACKED
</br> 	  
CREATE OR REPLACE TEMP TABLE INVOICE_DO_ALLOCATION_STACKED
AS 
SELECT
      "YEAR_PERIOD",
    "ARTICLE_NO",
  "org_Facility_Type",
    "dest_Facility_Type",
    "ORDER_QTY",
    "allocation_final"
FROM INVOICE_DO_ALLOCATION
UNION ALL 
SELECT 
      "YEAR_PERIOD",
      "ARTICLE_NO",
      "org_Facility_Type",
  "dest_Facility_Type",
  "ORDER_QTY",
  "allocation_final"
  FROM INVOICE_DO_BY_ARTICLE_NO_JOINED; 

<br>
--INVOICE_DO_ALLOCATION_ROLLUP
</br> 	  
CREATE OR REPLACE TEMP TABLE INVOICE_DO_ALLOCATION_ROLLUP	 
AS
SELECT
      "YEAR_PERIOD",
    "ARTICLE_NO",
  "org_Facility_Type",
    "dest_Facility_Type",
    SUM("ORDER_QTY") "ORDER_QTY",
    SUM("allocation_final") "allocation_final"
FROM INVOICE_DO_ALLOCATION_STACKED	  
GROUP BY   "YEAR_PERIOD", "ARTICLE_NO", "org_Facility_Type","dest_Facility_Type";
	   
	
<br>
--INVOICE_DO_TURN_PERIOD
</br>  
CREATE OR REPLACE TEMP TABLE INVOICE_DO_TURN_PERIOD
AS 
SELECT 
    R."YEAR_PERIOD",
    R."ARTICLE_NO",
    R."org_Facility_Type",
    R."dest_Facility_Type",
    R."ORDER_QTY",
    R."allocation_final",
    T."turn_period" AS "turn_period"
FROM INVOICE_DO_ALLOCATION_ROLLUP R
LEFT JOIN  "TURN_PERIOD_MASTER"  T 
  ON R."ARTICLE_NO" =T."ARTICLE_NO";
	 
<br>
--- 2 nd stack SHIPMENT_DO_ALLOCATION
</br>  	 

CREATE OR REPLACE TEMP TABLE SHIPMENT_DO_ALLOCATION 
AS 
SELECT "act_del_YEAR_PERIOD" AS "YEAR_PERIOD",
          TRY_TO_NUMBER("do_ITEM_NAME") AS "ARTICLE_NO",
          "org_Facility_Type" AS "org_Facility_Type",
          "dest_Facility_Type" AS "dest_Facility_Type",
          SUM( "do_ORDER_QTY") AS "ORDER_QTY",
          SUM( "allocation_final") AS "allocation_final"
  FROM "TLM_SHIPMENT_JOINED_DO_VOl_WGT_ALLOCATION"	  
  GROUP BY 1,2,3,4 ;	 

<br>
--SHIPING_DO_BY_ARTICLE_NO
</br>  	 	  

CREATE OR REPLACE TEMP TABLE SHIPING_DO_BY_ARTICLE_NO AS	  
SELECT  "ARTICLE_NO",
        "org_Facility_Type",
        "dest_Facility_Type"
FROM SHIPMENT_DO_ALLOCATION 
GROUP BY "ARTICLE_NO","org_Facility_Type","dest_Facility_Type";

<br>
--SHIPING_DO_BY_ARTICLE_NO_JOINED
</br> 
CREATE OR REPLACE TEMP TABLE SHIPING_DO_BY_ARTICLE_NO_JOINED
AS
SELECT 
        "shiping_do_by_ARTICLE_NO"."ARTICLE_NO",
        "shiping_do_by_ARTICLE_NO"."org_Facility_Type",
    "shiping_do_by_ARTICLE_NO"."dest_Facility_Type",
    "shiping_do_by_ARTICLE_NO"."ORDER_QTY",
    "shiping_do_by_ARTICLE_NO"."allocation_final",
    "time_dimension_by_YEAR_PERIOD_filtered"."YEAR_PERIOD"
FROM 
(

SELECT 
        "ARTICLE_NO",
        "org_Facility_Type",
        "dest_Facility_Type",
        0 AS "ORDER_QTY",
        0 AS "allocation_final" 
  FROM SHIPING_DO_BY_ARTICLE_NO
) "shiping_do_by_ARTICLE_NO" 
CROSS JOIN 
  ( 
  SELECT DISTINCT "YEAR_PERIOD"
      FROM "EDW"."TIME_DIMENSION"
      WHERE "YEAR_PERIOD" >= 202001
      AND "YEAR_PERIOD" <= (TRIM(REPLACE(LEFT(ADD_MONTHS(GETDATE(),-1),7),'-','')))
  )"time_dimension_by_YEAR_PERIOD_filtered"; 
		 
<br>
--SHIPPING_DO_ALLOCATION_STACKED
</br> 		 
CREATE OR REPLACE TEMP TABLE SHIPPING_DO_ALLOCATION_STACKED
AS 
SELECT
      "YEAR_PERIOD",
    "ARTICLE_NO",
  "org_Facility_Type",
    "dest_Facility_Type",
    "ORDER_QTY",
    "allocation_final"
FROM SHIPMENT_DO_ALLOCATION
UNION ALL 
SELECT 
      "YEAR_PERIOD",
      "ARTICLE_NO",
      "org_Facility_Type",
  "dest_Facility_Type",
  "ORDER_QTY",
  "allocation_final"
  FROM SHIPING_DO_BY_ARTICLE_NO_JOINED;

<br>
--SHIPPING_DO_ALLOCATION_ROLLUP
</br> 			   
  
CREATE OR REPLACE TEMP TABLE SHIPPING_DO_ALLOCATION_ROLLUP	 
AS
SELECT
      "YEAR_PERIOD",
    "ARTICLE_NO",
  "org_Facility_Type",
    "dest_Facility_Type",
    SUM("ORDER_QTY") "ORDER_QTY",
    SUM("allocation_final") "allocation_final"
FROM SHIPPING_DO_ALLOCATION_STACKED	  
GROUP BY   "YEAR_PERIOD", "ARTICLE_NO", "org_Facility_Type","dest_Facility_Type";

<br>
--SHIPPING_DO_TURN_PERIOD
</br> 		

CREATE OR REPLACE TEMP TABLE SHIPPING_DO_TURN_PERIOD
AS 
SELECT 
    R."YEAR_PERIOD",
  R."ARTICLE_NO",
  R."org_Facility_Type",
    R."dest_Facility_Type",
  R."ORDER_QTY",
  R."allocation_final",
  T."turn_period" AS "turn_period"
FROM SHIPPING_DO_ALLOCATION_ROLLUP R
LEFT JOIN  "TURN_PERIOD_MASTER"  T 
  ON R."ARTICLE_NO" =T."ARTICLE_NO";
  
<br>
--DO_TURN_PERIOD_STACKED
</br> 
  
CREATE OR REPLACE TEMP TABLE DO_TURN_PERIOD_STACKED
AS
SELECT 
"YEAR_PERIOD",
  "ARTICLE_NO",
  "org_Facility_Type",
  "dest_Facility_Type",
  "ORDER_QTY",
  "allocation_final",
  "turn_period"
FROM INVOICE_DO_TURN_PERIOD
UNION ALL 
SELECT 
"YEAR_PERIOD",
  "ARTICLE_NO",
  "org_Facility_Type",
  "dest_Facility_Type",
  "ORDER_QTY",
  "allocation_final",
  "turn_period"
FROM SHIPPING_DO_TURN_PERIOD;

<br>
--DO_TURN_PERIOD_STACKED_GRP
</br> 
	
CREATE OR REPLACE TEMP TABLE DO_TURN_PERIOD_STACKED_GRP as 
SELECT 
    "YEAR_PERIOD",
    "ARTICLE_NO",
    "org_Facility_Type",
    "dest_Facility_Type",
    "turn_period",
    "ORDER_QTY",
    "allocation_final"
from 
(
SELECT
  "YEAR_PERIOD",
  "ARTICLE_NO",
  "org_Facility_Type",
  "dest_Facility_Type",
   "turn_period",
  SUM("ORDER_QTY")"ORDER_QTY" ,
  SUM("allocation_final")"allocation_final"
  FROM DO_TURN_PERIOD_STACKED 
GROUP BY "YEAR_PERIOD","ARTICLE_NO","org_Facility_Type","dest_Facility_Type","turn_period"
);


<br>
--DO_TURN_PERIOD_STACKED_GRP
</br>
   
CREATE OR REPLACE TEMPORARY TABLE DO_INVENTORY_TURN AS 
 WITH Base AS (
  SELECT 
    B."YEAR_PERIOD", 
    B."ARTICLE_NO", 
    B."ORDER_QTY", 
    B."allocation_final" , 
    B."turn_period" , 
    B."org_Facility_Type" , 
    B."dest_Facility_Type", 
    ifnull(
      (B."turn_period" ) *-1, 
      -1
    ) as negativeturn_period, 
    TO_DATE(
      CONCAT(
        LEFT(
          cast(B."YEAR_PERIOD" AS VARCHAR), 
          4
        ), 
        '-', 
        RIGHT(
          cast(B."YEAR_PERIOD" AS VARCHAR), 
          2
        ), 
        '-01'
      )
    ) as Period 
  FROM 
    DO_TURN_PERIOD_STACKED_GRP B
) 
SELECT 
  Base."YEAR_PERIOD", 
  Base."ARTICLE_NO", 
  Base."ORDER_QTY", 
  Base."allocation_final", 
  Base."turn_period", 
  Base."org_Facility_Type", 
  Base."dest_Facility_Type", 
  SUM (Agg."ORDER_QTY") as "order_qty_cummulated", 
  SUM (Agg."allocation_final") as "allocation_final_cummulated" 
FROM 
  Base 
  LEFT OUTER JOIN Base Agg on ifnull(Base."ARTICLE_NO",-9999) = ifnull(Agg."ARTICLE_NO",-9999) 
  and ifnull(Base."org_Facility_Type", '') = ifnull(Agg."org_Facility_Type", '') 
  and ifnull(Base."dest_Facility_Type", '') = ifnull(Agg."dest_Facility_Type", '') 
  AND Agg.Period between DateAdd(
    month, Base.negativeturn_period + 1, 
    Base.Period
  ) 
  and Base.Period 
GROUP BY 
  Base."YEAR_PERIOD", 
  Base."ARTICLE_NO", 
  Base."ORDER_QTY", 
  Base."allocation_final", 
  Base."turn_period", 
  Base."org_Facility_Type", 
  Base."dest_Facility_Type";

<br>
--FREIGHT_COST_FINAL
</br>
CREATE OR REPLACE TEMPORARY TABLE FREIGHT_COST_FINAL AS 
SELECT 
  "YEAR_PERIOD" AS "YEAR_PERIOD", 
  "ARTICLE_NO" AS "ARTICLE_NO", 
  "turn_period" AS "turn_period", 
  "VENDOR_ID" AS "VENDOR_ID", 
  "org_Facility_Type" AS "org_Facility_Type", 
  "dest_Facility_Type" AS "dest_Facility_Type", 
  SUM("ORDER_QTY") AS "ORDER_QTY_sum", 
  SUM("allocation_final") AS "allocation_final", 
  SUM("order_qty_cummulated") AS "order_qty_cummulated", 
  SUM("allocation_final_cummulated") AS "allocation_final_cummulated" 
FROM 
  (
    SELECT 
      "YEAR_PERIOD", 
      "ARTICLE_NO", 
      "ORDER_QTY", 
      "allocation_final", 
      "turn_period", 
      "VENDOR_ID", 
      "org_Facility_Type", 
      "dest_Facility_Type", 
      "order_qty_cummulated", 
      "allocation_final_cummulated", 
      CASE WHEN ("order_qty_cummulated" = 0) OR "order_qty_cummulated" IS NULL THEN 0 ELSE CAST(COALESCE("allocation_final_cummulated", 0) AS DOUBLE) / NULLIF(COALESCE("order_qty_cummulated", 0), 0) END AS "unit_cost" 
    FROM 
      "PO_INVENTORY_TURN" 
    UNION ALL 
    SELECT 
      "Year Period" AS "YEAR_PERIOD", 
      "po_Item_No" AS "ARTICLE_NO", 
      "po_Item_Qty_sum" AS "ORDER_QTY", 
      "allocation_final_sum" AS "allocation_final", 
      "turn_period", 
      "po_VENDOR_ID" AS "VENDOR_ID", 
      "org_Facility_Type", 
      "dest_Facility_Type", 
      "po_item_qty_sum_cummulated" AS "order_qty_cummulated", 
      "allocation_final_sum_cummulated" AS "allocation_final_cummulated", 
      "ocean_freight_per_unit" AS "unit_cost" 
    FROM 
      "OCEAN_FREIGHT_TURN_PERIOD_CUMMU_PREPARED" 
    UNION ALL 
    SELECT 
      "YEAR_PERIOD", 
      "ARTICLE_NO", 
      "ORDER_QTY", 
      "allocation_final", 
      "turn_period", 
      NULL AS "VENDOR_ID", 
      "org_Facility_Type", 
      "dest_Facility_Type", 
      "order_qty_cummulated", 
      "allocation_final_cummulated", 
      CASE WHEN ("order_qty_cummulated" = 0) OR "order_qty_cummulated" IS NULL THEN 0 ELSE CAST(COALESCE("allocation_final_cummulated", 0) AS DOUBLE) / NULLIF(COALESCE("order_qty_cummulated", 0), 0) END AS "unit_cost" 
    FROM 
      "DO_INVENTORY_TURN"
  ) unionedall 
GROUP BY "YEAR_PERIOD", "ARTICLE_NO", "turn_period", "VENDOR_ID", "org_Facility_Type", "dest_Facility_Type";

<br>
--FREIGHT_LATEST_COST
</br>
CREATE OR REPLACE TEMPORARY TABLE FREIGHT_LATEST_COST AS 
SELECT 
  YEAR_PERIOD, 
  ARTICLE_NO, 
  "turn_period", 
  VENDOR_ID, 
  "org_Facility_Type", 
  "dest_Facility_Type", 
  "leg", 
  ORDER_QTY, 
  "allocation_final", 
  "order_qty_cummulated", 
  "allocation_final_cummulated", 
  "unit_cost", 
  value_partition, 
  first_Value("unit_cost") over (partition by ARTICLE_NO, VENDOR_ID, "leg", value_partition order by YEAR_PERIOD ASC) as "last_unit_cost" 
FROM 
  (
    SELECT 
      YEAR_PERIOD, 
      ARTICLE_NO, 
      "turn_period", 
      VENDOR_ID, 
      "org_Facility_Type", 
      "dest_Facility_Type", 
      "leg", 
      ORDER_QTY, 
      "allocation_final", 
      "order_qty_cummulated", 
      "allocation_final_cummulated", 
      "unit_cost", 
      sum(case when ifnull("unit_cost", 0) = 0 then 0 else 1 end) over (Partition By ARTICLE_NO, VENDOR_ID, "leg" order by YEAR_PERIOD) as value_partition 
    FROM 
      (
        SELECT 
          "YEAR_PERIOD", 
          "ARTICLE_NO", 
          "turn_period", 
          "VENDOR_ID", 
          "org_Facility_Type", 
          "dest_Facility_Type", 
          "ORDER_QTY_sum" AS "ORDER_QTY", 
          "allocation_final", 
          "order_qty_cummulated", 
          "allocation_final_cummulated", 
          CASE WHEN ("order_qty_cummulated" = 0) OR "order_qty_cummulated" IS NULL THEN 0 ELSE CAST(COALESCE(
              "allocation_final_cummulated", 0
            ) AS DOUBLE
          ) / NULLIF(
            COALESCE("order_qty_cummulated", 0), 
            0
          ) END AS "unit_cost", 
          CONCAT(
            IFNULL(
              TO_VARCHAR("org_Facility_Type"), 
              ''
            ), 
            ' to ', 
            IFNULL(
              TO_VARCHAR("dest_Facility_Type"), 
              ''
            )
          ) AS "leg" 
        FROM 
          FREIGHT_COST_FINAL
      ) FCF 
    ORDER BY 
      ARTICLE_NO, 
      VENDOR_ID, 
      "leg", 
      YEAR_PERIOD
  ) as result 
ORDER BY 
  ARTICLE_NO, 
  VENDOR_ID, 
  "leg", 
  YEAR_PERIOD;

<br>
--LM_SCANDOWN_NEW_JOINED
</br>   
CREATE OR REPLACE TEMP TABLE LM_SCANDOWN_NEW_JOINED
  AS
  SELECT 
      "sku"."SKU",
      "sku"."YEAR",
      "sku"."YEAR_PERIOD_NEW",
      "sku"."LOG_NO",
      "sku"."LOG_NO_CLEAN",
      "sku"."VENDOR_NO",
      "sku"."TOTAL",
      "artno"."SALES_AMT"
  FROM LM_NEW_SCANDOWN_FLAG_JOINED_SKU "sku"
  LEFT JOIN (
              SELECT 
              "ARTICLE_NO",
              "YEAR_PERIOD",
              "VENDOR_ID",
              SUM("SALES_AMT") AS "SALES_AMT"
              FROM SALES_W_PAR_VENDOR
              GROUP BY "ARTICLE_NO", "YEAR_PERIOD", "VENDOR_ID"
              ) as "artno"
  ON ("sku"."SKU" = "artno"."ARTICLE_NO")
  AND ("sku"."YEAR_PERIOD_NEW" = "artno"."YEAR_PERIOD")
  AND ("sku"."VENDOR_NO" = "artno"."VENDOR_ID");

<br>
--LM_SCANDOWN_NEW_JOINED_WINDOWS_PREPARED
</br>  

CREATE OR REPLACE TEMP TABLE LM_SCANDOWN_NEW_JOINED_WINDOWS_PREPARED
 AS
 WITH CTE AS 
 (
 SELECT *,IFF(COALESCE("SALES_AMT_sum",0) =0 ,0,(COALESCE("SALES_AMT",0)/COALESCE("SALES_AMT_sum",0))) AS "allocation_share"                
 FROM 
 (
        
 SELECT 
 *,SUM("SALES_AMT") OVER (PARTITION BY "LOG_NO_CLEAN", "YEAR_PERIOD_NEW") AS "SALES_AMT_sum"
 FROM LM_SCANDOWN_NEW_JOINED 
 )LM_SCANDOWN_NEW_JOINED_WINDOWS
 
 )
 SELECT *,(COALESCE("TOTAL",0) * COALESCE( "allocation_share"  ,0)) AS "allocation_value"                 
 FROM CTE ;

<br>
--LM_SCANDOWN_PREPARED
</br>  
      
CREATE OR REPLACE TEMP TABLE LM_SCANDOWN_PREPARED
 AS
 SELECT 
 "SKU" AS ARTICLE_NO,
 LEFT("YEAR_PERIOD_NEW",4) AS MERCH_YEAR,
 "YEAR_PERIOD_NEW" AS YEAR_PERIOD,
 "VENDOR_NO" as Vendor_ID,
 "allocation_value"
 FROM 
 (
 SELECT 
 "SKU" ,
 "YEAR",
 "YEAR_PERIOD_NEW" ,
 "VENDOR_NO",
 SUM("allocation_value") AS "allocation_value"
 FROM LM_SCANDOWN_NEW_JOINED_WINDOWS_PREPARED
 GROUP BY  "SKU","YEAR","YEAR_PERIOD_NEW","VENDOR_NO"
 )lm_scandown;

<br>
--OMNICHANNEL_SALES_W_OMS_ITEM
----------------------
</br>
CREATE OR REPLACE TEMPORARY TABLE OMNICHANNEL_SALES_W_OMS_ITEM AS
SELECT  
    "joined_2"."ACCT_YEAR" AS "ACCT_YEAR",
    "joined_2"."YEAR_PERIOD" AS "YEAR_PERIOD",
    "joined_2"."YEAR_WEEK" AS "YEAR_WEEK",
    "joined_2"."OMS_ORDER_NO" AS "OMS_ORDER_NO",
    "joined_2"."OMS_ITEM_ID" AS "OMS_ITEM_ID",
    "joined_2"."OMS_ORDER_LINE_KEY" AS "OMS_ORDER_LINE_KEY",
    "joined_2"."VENDOR_ID" AS "VENDOR_ID",
    "joined_2"."OMS_ORDER_LINE_SCHEDULE_SHIP_NODE" AS "OMS_ORDER_LINE_SCHEDULE_SHIP_NODE",
    "joined_2"."OMS_SHIP_NODE_DESC" AS "OMS_SHIP_NODE_DESC",
    "joined_2"."ARTICLE_CAT_FULL" AS "ARTICLE_CAT_FULL",
    "joined_2"."DEMAND_QTY" AS "DEMAND_QTY",
    "joined_2"."DEMAND_SALES" AS "DEMAND_SALES",
    "joined_2"."BOOKED_SALES_QTY" AS "BOOKED_SALES_QTY",
    "joined_2"."BOOKED_SALES_AMT" AS "BOOKED_SALES_AMT",
    "joined_2"."BOOKED_COST_AMT" AS "BOOKED_COST_AMT",
    "joined_2"."SHIPPING_REVENUE" AS "SHIPPING_REVENUE",
    "joined_2"."SHIPPING_DISC" AS "SHIPPING_DISC",
    "joined_2"."ACTUAL_SHIPPING_REVENUE" AS "ACTUAL_SHIPPING_REVENUE",
    "joined_2"."ORDER_LINE_TYPE" AS "ORDER_LINE_TYPE",
    "joined_2"."SCAC" AS "SCAC",
    "joined_2"."SHIP_NODE_TYPE" AS "SHIP_NODE_TYPE",
    "joined_2"."MERCH_YEAR" AS "MERCH_YEAR",
    "joined_2"."YEAR_QUARTER" AS "YEAR_QUARTER",
    "joined_2"."CHAIN_PROD" AS "CHAIN_PROD",
    "joined_2"."ARTICLE_DESC" AS "ARTICLE_DESC",
    "joined_2"."ARTICLE_FULL" AS "ARTICLE_FULL",
    "joined_2"."ARTICLE_TYPE_NAME" AS "ARTICLE_TYPE_NAME",
    "joined_2"."ARTICLE_TYPE_CODE" AS "ARTICLE_TYPE_CODE",
    "joined_2"."ARTICLE_TYPE_FULL" AS "ARTICLE_TYPE_FULL",
    "joined_2"."ARTICLE_LENGTH" AS "ARTICLE_LENGTH",
    "joined_2"."ARTICLE_WIDTH" AS "ARTICLE_WIDTH",
    "joined_2"."ARTICLE_HEIGHT" AS "ARTICLE_HEIGHT",
    "joined_2"."ARTICLE_WEIGHT" AS "ARTICLE_WEIGHT",
    "joined_2"."ARTICLE_SIZE" AS "ARTICLE_SIZE",
    "joined_2"."ARTICLE_COUNT" AS "ARTICLE_COUNT",
    "joined_2"."ARTICLE_COLOR" AS "ARTICLE_COLOR",
    "joined_2"."PARENT_ARTICLE_NO" AS "PARENT_ARTICLE_NO",
    "joined_2"."PARENT_ARTICLE_DESC" AS "PARENT_ARTICLE_DESC",
    "joined_2"."PARENT_ARTICLE_FULL" AS "PARENT_ARTICLE_FULL",
    "joined_2"."PRIMARY_VENDOR_ID" AS "PRIMARY_VENDOR_ID",
    "joined_2"."ARTICLE_CAT_CODE" AS "ARTICLE_CAT_CODE",
    "joined_2"."ARTICLE_CAT_NAME" AS "ARTICLE_CAT_NAME",
    "joined_2"."DEPT_CODE" AS "DEPT_CODE",
    "joined_2"."DEPT_NAME" AS "DEPT_NAME",
    "joined_2"."DEPT_FULL" AS "DEPT_FULL",
    "joined_2"."LOB_NO" AS "LOB_NO",
    "joined_2"."LOB_DESC" AS "LOB_DESC",
    "joined_2"."LOB_FULL" AS "LOB_FULL",
    "joined_2"."MAJ_DEPT_NO" AS "MAJ_DEPT_NO",
    "joined_2"."MAJ_DEPT_DESC" AS "MAJ_DEPT_DESC",
    "joined_2"."MAJ_DEPT_FULL" AS "MAJ_DEPT_FULL",
    "joined_2"."BRAND_NAME" AS "BRAND_NAME",
    "joined_2"."PVT_LABEL_DESC" AS "PVT_LABEL_DESC",
    "joined_2"."VENDOR_NAME" AS "VENDOR_NAME",
    "joined_2"."VENDOR_FULL" AS "VENDOR_FULL",
    "joined_2"."PARENT_VENDOR_ID" AS "PARENT_VENDOR_ID",
    "itmpr"."OMS_ITEM_WEIGHT" ,
    "itmpr"."OMS_ITEM_HEIGHT" ,
    "itmpr"."OMS_ITEM_LENGTH" ,
    "itmpr"."OMS_ITEM_WIDTH" 
from(
select 
    "omni_prep_joined".*, 
    "cpvp"."PARENT_VENDOR_ID" 
from (
select  
    "omni_prep"."ACCT_YEAR" ,
    "omni_prep"."YEAR_PERIOD" ,
    "omni_prep"."YEAR_WEEK" ,
    "omni_prep"."OMS_ORDER_NO" ,
    "omni_prep"."OMS_ITEM_ID" ,
    "omni_prep"."OMS_ORDER_LINE_KEY" ,
    "omni_prep"."OMS_ITEM_PRIMARY_VENDOR_ID" as VENDOR_ID,
    "omni_prep"."OMS_ORDER_LINE_SCHEDULE_SHIP_NODE" ,
    "omni_prep"."OMS_SHIP_NODE_DESC" ,
    "omni_prep"."ARTICLE_CAT_FULL" ,
    "omni_prep"."DEMAND_QTY" ,
    "omni_prep"."DEMAND_SALES" ,
    "omni_prep"."BOOKED_SALES_QTY" ,
    "omni_prep"."BOOKED_SALES_AMT" ,
    "omni_prep"."BOOKED_COST_AMT" ,
    "omni_prep"."SHIPPING_REVENUE" ,
    "omni_prep"."SHIPPING_DISC" ,
    "omni_prep"."ACTUAL_SHIPPING_REVENUE" ,
    "omni_prep"."ORDER_LINE_TYPE" ,
    "omni_prep"."SCAC" ,
    "omni_prep"."SHIP_NODE_TYPE" ,
    "omni_prep"."MERCH_YEAR" ,
    "omni_prep"."YEAR_QUARTER",
    "omni_prep"."CHAIN_PROD",
    "omni_prep"."ARTICLE_DESC",
    "omni_prep"."ARTICLE_FULL",
    "omni_prep"."ARTICLE_TYPE_NAME",
    "omni_prep"."ARTICLE_TYPE_CODE",
    "omni_prep"."ARTICLE_TYPE_FULL",
    "omni_prep"."ARTICLE_LENGTH" ,
    "omni_prep"."ARTICLE_WIDTH" ,
    "omni_prep"."ARTICLE_HEIGHT" ,
    "omni_prep"."ARTICLE_WEIGHT" , 
    "omni_prep"."ARTICLE_SIZE" ,
    "omni_prep"."ARTICLE_COUNT" ,
    "omni_prep"."ARTICLE_COLOR" ,
    "omni_prep"."PARENT_ARTICLE_NO" ,
    "omni_prep"."PARENT_ARTICLE_DESC" ,
    "omni_prep"."PARENT_ARTICLE_FULL" ,
    "omni_prep"."PRIMARY_VENDOR_ID" ,
    "omni_prep"."ARTICLE_CAT_CODE" ,
    "omni_prep"."ARTICLE_CAT_NAME" ,
    "omni_prep"."DEPT_CODE" ,
    "omni_prep"."DEPT_NAME" ,
    "omni_prep"."DEPT_FULL" ,
    "omni_prep"."LOB_NO" ,
    "omni_prep"."LOB_DESC" ,
    "omni_prep"."LOB_FULL" ,
    "omni_prep"."MAJ_DEPT_NO" ,
    "omni_prep"."MAJ_DEPT_DESC" ,
    "omni_prep"."MAJ_DEPT_FULL" ,
    "omni_prep"."BRAND_NAME" ,
    "omni_prep"."PVT_LABEL_DESC" ,
    "ven"."VENDOR_NAME" ,
    "ven"."VENDOR_FULL" 
 from (
select 
    "omni_joined"."ACCT_YEAR" ,
    "omni_joined"."YEAR_PERIOD" ,
    "omni_joined"."YEAR_WEEK" ,
    "omni_joined"."OMS_ORDER_NO" ,
    "omni_joined"."OMS_ITEM_ID" ,
    "omni_joined"."OMS_ORDER_LINE_KEY" ,
    "omni_joined"."OMS_ITEM_PRIMARY_VENDOR_ID",
    "omni_joined"."OMS_ORDER_LINE_SCHEDULE_SHIP_NODE" ,
    "omni_joined"."OMS_SHIP_NODE_DESC" ,
    "omni_joined"."ARTICLE_CAT_FULL" ,
    "omni_joined"."DEMAND_QTY" ,
    "omni_joined"."DEMAND_SALES" ,
    "omni_joined"."BOOKED_SALES_QTY" ,
    "omni_joined"."BOOKED_SALES_AMT" ,
    "omni_joined"."BOOKED_COST_AMT" ,
    "omni_joined"."SHIPPING_REVENUE" ,
    "omni_joined"."SHIPPING_DISC" ,
    "omni_joined"."ACTUAL_SHIPPING_REVENUE" ,
    "omni_joined"."ORDER_LINE_TYPE" ,
    "omni_joined"."SCAC" ,
    "omni_joined"."SHIP_NODE_TYPE" ,
    "omni_joined"."MERCH_YEAR" ,
    "omni_joined"."YEAR_QUARTER",
    "art"."CHAIN_PROD",
    "art"."ARTICLE_DESC",
    "art"."ARTICLE_FULL",
    "art"."ARTICLE_TYPE_NAME",
    "art"."ARTICLE_TYPE_CODE",
    "art"."ARTICLE_TYPE_FULL",
    "art"."ARTICLE_LENGTH" ,
    "art"."ARTICLE_WIDTH" ,
    "art"."ARTICLE_HEIGHT" ,
    "art"."ARTICLE_WEIGHT" , 
    "art"."ARTICLE_SIZE" ,
    "art"."ARTICLE_COUNT" ,
    "art"."ARTICLE_COLOR" ,
    "art"."PARENT_ARTICLE_NO" ,
    "art"."PARENT_ARTICLE_DESC" ,
    "art"."PARENT_ARTICLE_FULL" ,
    "art"."PRIMARY_VENDOR_ID" ,
    "art"."ARTICLE_CAT_CODE" ,
    "art"."ARTICLE_CAT_NAME" ,
    "art"."DEPT_CODE" ,
    "art"."DEPT_NAME" ,
    "art"."DEPT_FULL" ,
    "art"."LOB_NO" ,
    "art"."LOB_DESC" ,
    "art"."LOB_FULL" ,
    "art"."MAJ_DEPT_NO" ,
    "art"."MAJ_DEPT_DESC" ,
    "art"."MAJ_DEPT_FULL" ,
    "art"."BRAND_NAME" ,
    "art"."PVT_LABEL_DESC" 
from (
SELECT 
    "omni"."ACCT_YEAR" ,
    "omni"."YEAR_PERIOD" ,
    "omni"."YEAR_WEEK" ,
    "omni"."OMS_ORDER_NO" ,
    "omni"."OMS_ITEM_ID" ,
    "omni"."OMS_ORDER_LINE_KEY" ,
    cast("omni"."OMS_ITEM_PRIMARY_VENDOR_ID" as number) as "OMS_ITEM_PRIMARY_VENDOR_ID"  ,
    "omni"."OMS_ORDER_LINE_SCHEDULE_SHIP_NODE" ,
    "omni"."OMS_SHIP_NODE_DESC" ,
    "omni"."ARTICLE_CAT_FULL" ,
    "omni"."DEMAND_QTY" ,
    "omni"."DEMAND_SALES" ,
    "omni"."BOOKED_SALES_QTY" ,
    "omni"."BOOKED_SALES_AMT" ,
    "omni"."BOOKED_COST_AMT" ,
    "omni"."SHIPPING_REVENUE" ,
    "omni"."SHIPPING_DISC" ,
    "omni"."ACTUAL_SHIPPING_REVENUE" ,
    "omni"."ORDER_LINE_TYPE" ,
    "omni"."SCAC" ,
    "omni"."SHIP_NODE_TYPE" ,
    "time"."MERCH_YEAR" ,
    "time"."YEAR_QUARTER" 
  FROM OMNICHANNEL_SALES_STATUS_PREPARED "omni" 
  LEFT JOIN (SELECT 
                "YEAR_PERIOD" ,
                "MERCH_YEAR" ,
                "YEAR_QUARTER" 
                FROM EDW.TIME_DIMENSION 
                GROUP by "YEAR_PERIOD" , "MERCH_YEAR" ,"YEAR_QUARTER" ) "time" 
            ON "omni"."YEAR_PERIOD" = "time"."YEAR_PERIOD"
  where MERCH_YEAR  >=  2020) "omni_joined"
  LEFT JOIN ARTICLE_W_SHP_DIM_PREP "art"
    ON cast("omni_joined"."OMS_ITEM_ID" as number) = cast("art"."ARTICLE_NO"as number)) as "omni_prep"
  LEFT JOIN EDW.VW_VENDOR "ven"
    ON cast("omni_prep"."OMS_ITEM_PRIMARY_VENDOR_ID" as number)  = cast("ven"."VENDOR_ID"as number) ) as "omni_prep_joined"
  LEFT JOIN COMPANY_PARENT_VENDOR_PREPARED "cpvp"
    ON cast("omni_prep_joined"."VENDOR_ID" as number) = cast("cpvp"."VENDOR_ID" as number)) as "joined_2"
  LEFT JOIN OMS_ITEM_PREPARED_BY_OMS_ITEM_ID "itmpr"
    ON cast("joined_2"."OMS_ITEM_ID" as number) = cast("itmpr"."OMS_ITEM_ID" as number)  ;

<br>
---OMNICHANNEL_SALES_W_OMS_ITEM_DIM_WEIGHT
</br>

CREATE OR REPLACE TEMP TABLE OMNICHANNEL_SALES_W_OMS_ITEM_DIM_WEIGHT AS
select 
  "ACCT_YEAR",
  "YEAR_PERIOD",
  "YEAR_WEEK",
  "OMS_ORDER_NO",
  "OMS_ITEM_ID",
  "OMS_ORDER_LINE_KEY",
  "VENDOR_ID",
  "OMS_ORDER_LINE_SCHEDULE_SHIP_NODE",
  "OMS_SHIP_NODE_DESC",
  "ARTICLE_CAT_FULL",
  "DEMAND_QTY",
  "DEMAND_SALES",
  "BOOKED_SALES_QTY",
  "BOOKED_SALES_AMT",
  "BOOKED_COST_AMT",
  "SHIPPING_REVENUE",
  "SHIPPING_DISC",
  "ACTUAL_SHIPPING_REVENUE",
  "ORDER_LINE_TYPE",
  "SCAC",
  "SHIP_NODE_TYPE",
  "MERCH_YEAR",
  "YEAR_QUARTER",
  "CHAIN_PROD",
  "ARTICLE_DESC",
  "ARTICLE_FULL",
  "ARTICLE_TYPE_NAME",
  "ARTICLE_TYPE_CODE",
  "ARTICLE_TYPE_FULL",
  ARTICLE_LENGTH,
  ARTICLE_WIDTH,
  ARTICLE_HEIGHT,
  GREATEST(coalesce(coalesce(ARTICLE_LENGTH * ARTICLE_WIDTH * ARTICLE_HEIGHT/139,0),0),coalesce(ARTICLE_WEIGHT,0)) as ARTICLE_WEIGHT,
  "ARTICLE_SIZE",
  "ARTICLE_COUNT",
  "ARTICLE_COLOR",
  "PARENT_ARTICLE_NO",
  "PARENT_ARTICLE_DESC",
  "PARENT_ARTICLE_FULL",
  "PRIMARY_VENDOR_ID",
  "ARTICLE_CAT_CODE",
  "ARTICLE_CAT_NAME",
  "DEPT_CODE",
  "DEPT_NAME",
  "DEPT_FULL",
  "LOB_NO",
  "LOB_DESC",
  "LOB_FULL",
  "MAJ_DEPT_NO",
  "MAJ_DEPT_DESC",
  "MAJ_DEPT_FULL",
  "BRAND_NAME",
  "PVT_LABEL_DESC",
  "VENDOR_NAME",
  "VENDOR_FULL",
  "PARENT_VENDOR_ID"
from
 (
  select 
    "ACCT_YEAR",
    "YEAR_PERIOD",
    "YEAR_WEEK",
    "OMS_ORDER_NO",
    "OMS_ITEM_ID",
    "OMS_ORDER_LINE_KEY",
    "VENDOR_ID",
    "OMS_ORDER_LINE_SCHEDULE_SHIP_NODE",
    "OMS_SHIP_NODE_DESC",
    "ARTICLE_CAT_FULL",
    "DEMAND_QTY",
    "DEMAND_SALES",
    "BOOKED_SALES_QTY",
    "BOOKED_SALES_AMT",
    "BOOKED_COST_AMT",
    "SHIPPING_REVENUE",
    "SHIPPING_DISC",
    "ACTUAL_SHIPPING_REVENUE",
    "ORDER_LINE_TYPE",
    "SCAC",
    "SHIP_NODE_TYPE",
    "MERCH_YEAR",
    "YEAR_QUARTER",
    "CHAIN_PROD",
    "ARTICLE_DESC",
    "ARTICLE_FULL",
    "ARTICLE_TYPE_NAME",
    "ARTICLE_TYPE_CODE",
    "ARTICLE_TYPE_FULL",
    CASE WHEN "OMS_ITEM_LENGTH" IS NULL THEN COALESCE("ARTICLE_LENGTH", 0) ELSE COALESCE("OMS_ITEM_LENGTH", 0) END as ARTICLE_LENGTH,
    CASE WHEN "OMS_ITEM_WIDTH" IS NULL THEN  COALESCE("ARTICLE_WIDTH", 0) ELSE  COALESCE("OMS_ITEM_WIDTH", 0) END as ARTICLE_WIDTH,
    CASE WHEN "OMS_ITEM_HEIGHT" IS NULL THEN COALESCE("ARTICLE_HEIGHT", 0) ELSE COALESCE("OMS_ITEM_HEIGHT", 0) END as ARTICLE_HEIGHT,
    CASE WHEN "OMS_ITEM_WEIGHT" IS NULL THEN COALESCE("ARTICLE_WEIGHT", 0) ELSE COALESCE("OMS_ITEM_WEIGHT", 0) END as ARTICLE_WEIGHT,
    "ARTICLE_SIZE",
    "ARTICLE_COUNT",
    "ARTICLE_COLOR",
    "PARENT_ARTICLE_NO",
    "PARENT_ARTICLE_DESC",
    "PARENT_ARTICLE_FULL",
    "PRIMARY_VENDOR_ID",
    "ARTICLE_CAT_CODE",
    "ARTICLE_CAT_NAME",
    "DEPT_CODE",
    "DEPT_NAME",
    "DEPT_FULL",
    "LOB_NO",
    "LOB_DESC",
    "LOB_FULL",
    "MAJ_DEPT_NO",
    "MAJ_DEPT_DESC",
    "MAJ_DEPT_FULL",
    "BRAND_NAME",
    "PVT_LABEL_DESC",
    "VENDOR_NAME",
    "VENDOR_FULL",
    "PARENT_VENDOR_ID"
    from OMNICHANNEL_SALES_W_OMS_ITEM
    ) as dku  ;

  
<br>
---------------
</br>
CREATE OR REPLACE TEMPORARY TABLE OMNICHANNEL_SALES AS
SELECT 
    sales.ACCT_YEAR,
    sales.YEAR_PERIOD,
    sales.YEAR_WEEK,
    sales.OMS_ORDER_NO,
    sales.OMS_ITEM_ID,
    sales.OMS_ORDER_LINE_KEY,
    sales.VENDOR_ID,
    sales.OMS_ORDER_LINE_SCHEDULE_SHIP_NODE,
    sales.OMS_SHIP_NODE_DESC,
    sales.ARTICLE_CAT_FULL,
    sales.DEMAND_QTY,
    sales.DEMAND_SALES,
    sales.BOOKED_SALES_QTY,
    sales.BOOKED_SALES_AMT,
    sales.BOOKED_COST_AMT,
    sales.SHIPPING_REVENUE,
    sales.SHIPPING_DISC,
    sales.ACTUAL_SHIPPING_REVENUE,
    sales.ORDER_LINE_TYPE,
    sales.SCAC,
    sales.SHIP_NODE_TYPE,
    sales.MERCH_YEAR,
    sales.YEAR_QUARTER,
    sales.CHAIN_PROD,
    sales.ARTICLE_DESC,
    sales.ARTICLE_FULL,
    sales.ARTICLE_TYPE_NAME,
    sales.ARTICLE_TYPE_CODE,
    sales.ARTICLE_TYPE_FULL,
    sales.ARTICLE_LENGTH,
    sales.ARTICLE_WIDTH,
    sales.ARTICLE_HEIGHT,
    sales.ARTICLE_WEIGHT,
    sales.ARTICLE_SIZE,
    sales.ARTICLE_COUNT,
    sales.ARTICLE_COLOR,
    sales.PARENT_ARTICLE_NO,
    sales.PARENT_ARTICLE_DESC,
    sales.PARENT_ARTICLE_FULL,
    sales.PRIMARY_VENDOR_ID,
    sales.ARTICLE_CAT_CODE,
    sales.ARTICLE_CAT_NAME,
    sales.DEPT_CODE,
    sales.DEPT_NAME,
    sales.DEPT_FULL,
    sales.LOB_NO,
    sales.LOB_DESC,
    sales.LOB_FULL,
    sales.MAJ_DEPT_NO,
    sales.MAJ_DEPT_DESC,
    sales.MAJ_DEPT_FULL,
    sales.BRAND_NAME,
    sales.PVT_LABEL_DESC,
    sales.VENDOR_NAME,
    sales.VENDOR_FULL,
    sales.PARENT_VENDOR_ID,
    flag.omni_small_package_flag,
    flag.tsc_delivery_flag,
    flag.roadie_flag
  FROM OMNICHANNEL_SALES_W_OMS_ITEM_DIM_WEIGHT sales
  LEFT JOIN OMNI_SMALL_PACKAGE_FLAG_PREPARED flag
    ON (sales.ORDER_LINE_TYPE = flag.ORDER_LINE_TYPE) AND (sales.SCAC = flag.SCAC);

<br>
--pop_by_date
----------------
</br>

CREATE OR REPLACE TEMPORARY TABLE POP_BY_DATE AS
SELECT 
  Prepared_stacked."Vendor_NO" AS Vendor_no,
  TD.MERCH_YEAR,
  TD.YEAR_PERIOD,
  sum(Prepared_stacked."Amount") AS allocation_value
FROM
(
  SELECT 
    "Vendor_NO",
    "Amount",
    to_varchar(CASE WHEN  LEFT(CAST("Submitted" AS DATE),2)='00' THEN REPLACE(CAST("Submitted" AS DATE),'00','20') 
         ELSE CAST("Submitted" AS DATE) END ::date,'yyyyMMdd')    AS "Submitted"
  FROM POP_PREPARED_STG
UNION ALL
  SELECT 
    "Vendor_no" AS Vendor_no,
    "Amount" AS Amount,
    "date_parsed" AS "Submitted"
  FROM lm_pop_prep
)Prepared_stacked
LEFT JOIN EDW.TIME_DIMENSION TD ON TD.TIME_DIM_KEY=Prepared_stacked."Submitted"
group by 1,2,3;
<br>
---------------------------------------
</br>
CREATE OR REPLACE TEMPORARY TABLE SALES_W_PAR_VENDOR_BY_ARTICLE_NO AS
SELECT 
    "ARTICLE_NO" AS "ARTICLE_NO",
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "VENDOR_ID" AS "VENDOR_ID",
    SUM("SALES_AMT") AS "SALES_AMT"
  FROM SALES_W_PAR_VENDOR
  GROUP BY "ARTICLE_NO", "YEAR_PERIOD", "VENDOR_ID";

<br>
--theft_rate
---------------------------------------
</br>
CREATE OR REPLACE TEMP TABLE THEFT_PREP_JOINED_PREPARED_BY_ARTICLE_1_1
 AS
 SELECT Article,
        cal_MERCH_YEAR,
        cal_YEAR_PERIOD,
        SUM(allocation_value) AS allocation_value 
 FROM (
 SELECT
    theft."Article" AS Article,
    dimprep.MERCH_YEAR AS cal_MERCH_YEAR,
    dimprep.YEAR_PERIOD AS cal_YEAR_PERIOD,
    COALESCE(theft."Amount_in_LC", 0) * movcode.multiplier AS allocation_value
FROM THEFT_V2_PREPARED_STACKED theft
LEFT JOIN MOVEMENT_CODES_PREPARED_STG movcode
    ON CAST(theft."Movement_type" AS NUMBER) = CAST(movcode.Movement_codes AS NUMBER)
LEFT JOIN EDW.TIME_DIMENSION dimprep
    ON theft."Posting_date"= dimprep."TIME_DIM_KEY"
WHERE CAST(theft."Movement_type" AS NUMBER) IN (876,976)
) GROUP BY Article,cal_MERCH_YEAR,cal_YEAR_PERIOD;

<br>
--THEFT_PREP_JOINED_PREPARED_BY_ARTICLE_JOINED
---------------------------------------
</br>
CREATE OR REPLACE TEMP TABLE THEFT_PREP_JOINED_PREPARED_BY_ARTICLE_JOINED
AS
 SELECT 
    T.Article,
    T.cal_MERCH_YEAR,
    T.cal_YEAR_PERIOD ,
    T.allocation_value ,
    S.SALES_AMT 
  FROM THEFT_PREP_JOINED_PREPARED_BY_ARTICLE_1_1 T
  LEFT JOIN SALES_FOR_SHRINK  S
  ON (T.Article = S.ARTICLE_NO)
  AND (T.cal_YEAR_PERIOD = S."YEAR_PERIOD");
<br>
--THEFT_RATE
---------------------------------------
</br>
CREATE  OR REPLACE TEMP TABLE THEFT_RATE
AS
SELECT 
CAST(Article AS NUMBER) AS Article,
cal_MERCH_YEAR,
cal_YEAR_PERIOD,
allocation_value,
SALES_AMT,
CASE WHEN SALES_AMT =0 OR SALES_AMT IS NULL THEN 0 ELSE COALESCE(allocation_value,0)/COALESCE(SALES_AMT,0) END AS shrink_rate
FROM THEFT_PREP_JOINED_PREPARED_BY_ARTICLE_JOINED;

<br>
--FINANCIAL_INVENTORY_YP_PREP_JOINED_QTY
</br>
CREATE or replace  TEMPORARY TABLE FINANCIAL_INVENTORY_YP_PREP_JOINED_QTY AS 
SELECT 
    "STORE_NO" AS "STORE_NO",
    "VENDOR_ID" AS "VENDOR_ID",
    "ARTICLE_NO" AS "ARTICLE_NO",
    "FIN_INV_YEAR_PERIOD" AS "FIN_INV_YEAR_PERIOD",
    SUM("AVG_FIN_INV_QTY") AS "AVG_FIN_INV_QTY_SUM"
FROM (
    SELECT 
        "CO_CODE" AS "CO_CODE",
        "STORE_NO" AS "STORE_NO",
        "ARTICLE_NO" AS "ARTICLE_NO",
        "TIME_DIM_KEY" AS "TIME_DIM_KEY",
        "FIN_INV_YEAR_PERIOD" AS "FIN_INV_YEAR_PERIOD",
        "SUM_TYPE_CODE" AS "SUM_TYPE_CODE",
        "VENDOR_ID" AS "VENDOR_ID",
        "DC_NO" AS "DC_NO",
        "REPL_TYPE_CODE" AS "REPL_TYPE_CODE",
        "CURRENT_VENDOR_ID" AS "CURRENT_VENDOR_ID",
        "CURRENT_DC_NO" AS "CURRENT_DC_NO",
        "CURRENT_REPL_TYPE_CODE" AS "CURRENT_REPL_TYPE_CODE",
        "FIN_INV_QTY" AS "FIN_INV_QTY",
        "FIN_INV_AMT" AS "FIN_INV_AMT",
        "OB_FIN_INV_QTY" AS "OB_FIN_INV_QTY",
        "OB_FIN_INV_AMT" AS "OB_FIN_INV_AMT",
        "FIN_INV_13_AMT" AS "FIN_INV_13_AMT",
        "CALC_RCPT_QTY" AS "CALC_RCPT_QTY",
        "CALC_RCPT_AMT" AS "CALC_RCPT_AMT",
        "AVG_FIN_INV_QTY" AS "AVG_FIN_INV_QTY",
        "AVG_FIN_INV_AMT" AS "AVG_FIN_INV_AMT",
        "FACILITY_CODE" AS "FACILITY_CODE",
        "FACILITY" AS "FACILITY",
        "DC_HIERCHY" AS "DC_HIERCHY",
        "DC_3PL" AS "DC_3PL",
        "OMS_ITEM_HEIGHT" AS "OMS_ITEM_HEIGHT",
        "OMS_ITEM_LENGTH" AS "OMS_ITEM_LENGTH",
        "OMS_ITEM_WIDTH" AS "OMS_ITEM_WIDTH",
        "ITEM_VOLUME" AS "ITEM_VOLUME",
        "ARTICLE_LENGTH" AS "ARTICLE_LENGTH",
        "ARTICLE_WIDTH" AS "ARTICLE_WIDTH",
        "ARTICLE_HEIGHT" AS "ARTICLE_HEIGHT",
        "ITEM_VOLUME_ARTICLE" AS "ITEM_VOLUME_ARTICLE",
        "ITEM_VOLUME_COMBINE" AS "ITEM_VOLUME_COMBINE"
      FROM FINANCIAL_INVENTORY_YP_PREP_JOINED_PREPARED
    ) "DKU__BEFOREGROUPING"
GROUP BY "STORE_NO", "VENDOR_ID", "ARTICLE_NO", "FIN_INV_YEAR_PERIOD";

<br>
--SHRINK_R12_PERIOD_WINDOWS
</br>
CREATE OR  REPLACE TEMPORARY TABLE SHRINK_R12_PERIOD_WINDOWS 
AS
SELECT 
    cast("SKU" as number) as "SKU",
    "Month" AS "MONTH",
    "LAST_R12_PERIOD",
    "YEAR",
    "LAST_R12_YEAR",
    "LAST_R12_YEARPERIOD",
    cast("YEAR_PERIOD" as number) as "YEAR_PERIOD" ,
    "SALES",
    "COST",
    "THEFT",
    "SHRINK",
    "THEFT_PREVIOUS",
    "ACTUAL_THEFT",
    "SHRINK_PREVIOUS",
    "ACTUAL_SHRINK",
    "SALES_AMT",
    SUM("SALES") OVER (PARTITION BY "SKU" ORDER BY "YEAR_PERIOD_PARSED" ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS "SALES_SUM",
    SUM("ACTUAL_SHRINK") OVER (PARTITION BY "SKU" ORDER BY "YEAR_PERIOD_PARSED" ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS "ACTUAL_SHRINK_SUM",
    SUM("SALES_AMT") OVER (PARTITION BY "SKU" ORDER BY "YEAR_PERIOD_PARSED" ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS "SALES_AMT_SUM"
FROM
    (
    SELECT 
        "S_R12_P".*,
        "SFS"."SALES_AMT" AS "SALES_AMT"
    FROM SHRINK_R12_PERIOD "S_R12_P"
    LEFT JOIN SALES_FOR_SHRINK "SFS"
        ON (cast("S_R12_P"."YEAR_PERIOD" as number) = cast("SFS"."YEAR_PERIOD" as number))
        AND (cast("S_R12_P"."SKU" as number) = "SFS"."ARTICLE_NO")
) AS "DKU_BEFORWINDOW";

<br>
--3
</br>

CREATE OR REPLACE TEMP TABLE SHRINK_R12_PERIOD_BY_YEAR_PERIOD_WINDOWS
 AS
 SELECT 
      "YEAR_PERIOD",
      "YEAR_PERIOD_PARSED",
      "ACTUAL_SHRINK" AS "ACTUAL_MONTHLY_SHRINK",
      SUM("ACTUAL_SHRINK") OVER (ORDER BY "YEAR_PERIOD_PARSED" ROWS BETWEEN 11 PRECEDING AND CURRENT ROW ) AS "ACTUAL_R12_MONTH_SHRINK"
  FROM(
      SELECT 
          "YEAR_PERIOD" AS "YEAR_PERIOD",
          "YEAR_PERIOD_PARSED" AS "YEAR_PERIOD_PARSED",
          SUM("ACTUAL_SHRINK")AS "ACTUAL_SHRINK"
      FROM SHRINK_R12_PERIOD
      GROUP BY "YEAR_PERIOD", "YEAR_PERIOD_PARSED" );

<br>
--3
</br>
CREATE OR REPLACE TEMPORARY TABLE SHRINK_R12_RATE AS
SELECT
    *,
     "SHRINK_RATE" * "ACTUAL_MONTHLY_SHRINK" AS "SHRINK_ALLOCATE"
    FROM
    (
      SELECT
      *,
      ROUND("DKU_BEFOR"."ACTUAL_SHRINK_SUM") AS "SHRINK_ROLLING_ROUND",
      ROUND("DKU_BEFOR"."SALES_AMT_SUM") AS "SALES_ROLLING_ROUND",
      CASE WHEN "DKU_BEFOR"."SALES_AMT_SUM" = 0 OR "DKU_BEFOR"."SALES_AMT_SUM" IS NULL THEN 0
           ELSE COALESCE("DKU_BEFOR"."ACTUAL_SHRINK_SUM", 0) / "DKU_BEFOR"."SALES_AMT_SUM"
      END AS "SHRINK_RATE"  
  FROM
     (SELECT 
          "S_R_P_W"."SKU" AS "SKU",
          "S_R_P_W"."MONTH" AS "MONTH",
          "S_R_P_W"."YEAR" AS "YEAR",
          "S_R_P_W"."YEAR_PERIOD" AS "YEAR_PERIOD",
          "S_R_P_W"."SALES" AS "SALES",
          "S_R_P_W"."COST" AS "COST",
          "S_R_P_W"."THEFT" AS "THEFT",
          "S_R_P_W"."SHRINK" AS "SHRINK",
          "S_R_P_W"."THEFT_PREVIOUS" AS "THEFT_PREVIOUS",
          "S_R_P_W"."ACTUAL_THEFT" AS "ACTUAL_THEFT",
          "S_R_P_W"."SHRINK_PREVIOUS" AS "SHRINK_PREVIOUS",
          "S_R_P_W"."ACTUAL_SHRINK" AS "ACTUAL_SHRINK",
          "S_R_P_W"."SALES_AMT" AS "SALES_AMT",
          "S_R_P_W"."SALES_SUM" AS "SALES_SUM",
          "S_R_P_W"."ACTUAL_SHRINK_SUM" AS "ACTUAL_SHRINK_SUM",
          "S_R_P_W"."SALES_AMT_SUM" AS "SALES_AMT_SUM",
          "R12"."ACTUAL_MONTHLY_SHRINK" AS "ACTUAL_MONTHLY_SHRINK",
          "R12"."ACTUAL_R12_MONTH_SHRINK" AS "ACTUAL_R12_MONTH_SHRINK"
      FROM SHRINK_R12_PERIOD_WINDOWS "S_R_P_W"
      LEFT JOIN SHRINK_R12_PERIOD_BY_YEAR_PERIOD_WINDOWS "R12"
      ON "S_R_P_W"."YEAR_PERIOD" = "R12"."YEAR_PERIOD"
  )"DKU_BEFOR"
)"BEFOR_SUM";

<br>
--PURCHASE_ORDER_LINE_COST
</br>
CREATE or replace TEMPORARY TABLE PURCHASE_ORDER_LINE_COST AS
SELECT 
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "ARTICLE_NO" AS "ARTICLE_NO",
    SUM("PO_ORDER_QTY") AS "PO_ORDER_QTY",
    SUM("RECEIPT") AS "PO_RECEIPT"
FROM (
    SELECT 
        "YEAR_PERIOD",
        "ARTICLE_NO",
        "FREIGHT_TYPE_CODE",
        "PO_ORDER_QTY",
        "RECEIPT"
    FROM "PURCHASE_ORDER_LINE_PREPAID"
    WHERE "FREIGHT_TYPE_CODE" = 'FPV'
    ) "DKU__BEFOREGROUPING"
GROUP BY "YEAR_PERIOD", "ARTICLE_NO";

<br>
--A4--DC_3PL_omni_fulfillment_base
</br>
INSERT INTO DC_3PL_omni_fulfillment_base(
	ACCT_YEAR ,
	YEAR_PERIOD ,
	YEAR_WEEK ,
	OMS_ORDER_NO ,
	OMS_ITEM_ID ,
	OMS_ORDER_LINE_KEY ,
	OMS_ITEM_PRIMARY_VENDOR_ID ,
	OMS_ORDER_LINE_SCHEDULE_SHIP_NODE ,
	OMS_SHIP_NODE_DESC ,
	ARTICLE_CAT_FULL ,
	DEMAND_QTY ,
	DEMAND_SALES ,
	BOOKED_SALES_QTY ,
	BOOKED_SALES_AMT ,
	BOOKED_COST_AMT ,
	SHIPPING_REVENUE ,
	SHIPPING_DISC ,
	ACTUAL_SHIPPING_REVENUE ,
	ORDER_LINE_TYPE ,
	SCAC ,
	SHIP_NODE_TYPE )
SELECT 
    ACCT_YEAR,
    YEAR_PERIOD,
    YEAR_WEEK,
    OMS_ORDER_NO,
    OMS_ITEM_ID,
    OMS_ORDER_LINE_KEY,
    OMS_ITEM_PRIMARY_VENDOR_ID,
    OMS_ORDER_LINE_SCHEDULE_SHIP_NODE,
    OMS_SHIP_NODE_DESC,
    ARTICLE_CAT_FULL,
    DEMAND_QTY,
    DEMAND_SALES,
    BOOKED_SALES_QTY,
    BOOKED_SALES_AMT,
    BOOKED_COST_AMT,
    SHIPPING_REVENUE,
    SHIPPING_DISC,
    ACTUAL_SHIPPING_REVENUE,
    ORDER_LINE_TYPE,
    SCAC,
    SHIP_NODE_TYPE
FROM OMNICHANNEL_SALES_STATUS_Prepared
WHERE ACCT_YEAR >= 2020
AND OMS_ORDER_LINE_SCHEDULE_SHIP_NODE IN ('111','114','120' , '398', '399', '498', '499', '597', '771', '400' );

<br>
--A4--TENANT149_DATA_DC_3PL_omni_fulfillment_base_prepared
</br>
CREATE or replace TEMPORARY TABLE TENANT149_DATA_DC_3PL_OMNI_FULFILLMENT_BASE_PREPARED AS
SELECT
    *,
    REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE("OMS_ORDER_LINE_SCHEDULE_SHIP_NODE", '111', '108'), '114', '149'), '120', '168'), '398', '208'), '399', '233'), '498', '188'), '499', '598'), '597', '597'), '771', '141'), '400', '609') AS "STORE_NO",
    'Omni' AS "CHANNEL"
FROM(
    SELECT 
        "OMNI"."ACCT_YEAR" AS "ACCT_YEAR",
        "OMNI"."YEAR_PERIOD" AS "YEAR_PERIOD",
        "OMNI"."YEAR_WEEK" AS "YEAR_WEEK",
        "OMNI"."OMS_ORDER_NO" AS "OMS_ORDER_NO",
        "OMNI"."OMS_ITEM_ID" AS "OMS_ITEM_ID",
        "OMNI"."OMS_ORDER_LINE_KEY" AS "OMS_ORDER_LINE_KEY",
        "OMNI"."OMS_ITEM_PRIMARY_VENDOR_ID" AS "OMS_ITEM_PRIMARY_VENDOR_ID",
        "OMNI"."OMS_ORDER_LINE_SCHEDULE_SHIP_NODE" AS "OMS_ORDER_LINE_SCHEDULE_SHIP_NODE",
        "OMNI"."OMS_SHIP_NODE_DESC" AS "OMS_SHIP_NODE_DESC",
        "OMNI"."ARTICLE_CAT_FULL" AS "ARTICLE_CAT_FULL",
        "OMNI"."DEMAND_QTY" AS "DEMAND_QTY",
        "OMNI"."DEMAND_SALES" AS "DEMAND_SALES",
        "OMNI"."BOOKED_SALES_QTY" AS "BOOKED_SALES_QTY",
        "OMNI"."BOOKED_SALES_AMT" AS "BOOKED_SALES_AMT",
        "OMNI"."BOOKED_COST_AMT" AS "BOOKED_COST_AMT",
        "OMNI"."SHIPPING_REVENUE" AS "SHIPPING_REVENUE",
        "OMNI"."SHIPPING_DISC" AS "SHIPPING_DISC",
        "OMNI"."ACTUAL_SHIPPING_REVENUE" AS "ACTUAL_SHIPPING_REVENUE",
        "OMNI"."ORDER_LINE_TYPE" AS "ORDER_LINE_TYPE",
        "OMNI"."SCAC" AS "SCAC",
        "OMNI"."SHIP_NODE_TYPE" AS "SHIP_NODE_TYPE",
        "TIME_DIMENTION"."MERCH_YEAR" AS "MERCH_YEAR"
    FROM (
        SELECT  *
        FROM  DC_3PL_OMNI_FULFILLMENT_BASE)as "OMNI"
    LEFT JOIN TENANT149_DATA_TIME_DIMENSION_BY_YEAR_PERIOD_PREPARED "TIME_DIMENTION"
    ON "OMNI"."YEAR_PERIOD" = "TIME_DIMENTION"."YEAR_PERIOD"
)AS "DKU";

<br>
--A5--TENANT149_DATA_dc_3pl_PandL_fixed_cost_prepared_joined
--1
</br>
CREATE or replace TEMPORARY TABLE TENANT149_DATA_DC_3PL_PANDL_FIXED_COST_PREPARED_JOINED AS
SELECT 
    "F_C_P"."STORE_NO" AS "STORE_NO",
    "F_C_P"."YEAR_PERIOD" AS "YEAR_PERIOD",
    "F_C_P"."COST_AMT" AS "ALLOCATION_VALUE",
    "Y_P_P"."YEAR_PERIOD" AS "MERCH_YEAR"
FROM (  
    SELECT 
          "COST_CENTER" AS "STORE_NO",
          "YEAR",
          "PERIOD" AS "PERIOD",
          CONCAT("YEAR", LPAD("PERIOD",2,'0')) AS "YEAR_PERIOD",
          "ACTUAL" AS "COST_AMT"
    FROM DC_3PL_PANDL_FIXED_COST_BY_COST_CENTER
  )"F_C_P"
LEFT JOIN TIME_DIMENSION_BY_YEAR_PERIOD "Y_P_P"
ON "F_C_P"."YEAR_PERIOD" = "Y_P_P"."YEAR_PERIOD";

<br>
--A6--TENANT149_DATA_pdq_vf_prep_joined
</br>
CREATE OR REPLACE TEMPORARY TABLE TENANT149_DATA_PDQ_VF_PREP_JOINED 
AS
SELECT 
    "lm_pdq"."LOG_NUMBER" AS "LOG_NUMBER",
    "lm_pdq"."ACCOUNTING_PERIOD_RECEIVED" AS "ACCOUNTING_PERIOD_RECEIVED",
    "lm_pdq"."VENDOR_NO" AS "VENDOR_NO",
    "lm_pdq"."VENDOR_NAME" AS "VENDOR_NAME",
    "lm_pdq"."AMOUNT" AS "AMOUNT",
    "lm_pdq"."PERIOD_SUBMIT_TO_AP" AS "PERIOD_SUBMIT_TO_AP",
    "lm_pdq"."DESCRIPTION" AS "DESCRIPTION",
    "lm_pdq"."PAYMENT_DATE_NOTES" AS "PAYMENT_DATE_NOTES",
    "lm_pdq"."ACCOUNT" AS "ACCOUNT",
    "lm_pdq"."CC" AS "CC",
    "lm_pdq"."DATE_START" AS "DATE_START",
    "lm_pdq"."DATE_END" AS "DATE_END",
    "lm_pdq"."ACCRUED" AS "ACCRUED",
    "lm_pdq"."SUBMITTED" AS "SUBMITTED",
    "lm_pdq"."DATE" AS "DATE",
    "lm_pdq"."DATE_PARSED" AS "DATE_PARSED",
    "lm_pdq"."IN_LEDGER" AS "IN_LEDGER",
    "lm_pdq"."DW_NOTES" AS "DW_NOTES",
    "lm_pdq"."RECEIVED_FROM" AS "RECEIVED_FROM",
    "time_dimention"."MERCH_YEAR" AS "MERCH_YEAR",
    "time_dimention"."YEAR_PERIOD" AS "YEAR_PERIOD"
  FROM (
    SELECT 
        "Log_Number" AS "LOG_NUMBER",
        "Accounting_Period_Received" AS "ACCOUNTING_PERIOD_RECEIVED",
        "Vendor_no" AS "VENDOR_NO",
        "Vendor_Name" AS "VENDOR_NAME",
        "Amount" AS "AMOUNT",
        "Period_Submit_to_AP" AS "PERIOD_SUBMIT_TO_AP",
        "Description" AS "DESCRIPTION",
        "Payment_Date_Notes" AS "PAYMENT_DATE_NOTES",
        "Account" AS "ACCOUNT",
        "CC" AS "CC",
        "Date_Start" AS "DATE_START",
        "Date_End" AS "DATE_END",
        "Accrued" AS "ACCRUED",
        "Submitted" AS "SUBMITTED",
        "date" AS "DATE",
        "date_parsed" AS "DATE_PARSED",
        "In_Ledger" AS "IN_LEDGER",
        "DW_Notes" AS "DW_NOTES",
        "Received_From" AS "RECEIVED_FROM",
        "col_17" AS "COL_17",
        "col_18" AS "COL_18",
        "col_19" AS "COL_19",
        "col_20" AS "COL_20",
        "col_21" AS "COL_21",
        "col_22" AS "COL_22",
        "col_23" AS "COL_23",
        "col_24" AS "COL_24",
        "col_25" AS "COL_25",
        "col_26" AS "COL_26",
        "col_27" AS "COL_27",
        "col_28" AS "COL_28",
        "col_29" AS "COL_29",
        "col_30" AS "COL_30",
        "col_31" AS "COL_31"
    FROM LC_PDQ_VF_PREP
    UNION ALL
    SELECT 
        NULL AS "LOG_NUMBER",
        NULL AS "ACCOUNTING_PERIOD_RECEIVED",
        "VENDOR_NO" AS "VENDOR_NO",
        NULL AS "VENDOR_NAME",
        "AMOUNT" AS "AMOUNT",
        NULL AS "PERIOD_SUBMIT_TO_AP",
        NULL AS "DESCRIPTION",
        NULL AS "PAYMENT_DATE_NOTES",
        NULL AS "ACCOUNT",
        NULL AS "CC",
        NULL AS "DATE_START",
        NULL AS "DATE_END",
        NULL AS "ACCRUED",
        NULL AS "SUBMITTED",
        NULL AS "DATE",
        "DATE_PARSED" AS "DATE_PARSED",
        NULL AS "IN_LEDGER",
        NULL AS "DW_NOTES",
        NULL AS "RECEIVED_FROM",
        NULL AS "COL_17",
        NULL AS "COL_18",
        NULL AS "COL_19",
        NULL AS "COL_20",
        NULL AS "COL_21",
        NULL AS "COL_22",
        NULL AS "COL_23",
        NULL AS "COL_24",
        NULL AS "COL_25",
        NULL AS "COL_26",
        NULL AS "COL_27",
        NULL AS "COL_28",
        NULL AS "COL_29",
        NULL AS "COL_30",
        NULL AS "COL_31"
    FROM lm_pdq_prep
  )"lm_pdq"
LEFT JOIN TIME_DIMENSION_PREPARED "time_dimention"
ON  CAST("lm_pdq"."DATE_PARSED" AS DATE) = CAST("time_dimention"."DATE" AS DATE);

<br>
--A7--TENANT149_DATA_price_cuts_2021_2020_prepared_by_Year_Week_joined
</br>
CREATE OR REPLACE TEMPORARY TABLE TENANT149_DATA_price_cuts_2021_2020_prepared_by_Year_Week_joined 
AS
SELECT 
    cast("P_B_Y_W"."YEAR_WEEK" as number) AS "YEAR_WEEK",
    cast("P_B_Y_W"."ARTICLE_NUMBER" as number) AS "ARTICLE_NUMBER",
    cast("P_B_Y_W"."VENDOR_ID" as number) AS "VENDOR_ID",
    "P_B_Y_W"."TOTAL_SCAN_DOWN" AS "TOTAL_SCAN_DOWN",
    cast("C_B_P_W"."MERCH_YEAR" as number) AS "MERCH_YEAR",
    cast("C_B_P_W"."YEAR_QUARTER" as number) AS "YEAR_QUARTER",
    cast("C_B_P_W"."YEAR_PERIOD" as number) AS "YEAR_PERIOD"
FROM (
    SELECT 
        "YEAR_WEEK" AS "YEAR_WEEK",
        "ARTICLE_NUMBER" AS "ARTICLE_NUMBER",
        "VENDOR_ID" AS "VENDOR_ID",
         SUM("TOTAL_SCAN_DOWN") AS "TOTAL_SCAN_DOWN"
    FROM 
        (
        SELECT 
            "YEAR_WEEK" AS "YEAR_WEEK",
            "DIST_CHANNEL_CODE" AS "DIST_CHANNEL_CODE",
            "DIST_CHANNEL_DESC" AS "DIST_CHANNEL_DESC",
            "ARTICLE_NUMBER" AS "ARTICLE_NUMBER",
            "ARTICLE_DESCRIPTION" AS "ARTICLE_DESCRIPTION",
            "CATEGORY_FULL" AS "CATEGORY_FULL",
            "CATEGORY_NO" AS "CATEGORY_NO",
            "DEPT_NO" AS "DEPT_NO",
            "DEPT_FULL" AS "DEPT_FULL",
            "LOB_NO" AS "LOB_NO",
            "LOB_FULL" AS "LOB_FULL",
            "BUYER" AS "BUYER",
            "BUYER_FULL" AS "BUYER_FULL",
            "SALES_UNITS" AS "SALES_UNITS",
            "SALES_DOL" AS "SALES_DOL",
            "COST_DOL" AS "COST_DOL",
            "GM_DOL" AS "GM_DOL",
            "FACT_VENDOR_ID" AS "FACT_VENDOR_ID",
            "FACT_VENDOR_NAME" AS "FACT_VENDOR_NAME",
            "FACT_PARENT_VENDOR_ID" AS "FACT_PARENT_VENDOR_ID",
            "VENDOR_ID" AS "VENDOR_ID",
            "SCAN_DOWN" AS "SCAN_DOWN",
            TRY_TO_NUMBER("TOTAL_SCAN_DOWN") AS "TOTAL_SCAN_DOWN",
            "TOTAL_GM_W_SCAN_DOWN" AS "TOTAL_GM_W_SCAN_DOWN",
            "IN_STORE_FLYER_Y_N" AS "IN_STORE_FLYER_Y_N",
            "IMPORT_DOMESTIC" AS "IMPORT_DOMESTIC",
            "FLAT_FUNDING" AS "FLAT_FUNDING",
            "EXCLUDED" AS "EXCLUDED"
        FROM PRICE_CUTS_2021_2020_PREPARED
        UNION ALL
        SELECT 
            "YEAR_WEEK" AS "YEAR_WEEK",
            NULL AS "DIST_CHANNEL_CODE",
            NULL AS "DIST_CHANNEL_DESC",
            "SKU" AS "ARTICLE_NUMBER",
            NULL AS "ARTICLE_DESCRIPTION",
            NULL AS "CATEGORY_FULL",
            NULL AS "CATEGORY_NO",
            NULL AS "DEPT_NO",
            NULL AS "DEPT_FULL",
            NULL AS "LOB_NO",
            NULL AS "LOB_FULL",
            NULL AS "BUYER",
            NULL AS "BUYER_FULL",
            NULL AS "SALES_UNITS",
            NULL AS "SALES_DOL",
            NULL AS "COST_DOL",
            NULL AS "GM_DOL",
            NULL AS "FACT_VENDOR_ID",
            NULL AS "FACT_VENDOR_NAME",
            NULL AS "FACT_PARENT_VENDOR_ID",
            "VENDOR_ID" AS "VENDOR_ID",
            NULL AS "SCAN_DOWN",
            "PRICE_CUT_AMOUNT" AS "TOTAL_SCAN_DOWN",
            NULL AS "TOTAL_GM_W_SCAN_DOWN",
            NULL AS "IN_STORE_FLYER_Y_N",
            NULL AS "IMPORT_DOMESTIC",
            NULL AS "FLAT_FUNDING",
            NULL AS "EXCLUDED"
        FROM
         (
            SELECT 
                "CUTS_0822"."VENDOR_ID" AS "VENDOR_ID",
                "CUTS_0822"."SKU" AS "SKU",
                "CUTS_0822"."PRICE_CUT_AMOUNT" AS "PRICE_CUT_AMOUNT",
                "DIM_PRE"."YEAR_WEEK" AS "YEAR_WEEK"
            FROM LM_PRICE_CUTS_0822_PREPARED "CUTS_0822"
            LEFT JOIN TIME_DIMENSION_PREPARED "DIM_PRE"
                ON "CUTS_0822"."TIME_DMKEY" = "DIM_PRE"."TIME_DIM_KEY"
            UNION ALL
            SELECT 
                "STAC_PRE"."VENDOR_ID" AS "VENDOR_ID",
                "STAC_PRE"."SKU" AS "SKU",
                "STAC_PRE"."PRICE_CUT_AMOUNT" AS "PRICE_CUT_AMOUNT",
                "DIM_PRE"."YEAR_WEEK" AS "YEAR_WEEK"
            FROM LM_PRICECYTS_202211_SF_STACKED_PREPARED "STAC_PRE"
            LEFT JOIN TIME_DIMENSION_PREPARED "DIM_PRE"
           ON CAST("STAC_PRE"."SALES_DATE_PARSED" AS DATE) = CAST("DIM_PRE"."CAL_DATE" AS DATE)
         )DKU
     )BEFOR_GRP
    GROUP BY "YEAR_WEEK", "ARTICLE_NUMBER", "VENDOR_ID"
  ) "P_B_Y_W"
LEFT JOIN CAL_BY_PERIOD_WEEK "C_B_P_W"
ON "P_B_Y_W"."YEAR_WEEK" = "C_B_P_W"."YEAR_WEEK";


<br>
--A9--UNSELLABLES_AND_MISC_PREP_JOINED_PREPARED
</br>
INSERT INTO  UNSELLABLES_AND_MISC_PREP_JOINED_PREPARED 
SELECT 
    "UMP"."Article" as "ARTICLE",
    "UMP"."Article_Description" as "ARTICLE_DESCRIPTION",
    "UMP"."User_name" as "USER_NAME",
    "UMP"."Movement_type" as "MOVEMENT_TYPE",
    "UMP"."Posting_date" as "POSTING_DATE",
    "UMP"."POSTING_DATE_PARSED" as "POSTING_DATE_PARSED",
    "UMP"."Quantity" as "QUANTITY",
    "UMP"."BUOM" as "BUOM",
    "UMP"."Amount_in_LC" as "AMOUNT_IN_LC",
    "UMP"."Currency" as "CURRENCY",
    "UMP"."Site" as "SITE",
    "UMP"."Reference" as "REFERENCE",
    "UMP"."RECEIVING_ISSUINGSITE" as "RECEIVING_ISSUINGSITE",
    "UMP"."Entry_Date" as "ENTRY_DATE",
    "UMP"."Storage_Location" as "STORAGE_LOCATION",
    "UMP"."Purchase_order" as "PURCHASE_ORDER",
    "UMP"."Vendor" as "VENDOR",
    "UMP"."Debit_Credit_Indicator" as "DEBIT_CREDIT_INDICATOR",
    "MCP"."INCREASE_DECREASE" as "INCREASE_DECREASE",
    "MCP"."MULTIPLIER" as "MULTIPLIER",
    "TDP"."MERCH_YEAR" AS "CAL_MERCH_YEAR",
    "TDP"."YEAR_WEEK" AS "CAL_YEAR_WEEK",
    "TDP"."YEAR_QUARTER" AS "CAL_YEAR_QUARTER",
    "TDP"."YEAR_PERIOD" AS "CAL_YEAR_PERIOD",
    COALESCE("UMP"."Amount_in_LC", 0) * "MCP"."MULTIPLIER" AS "ALLOCATION_VALUE"
FROM 
   (
   SELECT 
     *,
     CONCAT(left(CAST("Posting_date" as VARCHAR),4), '-', SUBSTRING(CAST("Posting_date" as VARCHAR),5,2), '-', SUBSTRING(CAST("Posting_date" as VARCHAR),7,2) ) AS 
     "POSTING_DATE_PARSED"
   FROM  Unsellables_and_Misc_stacked
   )"UMP"
LEFT JOIN 
    "MOVEMENT_CODES_PREPARED_STG" "MCP"
    ON CAST("UMP"."Movement_type" AS NUMBER) = CAST("MCP"."MOVEMENT_CODES" AS NUMBER)
LEFT JOIN 
    TENANT149_DATA_TIME_DIMENSION_PREPARED "TDP"
    ON "UMP"."POSTING_DATE_PARSED" = "TDP"."DATE"
WHERE CAST("UMP"."Movement_type"  AS NUMBER) IN (977, 877, 983, 883, 978, 878) ;


<br>
--2
</br>
CREATE or replace TEMPORARY TABLE UNSELLABLES_SKRINK_RATE AS
SELECT 
      *,
      CASE
          WHEN "SALES_AMT" = 0 OR "SALES_AMT" IS NULL THEN 0
          ELSE COALESCE("ALLOCATION_VALUE", 0) / COALESCE("SALES_AMT", 0)
      END AS "SHRINK_RATE"
  FROM
  (
      SELECT 
          "P_B_A"."ARTICLE" AS "ARTICLE",
          "P_B_A"."CAL_MERCH_YEAR" AS "CAL_MERCH_YEAR",
          "P_B_A"."CAL_YEAR_PERIOD" AS "CAL_YEAR_PERIOD",
          "P_B_A"."ALLOCATION_VALUE" AS "ALLOCATION_VALUE",
          "S_F_S"."SALES_AMT" AS "SALES_AMT"
      FROM (
          SELECT 
              "ARTICLE",
              "CAL_MERCH_YEAR",
              "CAL_YEAR_PERIOD",
              SUM("ALLOCATION_VALUE") AS "ALLOCATION_VALUE"
          FROM UNSELLABLES_AND_MISC_PREP_JOINED_PREPARED
          GROUP BY "ARTICLE", "CAL_MERCH_YEAR", "CAL_YEAR_PERIOD"
      ) "P_B_A"
      LEFT JOIN SALES_FOR_SHRINK "S_F_S"
      ON ("P_B_A"."ARTICLE" = "S_F_S"."ARTICLE_NO")
      AND ("P_B_A"."CAL_YEAR_PERIOD" = "S_F_S"."YEAR_PERIOD")
  )DKU;

<br>
--PURCHASE_ORDER_LINE_TEST
</br>

CREATE OR REPLACE TEMP TABLE PURCHASE_ORDER_LINE_TEST AS
WITH CTE AS 
(

                SELECT 
                     "CO_CODE",
                     "cal_YEAR_PERIOD",    
                     "cal_MERCH_YEAR",
                    "VENDOR_ID",
                    "PO_LINE_ORDER_QTY",
                    "PO_LINE_UNIT_PRICE",
                    "po_date_parsed",
                    "deliv_date_parsed" AS "DELIV_DATE_PARSED"
                  FROM PURCHASE_ORDER_LINE_W_CAL   WHERE "cal_MERCH_YEAR" >= 2021 AND ("CO_CODE" = 'TSC') 
)

   SELECT 
             "cal_YEAR_PERIOD" AS "cal_YEAR_PERIOD",
             "cal_MERCH_YEAR" AS "cal_MERCH_YEAR",
             "VENDOR_ID" AS "VENDOR_ID",
             SUM("receipt") AS "receipt_sum"
    FROM
    (
    SELECT *,
           COALESCE("PO_LINE_ORDER_QTY", 0) * COALESCE("PO_LINE_UNIT_PRICE", 0) AS "receipt"
    FROM CTE
    ) GROUP BY "cal_YEAR_PERIOD", "cal_MERCH_YEAR", "VENDOR_ID";

<br>
--TENANT149_DATA_VOLUMNE_REBATE_2021_V2_PREPARED_BY_VENDOR__JOINED_BY_VENDOR__JOINED_PREPARED
</br>
CREATE or replace TEMPORARY TABLE TENANT149_DATA_VOLUMNE_REBATE_2021_V2_PREPARED_BY_VENDOR__JOINED_BY_VENDOR__JOINED_PREPARED AS
SELECT 
    *,
    CASE
        WHEN COALESCE(RECEIPT_SUM_SUM, '0') = '0' THEN '0'
        ELSE COALESCE(FULL_YEAR_EARNED_REBATES_SUM_SUM, '0') / COALESCE(RECEIPT_SUM_SUM, '0')
    END AS AVG_RATE
FROM
    (
    SELECT 
        J_B_V.PARENT_VENDOR_ID AS PARENT_VENDOR_ID,
        J_B_V.MERCH_YEAR AS MERCH_YEAR,
        J_B_V.FULL_YEAR_EARNED_REBATES_SUM_SUM AS FULL_YEAR_EARNED_REBATES_SUM_SUM,
        V_ID.RECEIPT_SUM_SUM AS RECEIPT_SUM_SUM
    FROM (
        SELECT 
            PARENT_VENDOR_ID AS PARENT_VENDOR_ID,
            MERCH_YEAR AS MERCH_YEAR,
            SUM(FULL_YEAR_EARNED_REBATES_SUM) AS FULL_YEAR_EARNED_REBATES_SUM_SUM,
            COUNT(*) AS COUNT
        FROM (
            SELECT 
                B_V.VENDOR_ID AS VENDOR_ID,
                B_V.MERCH_YEAR AS MERCH_YEAR,
                B_V.FULL_YEAR_EARNED_REBATES_SUM AS FULL_YEAR_EARNED_REBATES_SUM,
                V_P.PARENT_VENDOR_ID AS PARENT_VENDOR_ID
            FROM (
                SELECT 
                    "Vendor #" AS VENDOR_ID,
                    "Merch_Year" AS MERCH_YEAR,
                    SUM("Full Year Earned Rebates") AS FULL_YEAR_EARNED_REBATES_SUM  
                FROM VOLUME_REBATE_FULL_YEAR_STACKED
                WHERE VENDOR_ID IS NOT NULL
                GROUP BY VENDOR_ID, MERCH_YEAR
                ) B_V
            LEFT JOIN COMPANY_PARENT_VENDOR_PREPARED V_P
            ON cast(B_V.VENDOR_ID as number) = V_P.VENDOR_ID   
            ) BEFOR_GRP
        GROUP BY PARENT_VENDOR_ID, MERCH_YEAR
        ) J_B_V
    LEFT JOIN (
        SELECT 
            PARENT_VENDOR_ID AS PARENT_VENDOR_ID,
            CAL_MERCH_YEAR AS CAL_MERCH_YEAR,
            SUM(RECEIPT_SUM) AS RECEIPT_SUM_SUM,
            COUNT(*) AS COUNT
        FROM (
            SELECT 
                M_Y.CAL_MERCH_YEAR AS CAL_MERCH_YEAR,
                M_Y.VENDOR_ID AS VENDOR_ID,
                M_Y.RECEIPT_SUM AS RECEIPT_SUM,
                V_P.PARENT_VENDOR_ID AS PARENT_VENDOR_ID
            FROM (   
                SELECT 
                    "cal_MERCH_YEAR" AS CAL_MERCH_YEAR,
                    VENDOR_ID AS VENDOR_ID,
                    SUM("receipt_sum") AS RECEIPT_SUM
                FROM PURCHASE_ORDER_LINE_TEST
                GROUP BY CAL_MERCH_YEAR, VENDOR_ID
                ) M_Y
            LEFT JOIN COMPANY_PARENT_VENDOR_PREPARED V_P
            ON cast(M_Y.VENDOR_ID as number)= V_P.VENDOR_ID
            ) DKU_BG
        GROUP BY PARENT_VENDOR_ID, CAL_MERCH_YEAR
        ) V_ID
    ON (J_B_V.PARENT_VENDOR_ID = V_ID.PARENT_VENDOR_ID)
    AND (J_B_V.MERCH_YEAR = V_ID.CAL_MERCH_YEAR)
    ) BEFOR_FILTTER;

<br>
--TENANT149_DATA_volumne_rebate_2021_v2_prepared_by_Vendor__joined_by_Vendor__joined_prepared
</br> 
create or replace temp table TENANT149_DATA_volumne_rebate_2021_v2_prepared_by_Vendor__joined_by_Vendor__joined_prepared as
SELECT 
    "volum"."PARENT_VENDOR_ID" AS "PARENT_VENDOR_ID",
    "volum"."Merch_Year" AS "Merch_Year",
    "volum"."Full Year Earned Rebates_sum_sum" AS "Full Year Earned Rebates_sum_sum",
    "purchase"."receipt_sum_sum" AS "receipt_sum_sum"
  FROM (        
        SELECT 
            "PARENT_VENDOR_ID" AS "PARENT_VENDOR_ID",
            "Merch_Year" AS "Merch_Year",
            SUM("Full Year Earned Rebates_sum") AS "Full Year Earned Rebates_sum_sum",
            COUNT(*) AS "count"
        FROM (
            SELECT 
                "Vendor #" AS "Vendor #",
                "Merch_Year" AS "Merch_Year",
                "Full Year Earned Rebates_sum" AS "Full Year Earned Rebates_sum",
                "PARENT_VENDOR_ID" AS "PARENT_VENDOR_ID"
            FROM (   
                    SELECT 
                        "TENANT149_DATA_volumne_rebate_2021_v2_prepared_by_Vendor_"."Vendor #" AS "Vendor #",
                        "TENANT149_DATA_volumne_rebate_2021_v2_prepared_by_Vendor_"."Merch_Year" AS "Merch_Year",
                        "TENANT149_DATA_volumne_rebate_2021_v2_prepared_by_Vendor_"."Full Year Earned Rebates_sum" AS "Full Year Earned Rebates_sum",
                        "company_parent_vendor_prepared"."PARENT_VENDOR_ID" AS "PARENT_VENDOR_ID"
                    FROM (
                        SELECT *
                    FROM (
                        SELECT 
                            "Vendor #" AS "Vendor #",
                            "Merch_Year" AS "Merch_Year",
                            SUM("Full Year Earned Rebates") AS "Full Year Earned Rebates_sum"
                        FROM (
                            SELECT 
                                "Vendor #" AS "Vendor #",
                                "Full Year Earned Rebates" AS "Full Year Earned Rebates",
                                "Merch_Year" AS "Merch_Year"
                            FROM VOLUME_REBATE_FULL_YEAR_STACKED
                            ) "dku__beforegrouping"
                        GROUP BY "Vendor #", "Merch_Year"
                        ) "unfiltered_query"
                    WHERE "Vendor #" IS NOT NULL) "TENANT149_DATA_volumne_rebate_2021_v2_prepared_by_Vendor_"
                    LEFT JOIN COMPANY_PARENT_VENDOR_PREPARED "company_parent_vendor_prepared"
                        ON cast("TENANT149_DATA_volumne_rebate_2021_v2_prepared_by_Vendor_"."Vendor #" as number) = "company_parent_vendor_prepared"."VENDOR_ID"
                        )dku
                        ) "dku__beforegrouping"
                    GROUP BY "PARENT_VENDOR_ID", "Merch_Year") "volum"
LEFT JOIN (   
        SELECT 
            "PARENT_VENDOR_ID" AS "PARENT_VENDOR_ID",
            "cal_MERCH_YEAR" AS "cal_MERCH_YEAR",
            SUM("receipt_sum") AS "receipt_sum_sum",
            COUNT(*) AS "count"
        FROM (
            SELECT 
                "cal_MERCH_YEAR" AS "cal_MERCH_YEAR",
                "VENDOR_ID" AS "VENDOR_ID",
                "receipt_sum" AS "receipt_sum",
                "PARENT_VENDOR_ID" AS "PARENT_VENDOR_ID"
            FROM (
                SELECT 
                    "TENANT149_purchase_order_line_test_by_cal_MERCH_YEAR"."cal_MERCH_YEAR" AS "cal_MERCH_YEAR",
                    "TENANT149_purchase_order_line_test_by_cal_MERCH_YEAR"."VENDOR_ID" AS "VENDOR_ID",
                    "TENANT149_purchase_order_line_test_by_cal_MERCH_YEAR"."receipt_sum" AS "receipt_sum",
                    "company_parent_vendor_prepared"."PARENT_VENDOR_ID" AS "PARENT_VENDOR_ID"
                FROM (
                    SELECT 
                        "cal_MERCH_YEAR" AS "cal_MERCH_YEAR",
                        "VENDOR_ID" AS "VENDOR_ID",
                        SUM("receipt_sum") AS "receipt_sum"
                    FROM PURCHASE_ORDER_LINE_TEST
                    GROUP BY "cal_MERCH_YEAR", "VENDOR_ID" 
                ) "TENANT149_purchase_order_line_test_by_cal_MERCH_YEAR"
                LEFT JOIN COMPANY_PARENT_VENDOR_PREPARED "company_parent_vendor_prepared"
                    ON cast("TENANT149_purchase_order_line_test_by_cal_MERCH_YEAR"."VENDOR_ID" as number) = "company_parent_vendor_prepared"."VENDOR_ID"
            )dku
            ) "dku__beforegrouping"
        GROUP BY "PARENT_VENDOR_ID", "cal_MERCH_YEAR") "purchase"
ON ("volum"."PARENT_VENDOR_ID" = "purchase"."PARENT_VENDOR_ID")
AND ("volum"."Merch_Year" = "purchase"."cal_MERCH_YEAR")

<br>
--TENANT149_DATA_VOLUME_REBATE_2021_V2_PREPARED_BY_VENDOR_JOINED_BY_VENDOR_JOINED_PREPARED
</br> 
insert into TENANT149_DATA_VOLUME_REBATE_2021_V2_PREPARED_BY_VENDOR_JOINED_BY_VENDOR_JOINED_PREPARED
select 
    "PARENT_VENDOR_ID" as PARENT_VENDOR_ID,
    "Merch_Year" as MERCH_YEAR,
    "Full Year Earned Rebates_sum_sum" as FULL_YEAR_EARNED_REBATES_SUM_SUM,
    "receipt_sum_sum" as RECEIPT_SUM_SUM,
    case 
         when coalesce(receipt_sum_sum,0) = 0 then 0 
         else coalesce("Full Year Earned Rebates_sum_sum",0)/coalesce(receipt_sum_sum,0)
    end as AVG_RATE
FROM TENANT149_DATA_volumne_rebate_2021_v2_prepared_by_Vendor__joined_by_Vendor__joined_prepared

<br>
--2
</br>
CREATE or replace TEMPORARY TABLE TENANT149_PURCHASE_ORDER_LINE_TEST_JOINED_JOINED_TEST AS
SELECT 
    CAL_YEAR_PERIOD AS CAL_YEAR_PERIOD,
    CAL_MERCH_YEAR AS CAL_MERCH_YEAR,
    VENDOR_ID AS VENDOR_ID,
    RECEIPT_SUM AS RECEIPT_SUM,
    PARENT_VENDOR_ID AS PARENT_VENDOR_ID,
    TOTAL_REBATES_EARNED AS TOTAL_REBATES_EARNED,
    TOTAL_RECEIPTS AS TOTAL_RECEIPTS,
    AVG_RATE AS AVG_RATE,
    COALESCE(RECEIPT_SUM, '0') * COALESCE(AVG_RATE, '0') AS CALCULATED_REBATE
FROM (
    SELECT 
        V_R_J.CAL_YEAR_PERIOD AS CAL_YEAR_PERIOD,
        V_R_J.CAL_MERCH_YEAR AS CAL_MERCH_YEAR,
        V_R_J.VENDOR_ID AS VENDOR_ID,
        V_R_J.RECEIPT_SUM AS RECEIPT_SUM,
        V_R_J.PARENT_VENDOR_ID AS PARENT_VENDOR_ID,
        V_J_P.FULL_YEAR_EARNED_REBATES_SUM_SUM AS TOTAL_REBATES_EARNED,
        V_J_P.RECEIPT_SUM_SUM AS TOTAL_RECEIPTS,
        V_J_P.AVG_RATE AS AVG_RATE
    FROM (
        SELECT 
            V_R."cal_YEAR_PERIOD" AS CAL_YEAR_PERIOD,
            V_R."cal_MERCH_YEAR" AS CAL_MERCH_YEAR,
            V_R."VENDOR_ID" AS VENDOR_ID,
            V_R."receipt_sum" AS RECEIPT_SUM,
            V_P.PARENT_VENDOR_ID AS PARENT_VENDOR_ID
        FROM  RECEIPTS_FOR_VOLUME_REBATE V_R
        LEFT JOIN COMPANY_PARENT_VENDOR_PREPARED V_P
        ON cast(V_R.VENDOR_ID as number) = V_P.VENDOR_ID
        ) V_R_J
    LEFT JOIN (
        SELECT 
            PARENT_VENDOR_ID AS PARENT_VENDOR_ID,
            MERCH_YEAR AS MERCH_YEAR,
            FULL_YEAR_EARNED_REBATES_SUM_SUM AS FULL_YEAR_EARNED_REBATES_SUM_SUM,
            RECEIPT_SUM_SUM AS RECEIPT_SUM_SUM,
            AVG_RATE AS AVG_RATE,
            MERCH_YEAR + 1 AS MERCH_YEAR_RATE
        FROM TENANT149_DATA_VOLUME_REBATE_2021_V2_PREPARED_BY_VENDOR_JOINED_BY_VENDOR_JOINED_PREPARED 
        ) V_J_P
    ON (V_R_J.PARENT_VENDOR_ID = V_J_P.PARENT_VENDOR_ID)
    AND (V_R_J.CAL_MERCH_YEAR = V_J_P.MERCH_YEAR_RATE)
) WITHOUTCOMPUTEDCOLS_QUERY;

<br>
--3
</br>
CREATE or replace TEMPORARY TABLE VOLUME_REBATE_NEW AS
SELECT 
    "CAL_YEAR_PERIOD" AS "YEAR_PERIOD",
    "CAL_MERCH_YEAR" AS "MERCH_YEAR",
    "VENDOR_ID" AS "VENDOR_ID",
    SUM("CALCULATED_REBATE") AS "ALLOCATION_VALUE"
FROM "TENANT149_PURCHASE_ORDER_LINE_TEST_JOINED_JOINED_TEST"
GROUP BY "CAL_YEAR_PERIOD", "CAL_MERCH_YEAR", "VENDOR_ID";

<br>

-------------------------------------------dnp query--------------------------------------------------

--Lava's 

--OMNI_MASTER_SALES_FINAL
</br>
INSERT INTO OMNI_MASTER_SALES_FINAL
SELECT     oc.acct_year,
          oc.year_period,
          oc.year_week,
          oc.oms_order_no,
          oc.article_no,
          oc.oms_order_line_key,
          oc.vendor_id,
          oc.oms_order_line_schedule_ship_node,
          oc.oms_ship_node_desc,
          oc.article_cat_full,
          oc.demand_qty,
          oc.demand_sales,
          oc.booked_sales_qty,
          oc.booked_sales_amt,
          oc.booked_cost_amt,
          oc.shipping_revenue,
          oc.shipping_disc,
          oc.actual_shipping_revenue,
          oc.order_line_type,
          oc.scac,
          oc.ship_node_type,
          oc.merch_year,
          oc.year_quarter,
          oc.chain_prod,
          oc.article_desc,
          oc.article_full,
          oc.article_type_name,
          oc.article_type_code,
          oc.article_type_full,
          oc.article_length,
          oc.article_width,
          oc.article_height,
          oc.article_weight,
          oc.total_weight ,
          oc.article_size,
          oc.article_count,
          oc.article_color,
          oc.parent_article_no,
          oc.parent_article_desc,
          oc.parent_article_full,
          oc.primary_vendor_id,
          oc.article_cat_code,
          oc.article_cat_name,
          oc.dept_code,
          oc.dept_name,
          oc.dept_full,
          oc.lob_no,
          oc.lob_desc,
          oc.lob_full,
          oc.maj_dept_no,
          oc.maj_dept_desc,
          oc.maj_dept_full,
          oc.brand_name,
          oc.pvt_label_desc,
          oc.vendor_name,
          oc.vendor_full,
          oc.parent_vendor_id,
          oc.omni_small_package_flag,
          oc.tsc_delivery_flag,
          oc.roadie_flag,
          oc.sales_allocate,
          oc.cost_allocate,
          oc.multi_salvage_flag,
          omnikeyline.omni_small_package_flag as sm_omni_small_package_flag,
          omniorderkey.roadie_flag                                  AS rd_roadie_flag,
         CASE WHEN (oc.omni_small_package_flag = 1) AND (omnikeyline.omni_small_package_flag != 1 OR omnikeyline.omni_small_package_flag IS NULL AND                         1 IS NOT NULL OR omnikeyline.omni_small_package_flag IS NOT NULL AND 1 IS NULL) THEN 1 ELSE 0 END AS omni_small_dropout_flag,
         CASE WHEN (oc.roadie_flag = 1) AND (omniorderkey.roadie_flag  != 1 OR omniorderkey.roadie_flag  IS NULL AND 1 IS NOT NULL OR                                         omniorderkey.roadie_flag  IS NOT NULL AND 1 IS NULL) THEN 1 ELSE 0 END AS roadie_dropout_flag
FROM ( SELECT           acct_year,
                        year_period,
                        year_week,
                        oms_order_no,
                        oms_item_id AS article_no,
                        oms_order_line_key,
                        vendor_id,
                        oms_order_line_schedule_ship_node,
                        oms_ship_node_desc,
                        article_cat_full,
                        demand_qty,
                        demand_sales,
                        booked_sales_qty,
                        booked_sales_amt,
                        booked_cost_amt,
                        shipping_revenue,
                        shipping_disc,
                        actual_shipping_revenue,
                        order_line_type,
                        scac,
                        ship_node_type,
                        merch_year,
                        year_quarter,
                        chain_prod,
                        article_desc,
                        article_full,
                        article_type_name,
                        article_type_code,
                        article_type_full,
                        article_length,
                        article_width,
                        article_height,
                        article_weight,
                        article_size,
                        article_count,
                        article_color,
                        parent_article_no,
                        parent_article_desc,
                        parent_article_full,
                        primary_vendor_id,
                        article_cat_code,
                        article_cat_name,
                        dept_code,
                        dept_name,
                        dept_full,
                        lob_no,
                        lob_desc,
                        lob_full,
                        maj_dept_no,
                        maj_dept_desc,
                        maj_dept_full,
                        brand_name,
                        pvt_label_desc,
                        vendor_name,
                        vendor_full,
                        parent_vendor_id,
                        omni_small_package_flag,
                        tsc_delivery_flag,
                        roadie_flag,
                        Round(booked_sales_amt,0)                                   AS sales_allocate,
                        Round(booked_cost_amt,0)                                    AS cost_allocate,
                        COALESCE(article_weight, 0) * COALESCE(booked_sales_qty, 0) AS total_weight,
                        CASE
                               WHEN (
                                             order_line_type= 'BODFS')
                               OR     (
                                             order_line_type = 'BOPIS') THEN 0
                               ELSE 1
                        END AS multi_salvage_flag
                 FROM   OMNICHANNEL_SALES ) oc
LEFT JOIN
          (
                    SELECT     ofrsmwi.order_line_key,
                              1 AS omni_small_package_flag
                    FROM      OMNI_FREIGHT_DETAIL_SMALL_LTL_WINDOWS_PREPARED ofrsmwi
                    LEFT JOIN TIME_DIMENSION_PREPARED tidim
                    ON        ofrsmwi.order_date = tidim.date
                    GROUP BY  ofrsmwi.order_line_key ) omnikeyline
ON        oc.oms_order_line_key=omnikeyline.order_line_key
AND       oc.omni_small_package_flag =omnikeyline.omni_small_package_flag
LEFT JOIN
          (
                   SELECT   order_line_key AS oms_order_line_key,
                            1              AS roadie_flag
                   FROM     FREIGHT_DETAIL_ROADIE_WINDOWS_JOINED_PREPARED
                   GROUP BY order_line_key ) omniorderkey
ON        oc.oms_order_line_key =omniorderkey.oms_order_line_key
AND       oc.roadie_flag=omniorderkey.roadie_flag
where oc.acct_year>=2020;

<br>
--ROADIE_DROPOUT_FINAL
</br>  
INSERT INTO  "ROADIE_DROPOUT_FINAL"
SELECT 
    "MERCH_YEAR" AS "MERCH_YEAR",
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "roadie_dropout_flag" AS "roadie_dropout_flag",
    "Roadie_Total_Cost_sum" AS "allocation_value"
  FROM (
    SELECT 
        "MERCH_YEAR" AS "MERCH_YEAR",
        "YEAR_PERIOD" AS "YEAR_PERIOD",
        "roadie_dropout_flag" AS "roadie_dropout_flag",
        SUM("Roadie_Total_Cost") AS "Roadie_Total_Cost_sum"
      FROM (
        SELECT 
       
            "Roadie_Total_Cost" AS "Roadie_Total_Cost",
            "MERCH_YEAR" AS "MERCH_YEAR",
            "YEAR_PERIOD" AS "YEAR_PERIOD",
            1 AS "roadie_dropout_flag"
          FROM (
            SELECT 
                 "ROADIE"."Delivery_Date" AS "Delivery_Date",
                 "ROADIE"."Delivery_Date_parsed" AS "Delivery_Date_parsed",
                 "ROADIE"."Pick_up_Store_Number" AS "Pick_up_Store_Number",
                 "ROADIE"."Tracking_Number" AS "Tracking_Number",
                 "ROADIE"."TSC_Order_Number" AS "TSC_Order_Number",
                 "ROADIE"."Customer_Name" AS "Customer_Name",
                 "ROADIE"."SKU" AS "SKU",
                 "ROADIE"."SKU_Description" AS "SKU_Description",
                 "ROADIE"."Ship_to_Zip_Code" AS "Ship_to_Zip_Code",
                 "ROADIE"."Service_Level" AS "Service_Level",
                 "ROADIE"."Distance_Shipped" AS "Distance_Shipped",
                 "ROADIE"."Roadie_Total_Cost" AS "Roadie_Total_Cost",
                 "ROADIE"."Store_Charge_to_customer" AS "Store_Charge_to_customer",
                 "ROADIE"."Store_CostCharge_to_Store" AS "Store_CostCharge_to_Store",
                 "ROADIE"."SSC_Subsidized" AS "SSC_Subsidized",
                 "ROADIE"."TRACKING_NO" AS "TRACKING_NO",
                 "TIME"."MERCH_YEAR" AS "MERCH_YEAR",
                 "TIME"."YEAR_PERIOD" AS "YEAR_PERIOD"
            FROM ( SELECT 
                "Delivery_Date",
                "Delivery_Date_parsed",
                "Pick_up_Store_Number" AS "Pick_up_Store_Number",
                "Tracking_Number" AS "Tracking_Number",
                "TSC_Order_Number" AS "TSC_Order_Number",
                "Customer_Name" AS "Customer_Name",
                "SKU" AS "SKU",
                "SKU_Description" AS "SKU_Description",
                "Ship_to_Zip_Code" AS "Ship_to_Zip_Code",
                "Service_Level" AS "Service_Level",
                "Distance_Shipped" AS "Distance_Shipped",
                TRY_TO_NUMBER("Roadie_Total_Cost") AS "Roadie_Total_Cost",
                "Store_Charge_to_customer" AS "Store_Charge_to_customer",
                "Store_CostCharge_to_Store" AS "Store_CostCharge_to_Store",
                "SSC_Subsidized" AS "SSC_Subsidized",
                "TRACKING_NO" AS "TRACKING_NO"
                FROM "ROADIE_TRACTOR_SUPPLY_INVOICE_STACKED_JOINED"
            )
             "ROADIE"
            LEFT JOIN TENANT149_DATA_TIME_DIMENSION_PREPARED "TIME"
              ON TRY_CAST("ROADIE"."Delivery_Date_parsed" AS DATE) = CAST("TIME"."DATE" AS DATE)
                    )dku
        ) "dku__beforegrouping"
        WHERE "MERCH_YEAR" IS NOT NULL 
      GROUP BY "MERCH_YEAR", "YEAR_PERIOD", "roadie_dropout_flag"
      ORDER BY "MERCH_YEAR","YEAR_PERIOD" 
    ) "pristine_query" ;


<br>
--MERCH_YEAR_YEAR_PERIOD --- Moving before use
</br>
insert into MERCH_YEAR_YEAR_PERIOD 
SELECT 
    "MERCH_YEAR" AS "MERCH_YEAR",
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "PERIOD" AS "PERIOD"
FROM (
    SELECT 
        "TIME_DIM_KEY" AS "TIME_DIM_KEY",
        "DATE" AS "DATE",
        "CAL_DATE" AS "CAL_DATE",
        "WEEK_IN_YEAR" AS "WEEK_IN_YEAR",
        "WEEK" AS "WEEK",
        "PERIOD" AS "PERIOD",
        "QUARTER" AS "QUARTER",
        "HOLIDAY_FLAG" AS "HOLIDAY_FLAG",
        "SEASON_DESC" AS "SEASON_DESC",
        "WEEKEND_FLAG" AS "WEEKEND_FLAG",
        "MERCH_YEAR" AS "MERCH_YEAR",
        "ACCT_YEAR" AS "ACCT_YEAR",
        "WEEK_DAY" AS "WEEK_DAY",
        "MONTH_END_FLAG" AS "MONTH_END_FLAG",
        "YEAR_WEEK" AS "YEAR_WEEK",
        "YEAR_WEEK_START_DATE" AS "YEAR_WEEK_START_DATE",
        "YEAR_WEEK_END_DATE" AS "YEAR_WEEK_END_DATE",
        "YEAR_QUARTER" AS "YEAR_QUARTER",
        "YEAR_PERIOD" AS "YEAR_PERIOD",
        "LAST_FISCAL_YEAR_TIME_DIM_KEY" AS "LAST_FISCAL_YEAR_TIME_DIM_KEY",
        "WEEKS_52_BACK_TIME_DIM_KEY" AS "WEEKS_52_BACK_TIME_DIM_KEY",
        "WEEK_END_DATE" AS "WEEK_END_DATE",
        "MONTH_END_IND" AS "MONTH_END_IND",
        "QUARTER_END_IND" AS "QUARTER_END_IND",
        "HALF_YEAR_END_IND" AS "HALF_YEAR_END_IND",
        "YEAR_END_IND" AS "YEAR_END_IND"
    FROM TENANT149_DATA_TIME_DIMENSION_PREPARED
    ) "dku__beforegrouping"
GROUP BY "MERCH_YEAR", "YEAR_PERIOD", "PERIOD";

<br>
--VARIABLE_COST_COMBINED_MASTER_FILE         ---------wrong year_period formate
</br>
INSERT INTO   VARIABLE_COST_COMBINED_MASTER_FILE
select
  article_no,
  year_period,
  store_no,
  vendor_id,
  variable_cost_combined,
  case 
    when substring(year_period,0,4) like '%.%' then NULL
      else substring(year_period,0,4)
  END as merch_year,
  channel
FROM
    (SELECT   DISTINCT varcomcosjoi.article_no    AS article_no,
              varcomcosjoi.year_period            AS year_period,
              varcomcosjoi.store_no               AS store_no,
              varcomcosjoi.vendor_id              AS vendor_id,
              varcomcosjoi.variable_cost_combined AS variable_cost_combined,
              varcomcosjoi.merch_year             AS merch_year,
              'Store'                             AS channel
    FROM      VARIABLE_COST_COMBINED_PREPARED_JOINED_TMP varcomcosjoi
    LEFT JOIN LC_3PL_VARIABLE_COST_PER_PALLET_11212022_PREPARED pl_varcospalpre
    ON        varcomcosjoi.store_no = pl_varcospalpre."Facility_Code"
    WHERE     pl_varcospalpre."Facility_Code" IS NULL)dku
UNION ALL
SELECT
     article_no,
     year_period,
     store_no,
     vendor_id,
     variable_cost_combined,
     case 
        when substring(year_period,0,4) like '%.%' then NULL
        else substring(year_period,0,4)
     END as merch_year,
     channel
FROM
     (SELECT    DISTINCT facvol.article_no        AS article_no,
               facvol.year_period                AS year_period,
               facvol.store_no                   AS store_no,
               facvol.vendor_id                  AS vendor_id,
               facvol."PL_VARIABLE_COST_COMBINED" AS variable_cost_combined,
               meryea."MERCH_YEAR"                 AS merch_year ,
               facvol."CHANNEL" AS channel
     FROM      FACILITY_LOCATION_3PL_MIXING_VOL_WEI_STACKED_PREPARED facvol
     LEFT JOIN MERCH_YEAR_YEAR_PERIOD meryea
     ON        facvol."YEAR_PERIOD" = meryea."YEAR_PERIOD")dku_1;


<br>
/*BOOTH_RENTAL_FINAL*/ ------- no changes
</br>
insert into "BOOTH_RENTAL_FINAL"
SELECT  * FROM  BOOTH_RENTAL_STACKED_PREPARED_BY_PARENT_VENDOR_INT	;

<br>
/*DC_SHRINK_FINAL*/ -----------earlier source (DCSHRINK_RATE) not created insteed of  that DCSHRINK_RATE_BACKUP is created 
</br>
INSERT INTO  "DC_SHRINK_FINAL"
SELECT 
    try_to_number(ARTICLE) AS "ARTICLE_NO",
    try_to_number(CAL_MERCH_YEAR) AS "MERCH_YEAR",
    try_to_number(CAL_YEAR_PERIOD) AS "YEAR_PERIOD",
    SUM(ALLOCATION_VALUE) AS "ALLOCATION_VALUE"
FROM  DCSHRINK_RATE
GROUP BY ARTICLE, "CAL_MERCH_YEAR", "CAL_YEAR_PERIOD";


<br>
 /*DEFECTIVES_FINAL */ --- NO Change
</br>
INSERT INTO  "DEFECTIVES_FINAL"
SELECT 
  "Article" AS "ARTICLE_NO",
  "CAL_MERCH_YEAR" AS "MERCH_YEAR",
  "CAL_YEAR_PERIOD" AS "YEAR_PERIOD",
  SUM("ALLOCATION_VALUE") AS "ALLOCATION_VALUE" 	
FROM (select distinct * from "DEFECTIVE_RATE_1")dku
GROUP BY "Article", "CAL_MERCH_YEAR", "CAL_YEAR_PERIOD";


<br>
   /*MIXING_CENTER_FINAL*/ 
</br>
INSERT INTO  "MIXING_CENTER_FINAL"
SELECT 
    "YEAR_PERIOD" AS "YEAR_PERIOD",
      522341 AS "VENDOR_ID",
    "MERCH_YEAR" AS "MERCH_YEAR",
    SUM("MIXING_CENTER_CREDIT") AS "ALLOCATION_VALUE"
FROM (SELECT  distinct *,LEFT(YEAR_PERIOD,4)AS "MERCH_YEAR" 
            FROM  mixing_center_credit)dku
GROUP BY "YEAR_PERIOD", "VENDOR_ID", "MERCH_YEAR";

<br>
  /*NEW_STORE_DISCOUNT_FINAL */ --- put distinct
</br> 
INSERT INTO  "NEW_STORE_DISCOUNT_FINAL"
SELECT 
  "NSD_Sku" AS "ARTICLE_NO",
  "Vendor_ID" AS "VENDOR_ID",
  "YEAR" AS "MERCH_YEAR",
  "YEAR_QUARTER" AS "YEAR_QUARTER",
  SUM("Sum_NSD_Discount_Amt") AS "ALLOCATION_VALUE"
FROM  (select  "NSD_Sku",
                       "Vendor_ID",
                       "YEAR",
                       "YEAR_QUARTER", 
                       "Sum_NSD_Discount_Amt" 
       from "NEW_STORE_DISCOUNT_PREPARED_PREPARED")dku
GROUP BY "NSD_Sku", "Vendor_ID", "YEAR", "YEAR_QUARTER";

<br>
--/*PDQ_FINAL*/
</br>
INSERT INTO  "PDQ_FINAL"
SELECT * FROM (
SELECT 
  "MERCH_YEAR" AS "MERCH_YEAR",
  "YEAR_PERIOD" AS "YEAR_PERIOD",
  "VENDOR_NO" AS "VENDOR_ID",
  SUM("AMOUNT") AS "ALLOCATION_VALUE"
  FROM (select  * from "TENANT149_DATA_PDQ_VF_PREP_JOINED")dku
GROUP BY "MERCH_YEAR", "YEAR_PERIOD", "VENDOR_NO"
)FINAL 
  WHERE "MERCH_YEAR" >= '2020';


<br>
/*POP_FINAL*/
</br>
INSERT INTO  "POP_FINAL"
SELECT  Distinct * FROM pop_by_date;

<br>
/*FREIGHT_OTHER_CHARGES_FINAL*/
</br>
INSERT INTO FREIGHT_OTHER_CHARGES_FINAL
SELECT 
  "Period" AS "YEAR_PERIOD",
    1 AS "freight_flag",
    SUM("other_charges") AS "ALLOCATION_VALUE"
FROM (select distinct * from FREIGHT_OTHER_CHARGES_PREPARED_FILTERED_STACKED)dku
GROUP BY "Period", "freight_flag";

<br>
/*PRICE_CUTS_FINAL*/
</br>
INSERT INTO  PRICE_CUTS_FINAL
SELECT 
       YEAR_PERIOD  AS "YEAR_PERIOD",
       MERCH_YEAR AS "MERCH_YEAR",
       Article_Number AS "ARTICLE_NO",
       Vendor_ID AS "VENDOR_ID",
       SUM(Total_Scan_Down) AS "ALLOCATION_VALUE"
FROM (select distinct * from TENANT149_DATA_price_cuts_2021_2020_prepared_by_Year_Week_joined)dku
WHERE Year_Week IS NOT NULL 
GROUP BY YEAR_PERIOD, MERCH_YEAR, Article_Number, Vendor_ID;

<br>
 /*LM_SCANDOWN_FINAL */
</br>
INSERT INTO "LM_SCANDOWN_FINAL"
SELECT 
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "MERCH_YEAR" AS "MERCH_YEAR",
    "VENDOR_ID" AS "VENDOR_ID",
    "ARTICLE_NO" AS "ARTICLE_NO",
    "allocation_value" AS "ALLOCATION_VALUE"
FROM (select * from "LM_SCANDOWN_PREPARED")dku
WHERE "YEAR_PERIOD" >= 202209;

<br>
/*DC_3PL_PNL_OMNI_FULFILLMENT_FIXED*/  
</br>
INSERT INTO  DC_3PL_PNL_OMNI_FULFILLMENT_FIXED
SELECT 
     "STORE_NO" AS STORE_NO,
     "YEAR_PERIOD" AS YEAR_PERIOD,
     "channel" AS channel,
     "MERCH_YEAR" AS MERCH_YEAR,
     SUM("allocation_value") AS ALLOCATION_VALUE
FROM  (select DISTINCT "STORE_NO",
              "YEAR_PERIOD",
              "channel",
              "MERCH_YEAR",
              "allocation_value"
       from "DC_3PL_PNL_OMNI_FULFILLMENT_JOINED"
       WHERE "Cost_Type" = 'Fixed')dku
GROUP BY "STORE_NO", "YEAR_PERIOD", "channel", "MERCH_YEAR";

<br>
/*DC_3PL_PNL_OMNI_FULFILLMENT_VARIABLE*/ 
</br>
INSERT INTO  DC_3PL_PNL_OMNI_FULFILLMENT_VARIABLE
SELECT 
    "STORE_NO" AS STORE_NO,
    "YEAR_PERIOD" AS YEAR_PERIOD,
    "channel" AS channel,
    "MERCH_YEAR" AS MERCH_YEAR,
    SUM("allocation_value") AS ALLOCATION_VALUE
FROM  (select DISTINCT "STORE_NO",
              "YEAR_PERIOD",
              "channel",
              "MERCH_YEAR",
              "allocation_value"
       from "DC_3PL_PNL_OMNI_FULFILLMENT_JOINED"
       WHERE "Cost_Type" = 'Variable')dku
GROUP BY "STORE_NO", "YEAR_PERIOD", "channel", "MERCH_YEAR";


<br>
/*DC_3PL_VARIABLE_COST_PREP_JOINED*/
</br>

INSERT INTO "DC_3PL_VARIABLE_COST_PREP_JOINED"
WITH VARIABLE_COST_PREP AS (
SELECT  DISTINCT COST_CENTER AS STORE_NO ,
        YEAR,
        PERIOD,
        CONCAT(YEAR,(LPAD("PERIOD",2,0))) AS YEAR_PERIOD,
        ACTUAL_SUM AS COST_AMT
FROM  DC_3PL_PANDL_VARIABLE_COST_BY_COST_CENTER
)
SELECT 
    "Variable_Cost_prep"."STORE_NO" AS "STORE_NO",
    "Variable_Cost_prep"."YEAR_PERIOD" AS "YEAR_PERIOD",
    "Variable_Cost_prep"."COST_AMT" AS "ALLOCATION_VALUE",
    "TENANT149_DATA_time_dimension_by_YEAR_PERIOD_bigint"."MERCH_YEAR" AS "MERCH_YEAR",
    'Store' AS channel
  FROM VARIABLE_COST_PREP "Variable_Cost_prep"
  LEFT JOIN (SELECT DISTINCT "YEAR_PERIOD","MERCH_YEAR" 
             FROM (
            SELECT DISTINCT
                 "YEAR_PERIOD" AS "YEAR_PERIOD",
                 "MERCH_YEAR" AS "MERCH_YEAR",
                 "YEAR_QUARTER" AS "YEAR_QUARTER"
            FROM "EDW"."TIME_DIMENSION"
            GROUP BY "YEAR_PERIOD", "MERCH_YEAR", "YEAR_QUARTER" )dku
                    )"TENANT149_DATA_time_dimension_by_YEAR_PERIOD_bigint"
    ON "Variable_Cost_prep"."YEAR_PERIOD" = "TENANT149_DATA_time_dimension_by_YEAR_PERIOD_bigint"."YEAR_PERIOD";


<br>
---MARKETING_VF_PREPARED_PREPARED
--check where condition with bcg it is changing
</br>
CREATE  OR REPLACE TEMPORARY TABLE "MARKETING_VF_PREPARED_PREPARED" 
AS
WITH CTE AS 
(
SELECT DISTINCT "Period Posted"
  ,"PERIOD" AS "Period"
  , CASE WHEN "PERIOD" <=3 THEN 1
                  WHEN "PERIOD" >=4 AND "PERIOD" <=6 THEN 2
                  WHEN "PERIOD" >=7 AND "PERIOD" <=9 THEN 3 
                  ELSE 4 END "Quarter"
  ,"Merch_Year"
  ,"year_period"
  ,"Vendor ID" 
  ,"Vendor"
  ,"Amount"
FROM 
(
SELECT  *,
      SPLIT_PART("Period Posted",'/',1) "PERIOD",
      (IFF( substring( "Period Posted",4,5) = '22', 2022, 2023 )) AS "Merch_Year",
      concat((IFF( substring( "Period Posted",4,5) = '22', 2022, 2023 )),LPAD((SPLIT_PART("Period Posted",'/',1)),2,0)) AS "year_period"
FROM MARKETING_CSV_PREPARED
)
)
SELECT 
    NULL AS "Document type",
    NULL AS "Document Number",
    NULL AS "Posting row",
    NULL AS "Document Date",
    NULL AS "Posting Date",
    NULL AS "Cost Center",
    NULL AS "Cost Element",
    NULL AS "Name",
    "Amount" AS "Vbl.Val./COCrcy",
    NULL AS "Cost element name",
    "Vendor ID" AS "Offsetting acct no.",
    NULL AS "Period",
    NULL AS "period_str",
    NULL AS "Name of offsetting account",
    NULL AS "Document Header Text",
    NULL AS "Cost element descr.",
    NULL AS "Ref Document Number",
    NULL AS "Reference",
    NULL AS "Dr/Cr indicator",
    "Merch_Year" AS "Fiscal Year",
    "year_period" AS "year_period",
    NULL AS "User Name",
    NULL AS "Created on"
    FROM(
SELECT 
    "Period Posted",
    "Period",
    "Quarter",
    "Merch_Year",
    REPLACE(REPLACE(REPLACE(CAST("year_period" AS VARCHAR), '202307', '202310'), '202308', '202311'),'202309','202312') AS "year_period",
    "Vendor ID",
    "Vendor",
    "Amount"
  FROM CTE 
  WHERE CAST("year_period" AS VARCHAR) IS NOT NULL AND (CAST("year_period" AS VARCHAR) = '202307') OR CAST("year_period" AS VARCHAR) IS NOT NULL AND (CAST("year_period" AS VARCHAR) = '202308')OR CAST("year_period" AS VARCHAR) IS NOT NULL AND (CAST("year_period" AS VARCHAR) = '202309')
        )from_csv_Replacing_07_08_09_into_10_11_12
  UNION ALL
SELECT 
    NULL AS "Document type",
    NULL AS "Document Number",
    NULL AS "Posting row",
    NULL AS "Document Date",
    NULL AS "Posting Date",
    NULL AS "Cost Center",
    NULL AS "Cost Element",
    NULL AS "Name",
    "Amount" AS "Vbl.Val./COCrcy",
    NULL AS "Cost element name",
    "Vendor ID" AS "Offsetting acct no.",
    NULL AS "Period",
    NULL AS "period_str",
    NULL AS "Name of offsetting account",
    NULL AS "Document Header Text",
    NULL AS "Cost element descr.",
    NULL AS "Ref Document Number",
    NULL AS "Reference",
    NULL AS "Dr/Cr indicator",
    "Merch_Year" AS "Fiscal Year",
    "year_period" AS "year_period",
    NULL AS "User Name",
    NULL AS "Created on"
    FROM(
SELECT 
    "Period Posted",
    "Period",
    "Quarter",
     REPLACE("Merch_Year",'2023','2024') AS "Merch_Year",
     REPLACE(REPLACE(REPLACE(CAST("year_period" AS VARCHAR), '202307', '202401'), '202308', '202402'),'202309','202403') AS "year_period",
    "Vendor ID",
    "Vendor",
    "Amount"
  FROM CTE 
  WHERE CAST("year_period" AS VARCHAR) IS NOT NULL AND (CAST("year_period" AS VARCHAR) = '202307') OR CAST("year_period" AS VARCHAR) IS NOT NULL AND (CAST("year_period" AS VARCHAR) = '202308')
        OR CAST("year_period" AS VARCHAR) IS NOT NULL AND (CAST("year_period" AS VARCHAR) = '202309')
        )from_csv_Replacing_07_08_09_into_202401_202402_202403
  UNION ALL 
  SELECT 
    NULL AS "Document type",
    NULL AS "Document Number",
    NULL AS "Posting row",
    NULL AS "Document Date",
    NULL AS "Posting Date",
    NULL AS "Cost Center",
    NULL AS "Cost Element",
    NULL AS "Name",
    "Amount" AS "Vbl.Val./COCrcy",
    NULL AS "Cost element name",
    "Vendor ID" AS "Offsetting acct no.",
    NULL AS "Period",
    NULL AS "period_str",
    NULL AS "Name of offsetting account",
    NULL AS "Document Header Text",
    NULL AS "Cost element descr.",
    NULL AS "Ref Document Number",
    NULL AS "Reference",
    NULL AS "Dr/Cr indicator",
    "Merch_Year" AS "Fiscal Year",
    "year_period" AS "year_period",
    NULL AS "User Name",
    NULL AS "Created on"
    FROM(
SELECT 
    "Period Posted",
    "Period",
    "Quarter",
     REPLACE("Merch_Year",'2023','2024') AS "Merch_Year",
     REPLACE(REPLACE(REPLACE(CAST("year_period" AS VARCHAR), '202307', '202404'), '202308', '202405'),'202309','202406') AS "year_period",
    "Vendor ID",
    "Vendor",
    "Amount"
  FROM CTE 
  WHERE CAST("year_period" AS VARCHAR) IS NOT NULL AND (CAST("year_period" AS VARCHAR) = '202307') OR CAST("year_period" AS VARCHAR) IS NOT NULL AND (CAST("year_period" AS VARCHAR) = '202308')
        OR CAST("year_period" AS VARCHAR) IS NOT NULL AND (CAST("year_period" AS VARCHAR) = '202309')
        )from_csv_Replacing_07_08_09_into_202404_202405_202406
  UNION ALL 
  SELECT 
    NULL AS "Document type",
    NULL AS "Document Number",
    NULL AS "Posting row",
    NULL AS "Document Date",
    NULL AS "Posting Date",
    NULL AS "Cost Center",
    NULL AS "Cost Element",
    NULL AS "Name",
    "Amount" AS "Vbl.Val./COCrcy",
    NULL AS "Cost element name",
    "Vendor ID" AS "Offsetting acct no.",
    NULL AS "Period",
    NULL AS "period_str",
    NULL AS "Name of offsetting account",
    NULL AS "Document Header Text",
    NULL AS "Cost element descr.",
    NULL AS "Ref Document Number",
    NULL AS "Reference",
    NULL AS "Dr/Cr indicator",
    "Merch_Year" AS "Fiscal Year",
    "year_period" AS "year_period",
    NULL AS "User Name",
    NULL AS "Created on"
FROM (
  SELECT  "Period Posted"
,"PERIOD" AS "Period"
, CASE WHEN "PERIOD" <=3 THEN 1
                WHEN "PERIOD" >=4 AND "PERIOD" <=6 THEN 2
                WHEN "PERIOD" >=7 AND "PERIOD" <=9 THEN 3 
                ELSE 4 END "Quarter"
  ,"Merch_Year"
  ,"year_period"
  ,"Vendor ID" 
  ,"Vendor"
  ,"Amount"
FROM 
(
SELECT DISTINCT *,
      SPLIT_PART("Period Posted",'/',1) "PERIOD",
      (IFF( substring( "Period Posted",4,5) = '22', 2022, 2023 )) AS "Merch_Year",
      concat((IFF( substring( "Period Posted",4,5) = '22', 2022, 2023 )),LPAD((SPLIT_PART("Period Posted",'/',1)),2,0)) AS "year_period"
FROM MARKETING_CSV_PREPARED
)A)Original_Chunk_csv_data
UNION ALL
SELECT 
    "Document type" AS "Document type",
    "Document Number" AS "Document Number",
    "Posting row" AS "Posting row",
    "Document Date" AS "Document Date",
    "Posting Date" AS "Posting Date",
    "Cost Center" AS "Cost Center",
    "Cost Element" AS "Cost Element",
    "Name" AS "Name",
    CAST("Vbl.Val./COCrcy" AS BIGINT) AS "Vbl.Val./COCrcy",
    "Cost element name" AS "Cost element name",
    "Offsetting acct no." AS "Offsetting acct no.",
    "Period" AS "Period",
    "period_str" AS "period_str",
    "Name of offsetting account" AS "Name of offsetting account",
    "Document Header Text" AS "Document Header Text",
    "Cost element descr." AS "Cost element descr.",
    "Ref Document Number" AS "Ref Document Number",
    "Reference" AS "Reference",
    "Dr/Cr indicator" AS "Dr/Cr indicator",
    "Fiscal Year" AS "Fiscal Year",
    "year_period" AS "year_period",
    "User Name" AS "User Name",
    "Created on" AS "Created on"
    FROM (
SELECT 
    "Document type",
    "Document Number",
    "Posting row",
    "Document Date",
    "Posting Date",
    "Cost Center",
    "Cost Element",
    "Name",
    "Vbl.Val./COCrcy",
    "Cost element name",
    "Offsetting acct no.",
    "Period",
    "Name of offsetting account",
    "Document Header Text",
    "Cost element descr.",
    "Ref Document Number",
    "Reference",
    "Dr/Cr indicator",
    "Fiscal Year",
    "User Name",
    "Created on",
    "period_str",
    CONCAT(IFNULL(TO_VARCHAR("Fiscal Year"), ''), IFNULL(TO_VARCHAR("period_str"), '')) AS "year_period"
  FROM (
    SELECT DISTINCT
        "Document type",
        "Document Number",
        "Posting row",
        "Document Date",
        "Posting Date",
        "Cost Center",
        "Cost Element",
        "Name",
        "Vbl.Val./COCrcy",
        "Cost element name",
        "Offsetting acct no.",
        "Period",
        "Name of offsetting account",
        "Document Header Text",
        "Cost element descr.",
        "Ref Document Number",
        "Reference",
        "Dr/Cr indicator",
        "Fiscal Year",
        "User Name",
        "Created on",
        CASE WHEN "Period" >= 10 THEN "Period" ELSE CONCAT(0, IFNULL(TO_VARCHAR("Period"), '')) END AS "period_str"
      FROM "MARKETING_VF_PREPARED" "__input_table"
    ) NO_GROUPING)FINAL
UNION ALL
SELECT 
    NULL AS "Document type",
    NULL AS "Document Number",
    NULL AS "Posting row",
    NULL AS "Document Date",
    NULL AS "Posting Date",
    "Cost_Center" AS "Cost Center",
    "Cost_Element" AS "Cost Element",
    NULL AS "Name",
    CAST("Vbl.Val./COCrcy" AS BIGINT) AS "Vbl.Val./COCrcy",
    NULL AS "Cost element name",
    "Offsetting_acct_no" AS "Offsetting acct no.",
    NULL AS "Period",
    NULL AS "period_str",
    "Name_of_offsetting_account" AS "Name of offsetting account",
    NULL AS "Document Header Text",
    NULL AS "Cost element descr.",
    NULL AS "Ref Document Number",
    NULL AS "Reference",
    NULL AS "Dr/Cr indicator",
    "Fiscal_Year" AS "Fiscal Year",
    "Year_Period" AS "year_period",
    NULL AS "User Name",
    "Created_on" AS "Created on"
    FROM (
SELECT DISTINCT *,
SPLIT_PART("Created_on",'/',1) "Month",
CASE WHEN SPLIT_PART("Created_on",'/',3) ='22' THEN  '2022' ELSE SPLIT_PART("Created_on",'/',3)  END AS "Year",
CONCAT((CASE WHEN SPLIT_PART("Created_on",'/',3) ='22' THEN  '2022' ELSE SPLIT_PART("Created_on",'/',3)  END ),LPAD((SPLIT_PART("Created_on",'/',1)),2,0)) AS "Year_Period"
FROM "LM_MARKETING_PREPARED"
)Final;

<br>
-- FINAL QUERY FOR MARKETING_FINAL 
</br>
INSERT INTO  "MARKETING_FINAL"
SELECT 
  cast("Fiscal Year" as numeric) AS "MERCH_YEAR",
  "year_period" AS "YEAR_PERIOD",
  "Offsetting acct no." AS "VENDOR_ID",
  SUM("Vbl.Val./COCrcy") AS "ALLOCATION_VALUE"      
  FROM (SELECT DISTINCT * FROM "MARKETING_VF_PREPARED_PREPARED")DKU
  GROUP BY "Fiscal Year", "year_period", "Offsetting acct no.";


<br>
--SHRINK_R12_FILTER
</br>
CREATE OR REPLACE TEMPORARY TABLE "SHRINK_R12_FILTER"
AS
SELECT DISTINCT
    SKU AS SKU,
    Month AS Month,
    year AS year,
    year_period AS year_period,
    Sales AS Sales,
    Cost AS Cost,
    Theft AS Theft,
    Shrink AS Shrink,
    Theft_previous AS Theft_previous,
    actual_theft AS actual_theft,
    Shrink_previous AS Shrink_previous,
    actual_shrink AS actual_shrink,
    SALES_AMT AS SALES_AMT,
    Sales_sum AS Sales_sum,
    actual_shrink_sum AS actual_shrink_sum,
    shrink_rolling_round AS shrink_rolling_round,
    SALES_AMT_sum AS SALES_AMT_sum,
    sales_rolling_round AS sales_rolling_round,
    shrink_rate AS shrink_rate,
    actual_monthly_shrink AS actual_monthly_shrink,
    shrink_allocate AS shrink_allocate,
    actual_r12_month_shrink AS actual_r12_month_shrink
  FROM SHRINK_R12_RATE
  WHERE SALES_AMT_sum >= 0 AND shrink_rate < 1 AND shrink_rate > -1
  
<br>  
 ---Sudheer's
 ------------------------------------
 -- tsc_delivery_final(file)
</br>
insert into TSC_DELIVERY_FINAL	
SELECT DISTINCT
    YEAR_PERIOD AS YEAR_PERIOD,
    MERCH_YEAR AS MERCH_YEAR,
    allocation_value AS allocation_value,
    tsc_delivery_flag AS tsc_delivery_flag
  FROM TSC_DELIVERY_PREPARED;


<br>
  ----------------------------------
   --multichannel_salvage (file)
</br>
insert into  MULTICHANNEL_SALVAGE
SELECT 
    Article AS ARTICLE_NO,
    cal_MERCH_YEAR AS MERCH_YEAR,
    cal_YEAR_PERIOD AS YEAR_PERIOD,
    multi_salvage_flag AS multi_salvage_flag,
    allocation_value_sum AS allocation_value
  FROM (
    SELECT 
        Article AS Article,
        cal_MERCH_YEAR AS cal_MERCH_YEAR,
        cal_YEAR_PERIOD AS cal_YEAR_PERIOD,
        multi_salvage_flag AS multi_salvage_flag,
        SUM(allocation_value) AS allocation_value_sum
      FROM (
        SELECT DISTINCT
            "Article" AS Article,
            cal_MERCH_YEAR AS cal_MERCH_YEAR,
            cal_YEAR_PERIOD AS cal_YEAR_PERIOD,
            allocation_value AS allocation_value,
            SALES_AMT AS SALES_AMT,
            shrink_rate AS shrink_rate,
            1 AS multi_salvage_flag
          FROM OMNI_LM_MULTICHANNEL_SALVAGE_RATE
        ) dku__beforegrouping
      GROUP BY Article, cal_MERCH_YEAR, cal_YEAR_PERIOD, multi_salvage_flag
    ) pristine_query;

<br>
-----------------------------------
--	  dc_3pl_PandL_fixed_cost_final
</br>
insert into DC_3PL_PANDL_FIXED_COST_FINAL
SELECT DISTINCT
  STORE_NO AS STORE_NO,
  YEAR_PERIOD AS YEAR_PERIOD,
  MERCH_YEAR AS MERCH_YEAR,
  allocation_value_sum AS allocation_value
FROM (
  SELECT 
      STORE_NO AS STORE_NO,
      YEAR_PERIOD AS YEAR_PERIOD,
      MERCH_YEAR AS MERCH_YEAR,
      SUM(allocation_value) AS allocation_value_sum
    FROM (
      SELECT DISTINCT
          STORE_NO AS STORE_NO,
          YEAR_PERIOD AS YEAR_PERIOD,
          allocation_value AS allocation_value,
          MERCH_YEAR AS MERCH_YEAR
        FROM TENANT149_DATA_DC_3PL_PANDL_FIXED_COST_PREPARED_JOINED
      ) dku__beforegrouping
    GROUP BY STORE_NO, YEAR_PERIOD, MERCH_YEAR
  ) pristine_query;

<br>
---------------------------------
	--   volume_rebate_2022_final(check where condition in flow)
</br>
insert into VOLUME_REBATE_2022_FINAL
select  * from (
SELECT 
    MERCH_YEAR AS MERCH_YEAR,
    YEAR_PERIOD AS YEAR_PERIOD,
    VENDOR_ID AS VENDOR_ID,
    allocation_value AS allocation_value
  FROM VOLUME_REBATE_NEW
  WHERE allocation_value != 0 
  union all
  SELECT 
    year AS MERCH_YEAR,
    year_month AS YEAR_PERIOD,
    CHILDVENDOR AS VENDOR_ID,
    volume_rebate_sum AS allocation_value
  FROM (
    SELECT 
        year AS year,
        year_month AS year_month,
        CHILDVENDOR,
        SUM(volume_rebate) AS volume_rebate_sum
      FROM (
        SELECT 
            PARENTVENDOR,
            CHILDVENDOR,
            JANUARY_SAP_NET_RECEIPTS_FPV,
            FEBRUARY_SAP_NET_RECEIPTS_FPV,
            MARCH_SAP_NET_RECEIPTS_FPV,
            APRIL_SAP_NET_RECEIPTS_FPV,
            MAY_SAP_NET_RECEIPTS_FPV,
            year AS year,
            avg_per AS avg_per,
            Month AS Month,
            year_month AS year_month,
            volume_rebate AS volume_rebate
          FROM VOLUME_REBATE_2022_W_RECEIPTS_FOLD
        ) dku__beforegrouping
      GROUP BY year, year_month, CHILDVENDOR
    ) pristine_query
	) TENANT149_DATA_VOLUME_REBATE_2022_FOLD_BY_PARENT_VENDOR_STACKED
	where YEAR_PERIOD <= 202404


<br>
-- vendor_support_fast_exception_final
</br>
insert into VENDOR_SUPPORT_FAST_EXCEPTION_FINAL
SELECT 
  Year_Period AS YEAR_PERIOD,
  year AS MERCH_YEAR,
  Vendor_ID AS VENDOR_ID,
  FAST_funding_sum AS allocation_value
FROM (
  SELECT 
      Year_Period AS Year_Period,
      year AS year,
      Vendor_ID AS Vendor_ID,
      SUM(FAST_funding) AS FAST_funding_sum
    FROM (
      SELECT DISTINCT
            "Year_Period" AS Year_Period,
          "year" AS year,
          "FAST_funding" AS FAST_funding,
          "Vendor_ID" AS Vendor_ID
        FROM VENDOR_SUPPORT_FAST_EXCEPTION_PREPARED
      ) dku__beforegrouping
    GROUP BY Year_Period, year, Vendor_ID
  ) pristine_query;


<br>
-----------------------------------------
</br>
insert into financial_inventory_master 
SELECT DISTINCT * FROM TENANT149_DATA_financial_inventory_yp_prep_joined;

<br>
--CASH_DISCOUNTS_BY_FLAG
</br>
INSERT INTO CASH_DISCOUNTS_BY_FLAG
SELECT 
    YEAR_PERIOD,
    MERCH_YEAR,
    CASH_DISCOUNT_FLAG,
    SUM(AMOUNT_IN_LOCAL_CURRENCY) AS ALLOCATION_VALUE 
FROM 
(
    SELECT 
        "YEAR_MONTH" AS YEAR_PERIOD,
        FISCAL_YEAR AS MERCH_YEAR,
        REGEXP_REPLACE(AMOUNT_IN_LOCAL_CURRENCY,',', '') AMOUNT_IN_LOCAL_CURRENCY ,
        1  CASH_DISCOUNT_FLAG
        FROM CASH_DISCOUNTS_PREPARED_FILTERED_PREPARED
        WHERE VENDOR IS NULL )A 
GROUP BY 1,2,3;

<br>
--Abhilash's 
--cash_discounts_by_flag_final
-------------------------------
</br>
insert into CASH_DISCOUNTS_BY_FLAG_FINAL 
SELECT 
    YEAR_PERIOD,
    MERCH_YEAR,
    CASH_DISCOUNT_FLAG,
    SUM(AMOUNT_IN_LOCAL_CURRENCY) AS ALLOCATION_VALUE 
FROM 
(
    SELECT 
        "YEAR_MONTH" AS YEAR_PERIOD,
        FISCAL_YEAR AS MERCH_YEAR,
        REGEXP_REPLACE(AMOUNT_IN_LOCAL_CURRENCY,',', '') AMOUNT_IN_LOCAL_CURRENCY ,
        1  CASH_DISCOUNT_FLAG
        FROM CASH_DISCOUNTS_PREPARED_FILTERED_PREPARED
        WHERE VENDOR IS NULL )A 
GROUP BY 1,2,3;

<br>
--cash_discounts_w_vendor_final
--------------------------------
</br>
insert into CASH_DISCOUNTS_W_VENDOR_FINAL
SELECT 
    year_month AS YEAR_PERIOD,
    Fiscal_Year AS MERCH_YEAR,
    Vendor AS Vendor,
    SUM(Amount_in_local_currency) AS allocation_value
    from(
        SELECT 
            Vendor,
            year_month AS year_month,
            Fiscal_Year AS FISCAL_YEAR,
            REGEXP_REPLACE(Amount_in_local_currency,',', '')as Amount_in_local_currency
        FROM CASH_DISCOUNTS_PREPARED_FILTERED_PREPARED)dku
    WHERE Vendor IS NOT NULL
    group by year_month, FISCAL_YEAR, Vendor;

<br>
--DC_3PL_PANDL_FIXED_COST_FINAL
---------------------------------
</br>
insert into DC_3PL_PANDL_FIXED_COST_FINAL 
SELECT 
    STORE_NO ,
    YEAR_PERIOD,
    MERCH_YEAR,
    SUM(allocation_value) AS allocation_value
  FROM (SELECT DISTINCT * FROM TENANT149_DATA_DC_3PL_PANDL_FIXED_COST_PREPARED_JOINED)DKU
  GROUP BY STORE_NO, YEAR_PERIOD, MERCH_YEAR;

<br>
--LM_MARKDOWNS_FINAL -- filtter condition is compulsary
--------------------
</br>
insert into LM_MARKDOWNS_FINAL 
SELECT 
    "MERCH_YEAR" AS "MERCH_YEAR",
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "VENDOR_ID" AS "VENDOR_ID",
    "markdown_flag" AS "markdown_flag",
    "allocation_value" AS "allocation_value"
  FROM LM_NEW_MARKDOWN_FLAG_GRP
  WHERE "YEAR_PERIOD" >= 202209;

<br>
--MARKDOWNS_FINAL
----------------
</br>
insert into MARKDOWNS_FINAL 
select  Distinct * from "MARKDOWNS_FILTER_BY_YEAR";

<br>
--OMNI_ROADIE_FINAL
------------------------
</br>
insert into OMNI_ROADIE_FINAL 
SELECT 
    ORDER_LINE_KEY as OMS_ORDER_LINE_KEY,
    OMS_ITEM_ID,
    1 AS roadie_flag,
    SUM(trans_amt_by_weight) AS allocation_value
FROM (select * from  FREIGHT_DETAIL_ROADIE_WINDOWS_JOINED_PREPARED)dku
GROUP BY ORDER_LINE_KEY, OMS_ITEM_ID, roadie_flag;

<br>
--shrink_inventory_final
--------------------
</br>
insert into SHRINK_INVENTORY_FINAL 
SELECT 
    cast("SKU" as numeric) AS "ARTICLE_NO",
    cast(year as numeric) AS "MERCH_YEAR",
    cast(year_period as numeric) AS "year_period",
    SUM(actual_shrink) AS "allocation_value"
  FROM (SELECT DISTINCT * FROM SHRINK_R12_PERIOD)DKU
GROUP BY "SKU", year, year_period;

<br>
--THEFT_FINAL
-------------------
</br>
insert into THEFT_FINAL 
SELECT 
    Article AS ARTICLE_NO,
    cal_MERCH_YEAR AS MERCH_YEAR,
    cal_YEAR_PERIOD AS YEAR_PERIOD,
    SUM(allocation_value) AS allocation_value
  FROM (SELECT DISTINCT * FROM THEFT_RATE)DKU
  GROUP BY Article, cal_MERCH_YEAR, cal_YEAR_PERIOD;

  
<br>
--UNSELLABLES_FINAL
--------------------------
</br>
insert into UNSELLABLES_FINAL 
SELECT 
    try_to_number(Article) AS ARTICAL_NO,
    cal_MERCH_YEAR AS MERCH_YEAR,
    cal_YEAR_PERIOD AS YEAR_PERIOD,
    SUM(allocation_value) AS allocation_value
FROM (SELECT DISTINCT * FROM UNSELLABLES_SKRINK_RATE)DKU
GROUP BY Article, cal_MERCH_YEAR, cal_YEAR_PERIOD;

<br>
--VENDOR_COMPLIANCE_FINAL
----------------------------------
</br>
insert into VENDOR_COMPLIANCE_FINAL 
SELECT 
  try_to_number("YEAR") AS "MERCH_YEAR",
  try_to_number("NUMBER") AS "VENDOR_ID",
  try_to_number(year_period) AS YEAR_PERIOD,
  SUM(allocation_value) AS allocation_value
FROM (SELECT DISTINCT * FROM VENDOR_COMPLIANCE_PIVOT)DKU
GROUP BY "YEAR", "NUMBER", year_period;

<br>
--VF_DEFECTIVE_FINAL
----------------------------
</br>
insert into VF_DEFECTIVE_FINAL 
SELECT 
    "article" AS "ARTICLE_NO",
    "vendor" AS "VENDOR_ID",
    "YEAR" AS "MERCH_YEAR",
    year_quarter AS "year_quarter",
    SUM("def_allow") AS "allocation_value"
  FROM (SELECT DISTINCT * FROM VF_DEFECTIVE_PREP)DKU
  GROUP BY "article", "vendor", "YEAR", year_quarter;

<br>
--VOLUME_REBATE_2021_2020_FINAL
--------------------------------
</br>
insert into VOLUME_REBATE_2021_2020_FINAL 
SELECT 
    ParentVendor AS "PARENT_VENDOR_ID",
    "YEAR" AS "MERCH_YEAR",
    "YEAR_MONTH" AS "YEAR_PERIOD",
    SUM(volume_rebate) AS "allocation_value"
  FROM (
    SELECT 
        cast(ParentVendor as number) as ParentVendor,
        cast("YEAR" as number) as "YEAR",
        cast("YEAR_MONTH" as number) as YEAR_MONTH,
        volume_rebate
   FROM VOLUME_REBATE_2021_FOLD_STACKED)DKU
  GROUP BY ParentVendor, "YEAR", "YEAR_MONTH";

<br>
--TENANT149_VOLUME_REBATE_NEW_BY_PARENT_VENDOR_ID
</br>
create or replace temp table TENANT149_VOLUME_REBATE_NEW_BY_PARENT_VENDOR_ID as
SELECT 
        PARENT_VENDOR_ID AS PARENT_VENDOR_ID,
        MERCH_YEAR AS MERCH_YEAR,
        SUM(allocation_value) AS allocation_value
      FROM (
        SELECT 
            YEAR_PERIOD,
            MERCH_YEAR,
            VENDOR_ID,
            allocation_value,
            PARENT_VENDOR_ID
          FROM (                    
              SELECT 
                  volum.YEAR_PERIOD AS YEAR_PERIOD,
                  volum.MERCH_YEAR AS MERCH_YEAR,
                  volum.VENDOR_ID AS VENDOR_ID,
                  volum.allocation_value AS allocation_value,
                  CPVP.PARENT_VENDOR_ID AS PARENT_VENDOR_ID
                FROM (
                    SELECT 
                          cast(YEAR_PERIOD as number) AS YEAR_PERIOD,
                          MERCH_YEAR AS MERCH_YEAR,
                          VENDOR_ID AS VENDOR_ID,
                          allocation_value AS allocation_value
                        FROM VOLUME_REBATE_NEW
                      UNION ALL
                      SELECT 
                              YEAR_MONTH AS YEAR_PERIOD,
                              YEAR AS MERCH_YEAR,
                              CHILDVENDOR AS VENDOR_ID,
                              SUM(VOLUME_REBATE) AS allocation_value
                                FROM VOLUME_REBATE_2022_W_RECEIPTS_FOLD
                            GROUP BY YEAR, YEAR_MONTH, CHILDVENDOR
                ) volum
                LEFT JOIN COMPANY_PARENT_VENDOR_PREPARED CPVP
                  ON cast(volum.VENDOR_ID as number) = CPVP.VENDOR_ID
          ) as dku
          WHERE MERCH_YEAR = 2022
        ) dku__beforegrouping
      GROUP BY PARENT_VENDOR_ID, MERCH_YEAR;

<br>
--VOLUME_REBATE_DEVIATION_FINAL
-----------------------------------
</br>
INSERT INTO VOLUME_REBATE_DEVIATION_FINAL
SELECT
 
    CAST(VOL_REB.Merch_Year AS NUMBER)  AS Merch_Year,
    CAST(VOL_REB.PARENT_VENDOR_ID AS NUMBER) AS PARENT_VENDOR_ID,
    SUM(COALESCE(VOL_REB.allocation_value, 0) - COALESCE(REB_UNIN.allocation_value, 0)) AS allocation_value
FROM
(SELECT
 
    CAST(VRS.Merch_Year AS NUMBER) AS  Merch_Year,
    TRY_TO_NUMBER(CPVP.PARENT_VENDOR_ID) AS PARENT_VENDOR_ID,
    ROUND(SUM(VRS.allocation_value)) as allocation_value
  FROM VOLUMNE_REBATE_STACKED VRS
  LEFT JOIN COMPANY_PARENT_VENDOR_PREPARED CPVP
    ON TRY_TO_NUMBER(VRS.VENDOR_ID)= TRY_TO_NUMBER(CPVP.VENDOR_ID)
  GROUP BY CPVP.PARENT_VENDOR_ID, VRS.Merch_Year ) VOL_REB
 
LEFT JOIN
 
(    SELECT  TRY_TO_NUMBER(PARENT_VENDOR_ID) AS PARENT_VENDOR_ID,
             CAST(MERCH_YEAR AS NUMBER) AS MERCH_YEAR,
             ROUND(allocation_value) AS allocation_value
      FROM TENANT149_VOLUME_REBATE_NEW_BY_PARENT_VENDOR_ID
UNION ALL
SELECT
    CAST(ParentVendor AS NUMBER) AS PARENT_VENDOR_ID,
    "YEAR" AS MERCH_YEAR,
    ROUND(SUM(volume_rebate)) AS allocation_value
  FROM  VOLUME_REBATE_2021_FOLD_STACKED
  GROUP BY ParentVendor, "YEAR") REB_UNIN
  ON   (CAST(VOL_REB.PARENT_VENDOR_ID AS NUMBER)=CAST(REB_UNIN.PARENT_VENDOR_ID AS NUMBER) AND 
     CAST(VOL_REB.MERCH_YEAR AS NUMBER)=CAST(REB_UNIN.MERCH_YEAR AS NUMBER))
GROUP by VOL_REB.PARENT_VENDOR_ID,VOL_REB.Merch_Year;

<br>
--VOLUME_REBATE_DEVIATION_FINAL
</br>
update  VOLUME_REBATE_DEVIATION_FINAL set parent_vendor_id = 0 where parent_vendor_id is null and merch_year is not null;

<br>
--DC_3PL_allocation_cost_union
</br>
insert into  DC_3PL_VARIABLE_COST_COMBINED_STACKED 
SELECT 
    "VCC"."ARTICLE_NO" AS "ARTICLE_NO",
    "VCC"."YEAR_PERIOD" AS "YEAR_PERIOD",
    "VCC"."STORE_NO" AS "STORE_NO",
    "VCC"."VENDOR_ID" AS "VENDOR_ID",
    "VCC".variable_cost_combined AS variable_cost_combined,
    "VCC"."MERCH_YEAR" AS "MERCH_YEAR",
    'Store' AS "channel"
FROM VARIABLE_COST_COMBINED_PREPARED_JOINED_TMP "VCC"
LEFT JOIN LC_3PL_VARIABLE_COST_PER_PALLET_11212022_PREPARED "VCP"
ON "VCC"."STORE_NO" = "VCP"."Facility_Code"
WHERE "Facility_Code" IS NULL
UNION ALL
SELECT 
    "VOLS"."ARTICLE_NO" AS "ARTICLE_NO",
    "VOLS"."YEAR_PERIOD" AS "YEAR_PERIOD",
    "VOLS"."STORE_NO" AS "STORE_NO",
    "VOLS"."VENDOR_ID" AS "VENDOR_ID",
    "VOLS".PL_variable_cost_combined AS "PL_variable_cost_combined",
    "MERCH"."MERCH_YEAR" AS "MERCH_YEAR",
    "VOLS".channel AS "channel"
FROM FACILITY_LOCATION_3PL_MIXING_VOL_WEI_STACKED_PREPARED "VOLS"
LEFT JOIN MERCH_YEAR_YEAR_PERIOD "MERCH"
ON "VOLS"."YEAR_PERIOD" = "MERCH"."YEAR_PERIOD";

<br>
---DC_3PL_omni_fulfillment_base_final
</br>

insert into DC_3PL_OMNI_FULFILLMENT_BASE_FINAL
select  DISTINCT * from TENANT149_DATA_DC_3PL_OMNI_FULFILLMENT_BASE_PREPARED;

<br>
--Hariom's
--D1--battery_core_final

--1
</br>
INSERT INTO  BATTERY_CORE_ALLOCATE
SELECT
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "MERCH_YEAR" AS "MERCH_YEAR",
    "BATTERY_CORE_FLAG" AS "BATTERY_CORE_FLAG",
    CASE WHEN "MERCH_YEAR" < 2023 THEN '501875' ELSE '501479'  END AS "VENDOR_ID",
    SUM("BATTERY_CORE") AS "ALLOCATION_VALUE"
FROM (
    SELECT DISTINCT
         *,
        SUBSTRING("YEAR_PERIOD", 1, 4) AS "MERCH_YEAR",
        1 AS "BATTERY_CORE_FLAG"
    FROM "BATTERY_CORE"
    )"DKU__BEFOREGROUPING"
GROUP BY "YEAR_PERIOD", "MERCH_YEAR", "BATTERY_CORE_FLAG", "VENDOR_ID";


<br>
--2
</br>
insert into BATTERY_CORE_FINAL 
Select DISTINCT  * from BATTERY_CORE_ALLOCATE;

<br>
--D3--omni_small_package_ltl_dropout_final

--1
</br>
insert into OMNI_MASTER_SALES 
SELECT DISTINCT
    *,
    ROUND("BOOKED_SALES_AMT", 0) AS SALES_ALLOCATE,
    ROUND("BOOKED_COST_AMT", 0) AS COST_ALLOCATE
FROM 
    "OMNICHANNEL_SALES";

<br>
--2
</br>
INSERT INTO OMNI_MASTER_SALES_PREP
(
OMS_ORDER_LINE_KEY
)
SELECT  DISTINCT
    OMS_ORDER_LINE_KEY   
FROM "OMNI_MASTER_SALES"


<br>
--D4--small_package_ltl_final

--1
</br>
insert into OMNI_SMALL_PACKAGE_LTL 
SELECT 
    "ORDER_LINE_KEY" AS "OMS_ORDER_LINE_KEY",
    "OMS_ITEM_ID" AS "ARTICLE_NO",
    1 AS "OMNI_SMALL_PACKAGE_FLAG",
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "MERCH_YEAR" AS "MERCH_YEAR",
    SUM("TRANS_AMT_BY_WEIGHT")  AS "ALLOCATION_VALUE"
FROM(
    SELECT 
        "W_P"."ORDER_DATE" AS "ORDER_DATE",
        "W_P"."ORDER_NO" AS "ORDER_NO",
        "W_P"."PO_ORDER_NO" AS "PO_ORDER_NO",
        "W_P"."ORDER_LINE_KEY" AS "ORDER_LINE_KEY",
        "W_P"."PO_ORDER_LINE_KEY" AS "PO_ORDER_LINE_KEY",
        "W_P"."OMS_ITEM_PARCEL_SHIP_FLAG" AS "OMS_ITEM_PARCEL_SHIP_FLAG",
        "W_P"."OMS_ITEM_ID" AS "OMS_ITEM_ID",
        "W_P"."OMS_SHIPMENT_LINE_ITEM_DESC" AS "OMS_SHIPMENT_LINE_ITEM_DESC",
        "W_P"."TRACKING_NO" AS "TRACKING_NO",
        "W_P"."OMS_SHIP_NODE_KEY" AS "OMS_SHIP_NODE_KEY",
        "W_P"."SCAC" AS "SCAC",
        "W_P"."SHIPMENT_QTY" AS "SHIPMENT_QTY",
        "W_P"."LINE_WEIGHT" AS "LINE_WEIGHT",
        "W_P"."TRANS_AMT" AS "TRANS_AMT",
        "W_P"."LINE_WEIGHT_SUM" AS "LINE_WEIGHT_SUM",
        "W_P"."SHIPMENT_TOTAL_WEIGHT" AS "SHIPMENT_TOTAL_WEIGHT",
        "W_P"."SHIPMENT_SHARE_BY_WEIGHT" AS "SHIPMENT_SHARE_BY_WEIGHT",
        "W_P"."TRANS_AMT_BY_WEIGHT" AS "TRANS_AMT_BY_WEIGHT",
        "D_P"."MERCH_YEAR" AS "MERCH_YEAR",
        "D_P"."YEAR_PERIOD" AS "YEAR_PERIOD"
    FROM "OMNI_FREIGHT_DETAIL_SMALL_LTL_WINDOWS_PREPARED" "W_P"
    LEFT JOIN "TENANT149_DATA_TIME_DIMENSION_PREPARED" "D_P"
    ON "W_P"."ORDER_DATE" = "D_P"."DATE"
)BEFORE_GRP
GROUP BY "ORDER_LINE_KEY", "OMS_ITEM_ID", "OMNI_SMALL_PACKAGE_FLAG", "YEAR_PERIOD", "MERCH_YEAR";

<br>
--3 OMNI_SMALL_PACKAGE_LTL_DROPOUT_BY_ALLOCATION_VALUE
</br>
insert into OMNI_SMALL_PACKAGE_LTL_DROPOUT_BY_ALLOCATION_VALUE 
SELECT 
    "YEAR_PERIOD" AS "YEAR_PERIOD",
    "MERCH_YEAR" AS "MERCH_YEAR",
    1 AS "OMNI_SMALL_DROPOUT_FLAG",
    SUM("ALLOCATION_VALUE") AS "ALLOCATION_VALUE"
FROM(
    SELECT *
    FROM (
        SELECT 
            "LTL"."OMS_ORDER_LINE_KEY" AS "OMS_ORDER_LINE_KEY",
            "LTL"."ARTICLE_NO" AS "ARTICLE_NO",
            "LTL"."OMNI_SMALL_PACKAGE_FLAG" AS "OMNI_SMALL_PACKAGE_FLAG",
            "LTL"."YEAR_PERIOD" AS "YEAR_PERIOD",
            "LTL"."MERCH_YEAR" AS "MERCH_YEAR",
            "LTL"."ALLOCATION_VALUE" AS "ALLOCATION_VALUE",
            "O_L_K"."OMS_ORDER_LINE_KEY" AS "SALES_OMS_ORDER_LINE_KEY"
        FROM "OMNI_SMALL_PACKAGE_LTL" "LTL"
        LEFT JOIN (
            SELECT 
                "OMS_ORDER_LINE_KEY" AS "OMS_ORDER_LINE_KEY",
                COUNT("OMS_ORDER_LINE_KEY") AS "COUNT"
            FROM "OMNI_MASTER_SALES_PREP"
            GROUP BY "OMS_ORDER_LINE_KEY"
        ) "O_L_K"
        ON "LTL"."OMS_ORDER_LINE_KEY" = "O_L_K"."OMS_ORDER_LINE_KEY"
        ) "UNFILTERED_QUERY"
    WHERE (CAST("SALES_OMS_ORDER_LINE_KEY" AS VARCHAR) = '') OR "SALES_OMS_ORDER_LINE_KEY" IS NULL
    )"BFORE_GRP"
WHERE "MERCH_YEAR" >= 2020
GROUP BY "YEAR_PERIOD", "MERCH_YEAR", "OMNI_SMALL_DROPOUT_FLAG";


<br>
--4
</br>
insert into OMNI_SMALL_PACKAGE_LTL_DROPOUT_FINAL 
Select DISTINCT * from OMNI_SMALL_PACKAGE_LTL_DROPOUT_BY_ALLOCATION_VALUE;


<br>
--4
</br>
insert into OMNI_SMALL_PACKAGE_LTL_GRP
SELECT 
    OMS_ORDER_LINE_KEY,
    ARTICLE_NO,
    omni_small_package_flag,
    SUM(allocation_value) as allocation_value
FROM (SELECT DISTINCT * FROM OMNI_SMALL_PACKAGE_LTL)DKU
WHERE MERCH_YEAR >= 2020
GROUP BY OMS_ORDER_LINE_KEY, ARTICLE_NO, omni_small_package_flag;

<br>
--2
</br>
insert into SMALL_PACKAGE_LTL_FINAL 
Select  DISTINCT * from OMNI_SMALL_PACKAGE_LTL_GRP;

<br>

--scandowns_final
</br>
insert into SCANDOWNS_FINAL 
SELECT  DISTINCT *
FROM SCANDOWNS_FILTER_BY_YEAR;

<br>
--TENANT149_DATA_volume_rebate_2022_fold_by_Parent_Vendor_stacked_period
</br>
insert into TENANT149_DATA_VOLUME_REBATE_2022_FOLD_BY_PARENT_VENDOR_STACKED_PERIOD
select 
    cast(MERCH_YEAR as number) as MERCH_YEAR,
    cast(YEAR_PERIOD as number) as YEAR_PERIOD, 
    VENDOR_ID, 
    ALLOCATION_VALUE 
from VOLUME_REBATE_2022_FINAL ;

<br>
--markdowns_final_sf
</br>
insert into MARKDOWNS_FINAL_SF
select DISTINCT * from MARKDOWNS_FINAL;

<br>
--update query MARKDOWNS_FINAL_SF need to roll back in future
</br>
update  MARKDOWNS_FINAL_SF set VENDOR_ID = 0 where VENDOR_ID is null and YEAR_PERIOD is not null;

<br>
--update query MARKDOWNS_FINAL need to roll back in future
</br>
update  MARKDOWNS_FINAL set VENDOR_ID = 0 where VENDOR_ID is null and YEAR_PERIOD is not null;

<br>
--vendor_support_fast_exception
</br>
insert into VENDOR_SUPPORT_FAST_EXCEPTION
select DISTINCT * from VENDOR_SUPPORT_FAST_EXCEPTION_FINAL;

<br>
--volume_rebate_deviation
</br>

insert into VOLUME_REBATE_DEVIATION
select DISTINCT * from VOLUME_REBATE_DEVIATION_FINAL;

<br>
--volume_rebate_deviation
</br>
update  volume_rebate_deviation set parent_vendor_id = 0 where parent_vendor_id is null and merch_year is not null;

<br>
--scandowns_final_sf
</br>
insert into SCANDOWNS_FINAL_SF
select DISTINCT * from SCANDOWNS_FINAL;

<br>
--TENANT149_DATA_freight_other_charges_prepared_by_year
</br>
insert into TENANT149_DATA_FREIGHT_OTHER_CHARGES_PREPARED_BY_YEAR
select DISTINCT * from FREIGHT_OTHER_CHARGES_FINAL;

<br>
--volume_rebate_2021_2020_allocate
</br>
insert into VOLUME_REBATE_2021_2020_ALLOCATE
select DISTINCT * from VOLUME_REBATE_2021_2020_FINAL;

<br>
--volume_rebate_2021_2020_allocate
</br>
update  VOLUME_REBATE_2021_2020_ALLOCATE set parent_vendor_id = 0 where parent_vendor_id is null and YEAR_PERIOD is not null;

<br>
--price_cuts_allocate
</br>
insert into PRICE_CUTS_ALLOCATE
select DISTINCT * from PRICE_CUTS_FINAL ;


<br>
--lm_scandown_prepared_filtered
</br>
INSERT INTO LM_SCANDOWN_PREPARED_FILTERED
SELECT DISTINCT * FROM LM_SCANDOWN_FINAL;

<br>
--TENANT149_lm_markdowns_new_filtered
</br>
INSERT INTO TENANT149_LM_MARKDOWNS_NEW_FILTERED
SELECT DISTINCT * FROM LM_MARKDOWNS_FINAL;


<br>
-- UNSELLABLES_ALLOCATE
</br>
insert into UNSELLABLES_ALLOCATE 
select DISTINCT * from UNSELLABLES_FINAL;

<br>
-- DEFECTIVES_ALLOCATE
</br>
insert into DEFECTIVES_ALLOCATE 
select DISTINCT * from "DEFECTIVES_FINAL";

<br>
-- DC_SHRINK_ALLOCATE
</br>
insert into DC_SHRINK_ALLOCATE 
select DISTINCT * from DC_SHRINK_FINAL;

<br>
-- THEFT_ALLOCATE
</br>
insert into THEFT_ALLOCATE 
select DISTINCT * from THEFT_FINAL;

<br>
-- SHRINK_ALLOCATE
</br>
insert into SHRINK_ALLOCATE 
select DISTINCT * from SHRINK_INVENTORY_FINAL;

<br>
-- MIXING_CENTER_CREDIT_PREP
</br>
insert into MIXING_CENTER_CREDIT_PREP 
select DISTINCT * from MIXING_CENTER_FINAL;

<br>
-- VF_DEFECTIVE_ALLOCATE
</br>
insert into VF_DEFECTIVE_ALLOCATE 
select DISTINCT * from VF_DEFECTIVE_FINAL;

<br>
-- TENANT149_DATA_NEW_STORE_DISCOUNT_PREPARED_PREPARED_BY_NSD_SKU
</br>
insert into TENANT149_DATA_NEW_STORE_DISCOUNT_PREPARED_PREPARED_BY_NSD_SKU 
select DISTINCT * from "NEW_STORE_DISCOUNT_FINAL";

<br>
-- POP_ALLOCATE
</br>
insert into POP_ALLOCATE 
select DISTINCT * from "POP_FINAL";

<br>
-- PDQ_ALLOCATE_FILTERED
</br>
insert into PDQ_ALLOCATE_FILTERED 
select DISTINCT * from PDQ_FINAL;

<br>
-- MARKETING_ALLOCATE
</br>
insert into MARKETING_ALLOCATE 
select DISTINCT * from "MARKETING_FINAL";

<br>
-- VENDOR_COMPLIANCE_ALLOCATE
</br>
insert into VENDOR_COMPLIANCE_ALLOCATE 
select DISTINCT * from VENDOR_COMPLIANCE_FINAL;

<br>
-- VENDOR_COMPLIANCE_ALLOCATE
</br>
insert into CASH_DISCOUNTS_W_VENDOR
select DISTINCT * from CASH_DISCOUNTS_W_VENDOR_FINAL;

<br>
-- TENANT149_dc_3pl_PnL_omni_fulfillment_variable
</br>
INSERT INTO  TENANT149_DC_3PL_PNL_OMNI_FULFILLMENT_VARIABLE
SELECT DISTINCT
    STORE_NO AS STORE_NO,
    YEAR_PERIOD AS YEAR_PERIOD,
    channel AS channel,
    MERCH_YEAR AS MERCH_YEAR,
    ALLOCATION_VALUE AS ALLOCATION_VALUE
from DC_3PL_PNL_OMNI_FULFILLMENT_VARIABLE;

<br>
-- TENANT149_dc_3pl_PnL_omni_fulfillment_fixed
</br>
insert into TENANT149_DC_3PL_PNL_OMNI_FULFILLMENT_FIXED
select DISTINCT
 STORE_NO as STORE_NO,
 YEAR_PERIOD as YEAR_PERIOD,
 channel as channel ,
 MERCH_YEAR as  MERCH_YEAR,
 ALLOCATION_VALUE as ALLOCATION_VALUE
from DC_3PL_PNL_OMNI_FULFILLMENT_FIXED

